################################################################################
# FindStatGen3  (c) 2006 originally written by Ian Rutson, ian@rutson.com      #
# Code forked and amended by Mike Wood (Lignumaqua) 2007/2008/2009/2010/2011   #
# /2012/2013 geocaching@mikewoodconsulting.com                                 #
#                                                                              #
# This script for GSAK generates pretty statistics about a Geocachers finds.   #
# Many different type of statistics can be generated as the user has the       #
# option to freely choose which should be included.                            #
#                                                                              #
# Two types of output are available, with and without shaded image bars on the #
# graphs.  Although the version with the shaded bars is 'nicer', the version   #
# without can be pasted directly in the Geocaching.com profile page. Once the  #
# macro has finished running the clipboard is loaded with the code ready for   #
# pasting into your GC.com Profile.                                            #
#                                                                              #
# The user can chose to exclude locationless caches from the 'Finds by         #
# Distance', 'Map' blocks and 'Total Distance' figures.                        #
#                                                                              #
# 4.4 Version History: Lignumaqua                                              #
#                                                                              #
# V4.4.01B 10-01-12 Most States in Day duplicate states in differing countries #
# V4.4.02B 10-11-12 Support Block Party type P                                 #
# V4.4.03B 12-9-12 Fix most types in a day icons                               #
# V4.4.04B 1-14-13 Move Finds By Month chart to POST                           #
# V4.4.05B 2-24-13 Respects $ExternalRunDate - String "YYYYMMDD"               #
#      If valid $ExternalRunDate AND $AutoRun = TRUE then initial form skipped #
#      If $ExternalSettings AND $AutoRun = TRUE then initial form skipped      #
#      Changed position of restore CENTER in Finish to before Restore Sort     #
# V4.4.06B 3-1-13 Respects $ExternalStartDate - String "YYYYMMDD"              #
#                                                                              #
# Bug reports, feature suggestions and any other comments should be posted     #
# on the GSAK forums.                                                          #
#                                                                              #
#                                                                              #
# This code is Open Source and comes with no warranty implied, or otherwise.   #
# I will get around to applying a formal License to it, but in the short term: #
# If it breaks, you get to keep both pieces.                                   #
#                                                                              #
# MacVersion = 4.4.06B
# MacDescription = Find Statistics Generator (4.4)
# MacAuthor = Rutson & Lignumaqua
# MacFileName = FindStatGen44Beta.gsk
# MacUrl = http://gsak.net/board/index.php?showtopic=19790&view=findpost&p=141634
#
################################################################################
# Version check
NOERROR SysVar=$_CurrentDataPath Functions=SqlQuote Commands=RESYNC
VERCHECK Version=7.7.3.53 (Note: this macro requires the latest GSAK 7.7 "patch")
PREPROCESS Shift=$StartOK
GOSUB Name=DeclareVariables
GOSUB Name=DeclareFormVariables
SHOWSTATUS msg="Macro Starting" Width=350

$Revision = MacHeader("MacVersion")

# Set this to true for a major revision to force reset of defaults
$ResetDefaults = FALSE

################################################################################
################################################################################
#                                                                              #
#	  Don't change anything below here unless you know what you're doing!        #
#                                                                              #
################################################################################
################################################################################

# Create and open main sqlite database file
$sqlfile = $_Install + "\macros\FoundStatsSQLLite.db3"
IF NOT(FileExists($sqlfile))
	$status = Sqlite("create",$sqlfile)
ENDIF
$status = Sqlite("open",$sqlfile)

# Clear up old SQLite tables now 7.7 uses these same table names
$_sql = "DROP TABLE IF EXISTS Caches; "
$_sql = $_sql + "DROP TABLE IF EXISTS Logs"
$status = Sqlite("sql",$_sql,"")

$LangStatus01 = "Initializing... 25%"
$LangStatus02 = "Initializing... 50%"

$DefaultSectionOrder = "01:02:03:04:05:06:07:08:09:10:11:12:13:14:15:16:17:19:20"

# Set default Shading bands
$limit1 = "1"
$limit2 = "5"
$limit3 = "10"
$limit4 = "20"
$limit5 = "50"
$limit6 = "100"
$limit7 = "200"
$limit8 = "500"
$limit9 = "1000"

# Set default Shading colors
$color1 = "#FFE0E0"
$color2 = ""
$color3 = ""
$color4 = ""
$color5 = ""
$color6 = ""
$color7 = ""
$color8 = ""
$color9 = ""
$color10 = "#FF0000"

# Set default map background
$MapCol4 = "#93CEED" # Background color 93CEED

#Check if we're using Miles or Kilometres
IF SysInfo("Distance") = "K"
	$distunits = "km"
ELSE
	$distunits = "Miles"
ENDIF
	
IF $distunits=""
	$msg = "Sorry, something is wrong, I couldn't read your Distance setting"
	CANCEL MSG=$msg
ENDIF

# Check user's preferred coord display format
#[TfmConfig]
#
#rbtMinutes.Checked=True
#rbtDegrees.Checked=FALSE
#rbtUTM.Checked=False
#rbtSeconds.Checked=FALSE
#rbtBritishos.Checked=FALSE

BEGINCASE 
	CASE SysInfo("gsakini;TfmConfig;rbtDegrees.Checked") = "True"
		$CoordFormat = "FormatDegrees"
	CASE SysInfo("gsakini;TfmConfig;rbtUTM.Checked") = "True"
		$CoordFormat = "FormatUTM"
	CASE SysInfo("gsakini;TfmConfig;rbtSeconds.Checked") = "True"
		$CoordFormat = "FormatSeconds"
	CASE SysInfo("gsakini;TfmConfig;rbtBritishos.Checked") = "True"
		$CoordFormat = "FormatBG"
	OTHERWISE
		$CoordFormat = "FormatMinutes"
ENDCASE
		

# Some global variables

$CR = $_NewLine

$ImageURL = "http://gsak.net/stats/"
SHOWSTATUS msg="$LangStatus01" Width=350
# Set and validate file paths
$htmlfilepath = $_Install + "\html"
IF Not(FolderExists($htmlfilepath))
	$BatFile = $_Install + "\babel.bat"
	$result = PutFile($BatFile, "MD " + quote($htmlfilepath))
	FileOpen File="$BatFile" Wait=yes
ENDIF

$datafilepath = Sysinfo("MacroPath")
$Folder = $datafilepath + "\FindStatGenData"
IF Not(FolderExists($Folder))
	$BatFile = $_Install + "\babel.bat"
	$result = PutFile($BatFile, "MD " + quote($Folder))
	FileOpen File="$BatFile" Wait=yes
ENDIF

$Folder = $datafilepath + "\FindStatGenData\colorpicker"
IF Not(FolderExists($Folder))
	$BatFile = $_Install + "\babel.bat"
	$result = PutFile($BatFile, "MD " + quote($Folder))
	FileOpen File="$BatFile" Wait=yes
ENDIF

# Create the List variables if this is the first time run
IF Len($Language) = 0
	$LogList = list("LL","create",$_Newline)
	$LogList = list("MM","create",$_Newline)
	$LogList = list("SS","create",$_Newline)

	# Create the List variable used for creating new logs
	$MultiList = list("ML","create",$_Newline)

	# Create the List variable used for fastest 100 calculation
	$Tmps = List("dbfound","create",$_NewLine)

	# Create the List variable used for the SQL
	$list = List("sql","create",$_NewLine)

	# groups for shading county maps
	$list = List("breaks", "create", ";")
	$list = List("colors", "create", ";")

	# set up list that's used for county map manipulation
	$list = list("CtyTable","create", ";")

ENDIF

#Create Special, Milestone and Home tables if necessary
$Data = "snumber integer, stype text, scode text, sdescription text, ssettings integer, UNIQUE(snumber, ssettings)"
$_sql = "CREATE TABLE IF NOT EXISTS Special ($Data)"
$status = Sqlite("sql",$_sql)
	
$Data = "mmilestone integer, mcode text, mdate text, msettings integer, UNIQUE(mmilestone, msettings)"
$_sql = "CREATE TABLE IF NOT EXISTS Milestone ($Data)"
$status = Sqlite("sql",$_sql)

# Create and intialize the Home table the first time run
$_sql = "pragma table_info(home)"
$status = Sqlite("sql",$_sql)
IF Len($status) = 0
	$Data = "hdate text, hlat text, hlon text, hsettings integer, UNIQUE(hdate, hsettings)"
	$_sql = "CREATE TABLE IF NOT EXISTS Home ($Data)"
	$status = Sqlite("sql",$_sql)
	#hdate, hlat, hlon, hsettings

	$text1 = DateToSql([20000503])
	$text2 = "Current"
	$text3 = "Position"
	$_sql = "REPLACE INTO Home VALUES ('$text1','$text2','$text3','1'); "
	$_sql = $_sql + "REPLACE INTO Home VALUES ('$text1','$text2','$text3','2'); "
	$_sql = $_sql + "REPLACE INTO Home VALUES ('$text1','$text2','$text3','3'); "
	$_sql = $_sql + "REPLACE INTO Home VALUES ('$text1','$text2','$text3','4')"
	$work = Sqlite("sql",$_sql)
ENDIF


# Check and update the old SQL files and convert to SQLite if necessary
GOSUB name=UpdateSQLFiles

# Find any language files and populate the drop-down
GOSUB Name=ChooseLang

# Create the default MasterMapData file if it doesn't exist
$FileName = $datafilepath + "\FindStatGenData\FindStatGenMap_MasterShadingFile.dat"
IF Not(FileExists($FileName))
	$tmpS = PutFile($FileName,$FindStatGenMap_MasterShadingFile)
ELSE
	$tmpS = GetFile($Filename)
	IF Left($tmpS,7) = "*Error*" OR Len($TmpS) < 100
		$tmpS = PutFile($FileName,$FindStatGenMap_MasterShadingFile)
	ENDIF
ENDIF

# Create the default US CountyMapData file if it doesn't exist
$FileName = $datafilepath + "\FindStatGenData\FindStatGenMap_USCountyShadingFile.dat"
IF Not(FileExists($FileName))
	$tmpS = PutFile($FileName,$FindStatGenMap_USCountyShadingFile)
ELSE
	$tmpS = GetFile($Filename)
	IF Left($tmpS,7) = "*Error*" OR Len($TmpS) < 100
		$tmpS = PutFile($FileName,$FindStatGenMap_USCountyShadingFile)
	ENDIF
ENDIF

# Create the default World CountryMapData file if it doesn't exist
$FileName = $datafilepath + "\FindStatGenData\FindStatGenMap_WorldCountryShadingFile.dat"
IF Not(FileExists($FileName))
	$tmpS = PutFile($FileName,$FindStatGenMap_WorldCountryShadingFile)
ELSE
	$tmpS = GetFile($Filename)
	IF Left($tmpS,7) = "*Error*" OR Len($TmpS) < 100
		$tmpS = PutFile($FileName,$FindStatGenMap_WorldCountryShadingFile)
	ENDIF
ENDIF

# Create the default Europe CountryMapData file if it doesn't exist
$FileName = $datafilepath + "\FindStatGenData\FindStatGenMap_EuropeCountryShadingFile.dat"
IF Not(FileExists($FileName))
	$tmpS = PutFile($FileName,$FindStatGenMap_EuropeCountryShadingFile)
ELSE
	$tmpS = GetFile($Filename)
	IF Left($tmpS,7) = "*Error*" OR Len($TmpS) < 100
		$tmpS = PutFile($FileName,$FindStatGenMap_EuropeCountryShadingFile)
	ENDIF
ENDIF

# Create the default Canada CountryMapData file if it doesn't exist
$FileName = $datafilepath + "\FindStatGenData\FindStatGenMap_CanadaCountryShadingFile.dat"
IF Not(FileExists($FileName))
	$tmpS = PutFile($FileName,$FindStatGenMap_CanadaCountryShadingFile)
ELSE
	$tmpS = GetFile($Filename)
	IF Left($tmpS,7) = "*Error*" OR Len($TmpS) < 100
		$tmpS = PutFile($FileName,$FindStatGenMap_CanadaCountryShadingFile)
	ENDIF
ENDIF

# Create the default US State MapData file if it doesn't exist
$FileName = $datafilepath + "\FindStatGenData\FindStatGenMap_USStateShadingFile.dat"
IF Not(FileExists($FileName))
	$tmpS = PutFile($FileName,$FindStatGenMap_USStateShadingFile)
ELSE
	$tmpS = GetFile($Filename)
	IF Left($tmpS,7) = "*Error*" OR Len($TmpS) < 100
		$tmpS = PutFile($FileName,$FindStatGenMap_USStateShadingFile)
	ENDIF
ENDIF

# Create the default Australia State MapData file if it doesn't exist
$FileName = $datafilepath + "\FindStatGenData\FindStatGenMap_AustraliaStateShadingFile.dat"
IF Not(FileExists($FileName))
	$tmpS = PutFile($FileName,$FindStatGenMap_AustraliaStateShadingFile)
ELSE
	$tmpS = GetFile($Filename)
	IF Left($tmpS,7) = "*Error*" OR Len($TmpS) < 100
		$tmpS = PutFile($FileName,$FindStatGenMap_AustraliaStateShadingFile)
	ENDIF
ENDIF

# Find any map files and populate the drop-down
GOSUB Name=ChooseCountries

# Set the default run date

IF ValidDate($ExternalRunDate)
	$RunDate = StringToDate($ExternalRunDate)
ELSE
	$RunDate = $_Today
ENDIF

# Set the default start date

IF ValidDate($ExternalStartDate)
	$StartDate = StringToDate($ExternalStartDate)
ELSE
	$StartDate = [20000101]
ENDIF

# Set MapCount variable
$MapIDCount = 1

# Set the default language
$Language="English"
$Settings = 0
GOSUB Name=SetLanguage
$DataFile = $datafilepath + "\FindStatGenData.dat"

# Get Notes files if they exist
IF (FileExists($datafilepath + "\FindStatGenNotes1.dat"))
	$Notes1 = GetFile($datafilepath + "\FindStatGenNotes1.dat")
ELSE
	$Notes1 = ""
ENDIF
IF (FileExists($datafilepath + "\FindStatGenNotes2.dat"))
	$Notes2 = GetFile($datafilepath + "\FindStatGenNotes2.dat")
ELSE
	$Notes2 = ""
ENDIF
IF (FileExists($datafilepath + "\FindStatGenNotes3.dat"))
	$Notes3 = GetFile($datafilepath + "\FindStatGenNotes3.dat")
ELSE
	$Notes3 = ""
ENDIF
IF (FileExists($datafilepath + "\FindStatGenNotes4.dat"))
	$Notes4 = GetFile($datafilepath + "\FindStatGenNotes4.dat")
ELSE
	$Notes4 = ""
ENDIF

IF (FileExists($datafilepath + "\FindStatGenNotes1B.dat"))
	$Notes1B = GetFile($datafilepath + "\FindStatGenNotes1B.dat")
ELSE
	$Notes1B = ""
ENDIF
IF (FileExists($datafilepath + "\FindStatGenNotes2B.dat"))
	$Notes2B = GetFile($datafilepath + "\FindStatGenNotes2B.dat")
ELSE
	$Notes2B = ""
ENDIF
IF (FileExists($datafilepath + "\FindStatGenNotes3B.dat"))
	$Notes3B = GetFile($datafilepath + "\FindStatGenNotes3B.dat")
ELSE
	$Notes3B = ""
ENDIF
IF (FileExists($datafilepath + "\FindStatGenNotes4B.dat"))
	$Notes4B = GetFile($datafilepath + "\FindStatGenNotes4B.dat")
ELSE
	$Notes4B = ""
ENDIF

IF (FileExists($datafilepath + "\FindStatGenNotes1C.dat"))
	$Notes1C = GetFile($datafilepath + "\FindStatGenNotes1C.dat")
ELSE
	$Notes1C = ""
ENDIF
IF (FileExists($datafilepath + "\FindStatGenNotes2C.dat"))
	$Notes2C = GetFile($datafilepath + "\FindStatGenNotes2C.dat")
ELSE
	$Notes2C = ""
ENDIF
IF (FileExists($datafilepath + "\FindStatGenNotes3C.dat"))
	$Notes3C = GetFile($datafilepath + "\FindStatGenNotes3C.dat")
ELSE
	$Notes3C = ""
ENDIF
IF (FileExists($datafilepath + "\FindStatGenNotes4C.dat"))
	$Notes4C = GetFile($datafilepath + "\FindStatGenNotes4C.dat")
ELSE
	$Notes4C = ""
ENDIF

SHOWSTATUS msg="$LangStatus02" Width=350
# Check if the data-file exist?
$NewVersion = TRUE

# Create the SQLite table for the section order
$Data = "ID integer,Position integer,Width integer, Enabled boolean, Settings integer, PlugInBefore text DEFAULT '', PlugInAfter text DEFAULT ''"
$_sql = "CREATE TABLE IF NOT EXISTS OrderMenu ($Data)"
$status = Sqlite("sql",$_sql)

# Add the pluginbefore and pluginafter fields if they aren't already present
$_sql = "select lower(sql) from sqlite_master where name='OrderMenu'"
$status = Sqlite("sql",$_sql)
IF At("pluginbefore",$status) = 0
	$Data = "PlugInBefore text DEFAULT ''"
	$_sql = "ALTER TABLE OrderMenu ADD COLUMN $Data"
	$status = Sqlite("sql",$_sql)
	$Data = "PlugInAfter text DEFAULT ''"
	$_sql = "ALTER TABLE OrderMenu ADD COLUMN $Data"
	$status = Sqlite("sql",$_sql)
ENDIF


# Create the SQLite table for our settings
$Data ="SaveName text UNIQUE, SaveText text"
$_sql = "CREATE TABLE IF NOT EXISTS SavedSettings ($Data)"
$status = Sqlite("sql",$_sql)

# Check if SavedSettings has any values, if not then migrate over the old .dat settings
$_sql = "SELECT SaveText from SavedSettings WHERE SaveName=1"
$status = Sqlite("sql",$_sql)
IF $status = ""
	IF (FileExists($DataFile))
		GOSUB name=ConvertSettingsToSql
	ENDIF
ENDIF

$_sql = "SELECT SaveText FROM SavedSettings WHERE SaveName = '1'"
$Settings1 = Sqlite("sql",$_sql,"delim=%$%")

IF $settings1 = ""
	GOSUB name=SetDefaults
ENDIF

$_sql = "SELECT SaveText FROM SavedSettings WHERE SaveName = '2'"
$Settings2 = Sqlite("sql",$_sql,"delim=%$%")
IF $Settings2 = ""
	$Settings2 = $Settings1
ENDIF

$_sql = "SELECT SaveText FROM SavedSettings WHERE SaveName = '3'"
$Settings3 = Sqlite("sql",$_sql,"delim=%$%")
IF $Settings3 = ""
	$Settings3 = $Settings1
ENDIF

$_sql = "SELECT SaveText FROM SavedSettings WHERE SaveName = '4'"
$Settings4 = Sqlite("sql",$_sql,"delim=%$%")
IF $Settings4 = ""
	$Settings4 = $Settings1
ENDIF

$_sql = "SELECT SaveText FROM SavedSettings WHERE SaveName = 'Settings'"
$Settings = Val(Sqlite("sql",$_sql))
IF $Settings = 0
	$Settings = 1
ENDIF

# Use $ExternalSettings variable if it's been set by another calling macro
IF $ExternalSettings > 0 AND $ExternalSettings <5 AND $ExternalSettings = Int($ExternalSettings)
	$Settings = $ExternalSettings
ENDIF

$SettingsPrevious = $Settings

# If the file exists then read the saved values and assign them to variables
GOSUB Name=LoadSettings

IF $FileRevision = $Revision
	$NewVersion = FALSE
ENDIF

GOSUB name=DoTypecasting

# Set the language
GOSUB Name=SetLanguage

GOSUB Name=CheckOrderMenu


SHOWSTATUS msg="$LangStatus03" Width=350

$dblist = SysInfo("databases")
# Remove the temp database from the list if it's there
#$dblist = Replace("FindStatsGenTempDatabase;","",$dblist,TRUE)

$stylelist = "Blue;Green;Red;Grey;Minimal;Smooth;Generator"

# User Style File - add to menu if exists
$StyleFile = $datafilepath + "\FindStatGenStyle.dat"
$UserStyleName=""
IF (FileExists($StyleFile))
	FILEREAD File=$StyleFile
	#Style name is in first line after the # then trim whitespace
	$UserStyleName = Extract($line,"#",2)
	$UserStyleName = RegExReplace("^\s+|\s+$", $UserStyleName, "")
	$stylelist = $stylelist + ";$UserStyleName"
	STOPREAD
	ENDREAD
ELSE
	$StyleFile = $datafilepath + "\FindStatGenData\FindStatGenStyle.dat"
	IF (FileExists($StyleFile))
		FILEREAD File=$StyleFile
		#Style name is in first line after the # then trim whitespace
		$UserStyleName = Extract($line,"#",2)
		$UserStyleName = RegExReplace("^\s+|\s+$", $UserStyleName, "")
		$stylelist = $stylelist + ";$UserStyleName"
		STOPREAD
		ENDREAD
	ENDIF
ENDIF

# Get the system location list and strip off the coordinates
$loclist = ""
$rawloclist = Sysinfo("locations")
$loclist = RegexReplace(",.*?;",$rawloclist,";")

IF $ResetDefaults AND $NewVersion
	#$SectionOrder = $DefaultSectionOrder
ENDIF

SHOWSTATUS Msg="$LangStatus04" Display=Off


IF (ValidDate($ExternalRunDate) AND $AutoRun) OR ($ExternalSettings > 0 AND $ExternalSettings <5 AND $ExternalSettings = Int($ExternalSettings) AND $AutoRun)
	# Skip starting form

ELSE

	$AutoRun = $StartAuto

	# ============= Startup Form ==============
	$Form2 = Editform($Form2,"VersionLabel","caption","V$Revision")
	$Form2 = Editform($Form2,"SettingsLabel","caption","Setting Group: $Settings ")

	WHILE NOT($StartOK) AND NOT($StartOptions)
		IF $AutoRun
			# Show labels in Red if auto-run
			$Form2 = Editform($Form2,"Form2","Delay","10")
			$Form2 = Editform($Form2,"Start1","color","255")
			$Form2 = Editform($Form2,"Start3","enabled","yes")
			$Form2 = Editform($Form2,"Start3","color","255")
		ENDIF

		# Center labels on form
		$tmpS = NumToStr(Int(180 - 4*(Len($LangForm30))))
		$Form2 = Editform($Form2,"Start1","left","$tmpS")
		$tmpS = NumToStr(Int(180 - 2.4*(Len($LangForm28))))
		$Form2 = Editform($Form2,"Start3","left","$tmpS")

		WHILE TRUE # Form Loop
			$tmpS = Form($form2,"")
			# Reset the screen position of the menu form to where the user left it
			$Form2 = EditForm($Form2,"Form2","Top",$_FormTop)
			$Form2 = EditForm($Form2,"Form2","Left",$_FormLeft)

			BEGINCASE #Buttons
			CASE $Startcancel
				cancel msg="Generation cancelled"
			CASE $Help
				$Form2 = Editform($Form2,"Form2","Delay","0")
				$AutoRun = FALSE
				GOSUB Name=Help
			CASE $CheckUpdates
				GOSUB Name=CheckUpdates
			CASE $StartOptions
				$StartOK = TRUE
				BREAK
			CASE $tmpS = "DelayExit"
				$StartOK = TRUE
				BREAK
			CASE $StartOK
				BREAK
			OTHERWISE
				CANCEL msg="Macro cancelled"
			ENDCASE
		ENDWHILE # Form Loop

	ENDWHILE
ENDIF
# If we get to here then the user must have clicked on the OK or the Options button or it was autorun AND an external date was supplied

# ============= End Startup Form ==============

SHOWSTATUS msg="$LangStatus05" Width=350

IF $StartOptions OR $NewVersion
	SHOWSTATUS msg="$LangStatus06" Width=350

	$OK = FALSE

	WHILE NOT($OK)
		SHOWSTATUS Msg="$LangStatus07" Display=Off

		# Set File Revision to current
		$FileRevision = $Revision

		# ============= Main Form ==============
		WHILE TRUE
			IF $StyleSet = "Generator"
				$form = EditForm($form,"Seed","Visible","Yes")
			ELSE
				$form = EditForm($form,"Seed","Visible","No")
			ENDIF
			
			IF $UseImageBars
				$Form = EditForm($Form,"FrmLbl39","Enabled","Yes")
				$Form = EditForm($Form,"FrmLbl40","Enabled","Yes")
				$Form = EditForm($Form,"RadioLabel1","Enabled","Yes")
				$Form = EditForm($Form,"RadioLabel2","Enabled","Yes")
				$Form = EditForm($Form,"ImagePathLocal","Enabled","Yes")
				$Form = EditForm($Form,"ImagePathRemote","Enabled","Yes")
			ELSE
				$Form = EditForm($Form,"FrmLbl39","Enabled","No")
				$Form = EditForm($Form,"FrmLbl40","Enabled","No")
				$Form = EditForm($Form,"RadioLabel1","Enabled","No")
				$Form = EditForm($Form,"RadioLabel2","Enabled","No")
				$Form = EditForm($Form,"ImagePathLocal","Enabled","No")
				$Form = EditForm($Form,"ImagePathRemote","Enabled","No")
			ENDIF
			
			$tmpS = Form($form,"")
			# Reset the screen position of the menu form to where the user left it
			$Form = EditForm($Form,"Form1","Top",$_FormTop)
			$Form = EditForm($Form,"Form1","Left",$_FormLeft)
			BEGINCASE
			CASE $OK
				BREAK

			CASE $cancelform
				CANCEL msg="Generation cancelled"

				# Reset Defaults pressed
			CASE $Reset
				$SomeNumbers = "TTTTTTTTTTT"
				$PlacedSections = "TTTT"
				GOSUB Name=CheckOrderMenu
				GOSUB name=DoTypecasting
				BREAK

				# Select Settings and Language combo
			CASE $Select1 OR $Select2 OR $Select3 OR $Select4 OR $tmpS = "Language"
				$Top = $_FormTop
				$Left = $_FormLeft
				GOSUB Name=ReverseTypecasting
				GOSUB Name=StoreSettings
				GOSUB name=SelectSettings
				GOSUB Name=SetLanguage
				GOSUB Name=SaveSettings
				$SettingsPrevious = $Settings
				#If it's a Major revision reset defaults the first time through
				IF NOT($FileRevision = $Revision) AND $ResetDefaults
					#$SectionOrder = $DefaultSectionOrder
				ENDIF
				$Form = Replace("#top=","top=$Top",$Form,TRUE)
				$Form = Replace("#left=","left=$Left",$Form,TRUE)
				BREAK
				
				#Style changed
			CASE $tmpS = "StyleSet"
				
				#Image bar source changed
			CASE $tmpS = "UseImageBars" OR $tmpS = "UseHeatBars" OR $tmpS = "UsePlainBars"

				# Save ALL the settings
			CASE $SelectStore
				GOSUB Name=ReverseTypecasting
				GOSUB Name=StoreSettings
				GOSUB Name=SetLanguage
				GOSUB Name=SaveSettings
				BREAK
				
				# Copy Settings
			CASE $CopySettings
				GOSUB Name=ReverseTypecasting
				GOSUB Name=StoreSettings
				GOSUB Name=CopySettings
				BREAK

				#Help button
			CASE $Help
				GOSUB Name=Help

				# Notes button
			CASE $NotesButton
				GOSUB Name=ReverseTypecasting
				GOSUB Name=StoreSettings
				GOSUB Name=EditNotes
				BREAK

				# Numbers button
			CASE $NumButton
				GOSUB Name=ReverseTypecasting
				GOSUB Name=StoreSettings
				GOSUB Name=EditNumbers
				BREAK

				# Special button
			CASE $SpecialButton
				GOSUB Name=ReverseTypecasting
				GOSUB Name=StoreSettings
				GOSUB Name=EditSpecial
				BREAK

				# Placed button
			CASE $placededit
				GOSUB Name=ReverseTypecasting
				GOSUB Name=StoreSettings
				GOSUB Name=EditPlaced
				BREAK

				# Milestone set
			CASE $milestoneedit
				GOSUB Name=ReverseTypecasting
				GOSUB Name=StoreSettings
				GOSUB name=MilestoneOverride
				BREAK

				# Maps edit
			CASE $MapsButton
				GOSUB Name=ReverseTypecasting
				GOSUB Name=StoreSettings
				GOSUB name=GetMapSelection
				BREAK
				
				# Elevation edit
			CASE $ElevationEdit
				GOSUB Name=ReverseTypecasting
				GOSUB Name=StoreSettings
				GOSUB name=ElevationOptions 
				BREAK
	
				# Home Position edit
			CASE $EditHomePosition
				GOSUB Name=ReverseTypecasting
				GOSUB Name=StoreSettings
				GOSUB Name=MainHome
				BREAK

				# Check database integrity
			CASE $Check
				GOSUB Name=CheckDatabase

				# Settings order
			CASE $SetSectionOrder
				GOSUB Name=ReverseTypecasting
				GOSUB Name=StoreSettings
				GOSUB Name=SetSectionOrder

			OTHERWISE
				CANCEL msg="Macro cancelled"

			ENDCASE

		ENDWHILE

	ENDWHILE

	# If we get to here then the user must have clicked on the OK button

	# cancel msg="OK pressed"

	# ============= End Main Form ==============

ENDIF
GOSUB Name=ReverseTypecasting
GOSUB Name=StoreSettings
GOSUB Name=SetLanguage

# Save the value into $datafile to be reused the next time the macro is run
GOSUB Name=SaveSettings

SHOWSTATUS msg="$LangStatus08" Width=350
# Add / suffix to $imagepath if needed

IF Len($imagepath)>0 AND Right($imagepath,1)<> "/"
	$imagepath = $imagepath + "/"
ENDIF

# This subroutine MUST be called first! ie. don't change this line
GOSUB Name=Start

# Then call the stats routines in any order.  Some routines
# generate full width output, and some half width.  The output looks better if
# the half width ones are called in pairs so they end up next to each other.
# the DiffTerr rouine is unique as it generates a pair of half width blocks

$_sql = "SELECT ID FROM OrderMenu WHERE Settings = $Settings AND Enabled = 1 ORDER by Position"
$SectionTemp = Sqlite("sql",$_sql,"")
$SectionTemp = Replace($_NewLine,";",$SectionTemp)
$SectionCount = RegExCount(";",$SectionTemp) + 1
$RunningSectionCount = 1

WHILE $RunningSectionCount <= $SectionCount
	$ShowTitle = TRUE
	$Before = FALSE
	$TabHtml = ""
	$Srun = Extract($SectionTemp,";",$RunningSectionCount)
	# Add plugin notes section before section
	$_sql = "SELECT pluginbefore FROM OrderMenu WHERE ID = $Srun AND Settings = $Settings"
	$PlugInNotes = Sqlite("sql",$_sql,"delim=%%delim%% crlfcvt=%%crlf%%")
	IF Len(RegExReplace("<fsgtitle>(.*?)</fsgtitle>",$PlugInNotes,"")) > 0
		$PlugInNotes = Replace("%%crlf%%",$_CrLf,$PlugInNotes)
		$Before = TRUE
		GOSUB Name=PlugInNotes
	ENDIF
	$ShowTitle = TRUE
	GOSUB Name=RunSections
	$ShowTitle = TRUE
	# Add plugin notes section after section
	$_sql = "SELECT pluginafter FROM OrderMenu WHERE ID = $Srun AND Settings = $Settings"
	$PlugInNotes = Sqlite("sql",$_sql,"delim=%%delim%% crlfcvt=%%crlf%%")
	IF Len(RegExReplace("<fsgtitle>(.*?)</fsgtitle>",$PlugInNotes,"")) > 0
		$PlugInNotes = Replace("%%crlf%%",$_CrLf,$PlugInNotes)
		$Before = FALSE
		GOSUB Name=PlugInNotes
	ENDIF
	$RunningSectionCount = $RunningSectionCount + 1
ENDWHILE

# Tidy up and restore previous view
GOSUB Name=Finish
# All done, write output the file
GOSUB Name=Output
# We are finished!
RETURN
########################---START OF SUBROUTINES---##############################
########################---General Subroutines---###############################

BEGINSUB Name=CheckOrderMenu
	
# Check if OrderMenu has any values, if not load it with default values
$tmpB = FALSE
$_sql = "SELECT ID from OrderMenu WHERE Settings=1 and Position = 1"
$status = Sqlite("sql",$_sql)
IF $status = ""
	$_sql = "DROP TABLE IF EXISTS OrderMenu"
	$status = Sqlite("sql",$_sql,"")
	$Data = "ID integer,Position integer,Width integer, Enabled boolean, Settings integer, PlugInBefore text DEFAULT '', PlugInAfter text DEFAULT ''"
	$_sql = "CREATE TABLE IF NOT EXISTS OrderMenu ($Data)"
	$status = Sqlite("sql",$_sql)
	$status = Sqlite("import",$DefaultMenuFile,"table=OrderMenu")
ENDIF

IF $Reset
	$Reset = FALSE
	$_sql = "DELETE FROM OrderMenu where settings = '$settings'"
	$status = Sqlite("sql",$_sql,"")
	$tmpS = Replace("%s","$settings",$DefaultSingleMenuFile)
	$status = Sqlite("import",$tmpS,"table=OrderMenu")
ENDIF


##############################################################################################################
# Update Order Menu with any new sections after 23 as ; separated list for ID and Width (1 or 2)             #
# Also add the names as $LangT?? $LangT24 in each language and add to main string in DefineNames subroutine  #
##############################################################################################################

$NewSectionIDs = "24;25;26;27;28;29;30;31;32;33;34;35;36"
$NewSectionWidths = "1;2;2;2;2;2;1;2;2;2;2;2;2"
$NewCount = 13

$count = 1

$status = Sqlite("sql","BEGIN")

WHILE $count <= $NewCount
	$ID = Extract($NewSectionIDs,";",$count)
	$Width = Val(Extract($NewSectionWidths,";",$count))
	$tmpN = Val($ID) - 1
	$j = 1
	WHILE $j <= 4
		$_sql = "SELECT * from OrderMenu WHERE ID = '$ID' AND Settings = '$j'"
		$status = Sqlite("sql",$_sql,"")
		IF Len($status) = 0
			$_sql = "INSERT INTO OrderMenu VALUES ('$ID','$tmpN','$Width','0','$j','','')"
			$status = Sqlite("sql",$_sql,"")
		ENDIF
		$j = $j + 1
	ENDWHILE
	$count = $count + 1
ENDWHILE

$status = Sqlite("sql","COMMIT")

ENDSUB #Name=CheckOrderMenu

BEGINSUB name=CopySettings
	$to1 = FALSE
	$to2 = FALSE
	$to3 = FALSE
	$to4 = FALSE
	
	$Form21 = Editform($form21,"to1","enabled","yes")
	$Form21 = Editform($form21,"to2","enabled","yes")
	$Form21 = Editform($form21,"to3","enabled","yes")
	$Form21 = Editform($form21,"to4","enabled","yes")
	
	$Form21 = Editform($form21,"settinglabel","caption","$settings")
	
	IF $settings = 1
		$Form21 = Editform($form21,"to1","enabled","no")
	ENDIF
	IF $settings = 2
		$Form21 = Editform($form21,"to2","enabled","no")
	ENDIF
	IF $settings = 3
		$Form21 = Editform($form21,"to3","enabled","no")
	ENDIF
	IF $settings = 4
		$Form21 = Editform($form21,"to4","enabled","no")
	ENDIF

	WHILE TRUE
		$tmpS = Form($form21,"")
		# Reset the screen position of the menu form to where the user left it
		$Form21 = EditForm($Form21,"Form21","Top",$_FormTop)
		$Form21 = EditForm($Form21,"Form21","Left",$_FormLeft)
		BEGINCASE
		CASE $CancelSettings
			BREAK
		CASE $CopySettingsOK
			BEGINCASE
				CASE $to1
					$tmpN = 1
				CASE $to2
					$tmpN = 2
				CASE $to3
					$tmpN = 3
				CASE $to4
					$tmpN = 4
				OTHERWISE
					BREAK
			ENDCASE
			IF $settings <> $tmpN
				IF $settings = 1
					BEGINCASE
						CASE $tmpN = 2
							$Settings2 = $Settings1
							$Notes2 = $Notes1
							$Notes2B = $Notes1B
							$Notes2C = $Notes1C
						CASE $tmpN = 3
							$Settings3 = $Settings1
							$Notes3 = $Notes1
							$Notes3B = $Notes1B
							$Notes3C = $Notes1C
						CASE $tmpN = 4
							$Settings4 = $Settings1
							$Notes4 = $Notes1
							$Notes4B = $Notes1B
							$Notes4C = $Notes1C
					ENDCASE
				ENDIF
				IF $settings = 2
					BEGINCASE
						CASE $tmpN = 1
							$Settings1 = $Settings2
							$Notes1 = $Notes2
							$Notes1B = $Notes2B
							$Notes1C = $Notes2C
						CASE $tmpN = 3
							$Settings3 = $Settings2
							$Notes3 = $Notes2
							$Notes3B = $Notes2B
							$Notes3C = $Notes2C
						CASE $tmpN = 4
							$Settings4 = $Settings2
							$Notes4 = $Notes2
							$Notes4B = $Notes2B
							$Notes4C = $Notes2C
					ENDCASE
				ENDIF
				IF $settings = 3
					BEGINCASE
						CASE $tmpN = 1
							$Settings1 = $Settings3
							$Notes1 = $Notes3
							$Notes1B = $Notes3B
							$Notes1C = $Notes3C
						CASE $tmpN = 2
							$Settings2 = $Settings3
							$Notes2 = $Notes3
							$Notes2B = $Notes3B
							$Notes2C = $Notes3C
						CASE $tmpN = 4
							$Settings4 = $Settings3
							$Notes4 = $Notes3
							$Notes4B = $Notes3B
							$Notes4C = $Notes3C
					ENDCASE
				ENDIF
				IF $settings = 4
					BEGINCASE
						CASE $tmpN = 1
							$Settings1 = $Settings4
							$Notes1 = $Notes4
							$Notes1B = $Notes4B
							$Notes1C = $Notes4C
						CASE $tmpN = 2
							$Settings2 = $Settings4
							$Notes2 = $Notes4
							$Notes2B = $Notes4B
							$Notes2C = $Notes4C
						CASE $tmpN = 3
							$Settings3 = $Settings4
							$Notes3 = $Notes4
							$Notes3B = $Notes4B
							$Notes3C = $Notes4C
					ENDCASE
				ENDIF
				
				# Update all the SQLite files
				$_sql = "delete from home where hsettings = '$tmpN' "
				$status = Sqlite("sql",$_sql,"")
				$_sql = "replace into home (hsettings, hdate, hlat, hlon) select '$tmpN', hdate, hlat, hlon from home where hsettings = '$settings' "
				$status = Sqlite("sql",$_sql,"")
				
				$_sql = "delete from milestone where msettings = '$tmpN' "
				$status = Sqlite("sql",$_sql,"")
				$_sql = "replace into milestone (msettings, mmilestone, mcode, mdate) select '$tmpN', mmilestone, mcode, mdate from milestone where msettings = '$settings' "
				$status = Sqlite("sql",$_sql,"")
				
				$_sql = "delete from ordermenu where settings = '$tmpN' "
				$status = Sqlite("sql",$_sql,"")
				$_sql = "replace into ordermenu (settings, id, position, width, enabled, pluginbefore, pluginafter) select '$tmpN', id, position, width, enabled, pluginbefore, pluginafter from ordermenu where settings = '$settings' "
				$status = Sqlite("sql",$_sql,"")
				
				$_sql = "delete from special where ssettings = '$tmpN' "
				$status = Sqlite("sql",$_sql,"")
				$_sql = "replace into special (ssettings, snumber, stype, scode, sdescription) select '$tmpN', snumber, stype, scode, sdescription from special where ssettings = '$settings' "
				$status = Sqlite("sql",$_sql,"")
				
				# Now save it all to disk
				GOSUB Name=SaveSettings
								
			ENDIF
			BREAK
		OTHERWISE
			BREAK
		ENDCASE
	ENDWHILE
ENDSUB # CopySettings


BEGINSUB Name=EditNotes
	$NotesOld = $Notes
	$NotesOldB = $NotesB
	$NotesOldC = $NotesC
	$Title = RegExSub("<fsgtitle>(.*?)</fsgtitle>",$Notes,1,1)
	$TitleB = RegExSub("<fsgtitle>(.*?)</fsgtitle>",$NotesB,1,1)
	$TitleC = RegExSub("<fsgtitle>(.*?)</fsgtitle>",$NotesC,1,1)
	$Notes = RegExReplace("<fsgtitle>(.*?)</fsgtitle>",$Notes,"")
	$NotesB = RegExReplace("<fsgtitle>(.*?)</fsgtitle>",$NotesB,"")
	$NotesC = RegExReplace("<fsgtitle>(.*?)</fsgtitle>",$NotesC,"")
	WHILE TRUE
		$tmpS = Form($form3,"")
		# Reset the screen position of the menu form to where the user left it
		$Form3 = EditForm($Form3,"Form3","Top",$_FormTop)
		$Form3 = EditForm($Form3,"Form3","Left",$_FormLeft)
		BEGINCASE
		CASE $Notescancel
			$Notes = $NotesOld
			$NotesB = $NotesOldB
			$NotesC = $NotesOldC
			BREAK
		CASE $NotesOK
			$Notes = "<fsgtitle>$Title</fsgtitle>$Notes"
			$NotesB = "<fsgtitle>$TitleB</fsgtitle>$NotesB"
			$NotesC = "<fsgtitle>$TitleC</fsgtitle>$NotesC"
			BREAK
		CASE $Test OR $TestB OR $TestC
			$tmpS1 = "width:750px;  background: #dedeee; color: black; margin: 1px; border: outset;"
			$stSectHead = "background: #666699; font-weight: bold; line-height: 20px; font-size: 13px; color: white; border: 1px solid #000000;	 margin: 0px auto; text-align: center;"
			$width = 750
			$tmpS = "<div align='center' style='$tmpS1 line-height: normal;'>" + "<div style='width:750px; font-family: Verdana, Arial, sans-serif; font-size: 13px; text-align: center;'>" + $CR
			
			BEGINCASE
				CASE $Test
					$text1 = $tmpS + $Notes + $CR
				CASE $TestB
					$text1 = $tmpS + $NotesB + $CR
				CASE $TestC
					$text1 = $tmpS + $NotesC + $CR
			ENDCASE
			
			$text1 = RegExReplace("(?m)^\s*?#.*?$",$text1,"")
			
			GOSUB Name=BuildNote
			
			$tmpS = $text1 + "</div></div>" + $CR
			$result = PutFile($datafilepath + "\FindStatGenNotesTest.html", $tmpS)
			IF Left($result, 7) = "*Error*"
				# If theres any error abort the macro
				CANCEL Msg="Unable to write to FindStatGenNotesTest.html!"
			ENDIF
			$tmpS = "file:///" + $datafilepath + "\FindStatGenNotesTest.html"
			$form19 = EditForm($form19,"NotesBrowser","url",$tmpS)
			$tmpS = Form($form19,"")
		OTHERWISE
			CANCEL msg="Macro cancelled"
		ENDCASE
	ENDWHILE
ENDSUB #EditNotes

BEGINSUB Name=EditPlugIn
	$PlugInBeforeOld = $PlugInBefore
	$PlugInAfterOld = $PlugInAfter
	$Title = RegExSub("<fsgtitle>(.*?)</fsgtitle>",$PlugInBefore,1,1)
	$TitleB = RegExSub("<fsgtitle>(.*?)</fsgtitle>",$PlugInAfter,1,1)
	$PlugInBefore = RegExReplace("<fsgtitle>(.*?)</fsgtitle>",$PlugInBefore,"")
	$PlugInAfter = RegExReplace("<fsgtitle>(.*?)</fsgtitle>",$PlugInAfter,"")
	$_sql="SELECT NAME FROM OrderMenu NATURAL JOIN Names WHERE Position = $CurrentPosition AND Settings = $Settings"
	$name = Sqlite("sql",$_sql)
	$Form20 = Editform($Form20,"Groupbox1","caption","Notes before: $name ")
	$Form20 = Editform($Form20,"Groupbox2","caption","Notes after: $name ")
	WHILE TRUE
		$tmpS = Form($form20,"")
		# Reset the screen position of the menu form to where the user left it
		$Form20 = EditForm($Form20,"Form20","Top",$_FormTop)
		$Form20 = EditForm($Form20,"Form20","Left",$_FormLeft)
		
		BEGINCASE
		CASE $Notescancel
			$PlugInBefore = $PlugInBeforeOld
			$PlugInAfter = $PlugInAfterOld
			BREAK
		CASE $NotesOK
			$PlugInBefore = "<fsgtitle>$Title</fsgtitle>$PlugInBefore"
			$PlugInAfter = "<fsgtitle>$TitleB</fsgtitle>$PlugInAfter"
			BREAK
		CASE $Test OR $TestB
			$tmpS1 = "width:750px;  background: #dedeee; color: black; margin: 1px; border: outset;"
			$stSectHead = "background: #666699; font-weight: bold; line-height: 20px; font-size: 13px; color: white; border: 1px solid #000000;	text-align: center; margin: 0px auto; "
			$width = 750
			$tmpS = "<div align='center' style='$tmpS1 line-height: normal;'>" + "<div style='width:750px; font-family: Verdana, Arial, sans-serif; font-size: 13px; text-align: center;'>" + $CR
			
			BEGINCASE
				CASE $Test
					$text1 = $tmpS + $PlugInBefore + $CR
				CASE $TestB
					$text1 = $tmpS + $PlugInAfter + $CR
			ENDCASE
			
			GOSUB Name=BuildNote
			
			$tmpS = $text1 + "</div></div>" + $CR
			$result = PutFile($datafilepath + "\FindStatGenNotesTest.html", $tmpS)
			IF Left($result, 7) = "*Error*"
				# If theres any error abort the macro
				CANCEL Msg="Unable to write to FindStatGenNotesTest.html!"
			ENDIF
			$tmpS = "file:///" + $datafilepath + "\FindStatGenNotesTest.html"
			$form19 = EditForm($form19,"NotesBrowser","url",$tmpS)
			$tmpS = Form($form19,"")
		OTHERWISE
			CANCEL msg="Macro cancelled"
		ENDCASE
	ENDWHILE
ENDSUB #EditPlugIn


BEGINSUB Name=EditNumbers
	$NumbersOld = $SomeNumbers
	WHILE TRUE
		$tmpS = Form($form5,"")
		# Reset the screen position of the menu form to where the user left it
		$Form5 = EditForm($Form5,"Form5","Top",$_FormTop)
		$Form5 = EditForm($Form5,"Form5","Left",$_FormLeft)
		BEGINCASE
		CASE $Numcancel
			$SomeNumbers = $NumbersOld
			GOSUB name=DoTypecasting
			BREAK
		CASE $NumOK
			IF Regex("[^0-9]", $ClosestText) OR Val($ClosestText)<0
				MSGOK msg="The Closest value must be a positive integer"
			ELSE
				$SomeNumbers = BoolToStr($numTotals,"T","F")
				$SomeNumbers = $SomeNumbers + BoolToStr($numConsecutive,"T","F")
				$SomeNumbers = $SomeNumbers + BoolToStr($numPeriods,"T","F")
				$SomeNumbers = $SomeNumbers + BoolToStr($numFastest,"T","F")
				$SomeNumbers = $SomeNumbers + BoolToStr($numDistance,"T","F")
				$SomeNumbers = $SomeNumbers + BoolToStr($numClosest,"T","F")
				$SomeNumbers = $SomeNumbers + BoolToStr($numExtremes,"T","F")
				$SomeNumbers = $SomeNumbers + BoolToStr($numCentroid,"T","F")
				$SomeNumbers = $SomeNumbers + BoolToStr($numOldest,"T","F")
				$SomeNumbers = $SomeNumbers + BoolToStr($numArchived,"T","F")
				$SomeNumbers = $SomeNumbers + BoolToStr($numFTF,"T","F")
				$SomeNumbers = $SomeNumbers + BoolToStr($numLogs,"T","F")
				$Closest = Val($ClosestText)
				BREAK
			ENDIF
		OTHERWISE
			CANCEL msg="Macro cancelled"
		ENDCASE
	ENDWHILE
ENDSUB #EditNumbers

BEGINSUB Name=EditPlaced
	$PlacedOld = $placedSections
	$NumPlacedTextOld = $NumPlacedText
	WHILE TRUE
		$tmpS = Form($form6,"")
		# Reset the screen position of the menu form to where the user left it
		$Form6 = EditForm($Form6,"Form6","Top",$_FormTop)
		$Form6 = EditForm($Form6,"Form6","Left",$_FormLeft)
		BEGINCASE
		CASE $Placedcancel
			$PlacedSections = $PlacedOld
			$NumPlacedText = $NumPlacedTextOld
			GOSUB name=DoTypecasting
			BREAK
		CASE $PlacedOK
			$PlacedSections = BoolToStr($placedTotals,"T","F")
			$PlacedSections = $PlacedSections + BoolToStr($placedList,"T","F")
			$PlacedSections = $PlacedSections + BoolToStr($placedFinders,"T","F")
			$PlacedSections = $PlacedSections + BoolToStr($placedCharts,"T","F")
			IF Val($NumPlacedText) = 0
				$NumPlacedText = "9999"
			ENDIF
			$NumPlaced = Val($NumPlacedText)
			BREAK
		OTHERWISE
			CANCEL msg="Macro cancelled"
		ENDCASE
	ENDWHILE
ENDSUB #EditPlaced

BEGINSUB Name=ElevationOptions
	IF $distunits = "Miles"
		$Form16 = Replace("%EU%","ft",$Form16,TRUE)
	ELSE
		$Form16 = Replace("%EU%","m",$Form16,TRUE)
	ENDIF
	$Form16 = EditForm($Form16,"EditElevation","Visible","No")
	$Form16 = EditForm($Form16,"EditinGSAK","Visible","Yes")
	WHILE TRUE
		$tmpS = Form($form16,"")
		# Reset the screen position of the menu form to where the user left it
		$Form16 = EditForm($Form16,"Form16","Top",$_FormTop)
		$Form16 = EditForm($Form16,"Form16","Left",$_FormLeft)
		BEGINCASE
		CASE $EditElevation
			GOSUB name=EditElevation
		CASE $ElevationCancel
			BREAK
		CASE $ElevationOK
			BREAK
		ENDCASE
	ENDWHILE
ENDSUB #ElevationOptions


BEGINSUB Name=EditElevation
	MSGOK msg="Now that Elevations are included in the main GSAK database you can edit them in GSAK before running FindStatGen."	
ENDSUB


BEGINSUB Name=ChooseLang
	# Choose language file
	# Get directory listing for language files
	$FileMask = $datafilepath + "\FindStatGenLang*.dat"
	$DirList= Dir($FileMask,"F")
	$FileMask = $datafilepath + "\FindStatGenData\FindStatGenLang*.dat"
	$DirList= $DirList + Dir($FileMask,"F")


	# Parse Dir listing
	IF NOT($DirList = "")
		$LineFeed= Chr(13) + chr(10)
		$DirList= Replace($LineFeed, ";" ,$DirList,false)
		#$DirList = Left($DirList, Len($DirList)-1)
		$LangList=""
		$LangCount = 1
		$FileName = Extract($DirList,";",$LangCount)
		WHILE NOT($FileName = "")
			$LangFile = $datafilepath + "\$FileName"
			IF (FileExists($LangFile))
				FILEREAD File=$LangFile
				#Language name is in first line after the # then trim whitespace
				$LangName = Extract($line,"#",2)
				$LangName = RegExReplace("^\s+|\s+$", $LangName, "")
				$LangList = $LangList + ";$LangName"
				STOPREAD
				ENDREAD
			ELSE
				$LangFile = $datafilepath + "\FindStatGenData\$FileName"
				IF (FileExists($LangFile))
					FILEREAD File=$LangFile
					#Language name is in first line after the # then trim whitespace
					$LangName = Extract($line,"#",2)
					$LangName = RegExReplace("^\s+|\s+$", $LangName, "")
					$LangList = $LangList + ";$LangName"
					STOPREAD
					ENDREAD
				ENDIF
			ENDIF
			$LangCount = $LangCount + 1
			$FileName = Extract($DirList,";",$LangCount)
		ENDWHILE
	ENDIF

	$LangList = "English" + ";" + "Francais" + ";" + "Deutsch" + $LangList
ENDSUB #Chooselang

BEGINSUB Name=ChooseCountries
	# Choose Country files for map

	# Get directory listing for Country map files
	$FileMask = $datafilepath + "\FindStatGenMap*.dat"
	$DirListMap= Dir($FileMask,"F")
	$FileMask = $datafilepath + "\FindStatGenData\FindStatGenMap*.dat"
	$DirListMap= $DirListMap + Dir($FileMask,"F")
	
	# Parse Dir listing
	IF NOT($DirListMap = "")
		$LineFeed= Chr(13) + chr(10)
		$DirListMap= Replace($LineFeed, ";" ,$DirListMap,false)
		#$DirListMap = Left($DirListMap, Len($DirListMap)-1)
		$MapMasterList=""
		$MapCount = 1
		$FileName = Extract($DirListMap,";",$MapCount)
		WHILE NOT($FileName = "")
			$MapFile = $datafilepath + "\$FileName"
			IF (FileExists($MapFile))
				FILEREAD File=$MapFile
				#Country name is in first line after the # then trim whitespace
				$MapName = Extract($line,"#",2)
				$MapName = RegExReplace("^\s+|\s+$", $MapName, "")
				$MapMasterList = $MapMasterList + "$MapName;"
				STOPREAD
				ENDREAD
			ELSE
				$MapFile = $datafilepath + "\FindStatGenData\$FileName"
				IF (FileExists($MapFile))
					FILEREAD File=$MapFile
					#Country name is in first line after the # then trim whitespace
					$MapName = Extract($line,"#",2)
					$MapName = RegExReplace("^\s+|\s+$", $MapName, "")
					$MapMasterList = $MapMasterList + "$MapName;"
					STOPREAD
					ENDREAD
				ENDIF
			ENDIF
			$MapCount = $MapCount + 1
			$FileName = Extract($DirListMap,";",$MapCount)
		ENDWHILE
	ENDIF
	$MapCount = $MapCount - 1
	
	#$MapMasterList = "Australia" + ";" + "Canada" + ";" + "United States" + $MapMasterList
ENDSUB #ChooseCountries

BEGINSUB Name=ParseFile
	# $line will hold the contents of the appropriate file line
	$user = Extract($line,";",1)
	$ExcludeLocationlessText = Extract($line,";",2)
	$UseImageBarsText = Extract($line,";",3)
	$milestoneText = Extract($line,";",4)
	$home = Extract($line,";",5)
	$DB = Extract($line,";",6)
	$SectionOrder = Extract($line,";",7)
	$UseCurrentSortText = Extract($line,";",8)
	$StyleSet = Extract($line,";",9)
	$ShowDiffTerrChartText = Extract($line,";",10)
	$imagepath = Extract($line,";",11)
	$ftfseptext = Extract($line,";",12)
	$YearsDescendingText = Extract($line,";",13)
	$StartAutoText = Extract($line,";",14)
	$FileRevision = Extract($line,";",15)
	$Language = Extract($line,";",16)
	$SomeNumbers = Extract($line,";",17)
	$IncludeOwnText = Extract($line,";",18)
	$PlacedDatabase = Extract($line,";",19)
	$PlacedSortText = Extract($line,";",20)
	$PlacedSections = Extract($line,";",21)
	$ClosestText = Extract($line,";",22)
	$YearsAllText = Extract($line,";",23)
	$NumPlacedText = Extract($line,";",24)
	$PieChartsText = Extract($line,";",25)
	$CumulativeText = Extract($line,";",26)
	$MapStringText = Extract($line,";",27)
	$MileTypesText = Extract($line,";",28)
	$CenterText = Extract($line,";",29)
	$ShowElevationChartText = Extract($line,";",30)
	$FlagIconsText = Extract($line,";",31)
	IF Extract($line,";",32) <> ""
		$Seed = Extract($line,";",32)
	ELSE
		$Seed = "#CAC089"
	ENDIF
	IF Extract($line,";",33) <> ""
		$ElevationIntervals = Extract($line,";",33)
	ELSE
		$ElevationIntervals = "200"
	ENDIF
	IF Extract($line,";",34) <> ""
		$SuppressZeroesText = Extract($line,";",34)
	ELSE
		$SuppressZeroesText = "true"
	ENDIF
	IF Extract($line,";",35) <> ""
		$AutomaticIntervalsText = Extract($line,";",35)
	ELSE
		$AutomaticIntervalsText = "true"
	ENDIF
	IF Extract($line,";",36) <> ""
		$UseHeatMapText = Extract($line,";",36)
	ELSE
		$UseHeatMapText = "true"
	ENDIF
	IF Extract($line,";",37) <> ""
		$UseAsterText = Extract($line,";",37)
	ELSE
		$UseAsterText = "true"
	ENDIF
	IF Extract($line,";",38) <> ""
		$UseHeatBarsText = Extract($line,";",38)
	ELSE
		$UseHeatBarsText = "false"
	ENDIF
	IF Extract($line,";",39) <> ""
		$UseLegacyMapsText = Extract($line,";",39)
		$UseLegacyMapsText = "false"
	ELSE
		$UseLegacyMapsText = "false"
	ENDIF
	IF Extract($line,";",40) <> ""
		$ElevationLimit = Extract($line,";",40)
	ELSE
		$ElevationLimit = "10"
	ENDIF
	IF Extract($line,";",41) <> ""
		$StyleRoundedText = Extract($line,";",41)
	ELSE
		$StyleRoundedText = "false"
	ENDIF
	
ENDSUB #ParseFile

BEGINSUB Name=DoTypecasting
	# Do the typecasting
	$ExcludeLocationless = StrToBool($ExcludeLocationlessText)
	$UseImageBars = StrToBool($UseImageBarsText)
	$UseCurrentSort = StrToBool($UseCurrentSortText)
	$ShowDiffTerrChart = StrToBool($ShowDiffTerrChartText)
	$ShowElevationChart = StrToBool($ShowElevationChartText)
	$FlagIcons = StrToBool($FlagIconsText)
	$YearsDescending = StrToBool($YearsDescendingText)
	$StartAuto = StrToBool($StartAutoText)
	$IncludeOwn = StrToBool($IncludeOwnText)
	$PlacedSort = StrToBool($PlacedSortText)
	$YearsAll = StrToBool($YearsAllText)
	$PieCharts = StrToBool($PieChartsText)
	$Cumulative = StrToBool($CumulativeText)
	$MileTypes = StrToBool($MileTypesText)
	$Center = StrToBool($CenterText)
	$SuppressZeroes = StrToBool($SuppressZeroesText)
	$UseAster = StrToBool($UseAsterText)
	$AutomaticIntervals = StrToBool($AutomaticIntervalsText)
	$UseHeatMap = StrToBool($UseHeatMapText)
	$UseHeatBars = StrToBool($UseHeatBarsText)
	$UseLegacyMaps = StrToBool($UseLegacyMapsText)
	$MapString = Replace("%%",";",$MapStringText,TRUE)
	$StyleRounded = StrToBool($StyleRoundedText)

	$SomeNumbers = Left($SomeNumbers + "TTTTTTTTTTTT",12)

	# SomeNumbers
	$numTotals = StrToBool(SubStr($SomeNumbers,1,1))
	$numConsecutive = StrToBool(SubStr($SomeNumbers,2,1))
	$numPeriods = StrToBool(SubStr($SomeNumbers,3,1))
	$numFastest = StrToBool(SubStr($SomeNumbers,4,1))
	$numDistance = StrToBool(SubStr($SomeNumbers,5,1))
	$numClosest = StrToBool(SubStr($SomeNumbers,6,1))
	$numExtremes = StrToBool(SubStr($SomeNumbers,7,1))
	$numCentroid = StrToBool(SubStr($SomeNumbers,8,1))
	$numOldest = StrToBool(SubStr($SomeNumbers,9,1))
	$numArchived = StrToBool(SubStr($SomeNumbers,10,1))
	$numFTF = StrToBool(SubStr($SomeNumbers,11,1))
	$numLogs = StrToBool(SubStr($SomeNumbers,12,1))

	$PlacedSections = Left($PlacedSections + "TTTT",4)

	# Placed Sections
	$placedTotals = StrToBool(SubStr($PlacedSections,1,1))
	$placedList = StrToBool(SubStr($PlacedSections,2,1))
	$placedFinders = StrToBool(SubStr($PlacedSections,3,1))
	$placedCharts = StrToBool(SubStr($PlacedSections,4,1))

	IF $imagepath = ""
		$imagepathremote = FALSE
		$imagepathlocal = TRUE
	ELSE
		$imagepathremote = TRUE
		$imagepathlocal = FALSE
	ENDIF

	IF $ClosestText = ""
		$ClosestText = "5"
	ENDIF
	
	$UsePlainBars = Not($UseImageBars OR $UseHeatBars)

ENDSUB #DoTypecasting

BEGINSUB Name=ReverseTypecasting
	# Do the reverse typecasting
	$ExcludeLocationlessText = BoolToStr($ExcludeLocationless,"true","false")
	$UseImageBarsText = BoolToStr($UseImageBars,"true","false")
	$UseCurrentSortText = BoolToStr($UseCurrentSort,"true","false")
	$ShowDiffTerrChartText = BoolToStr($ShowDiffTerrChart,"true","false")
	$ShowElevationChartText = BoolToStr($ShowElevationChart,"true","false")
	$FlagIconsText = BoolToStr($FlagIcons,"true","false")
	$YearsDescendingText = BoolToStr($YearsDescending,"true","false")
	$StartAutoText = BoolToStr($StartAuto,"true","false")
	$IncludeOwnText =BoolToStr($IncludeOwn,"true","false")
	$PlacedSortText =BoolToStr($PlacedSort,"true","false")
	$YearsAllText =BoolToStr($YearsAll,"true","false")
	$PieChartsText =BoolToStr($PieCharts,"true","false")
	$CumulativeText =BoolToStr($Cumulative,"true","false")
	$MileTypesText = BoolToStr($miletypes,"true","false")
	$MapStringText = Replace(";","%%",$MapString,TRUE)
	$CenterText = BoolToStr($Center,"true","false")
	$SuppressZeroesText = BoolToStr($SuppressZeroes,"true","false")
	$UseAsterText = BoolToStr($UseAster,"true","false")
	$AutomaticIntervalsText = BoolToStr($AutomaticIntervals,"true","false")
	$UseHeatMapText = BoolToStr($UseHeatMap,"true","false")
	$UseHeatBarsText = BoolToStr($UseHeatBars,"true","false")
	$UseLegacyMapsText = BoolToStr($UseLegacyMaps,"true","false")
	$StyleRoundedText = BoolToStr($StyleRounded,"true","false")

	#$NotesText = MimeEncode($Notes)

	IF $imagepathremote
		$imagepath = $imageURL
	ELSE
		$imagepath = ""
	ENDIF

	# Remove leading and trailing white space from $imagepath
	$imagepath = RegExReplace("^\s+|\s+$", $imagepath, "")

	IF Val($ftfseptext) = 0
		$ftfseptext = "1"
	ENDIF

	IF Val($milestoneText) = 0
		$milestonetext = "1"
	ENDIF

IF Val($ElevationLimit) = 0
		$ElevationLimit = "1"
	ENDIF

	IF Val($ClosestText) = 0
		$ClosestText = "0"
	ENDIF

	IF Val($NumPlacedtext) = 0
		$NumPlacedtext = "9999"
	ENDIF

	# No negatives for Milestones
	$tmpN = Abs(Val($milestonetext))
	$milestonetext = "$tmpN"

	# No negatives or non-integers for ElevationLimit
	$ElevationLimit = NumToStr(Int(Abs(Val($ElevationLimit))))
	
	$milestone = Val($milestoneText)
	$ftfsep = Val($ftfseptext)
	$Closest = Val($ClosestText)
	$NumPlaced = Val($NumPlacedtext)

ENDSUB #ReverseTypecasting

BEGINSUB Name=Help
	$FileName = "http://gsak.net/stats/help/findstatsgenhelp.html"
	WEB url=$FileName
ENDSUB

BEGINSUB name=ConvertSettingsToSql
	$variables = GetFile($DataFile)
	$Settings1 = Extract($variables,$_NewLine,1)
	$Settings2 = Extract($variables,$_NewLine,2)
	IF $Settings2 = ""
		$Settings2 = $Settings1
	ENDIF
	$Settings3 = Extract($variables,$_NewLine,3)
	IF $Settings3 = ""
		$Settings3 = $Settings1
	ENDIF
	$Settings4 = Extract($variables,$_NewLine,4)
	IF $Settings4 = ""
		$Settings4 = $Settings1
	ENDIF
	$Settings =  Val(Extract($variables,$_NewLine,5))
	IF $Settings = 0
		$Settings = 1
	ENDIF
	GOSUB name=SaveSettings
	# Now rename the old file

	$file = Quote($DataFile) + " " + Quote("021109_FindStatGenData.dat.old")
	$BatFile = $_Install + "\babel.bat"
	$result = PutFile($BatFile, "REN " + $file)
	FILEOPEN File="$BatFile" Wait=yes
ENDSUB

BEGINSUB name=SetSectionOrder

	$_sql="SELECT Count(*) FROM OrderMenu WHERE Settings = $Settings"
	$Count = Val(Sqlite("sql",$_sql))

	GOSUB name=CreateForm

	$_sql = "BEGIN"
	$status = Sqlite("sql",$_sql,"")

	WHILE TRUE
		$result = Form($MenuForm,"")
		BEGINCASE #Buttons
		CASE $Cancel
			$_sql = "ROLLBACK"
			$status = Sqlite("sql",$_sql,"")
			BREAK
		CASE $OK
			$_sql = "COMMIT"
			$status = Sqlite("sql",$_sql,"")
			#GOSUB name=
			BREAK
		CASE $result = "SystemExit"
			$_sql = "ROLLBACK"
			$status = Sqlite("sql",$_sql,"")
			BREAK
		OTHERWISE
			GOSUB name=ParseButtons
			GOSUB name=CreateForm
		ENDCASE

	ENDWHILE

ENDSUB

BEGINSUB name=ParseButtons
	$CurrentPosition = Val(RegExData("\d*",$result,1))

	# Was it an Enable button?
	IF Left($result,1) = "E"
		$_sql = "UPDATE OrderMenu SET Enabled = not(Enabled) WHERE Position = $CurrentPosition AND Settings = $Settings"
		$status = Sqlite("sql",$_sql,"")
		EXITSUB
	ENDIF
	
	# Was it a Notes button?
	IF Left($result,1) = "Q"
		$_sql = "SELECT pluginbefore FROM OrderMenu WHERE Position = $CurrentPosition AND Settings = $Settings"
		$PlugInBefore = Sqlite("sql",$_sql,"delim=%%delim%% crlfcvt=%%crlf%%")
		$PlugInBefore = Replace("%%crlf%%",$_CrLf,$PlugInBefore)
		$_sql = "SELECT pluginafter FROM OrderMenu WHERE Position = $CurrentPosition AND Settings = $Settings"
		$PlugInAfter = Sqlite("sql",$_sql,"delim=%%delim%% crlfcvt=%%crlf%%")
		$PlugInAfter = Replace("%%crlf%%",$_CrLf,$PlugInAfter)
		GOSUB name=EditPlugin
		
		$PlugInBefore=Replace("'","''",$PlugInBefore,TRUE)
		$PlugInAfter=Replace("'","''",$PlugInAfter,TRUE)
		$_sql = "UPDATE OrderMenu SET pluginbefore = '$PlugInBefore', pluginafter = '$PlugInAfter' WHERE Position = $CurrentPosition AND Settings = $Settings"
		$status = Sqlite("sql",$_sql,"")
		EXITSUB
	ENDIF
	

	# Must have been a move button
	IF Left($result,1) = "U"
		$delta = -1
	ELSE
		$delta = 1
	ENDIF

	# Ignore if try to go up when already at the top or down when already at the bottom
	IF ($delta = -1 AND $CurrentPosition = 1) OR ($delta = 1 AND $CurrentPosition = $Count)
		EXITSUB
	ENDIF

	$_sql="SELECT ID FROM OrderMenu WHERE Position=$CurrentPosition AND Settings = $Settings"
	$ID = Sqlite("sql",$_sql)

	$_sql = "UPDATE OrderMenu SET Position = Position - $delta WHERE Position = $CurrentPosition + $delta AND Settings = $Settings"
	$status = Sqlite("sql",$_sql,"")
	$_sql = "UPDATE OrderMenu SET Position = Position + $delta WHERE ID = $ID AND Settings = $Settings"
	$status = Sqlite("sql",$_sql,"")

ENDSUB

# Display main form

BEGINSUB name=CreateForm
	$_sql="SELECT Count(*) FROM OrderMenu WHERE Settings = $Settings"
	$Count = Val(Sqlite("sql",$_sql))
	$i = 1
	$MenuForm = $formSections
	$rowcount = 0
	$lasthalf = FALSE

	WHILE $i <= $Count
		$_sql="SELECT NAME, ID, Width, Enabled, PlugInBefore FROM OrderMenu NATURAL JOIN Names WHERE Position=$i AND Settings = $Settings"
		$status = Sqlite("sql",$_sql)
		$name = Extract($status,";",1)
		$width = Val(Extract($status,";",3))
		$enabled = Extract($status,";",4)
		$tmpS = Extract($status,";",5)

		IF $width = 1
			IF $lasthalf
				$lasthalf = FALSE
				$offset = 130
			ELSE
				$lasthalf = TRUE
				$rowcount = $rowcount + 1
				$offset = 0
			ENDIF
		ELSE
			$lasthalf = FALSE
			$rowcount = $rowcount + 1
			$offset = 0
		ENDIF

		$column = Int(($rowcount-1)/8)
		$row = $rowcount - 8*$column - 1
		$topedge = 30 + (58 * $row)
		$leftedge = 20 + (280 * $column) + $offset

		IF $enabled = "1"
			$color2 = "65280"
			$caption = $LangForm84
			$color = "16766421"
			$color = "14869218"
			$greyed = "yes"
		ELSE
			$color2 = "255"
			$color2 = "8421504"
			$caption = $LangForm85
			$color = "14869218"
			$greyed = "no"
		ENDIF
		
		IF At("<tab>",$tmpS) > 0
			$text = "Tab"
			$text1 = "T"
		ELSE
			$text = "Notes"
			$text1 = "N"
		ENDIF

		IF $width = 1
			$tempitem = $halfformitem
		ELSE
			$tempitem = $formitem
		ENDIF

		$tempitem = Replace("%%","$i",$tempitem,TRUE)
		$tempitem = Replace("!!left!!","$leftedge",$tempitem,TRUE)
		$tempitem = Replace("!!top!!","$topedge",$tempitem,TRUE)
		$tempitem = Replace("!!name!!","$name",$tempitem,TRUE)
		$tempitem = Replace("!!color!!","$color",$tempitem,TRUE)
		$tempitem = Replace("!!color2!!","$color2",$tempitem,TRUE)
		$tempitem = Replace("!!enable!!","$caption",$tempitem,TRUE)
		$tempitem = Replace("!!greyed!!","$greyed",$tempitem,TRUE)
		$tempitem = Replace("!!notes!!","$text",$tempitem,TRUE)
		$tempitem = Replace("!!n!!","$text1",$tempitem,TRUE)
		$MenuForm = $MenuForm + $tempitem
		$i = $i + 1
	ENDWHILE
	# Set overall Form Width
	$leftedge = 290 + (280 * $column)
	$MenuForm = Replace("!!formwidth!!","$leftedge",$MenuForm,TRUE)

	$leftedge = $leftedge/2 - 150
	$MenuForm = Replace("!!okleft!!","$leftedge",$MenuForm,TRUE)
	$MenuForm = Replace("!!titleleft!!","$leftedge",$MenuForm,TRUE)
	$MenuForm = Replace("!!settings!!","$settings",$MenuForm,TRUE)

	$leftedge = $leftedge + 220
	$MenuForm = Replace("!!cancelleft!!","$leftedge",$MenuForm,TRUE)

ENDSUB #CreateForm

<Data> VarName=$formSections

Name = Form10
Type = Form
Height = 560
Width = !!formwidth!!

Name = OK
Type = Button
Height = 25
Left = !!okleft!!
Top = 500
Width = 75
Taborder = 0
Caption = OK

Name = Cancel
Type = Button
Height = 25
Left = !!cancelleft!!
Top = 500
Width = 75
Taborder = 1
Caption = Cancel

Name = Label1
Type = Label
Color = 16744448
Height = 20
Left = !!titleleft!!
Size = 12
Style = bold
Top = 1
Width = 272
Caption = FindStatGen Section Order - Group !!settings!!

<enddata>

<Data> VarName=$formitem

Name = Groupbox%%
Type = Groupbox
Height = 51
Left = !!left!!
Top = !!top!!
Width = 250
Caption = %%
Color = !!color!!

Name = NameLabel%%
Type = Label
Container = Groupbox%%
Height = 13
Left = 10
Top = 14
Width = 32
Style = bold
Caption = !!name!!
Enabled = !!greyed!!

Name = M%%
Type = Memo
Color = !!color2!!
Container = Groupbox%%
Enabled = no
Height = 22
Left = 83
Top = 27
Width = 74

Name = E%%
Type = Button
Container = Groupbox%%
Height = 18
Left = 95
Top = 29
Width = 48
Caption = !!Enable!!

Name = U%%
Type = Button
Container = Groupbox%%
Height = 18
Left = 230
Top = 9
Width = 18
Caption = /\

Name = D%%
Type = Button
Container = Groupbox%%
Height = 18
Left = 230
Top = 30
Width = 18
Caption = \/

Name = Q%%
Type = Button
Container = Groupbox%%
Height = 18
Left = 3
Top = 30
Width = 34
Caption = !!notes!!

<enddata>

<Data> VarName=$halfformitem

Name = Groupbox%%
Type = Groupbox
Height = 51
Left = !!left!!
Top = !!top!!
Width = 120
Caption = %%
Color = !!color!!

Name = NameLabel%%
Type = Label
Container = Groupbox%%
Height = 13
Left = 2
Top = 14
Width = 32
Style = bold
Size = 7
Caption = !!name!!
Enabled = !!greyed!!

Name = M%%
Type = Memo
Color = !!color2!!
Container = Groupbox%%
Enabled = no
Height = 22
Left = 21
Top = 27
Width = 72

Name = E%%
Type = Button
Container = Groupbox%%
Height = 18
Left = 33
Top = 29
Width = 48
Caption = !!Enable!!

Name = U%%
Type = Button
Container = Groupbox%%
Height = 18
Left = 100
Top = 9
Width = 18
Caption = /\

Name = D%%
Type = Button
Container = Groupbox%%
Height = 18
Left = 100
Top = 30
Width = 18
Caption = \/

Name = Q%%
Type = Button
Container = Groupbox%%
Height = 18
Left = 3
Top = 30
Width = 16
Caption = !!n!!
<enddata>

<Data> VarName=$DefaultMenuFile
1;1;2;1;1;;
2;2;2;1;1;;
3;3;1;1;1;;
4;4;1;1;1;;
5;5;2;1;1;;
6;6;2;1;1;;
7;7;2;1;1;;
8;8;2;1;1;;
9;9;2;1;1;;
10;10;2;1;1;;
11;11;2;1;1;;
12;12;1;1;1;;
13;13;1;1;1;;
14;14;2;1;1;;
15;15;2;1;1;;
17;16;2;1;1;;
18;17;2;0;1;;
19;18;2;1;1;;
20;19;2;1;1;;
21;20;1;1;1;;
22;21;1;1;1;;
23;22;1;1;1;;
1;1;2;1;2;;
2;2;2;1;2;;
3;3;1;1;2;;
4;4;1;1;2;;
5;5;2;1;2;;
6;6;2;1;2;;
7;7;2;1;2;;
8;8;2;1;2;;
9;9;2;1;2;;
10;10;2;1;2;;
11;11;2;1;2;;
12;12;1;1;2;;
13;13;1;1;2;;
14;14;2;1;2;;
15;15;2;1;2;;
17;16;2;1;2;;
18;17;2;0;2;;
19;18;2;1;2;;
20;19;2;1;2;;
21;20;1;1;2;;
22;21;1;1;2;;
23;22;1;1;2;;
1;1;2;1;3;;
2;2;2;1;3;;
3;3;1;1;3;;
4;4;1;1;3;;
5;5;2;1;3;;
6;6;2;1;3;;
7;7;2;1;3;;
8;8;2;1;3;;
9;9;2;1;3;;
10;10;2;1;3;;
11;11;2;1;3;;
12;12;1;1;3;;
13;13;1;1;3;;
14;14;2;1;3;;
15;15;2;1;3;;
17;16;2;1;3;;
18;17;2;0;3;;
19;18;2;1;3;;
20;19;2;1;3;;
21;20;1;1;3;;
22;21;1;1;3;;
23;22;1;1;3;;
1;1;2;1;4;;
2;2;2;1;4;;
3;3;1;1;4;;
4;4;1;1;4;;
5;5;2;1;4;;
6;6;2;1;4;;
7;7;2;1;4;;
8;8;2;1;4;;
9;9;2;1;4;;
10;10;2;1;4;;
11;11;2;1;4;;
12;12;1;1;4;;
13;13;1;1;4;;
14;14;2;1;4;;
15;15;2;1;4;;
17;16;2;1;4;;
18;17;2;0;4;;
19;18;2;1;4;;
20;19;2;1;4;;
21;20;1;1;4;;
22;21;1;1;4;;
23;22;1;1;4;;
<enddata>

<Data> VarName=$DefaultSingleMenuFile
1;1;2;1;%s;;
2;2;2;1;%s;;
3;3;1;1;%s;;
4;4;1;1;%s;;
5;5;2;1;%s;;
6;6;2;1;%s;;
7;7;2;1;%s;;
8;8;2;1;%s;;
9;9;2;1;%s;;
10;10;2;1;%s;;
11;11;2;1;%s;;
12;12;1;1;%s;;
13;13;1;1;%s;;
14;14;2;1;%s;;
15;15;2;1;%s;;
17;16;2;1;%s;;
18;17;2;0;%s;;
19;18;2;1;%s;;
20;19;2;1;%s;;
21;20;1;1;%s;;
22;21;1;1;%s;;
23;22;1;1;%s;;
<enddata>

BEGINSUB name=DefineNames

	$DefaultNames="$LangT1;1" + $_NewLine + "$LangT2;2" + $_NewLine + "$LangT3;3" + $_NewLine + "$LangT4;4" + $_NewLine + "$LangT5;5" + $_NewLine
	$DefaultNames = $DefaultNames + "$LangT6;6" + $_NewLine + "$LangT7;7" + $_NewLine + "$LangT8;8" + $_NewLine + "$LangT9;9" + $_NewLine + "$LangT10;10" + $_NewLine
	$DefaultNames = $DefaultNames + "$LangT11;11" + $_NewLine + "$LangT12;12" + $_NewLine + "$LangT13;13" + $_NewLine + "$LangT14;14" + $_NewLine + "$LangT15;15" + $_NewLine
	$DefaultNames = $DefaultNames + "$LangT17;17" + $_NewLine + "$LangT18;18" + $_NewLine + "$LangT19;19" + $_NewLine + "$LangT20;20" + $_NewLine + "$LangT21;21" + $_NewLine
	$DefaultNames = $DefaultNames + "$LangT22;22" + $_NewLine + "$LangT23;23" + $_NewLine + "$LangT24;24" + $_NewLine + "$LangT25;25" + $_NewLine + "$LangT26;26" + $_NewLine
	$DefaultNames = $DefaultNames + "$LangT27;27" + $_NewLine + "$LangT28;28" + $_NewLine + "$LangT29;29" + $_NewLine + "$LangT30;30" + $_NewLine + "$LangT31;31" + $_NewLine
	$DefaultNames = $DefaultNames + "$LangT32;32" + $_NewLine + "$LangT33;33" + $_NewLine + "$LangT34;34" + $_NewLine + "$LangT35;35" + $_NewLine + "$LangT36;36"

	$_sql = "drop table if exists Names"
	$status = Sqlite("sql",$_sql,"")
	$Data = "Name text,ID integer"
	$_sql = "CREATE TABLE Names ($Data)"
	$status = Sqlite("sql",$_sql,"")
	$status = sqlite("import",$DefaultNames,"table=Names")

ENDSUB # DefineNames

BEGINSUB Name=SaveSettings
	
	$tmpS=Replace("'","''",$Settings1,TRUE)
	$_sql = "REPLACE INTO SavedSettings VALUES ('1','$tmpS')"
	$status = Sqlite("sql",$_sql)
	$tmpS=Replace("'","''",$Settings2,TRUE)
	$_sql = "REPLACE INTO SavedSettings VALUES ('2','$tmpS')"
	$status = Sqlite("sql",$_sql)
	$tmpS=Replace("'","''",$Settings3,TRUE)
	$_sql = "REPLACE INTO SavedSettings VALUES ('3','$tmpS')"
	$status = Sqlite("sql",$_sql)
	$tmpS=Replace("'","''",$Settings4,TRUE)
	$_sql = "REPLACE INTO SavedSettings VALUES ('4','$tmpS')"
	$status = Sqlite("sql",$_sql)
	$_sql = "REPLACE INTO SavedSettings VALUES ('Settings','$Settings')"
	$status = Sqlite("sql",$_sql)

	#	# Save the values into $datafile to be reused the next time the macro is run
	#	$variables = $Settings1 + $_NewLine + $Settings2 + $_NewLine + $Settings3 + $_NewLine + $Settings4 + $_NewLine + NumToStr($Settings)
	#
	#	$result = PutFile($datafile, $variables)
	#	IF Left($result, 7) = "*Error*"
	#		# If theres any error abort the macro
	#		CANCEL Msg="Unable to write to $datafile!"
	#	ENDIF

	$result = PutFile($datafilepath + "\FindStatGenNotes1.dat", $Notes1)
	IF Left($result, 7) = "*Error*"
		# If theres any error abort the macro
		CANCEL Msg="Unable to write to FindStatGenNotes1.dat!"
	ENDIF
	$result = PutFile($datafilepath + "\FindStatGenNotes2.dat", $Notes2)
	IF Left($result, 7) = "*Error*"
		# If theres any error abort the macro
		CANCEL Msg="Unable to write to FindStatGenNotes2.dat!"
	ENDIF
	$result = PutFile($datafilepath + "\FindStatGenNotes3.dat", $Notes3)
	IF Left($result, 7) = "*Error*"
		# If theres any error abort the macro
		CANCEL Msg="Unable to write to FindStatGenNotes3.dat!"
	ENDIF
	$result = PutFile($datafilepath + "\FindStatGenNotes4.dat", $Notes4)
	IF Left($result, 7) = "*Error*"
		# If theres any error abort the macro
		CANCEL Msg="Unable to write to FindStatGenNotes4.dat!"
	ENDIF
	
	$result = PutFile($datafilepath + "\FindStatGenNotes1B.dat", $Notes1B)
	IF Left($result, 7) = "*Error*"
		# If theres any error abort the macro
		CANCEL Msg="Unable to write to FindStatGenNotes1B.dat!"
	ENDIF
	$result = PutFile($datafilepath + "\FindStatGenNotes2B.dat", $Notes2B)
	IF Left($result, 7) = "*Error*"
		# If theres any error abort the macro
		CANCEL Msg="Unable to write to FindStatGenNotes2B.dat!"
	ENDIF
	$result = PutFile($datafilepath + "\FindStatGenNotes3B.dat", $Notes3B)
	IF Left($result, 7) = "*Error*"
		# If theres any error abort the macro
		CANCEL Msg="Unable to write to FindStatGenNotes3B.dat!"
	ENDIF
	$result = PutFile($datafilepath + "\FindStatGenNotes4B.dat", $Notes4B)
	IF Left($result, 7) = "*Error*"
		# If theres any error abort the macro
		CANCEL Msg="Unable to write to FindStatGenNotes4B.dat!"
	ENDIF

	$result = PutFile($datafilepath + "\FindStatGenNotes1C.dat", $Notes1C)
	IF Left($result, 7) = "*Error*"
		# If theres any error abort the macro
		CANCEL Msg="Unable to write to FindStatGenNotes1C.dat!"
	ENDIF
	$result = PutFile($datafilepath + "\FindStatGenNotes2C.dat", $Notes2C)
	IF Left($result, 7) = "*Error*"
		# If theres any error abort the macro
		CANCEL Msg="Unable to write to FindStatGenNotes2C.dat!"
	ENDIF
	$result = PutFile($datafilepath + "\FindStatGenNotes3C.dat", $Notes3C)
	IF Left($result, 7) = "*Error*"
		# If theres any error abort the macro
		CANCEL Msg="Unable to write to FindStatGenNotes3C.dat!"
	ENDIF
	$result = PutFile($datafilepath + "\FindStatGenNotes4C.dat", $Notes4C)
	IF Left($result, 7) = "*Error*"
		# If theres any error abort the macro
		CANCEL Msg="Unable to write to FindStatGenNotes4C.dat!"
	ENDIF

ENDSUB #SaveSettings

BEGINSUB Name=StoreSettings

	# Save the value into the appropriate $Settings# from Settings Previous
	$line = $user + ";" + $ExcludeLocationlessText + ";" + $UseImageBarsText  + ";" + $milestoneText + ";" + $home + ";"
	$line = $line + $DB + ";" + $SectionOrder + ";" + $UseCurrentSortText + ";" + "$StyleSet" + ";" + $ShowDiffTerrChartText + ";"
	$line = $line + $imagepath + ";" + $ftfseptext + ";" + $YearsDescendingText + ";" + $StartAutoText + ";" + $FileRevision + ";"
	$line = $line + $Language + ";" + $SomeNumbers + ";" + $IncludeOwnText + ";" + $PlacedDatabase + ";" + $PlacedSortText + ";"
	$line = $line + $PlacedSections + ";" + $ClosestText + ";" + $YearsAllText + ";" + $NumPlacedText + ";" + $PieChartsText + ";"
	$line = $line + $CumulativeText + ";" + $MapStringText + ";" + $MileTypesText + ";" + $CenterText + ";" + $ShowElevationChartText + ";"
	$line = $line + $FlagIconsText + ";" + $Seed + ";" + $ElevationIntervals + ";" + $SuppressZeroesText + ";" + $AutomaticIntervalsText + ";"
	$line = $line + $UseHeatMapText + ";" + $UseAsterText + ";" + $UseHeatBarsText + ";" + $UseLegacyMapsText + ";" + $ElevationLimit + ";"
	$line = $line + $StyleRoundedText

	IF $Settingsprevious = 1
		$Settings1 = $line
		$Notes1 = $Notes
		$Notes1B = $NotesB
		$Notes1C = $NotesC
	ENDIF
	IF $Settingsprevious = 2
		$Settings2 = $line
		$Notes2 = $Notes
		$Notes2B = $NotesB
		$Notes2C = $NotesC
	ENDIF
	IF $Settingsprevious = 3
		$Settings3 = $line
		$Notes3 = $Notes
		$Notes3B = $NotesB
		$Notes3C = $NotesC
	ENDIF
	IF $Settingsprevious = 4
		$Settings4 = $line
		$Notes4 = $Notes
		$Notes4B = $NotesB
		$Notes4C = $NotesC
	ENDIF

ENDSUB #StoreSettings

BEGINSUB Name=SelectSettings
	IF $Select1
		$Settings = 1
	ENDIF
	IF $Select2
		$Settings = 2
	ENDIF
	IF $Select3
		$Settings = 3
	ENDIF
	IF $Select4
		$Settings = 4
	ENDIF
	GOSUB Name=LoadSettings
ENDSUB #SelectSettings

BEGINSUB name=SetDefaults
	# No saved settings so set defaults for form

	# User name
	$user = "username"

	# Exclude Locationless cache types? (Set to either true or false)
	# This applies to the 'Finds by Distance' and 'State Map' sections
	$ExcludeLocationlessText = "false"

	# Set this to 'true' if you wish to use the pretty shaded bars for the graphs
	# and to false to use pure HTML suitable for pasting in the geocaching.com
	# profile page
	$UseImageBarsText = "false"

	# How often you want a milestone created?
	$milestoneText="100"

	# Set the Home position for distance from home
	$home = "Home"

	# Which Database to export from
	$DB = "Found"

	# Placed caches Database
	$PlacedDatabase = ""

	# Which Sections do you want to run?
	#$SectionFlags = $T1 + ":" + $T2 + ":" + $T3 + ":" + $T4 + ":" + $T5 + ":" + $T6 + ":" + $T7 + ":" + $T8 + ":" + $T9 + ":" + $T10 + ":" + $T11 + ":" + $T12 + ":" + $T13 + ":" + $T14 + ":" + $T15 + ":" + $T16 + ":" + $T17 + ":" + $T18
	#$SectionOrder = $DefaultSectionOrder
	$SectionOrder = ""

	# Do you want to use the current sort order for milestones and override the automatic sort?
	$UseCurrentSortText = "false"

	# Which Color Style set?
	$StyleSet = "Blue"

	# Show the Diff/Terr chart?
	$ShowDiffTerrChartText = "true"

	# Image path for bars (if using web server)
	$imagepath = ""

	# How often you want a ftf created?
	$ftfseptext = "1"

	# Show Years in descending order?
	$YearsDescendingText = "true"

	# Auto run the macro?
	$StartAutoText = "false"

	# language
	$Language = "English"

	# Some Numbers Sections?
	$SomeNumbers = "TTTTTTTTTTTT"

	# Placed Sections?
	$PlacedSections = "TTTT"

	# Include own finds in Placed Stats?
	$IncludeOwnText = "true"

	# Include column sorts in Placed List?
	$PlacedSortText = "true"

	# How close can the closest cache be to be displayed?
	$ClosestText="5"

	# Show all years open in output?
	$YearsAllText = "false"

	# How many placed caches to list?
	$NumPlacedText = "9999"

	#Use Pie charts?
	$PieChartsText = "true"

	#Show cumulative charts?
	$CumulativeText = "true"

	# Maps
	$MapStringText = ""

	#Show Cache types in Milestones?
	$MileTypesText = "true"
	
	# Center output?
	$CenterText = "false"
	
	# Show the Elevation Chart?
	$ShowElevationChartText = "true"
	
	# Show flag icons
	$FlagIconsText = "true"
	
	# Seed for style Generator
	$Seed = "#CAC089"
	
	# Number of elevations to plot
	$ElevationLimit = "10"

	$Settings = 1
	$SettingsPrevious = 4
	GOSUB name=StoreSettings
	$SettingsPrevious = 3
	GOSUB name=StoreSettings
	$SettingsPrevious = 2
	GOSUB name=StoreSettings
	$SettingsPrevious = 1
	GOSUB name=StoreSettings
ENDSUB

BEGINSUB Name=LoadSettings
	$form = Replace("color=255","color=16777215",$form,TRUE)
	IF $Settings=1
		$Form = Editform($Form,"Memo1","color","255")
		$line = $Settings1
		$Notes = $Notes1
		$NotesB = $Notes1B
		$NotesC = $Notes1C
	ENDIF
	IF $Settings=2
		$Form = Editform($Form,"Memo2","color","255")
		$line = $Settings2
		$Notes = $Notes2
		$NotesB = $Notes2B
		$NotesC = $Notes2C
	ENDIF
	IF $Settings=3
		$Form = Editform($Form,"Memo3","color","255")
		$line = $Settings3
		$Notes = $Notes3
		$NotesB = $Notes3B
		$NotesC = $Notes3C
	ENDIF
	IF $Settings=4
		$Form = Editform($Form,"Memo4","color","255")
		$line = $Settings4
		$Notes = $Notes4
		$NotesB = $Notes4B
		$NotesC = $Notes4C
	ENDIF
	IF NOT($settings=0)
		GOSUB Name=ParseFile
		GOSUB Name=DoTypecasting
	ENDIF
ENDSUB #LoadSettings

BEGINSUB Name=Setlanguage
	$Internal=FALSE
	$NumInternal=3

	IF $Language = "English"
		GOSUB Name=English
		$Internal=TRUE
	ENDIF
	IF $Language = "Deutsch"
		GOSUB Name=German
		$Internal=TRUE
	ENDIF
	IF $Language = "Francais"
		GOSUB Name=French
		$Internal=TRUE
	ENDIF

	IF NOT($internal)
		#Set Defaults in case of missing strings
		GOSUB Name=English
		$count = 1
		$FileName = ""
		WHILE $count <= $LangCount
			IF $Language = Extract($Langlist,";",$count+$NumInternal)
				$FileName = Extract($DirList,";",$count)
			ENDIF
			$count = $count + 1
		ENDWHILE
		$LanguageFile = SysInfo("MacroPath") + "\" + $FileName
		IF (FileExists($LanguageFile))
			MACRO File=$LanguageFile
		ELSE
			$LanguageFile = SysInfo("MacroPath") + "\FindStatGenData\" + $FileName
			IF (FileExists($LanguageFile))
				MACRO File=$LanguageFile
			ELSE
				GOSUB Name=English
			ENDIF
		ENDIF
	ENDIF

	# Set names for Section menu
	GOSUB name=DefineNames


	$Form = $FormOptions
	$Form2 = $FormRun
	$Form3 = $NotesForm
	$Form4 = $FormMilestones
	$Form5 = $FormNumbers
	$Form6 = $FormPlaced
	$Form7 = $FormUpdate
	$Form8 = $FormSpecial
	$Form9 = $FormMaps
	$Form11 = $FormMapEditor
	$Form12 = $MissingIDsForm
	$Form13 = $CountyUpdateCheck
	$Form14 = $ElevationUpdateCheck
	$Form15 = $formElevation
	$Form16 = $formElevationOptions
	$Form17 = $formhome
	$Form18 = $formUpdateMaps
	$Form19 = $formNotesBrowser
	$Form20 = $formPlugin
	$Form21 = $formCopySettings
	

	# All Form fields
	$Form = Replace("LangForm001",$LangForm01,$Form,TRUE)
	$Form = Replace("LangForm002",$LangForm02,$Form,TRUE)
	$Form = Replace("LangForm003",$LangForm03,$Form,TRUE)
	$Form = Replace("LangForm004",$LangForm04,$Form,TRUE)
	$Form = Replace("LangForm005",$LangForm05,$Form,TRUE)
	$Form = Replace("LangForm006",$LangForm06,$Form,TRUE)
	$Form = Replace("LangForm007",$LangForm07,$Form,TRUE)
	$Form = Replace("LangForm008",$LangForm08,$Form,TRUE)
	$Form = Replace("LangForm009",$LangForm09,$Form,TRUE)
	$Form = Replace("LangForm010",$LangForm10,$Form,TRUE)
	$Form = Replace("LangForm011",$LangForm11,$Form,TRUE)
	$Form = Replace("LangForm012",$LangForm12,$Form,TRUE)
	$Form = Replace("LangForm013",$LangForm13,$Form,TRUE)
	$Form = Replace("LangForm014",$LangForm14,$Form,TRUE)
	$Form = Replace("LangForm015",$LangForm15,$Form,TRUE)
	$Form = Replace("LangForm016",$LangForm16,$Form,TRUE)
	$Form = Replace("LangForm017",$LangForm17,$Form,TRUE)
	$Form = Replace("LangForm018",$LangForm18,$Form,TRUE)
	$Form = Replace("LangForm019",$LangForm19,$Form,TRUE)
	$Form = Replace("LangForm20",$LangForm20,$Form,TRUE)
	$Form = Replace("LangForm21",$LangForm21,$Form,TRUE)
	$Form = Replace("LangForm22",$LangForm22,$Form,TRUE)
	$Form = Replace("LangForm23",$LangForm23,$Form,TRUE)
	$Form = Replace("LangForm24",$LangForm24,$Form,TRUE)
	$Form = Replace("LangForm25",$LangForm25,$Form,TRUE)
	$Form = Replace("LangForm26",$LangForm26,$Form,TRUE)
	$Form = Replace("LangForm27",$LangForm27,$Form,TRUE)
	$Form = Replace("LangForm31",$LangForm31,$Form,TRUE)
	$Form = Replace("LangForm32",$LangForm32,$Form,TRUE)
	$Form = Replace("LangForm41",$LangForm41,$Form,TRUE)
	$Form = Replace("LangForm42",$LangForm42,$Form,TRUE)
	$Form = Replace("LangForm43",$LangForm43,$Form,TRUE)
	$Form = Replace("LangForm67",$LangForm67,$Form,TRUE)
	$Form = Replace("Lang89",$Lang89,$Form,TRUE)
	$Form = Replace("LangForm70",$LangForm70,$Form,TRUE)
	$Form = Replace("LangForm71",$LangForm71,$Form,TRUE)
	$Form = Replace("LangForm72",$LangForm72,$Form,TRUE)
	$Form = Replace("LangForm73",$LangForm73,$Form,TRUE)
	$Form = Replace("LangForm75",$LangForm75,$Form,TRUE)
	$Form = Replace("LangForm76",$LangForm76,$Form,TRUE)
	$Form = Replace("LangForm87",$LangForm87,$Form,TRUE)
	$Form = Replace("LangForm89",$LangForm89,$Form,TRUE)
	$Form = Replace("LangForm90",$LangForm90,$Form,TRUE)
	$Form = Replace("LangForm91",$LangForm91,$Form,TRUE)
	$Form = Replace("LangForm102",$LangForm102,$Form,TRUE)
	$Form = Replace("LangForm104",$LangForm104,$Form,TRUE)
	$Form = Replace("LangForm105",$LangForm105,$Form,TRUE)
	$Form = Replace("LangForm107",$LangForm107,$Form,TRUE)
	$Form = Replace("LangForm108",$LangForm108,$Form,TRUE)

	$Form2 = Replace("LangForm002",$LangForm02,$Form2,TRUE)
	$Form2 = Replace("LangForm22",$LangForm22,$Form2,TRUE)
	$Form2 = Replace("LangForm23",$LangForm23,$Form2,TRUE)
	$Form2 = Replace("LangForm28",$LangForm28,$Form2,TRUE)
	$Form2 = Replace("LangForm29",$LangForm29,$Form2,TRUE)
	$Form2 = Replace("LangForm30",$LangForm30,$Form2,TRUE)
	$Form2 = Replace("LangForm77",$LangForm77,$Form2,TRUE)
	$Form2 = Replace("LangForm78",$LangForm78,$Form2,TRUE)

	$Form3 = Replace("LangForm22",$LangForm22,$Form3,TRUE)
	$Form3 = Replace("LangForm23",$LangForm23,$Form3,TRUE)
	$Form3 = Replace("Lang89",$Lang89,$Form3,TRUE)
	$Form3 = Replace("<settings>","Group - $Settings",$Form3,TRUE)
	$Form3 = Replace("LangForm86",$LangForm86,$Form3,TRUE)

	$Form4 = Replace("LangForm33",$LangForm33,$Form4,TRUE)
	$Form4 = Replace("LangForm34",$LangForm34,$Form4,TRUE)
	$Form4 = Replace("LangForm35",$LangForm35,$Form4,TRUE)
	$Form4 = Replace("LangForm36",$LangForm36,$Form4,TRUE)
	$Form4 = Replace("LangForm37",$LangForm37,$Form4,TRUE)
	$Form4 = Replace("LangForm38",$LangForm38,$Form4,TRUE)
	$Form4 = Replace("LangForm39",$LangForm39,$Form4,TRUE)
	$Form4 = Replace("LangForm40",$LangForm40,$Form4,TRUE)
	$Form4 = Replace("LangForm22",$LangForm22,$Form4,TRUE)
	$Form4 = Replace("LangForm23",$LangForm23,$Form4,TRUE)

	$Form5 = Replace("LangForm51",$LangForm51,$Form5,TRUE)
	$Form5 = Replace("LangForm52",$LangForm52,$Form5,TRUE)
	$Form5 = Replace("LangForm53",$LangForm53,$Form5,TRUE)
	$Form5 = Replace("LangForm54",$LangForm54,$Form5,TRUE)
	$Form5 = Replace("LangForm55",$LangForm55,$Form5,TRUE)
	$Form5 = Replace("LangForm56",$LangForm56,$Form5,TRUE)
	$Form5 = Replace("LangForm57",$LangForm57,$Form5,TRUE)
	$Form5 = Replace("LangForm58",$LangForm58,$Form5,TRUE)
	$Form5 = Replace("LangForm59",$LangForm59,$Form5,TRUE)
	$Form5 = Replace("LangForm60",$LangForm60,$Form5,TRUE)
	$Form5 = Replace("LangForm61",$LangForm61,$Form5,TRUE)
	$Form5 = Replace("LangForm62",$LangForm62,$Form5,TRUE)
	$Form5 = Replace("LangForm68",$LangForm68,$Form5,TRUE)

	$Form6 = Replace("LangForm61",$LangForm61,$Form6,TRUE)
	$Form6 = Replace("LangForm79",$LangForm79,$Form6,TRUE)
	$Form6 = Replace("LangForm80",$LangForm80,$Form6,TRUE)
	$Form6 = Replace("LangForm81",$LangForm81,$Form6,TRUE)
	$Form6 = Replace("LangForm82",$LangForm82,$Form6,TRUE)
	$Form6 = Replace("LangForm83",$LangForm83,$Form6,TRUE)
	$Form6 = Replace("LangForm92",$LangForm92,$Form6,TRUE)

	$Form8 = Replace("LangForm010",$LangForm10,$Form8,TRUE)
	$Form8 = Replace("LangForm35",$LangForm35,$Form8,TRUE)
	$Form8 = Replace("LangForm63",$LangForm63,$Form8,TRUE)
	$Form8 = Replace("LangForm37",$LangForm37,$Form8,TRUE)
	$Form8 = Replace("LangForm38",$LangForm38,$Form8,TRUE)
	$Form8 = Replace("LangForm22",$LangForm22,$Form8,TRUE)
	$Form8 = Replace("LangForm23",$LangForm23,$Form8,TRUE)
	$Form8 = Replace("LangForm64",$LangForm64,$Form8,TRUE)
	$Form8 = Replace("LangForm65",$LangForm65,$Form8,TRUE)
	$Form8 = Replace("LangForm66",$LangForm66,$Form8,TRUE)
	$Form8 = Replace("LangForm69",$LangForm69,$Form8,TRUE)
	$Form8 = Replace("LangForm86",$LangForm86,$Form8,TRUE)

	$Form9 = Replace("LangForm74",$LangForm74,$Form9,TRUE)
	
	$Form15 = Replace("LangForm90",$LangForm90,$Form15,TRUE)
	$Form15 = Replace("LangForm93",$LangForm93,$Form15,TRUE)
	$Form15 = Replace("LangForm94",$LangForm94,$Form15,TRUE)
	
	$Form16 = Replace("LangForm89",$LangForm89,$Form16,TRUE)
	$Form16 = Replace("LangForm90",$LangForm90,$Form16,TRUE)
	$Form16 = Replace("LangForm93",$LangForm93,$Form16,TRUE)
	$Form16 = Replace("LangForm95",$LangForm95,$Form16,TRUE)
	$Form16 = Replace("LangForm96",$LangForm96,$Form16,TRUE)
	$Form16 = Replace("LangForm97",$LangForm97,$Form16,TRUE)
	$Form16 = Replace("LangForm98",$LangForm98,$Form16,TRUE)
	$Form16 = Replace("LangForm103",$LangForm103,$Form16,TRUE)
	$Form16 = Replace("LangForm106",$LangForm106,$Form16,TRUE)
	
	$Form17 = Replace("LangForm22",$LangForm22,$Form17,TRUE)
	$Form17 = Replace("LangForm23",$LangForm23,$Form17,TRUE)
	$Form17 = Replace("LangForm36",$LangForm36,$Form17,TRUE)
	$Form17 = Replace("LangForm37",$LangForm37,$Form17,TRUE)
	$Form17 = Replace("LangForm38",$LangForm38,$Form17,TRUE)
	$Form17 = Replace("LangForm99",$LangForm99,$Form17,TRUE)
	$Form17 = Replace("LangForm100",$LangForm100,$Form17,TRUE)
	$Form17 = Replace("LangForm101",$LangForm101,$Form17,TRUE)
	
	$Form20 = Replace("LangForm22",$LangForm22,$Form20,TRUE)
	$Form20 = Replace("LangForm23",$LangForm23,$Form20,TRUE)
	$Form20 = Replace("Lang89",$Lang89,$Form20,TRUE)
	$Form20 = Replace("<settings>","Group - $Settings",$Form20,TRUE)
	$Form20 = Replace("LangForm86",$LangForm86,$Form20,TRUE)
	

	GOSUB Name=LoadSettings

ENDSUB # Setlanguage

BEGINSUB Name=RunSections

	IF $Srun = "16"
		EXITSUB
	ENDIF

	IF $Srun = "1"
		GOSUB Name=Month		# Full width - Horizontal graphs depicting finds per month
		EXITSUB
	ENDIF

	IF $Srun = "2"
		GOSUB Name=Milestones	# Full width - Milestone
		EXITSUB
	ENDIF

	IF $Srun = "3"
		GOSUB Name=Distance		# Half width - Finds by distance from home coords.
		EXITSUB
	ENDIF

	IF $Srun = "4"
		GOSUB Name=Type			# Half width - Finds by type, Traditional, Multi etc.
		EXITSUB
	ENDIF

	IF $Srun = "5"
		GOSUB Name=DiffTerr		# Full width - Finds by difficulty and terrain rating
		EXITSUB
	ENDIF

	IF $Srun = "6"
		GOSUB Name=Owner		# Full width - Finds by Owner
		EXITSUB
	ENDIF

	IF $Srun = "7"
		GOSUB Name=State		# Full width - Finds by State map
		EXITSUB
	ENDIF

	IF $Srun = "8"
		GOSUB Name=Province		# Full width - Finds by Province map
		EXITSUB
	ENDIF

	IF $Srun = "9"
		GOSUB Name=Europe   	# Full width - Finds by European Country map
		EXITSUB
	ENDIF

	IF $Srun = "10"
		GOSUB Name=Australia 	# Full width - Finds by Australia Country map
		EXITSUB
	ENDIF

	IF $Srun = "11"
		GOSUB Name=Countries	# Full width - Finds by Country map
		EXITSUB
	ENDIF

	IF $Srun = "12"
		GOSUB Name=Weekday		# Half width - Finds by Weekday
		EXITSUB
	ENDIF

	IF $Srun = "13"
		GOSUB Name=Container	# Half width - Finds by Container size
		EXITSUB
	ENDIF

	IF $Srun = "14"
		GOSUB Name=Numbers		# Full width - Some 'interesting' numbers
		EXITSUB
	ENDIF

	IF $Srun = "15"
		GOSUB Name=Ftf				# Full width - FTFs
		EXITSUB
	ENDIF

	IF $Srun = "17"
		GOSUB Name=Notes				# Full width - HTML Notes
		EXITSUB
	ENDIF

	IF $Srun = "18"
		GOSUB Name=Placed				# Full width - Placed Caches
		EXITSUB
	ENDIF

	IF $Srun = "19"
		GOSUB Name=Special				# Full width - Special Caches
		EXITSUB
	ENDIF

	IF $Srun = "20"
		GOSUB Name=ParseMapList				# Full width - Universal Map
		EXITSUB
	ENDIF

	IF $Srun = "21"
		GOSUB Name=Bearing				# Half width - Bearing
		EXITSUB
	ENDIF

	IF $Srun = "22"
		GOSUB Name=PerMonth   # Half width - Finds by month
		EXITSUB
	ENDIF

	IF $Srun = "23"
		GOSUB Name=PlacedYear # Half width - Finds by year cache placed
		EXITSUB
	ENDIF
	
	IF $Srun = "24"
		GOSUB Name=FindsToDate # Half width - Finds by year to today's date
		EXITSUB
	ENDIF
	
	IF $Srun = "25"
		GOSUB Name=NotesB				# Full width - HTML Notes
		EXITSUB
	ENDIF
	
	IF $Srun = "26"
		GOSUB Name=FindsByFoundDate				# Full width - Finds by Found Date Chart
		EXITSUB
	ENDIF
	
	IF $Srun = "27"
		GOSUB Name=DiffTerrChart				# Full width - Chart of Diff/Terr
		EXITSUB
	ENDIF
	
	IF $Srun = "28"
		GOSUB Name=FindsByPlacedDate				# Full width - Finds by Placed Month Chart
		EXITSUB
	ENDIF
	
	IF $Srun = "29"
		GOSUB Name=ElevationInternal			# Full width - Max and Min elevations
		EXITSUB
	ENDIF
	
	IF $Srun = "30"
		GOSUB Name=BearingDistance				# Half width - Avg distance by bearing
		EXITSUB
	ENDIF
	
	IF $Srun = "31"
		GOSUB Name=FindsPerDay				# Full width - Chart of Finds By Day
		EXITSUB
	ENDIF
	
	IF $Srun = "32"
		GOSUB Name=UsCountyMap		# Full width - Finds by County map of entire USA
		EXITSUB
	ENDIF
	
	IF $Srun = "33"
		GOSUB Name=FindsByPlacedDay				# Full width - Finds by Placed Day Chart
		EXITSUB
	ENDIF
	
	IF $Srun = "34"
		GOSUB Name=FirstCacheByCountry
		EXITSUB
	ENDIF
	
	IF $Srun = "35"
		GOSUB Name=NotesC				# Full width - HTML Notes
		EXITSUB
	ENDIF

	IF $Srun = "36" AND $_Version >= "8.0.0.0"
		GOSUB Name=Favorites				# Full width - Top 10 Favorite
		EXITSUB
	ENDIF
ENDSUB

BEGINSUB Name=Start

	# Remember the start time of the macro
	$starttime=Time()

	# Check start date
	$Today = DateToSql($RunDate)
	$SQLStart = DateToSql($StartDate)

	IF $StyleSet = "Minimal"
		GOSUB Name=InitStyle5
	ENDIF
	IF $StyleSet = "Grey"
		GOSUB Name=InitStyle4
	ENDIF
	IF $StyleSet = "Red"
		GOSUB Name=InitStyle3
	ENDIF
	IF $StyleSet = "Green"
		GOSUB Name=InitStyle2
	ENDIF
	IF $StyleSet = "Blue"
		GOSUB Name=InitStyle1
	ENDIF
	IF $StyleSet = "Generator"
		GOSUB Name=CreateStyle
		GOSUB Name=InitStyle6
	ENDIF 
	IF $StyleSet = "Smooth"
		GOSUB Name=InitStyle7
	ENDIF
	IF $StyleSet = $UserStyleName
		IF (FileExists($StyleFile))
			MACRO File="$StyleFile"
		ENDIF
	ENDIF
	
	IF $StyleRounded
		$stTitle      =   	$stTitle + "margin-top: 15px; width: 732px; padding:4px; border-radius: 10px;" + $st2c1
		$stTab2cHead  =   	$stTab2cHead + "border-bottom: 1px solid #d8cd9d;"
		$st2cHi1      =   	$st2cHi1 + "padding:2px; border-bottom: 1px solid #d8cd9d;"
		$st2cHi2      =   	$st2cHi2 + "padding:2px; border-bottom: 1px solid #d8cd9d;"
		$st2c1        =   	$st2c1 + "padding:2px; border-bottom: 1px solid #d8cd9d;"
		$st2c2        =   	$st2c2 + "padding:2px; border-bottom: 1px solid #d8cd9d;"
		$stRankRow    =   	$stRankRow + "padding:2px;"
		$stRankTit    =   	$stRankTit + "font-weight:bold; padding: 0px 2px 0px 2px; vertical-align: middle;"
		$stYearDataTit=   	$stYearDataTit + "padding:2px; border-bottom: 1px solid #d8cd9d; color: black"
		$stYearDataInf=   	$stYearDataInf + "padding:2px; border-bottom: 1px solid #d8cd9d;"
		$stSectHead   =   	$stSectHead + "border-radius: 10px 10px 0 0; border-style: solid solid none; border-width: 0; color: #e3ddc2; font-size: 14px; font-weight: bold; letter-spacing:1px; margin-top: 10px; margin-bottom: 6px; padding-top:4px; padding-bottom:4px;"
	ELSE
		$stMainDiv = $stMainDiv + "margin: 1px; border: outset;"
		$stSectHead =	$stSectHead + "font-weight: bold; line-height: 20px; font-size: 13px; color: white; border: 1px solid #000000;	text-align: center; margin-bottom: 6px;"
	ENDIF
	
	

	# Store Current waypoint for restoration later
	IF NOT($_Count=0)
		$Savedcode = $d_Code
	ENDIF

	# Store current center point for restoration later
	$SavedCenter=SysInfo("gsakini;LastCenter;Lat") + " " + SysInfo("gsakini;LastCenter;Lon")

	# Store current database for restoration later
	$currentdb = $_CurrentDatabase

	# Store current filter to restore at end of macro
	IF SysInfo("JoinFilter") = "N"
		$SavedFilter = SaveFilter()
	ELSE
		$SavedFilter = "NA"
	ENDIF
	
	# Store current SORT settings to restore at end of macro
	#$SavedSortOriginal = $_SortBy
	$SavedSortOriginal = $_OrderBy

	SHOWSTATUS msg="$LangStatus09" Width=350

	IF $_CurrentDatabase <> $Db
		DATABASE Name="$Db" Action=Select
	ENDIF

	# Store current SORT settings to restore at end of macro
	#$SavedSort = $_SortBy
	$SavedSort = $_OrderBy

	# Check the database actually has some waypoints, otherwise we're stuffed
	IF $_Count = 0
		CANCEL msg="Error: No waypoints in this database!"
	ENDIF

	# Determine the total number of unique caches found in this database
	MFILTER Expression=$d_Found AND $d_FoundByMeDate<=$RunDate AND $d_FoundByMeDate>=$StartDate
	$TotalFinds=$_FilterCount
	# No caches marked as found in this database, let's give the user some
	# advice
	IF $TotalFinds = 0
		$msg = "Hmmmm.... that's odd, GSAK thinks you have no finds.  Assuming "
		$msg = $msg + "you DO have then maybe you haven't set up GSAK properly "
		$msg = $msg + "to recognise them? " + $CR
		$msg = $msg + "Would you like me to open your "
		$msg = $msg + "browser on a page that can show you how to do that?"
		$msg = $msg + $CR + $CR
		$msg = $msg + "Press [Continue] to go to the webpage, or either of the "
		$msg = $msg + "other two buttons to quit."
		PAUSE Msg=$msg
		WEB url="http://gsak.net/board/index.php?showtopic=2334"
		CANCEL
	ENDIF

	MFILTER expression=$d_FoundCount > 0 AND $d_FoundByMeDate<=$RunDate AND $d_FoundByMeDate>=$StartDate
	$TotalByLogs = $_FilterCount
	CANCELFILTER
	IF $TotalByLogs > $TotalFinds
		$msg = "It looks like you have not marked some caches as 'Found' "
		$msg = $msg + "even though they have Logs showing 'Found'" + $CR + $CR
		$msg = $msg + "Those caches will be skipped in the statistics so, if this isn't deliberate, "
		$msg = $msg + "you could run the 'My Finds' Pocket Query on the Geocaching web site "
		$msg = $msg + "and import that PQ into your database to bring it up to date."
		$msg = $msg + $CR + $CR
		$msg = $msg + "Press [Continue] to go on and finish the report but the"
		$msg = $msg + "statistics may be incomplete without the missing finds."
		PAUSE Msg=$msg
		$msg = ""
	ENDIF

	$SortByLogsRun = FALSE

	$countbackwards = FALSE

	# Clear out all the sql tables
	$_sql = "DROP TABLE IF EXISTS RawCaches; "
	$_sql = $_sql + "DROP TABLE IF EXISTS RawLogs; "
	$_sql = $_sql + "DROP TABLE IF EXISTS AllFinds;"
	$_sql = $_sql + "DROP TABLE IF EXISTS AllFindstemp;"
	$_sql = $_sql + "DROP TABLE IF EXISTS PlacedLogs;"
	$_sql = $_sql + "DROP TABLE IF EXISTS PlacedStatsData;"
	$_sql = $_sql + "DROP TABLE IF EXISTS FindsByDay"
	$status = Sqlite("sql",$_sql)

	# Call the Placed Stats routine if it is in the current report anywhere
	# Or <placed> is in any Notes section
	$_sql = "SELECT Enabled from OrderMenu WHERE Settings = $settings and ID='18'"
	$status = Sqlite("sql",$_sql,"")
	IF $status = "1"
		SHOWSTATUS msg="Creating Placed Stats SQL" Width=350
		GOSUB Name=PlacedStats
	ELSE
		# Check Plug in Notes sections
		$_sql = "select count(*) from ordermenu where Settings = $settings and PlugInBefore || PlugInAfter like '%<placed>%'"
		$tmpN = Val(Sqlite("sql",$_sql,""))
		IF $tmpN > 0
			SHOWSTATUS msg="Creating Placed Stats SQL" Width=350
			GOSUB Name=PlacedStats
		ELSE
			# Check regular Notes sections
			BEGINCASE
			CASE $Settings = 1
				$tmpS = $Notes1 + $Notes1B + $Notes1C
			CASE $Settings = 2
				$tmpS = $Notes2 + $Notes2B + $Notes2C
			CASE $Settings = 3
				$tmpS = $Notes3 + $Notes3B + $Notes3C
			CASE $Settings = 4
				$tmpS = $Notes4 + $Notes4B + $Notes4C
			ENDCASE
			IF At("<placed>",$tmpS) <> 0
				SHOWSTATUS msg="Creating Placed Stats SQL" Width=350
				GOSUB Name=PlacedStats
			ENDIF
		ENDIF
	ENDIF
		

	#Copy everything over to the SQL database and then run the routines on that
	GOSUB Name=CopyToNewDatabase

	# We are now in the new SQL database where each waypoint should have a single found log
	# Determine the total number of finds including duplicates in this database

	# Initialize base SQL List
	$_sql = "Select * from AllFinds ORDER BY lDate, lLogid"
	$work = Sqlite("sql",$_sql)
	$list = list("sql","replace",$work)
	$FindsWithDuplicates = $_SqlRows

	IF ($FindsWithDuplicates + $BenchmarkFinds + $WaymarkFinds) < $TotalFinds
		$msg = "Sorry, it looks like you have some 'Found' logs missing." + $CR
		$msg = $msg + "Maybe you have some cache finds you've marked here but haven't logged yet?" + $CR + $CR
		$msg = $msg + "If you are sure you've logged everything that's marked as 'Found' "
		$msg = $msg + "you could run the 'My Finds' Pocket Query on the Geocaching web site "
		$msg = $msg + "and import that PQ into your database to bring it up to date."
		$msg = $msg + $CR + $CR
		$msg = $msg + "Press [Continue] to go on and finish the report but the "
		$msg = $msg + "statistics may be incomplete without the missing logs."
		PAUSE Msg=$msg
		$msg = ""
	ENDIF

	SHOWSTATUS msg="$LangStatus10" Width=350
	
	# Check all dates are good
	
	$_sql = "SELECT code from allfinds WHERE date(ldate) ISNULL OR NOT g_IsValidDate(lDate) OR ldate = '1900-01-01'"
	$tmpS = Sqlite("sql",$_sql)
		
	IF Len($tmpS) > 0
		
		$msg = "Warning: The following caches have a bad or missing 'Found by me' or 'Log' date." + $CR + $CR + "Please check your database and ensure you have set the 'Method for matching caches' in Tools/Options/General"
		$msg = $msg +$CR +$CR+ "Or, if you have missing log dates, get the special 'My Finds' Pocket Query from Geocaching.com" +$CR +$CR
		$msg = $msg + $tmpS  + $CR + $CR + "Click 'OK' to continue"
		MSGOK msg=$msg
	ENDIF

	#Store date of first find
	$_sql = "SELECT lDate from AllFinds ORDER BY lDate LIMIT 1"
	$Date = Sqlite("sql",$_sql)
	$DateFirstFind = SqlToDate($Date)
	
	#IF $Date = "1900-01-01" OR $Date = "" OR Not(RegEx("\d{4}?-\d{2}-\d{2}?",$Date))
#	IF $Date = "1900-01-01" OR $Date = "" OR 	$Date <> Sqlite("sql","select date('$date')")
#		$DateFirstFind = [20000503]
#		$msg = "Warning: You have a found cache with a bad or missing 'Found by me' or 'Log' date." + $CR + $CR + "Please check your database and ensure you have set the 'Method for matching caches' in Tools/Options/General"
#		$msg = $msg +$CR +$CR+ "Or, if you have missing log dates, get the special 'My Finds' Pocket Query from Geocaching.com" +$CR +$CR+ "Click 'OK' to continue"
#		MSGOK Msg=$msg
#	ELSE
#		$DateFirstFind = SqlToDate($Date)
#	ENDIF
		
	$_sql = "SELECT lDate from AllFinds ORDER BY lDate DESC LIMIT 1"
	$Date = Sqlite("sql",$_sql)
	$Enddate = SqlToDate($Date)
	
	#Initialise output
	$out = ""

	SHOWSTATUS msg="$LangStatus11" Width=350
	# $FindsWithDuplicates = total of all finds in database counted by logs excluding benchmarks and Waymarks
	# $tmpN1 = total of all finds in database counted by logs including benchmarks and Waymarks

	# $TotalFinds = total of all finds in database counted by caches/benchmarks/waymarks etc
	# $tmpN = total of all finds in database counted by caches exluding benchmarks and waymarks

	# Start the variable which contains the output
	$tmpN = $TotalFinds - $BenchmarkFinds - $WaymarkFinds
	$tmpN1 = $FindsWithDuplicates + $BenchmarkFinds + $WaymarkFinds
	
	$out = AddStr(1,"clear")
	$out = AddStr(1,"add","<div id='gsakstats' align='center' style='$stMainDiv line-height: normal;'>" + $cr)
	#$out = AddStr(1,"add","<span style='$stTitle'>" + $cr + "$user $Lang01 $FindsWithDuplicates $Lang02 $tmpN $Lang03" + $CR)
	$out = AddStr(1,"add","<a name='top'></a><div style='$stTitle'>" + $cr + "$user $Lang01 $FindsWithDuplicates $Lang02 $tmpN $Lang03")
	IF $FindsWithDuplicates <> $tmpN1
		$out = AddStr(1,"add"," $Lang145 $tmpN1 $Lang07")
	ENDIF
	$out = AddStr(1,"add",$CR)
	$out = AddStr(1,"add","</div>$CR<br />$CR")

	$_sql = "SELECT Count(Code) from AllFinds where substr(code,1,2)='GC'"
	$num = Val(Sqlite("sql",$_sql))

	IF $num <> $FindsWithDuplicates OR $BenchmarkFinds >0 OR $WayMarkFinds >0
		$out = AddStr(1,"add","<span> <i>(" + "$num Geocaches")
		IF $num <> $FindsWithDuplicates
			$tmpN = $FindsWithDuplicates - $num
			IF $BenchmarkFinds =0 AND $WaymarkFinds =0
				$out = AddStr(1,"add"," &amp; ")
			ELSE
				$out = AddStr(1,"add",", ")
			ENDIF
			$out = AddStr(1,"add","$tmpN ") # "other cache"
			IF $tmpN > 1
				$out = AddStr(1,"add",$Lang146b)
			ELSE
				$out = AddStr(1,"add",$Lang146a)
			ENDIF
		ENDIF
		IF $BenchmarkFinds >0
			IF $WaymarkFinds =0
				$out = AddStr(1,"add"," &amp; ")
			ELSE
				$out = AddStr(1,"add",", ")
			ENDIF
			$out = AddStr(1,"add","$BenchmarkFinds Benchmark")
			IF $BenchmarkFinds >1
				$out = AddStr(1,"add","s")
			ENDIF
		ENDIF
		IF $WaymarkFinds >0
			$out = AddStr(1,"add"," &amp; $WaymarkFinds Waymark")
			IF $WaymarkFinds >1
				$out = AddStr(1,"add","s")
			ENDIF
		ENDIF
		$out = AddStr(1,"add",")</i></span>$CR<br />$CR")
	ELSE
		$out = AddStr(1,"add","")
	ENDIF

	# Add date line
	$date = DateFormat($RunDate)
	IF $StartDate = [20000101]
		$tmpS = ""
	ELSE
		$tmpS = DateFormat($StartDate) + " -"
	ENDIF
	$out = AddStr(1,"add","<i>$Lang04 $tmpS $date</i>" + $CR)
	
	# Add marker to be replaced later with tab structure
	$out = AddStr(1,"add","!!tabs!!" + $CR)
	
	# Tab counter
	$TabCount = 0	
	
	# Set $MostInthisMonth, blank as it's generated by SUB Month and used by
	# SUB numBestMonth, otherwise if SUB Month is not run, we get an error
	$MostInthisMonth = 0
	# Initialise column counter so the narrow sections know which side they're
	# on, this is updated by SUB SectionHead
	$column = 1
	$lastcolspan = 1
	#define maximum table width
	$maxtablewidth = 740

	GOSUB Name=GetMaxMonth

ENDSUB #Start

BEGINSUB Name=Finish
	SHOWSTATUS msg="$LangStatus12" Width=350

	IF $_CurrentDatabase = $currentdb
		# Restore applied filter
		IF $SavedFilter <>"NA"
			$tmpN = RestoreFilter($SavedFilter,True)
		ENDIF
		#Restore center point
		CENTER Location=Temp Coordinates=$SavedCenter
		# Restore SORT from before macro run
		SQLSORT OrderBy=$SavedSort
	ELSE
		# Restore SORT from before macro run
		#$SORTData = Extract($SavedSort, "=",1)
		#$Sequence = Extract($SavedSort, "=",2)
		#SORT By=$SORTData Sequence=$Sequence
		SQLSORT OrderBy=$SavedSort
		#restore database
		DATABASE Name=$currentdb Action=select
		# Restore applied filter
		IF $SavedFilter <>"NA"
			$tmpN = RestoreFilter($SavedFilter,True)
		ENDIF
		#Restore center point
		CENTER Location=Temp Coordinates=$SavedCenter
		# Restore SORT from before macro run
		SQLSORT OrderBy=$SavedSortOriginal
	ENDIF

	# Position at saved waypoInt
	$tmpB = Seek($SavedCode)

	# Get time for macro finish
	$endtime=time()
	# Calculate seconds, minutes and hours for start and finish times
	$stSec  = Val(substr($starttime,1,2))				# Hours
	$stSec  = Val(substr($starttime,4,2)) + $stSec * 60	# Minutes
	$stSec  = Val(substr($starttime,7,2)) + $stSec * 60 # Seconds
	$fiSec  = Val(substr($endtime,1,2))					# Hours
	$fiSec  = Val(substr($endtime,4,2)) + $fiSec * 60   # Minutes
	$fiSec  = Val(substr($endtime,7,2)) + $fiSec * 60   # Seconds
	# Check if we ran over midnight
	IF $fiSec < $stSec
		$fiSec = $fiSec + 24 * 60 * 60
	ENDIF
	# Calculate time elapsed
	$time = $fiSec - $stSec
	$mins  = Int($time/60)
	$secs  = $time - $mins*60
	# If the last section was a half width one, close the table
	IF $lastcolspan = 2
		GOSUB name=Close2col
	ENDIF
	# Generate a string with the generation Time in
	$TimeTaken = ""
	# more than a minute taken?
	IF $mins >0
		$TimeTaken = $TimeTaken + "$mins minute"
		# Only pluralise if needed, it's all the in the detail you know? ;)
		IF $mins<>1
			$TimeTaken = $TimeTaken + "s"
		ENDIF
		$TimeTaken = $TimeTaken + " and"
	ENDIF
	$TimeTaken = $TimeTaken + " $secs second"
	# Only pluralise if needed, it's all the in the detail you know? ;)
	IF $secs<>1
		$TimeTaken = $TimeTaken + "s"
	ENDIF
	# That's all folks......
ENDSUB #Finish
########################---Output Subroutines---################################
BEGINSUB Name=SectionHead
	# This subroutine is called by all the stats generating routines.
	# It writes the section header and also handles the half width sections
	# intelligently .
	# Add a couple of blank lines to the output variable
	$out = AddStr(1,"add","<br /><br />" + $CR)
	$out = AddStr(1,"add","<!-- SectionHead CS=$colspan LCS=$lastcolspan C=$column $text -->" + $CR)
	IF $colspan = 1
		# This is a full width section
		# If the last section was a half width close the previous table off
		IF $lastcolspan = 2
			GOSUB Name=Close2col
		ENDIF
		$out = AddStr(1,"add",$TabHtml)
		$lastcolspan = 1
		$column = 1
		$width = $maxtablewidth
	ELSE
		# This is a half width section
		IF $column = 1
			# First Column
			# If we're following another half width block, close the table off
			IF $lastcolspan = 2
				GOSUB Name=Close2col
			ENDIF
			$out = AddStr(1,"add",$TabHtml)
			GOSUB Name=Open2Col
			$column = 2
		ELSE
			# Second Column
			IF Len($TabHtml) > 0
				GOSUB Name=Close2col
				$out = AddStr(1,"add",$TabHtml)
				GOSUB Name=Open2Col
				$column = 2
			ELSE
				GOSUB Name=Mid2Col
				$column = 1
			ENDIF
		ENDIF
		$lastcolspan = 2
		$width = $maxtablewidth/2
	ENDIF
	$tmpS = ""
	IF $Placed
		$tmpS = $stYearDataTit
	ENDIF
	# And add the header to the output variable
	IF $ShowTitle
		$out = AddStr(1,"add","<div style='width:$width" + "px; $stSectHead $tmpS'>" + $CR)
		$out = AddStr(1,"add","<a name='$Srun'></a>")
		#$out = AddStr(1,"add","    $text" + $CR + "</div><br />" + $CR)
		$out = AddStr(1,"add","    $text" + $CR + "</div>" + $CR)
	ENDIF
	# Clear out the TabHtml string
	$TabHtml = ""
	$ShowTitle = TRUE
ENDSUB #SectionHead
BEGINSUB Name=Open2Col
	# Open the table for two column output
	$out = AddStr(1,"add","<!-- Open2Col -->" + $CR)
	$out = AddStr(1,"add","<table border='0'>" + $CR)
	$out = AddStr(1,"add","<tr>" + $CR)
	$out = AddStr(1,"add","<td valign='top' align='center'>" + $CR)
ENDSUB #Open2Col
BEGINSUB Name=Mid2Col
	# Add the HTML for between two, two column sections
	$out = AddStr(1,"add","<!-- Mid2Col -->" + $CR)
	$out = AddStr(1,"add","</td>" + $CR)
	$out = AddStr(1,"add","<td  valign='top' align='center'>" + $CR)
ENDSUB #Mid2Col
BEGINSUB Name=Close2Col
	# Finish two column output
	$out = AddStr(1,"add","<!-- Close2Col -->" + $CR)
	$out = AddStr(1,"add","</td></tr></table>" + $CR)
ENDSUB #Close2col

BEGINSUB Name=Table2Pi

	# This subroutine writes a fixed format pie chart, taking these inputs:
	# $result : semicolon delimited record pairs, each record is a 'text'
	#           and a 'number' separated by a comma
	# $maxnum : The largest number in the dataset
	# $note   : Any note that should appear beneath the table
	# $totalpercent : The total that percentage is based on, normally $FindsWithDuplicates
	#

	# How many records?
	$NumItems = RegExCount(";",$result)
	# Go through the data, one record at a time
	$index = 0

	$tmpS = RegExSub("background:\s*?#(.*?);",$stMainDiv,1,1)
	$out = AddStr(1,"add","<img src='http://chart.googleapis.com/chart?cht=p3&chs=370x120&chf=bg,s,$tmpS")
	$text1 = "&chd=t:"
	$text2 = "&chl="
	$text3 = "&chco="
	$text4 = "0000ff,ff9900,00ff00,ffff00,ff00ff,00ffff,ff8080,80ff80,8080ff"
	$text4 = "0000f0,2020f0,8080f0,2020f0,8080f0,2020f0,8080f0,2020f0,8080f0,2020f0,8080f0,2020f0,8080f0,2020f0,8080f0,2020f0,8080f0"

	WHILE $index < $NumItems
		$index = $index + 1
		# Get one data element
		$data = Extract($result, ";" , $Index)
		$text = Extract($data, ",", 1)
		$num  = Val(Extract($data, ",", 2))
		# Replace ampersands with &amp; etc to keep the HTML sweet
		$text = Replace("&","&amp;",$text,true)
		$text = Replace("%lt","&lt;",$text,true)
		$text = Replace("%gt","&gt;",$text,true)
		# Calculate the percentage of this record to one dp
		# $pc = Int(($num/$totalpercent) * 1000)/10
		# $percent = "$pc"
		
		$pc = ($num/$totalpercent) * 100
		$percent = left("$pc",4)
		
		$percent = Replace(",",".",$percent,TRUE)
		$text1 = $text1 + $percent
		$text2 = $text2 + $text + " ($percent%)"
		IF $num = $maxnum
			$text3 = $text3 + "ff0000"
		ELSE
			$text3 = $text3 + Extract($text4,",",$index)
		ENDIF
		IF $index <> $NumItems
			$text1 = $text1 + ","
			$text2 = $text2 + "|"
			$text3 = $text3 + ","
		ENDIF
	ENDWHILE

	$out = AddStr(1,"add",$text1 + $text2 + $text3 + "' />")

	IF $note <> ""
		$out = AddStr(1,"add","<span style='$stSmall'>$note</span>" + $CR)
	ENDIF

ENDSUB

BEGINSUB Name=Table2Col
	# This subroutine writes a fixed format stats table, taking these inputs:
	# $result : semicolon delimited record pairs, each record is a 'text'
	#           and a 'number' separated by a comma
	# $maxnum : The largest number in the dataset
	# $note   : Any note that should appear beneath the table
	# $totalpercent : The total that percentage is based on, nomrally $FindsWithDuplicates
	#
	# NB. It would be 'nicer' to calculate $maxnum in this routine, but there
	# is a significant cycle saving by doing it in the stats generating routines
	# They've already been through the data once after all!
	# Open the table and write the header line to the output variable
	$out = AddStr(1,"add","<!--  Table2Col -->" + $CR)
	$out = AddStr(1,"add","<table border='0' summary='' width='371' style='text-align: left;'>" + $CR)
	$out = AddStr(1,"add","<tr><td style='$stTab2cHead'>&nbsp;</td><td style='$stTab2cHead'><b> $Lang05 </b></td>")
	$out = AddStr(1,"add","<td style='$stTab2cHead'><b> $Lang06 </b></td><td style='$stTab2cHead'>&nbsp;</td></tr>" + $CR)
	# How many records?
	$NumItems = RegExCount(";",$result)
	# Go through the data, one record at a time
	$index = 0
	WHILE $index < $NumItems
		$index = $index + 1
		# Get one data element
		$data = Extract($result, ";" , $Index)
		$text = Extract($data, ",", 1)
		$num  = Val(Extract($data, ",", 2))
		# Replace ampersands with &amp; etc to keep the HTML sweet
		$text = Replace("&","&amp;",$text,true)
		$text = Replace("%lt","&lt;",$text,true)
		$text = Replace("%gt","&gt;",$text,true)
		# Calculate the percentage of this record
		$pc = ($num/$totalpercent) * 100
		$percent = left("$pc",4)
		# Call the subroutine to write a row out
		GOSUB Name=Table2ColRow
	ENDWHILE
	# write table footer
	$out = AddStr(1,"add","</table>" + $CR)
	IF $note <> ""
		$out = AddStr(1,"add","<span style='$stSmall'>$note</span>" + $CR)
	ENDIF

ENDSUB # Table2Col

BEGINSUB Name=Table2ColRow
	# Write a row in the standard half width layout
	# If this is the largest data element, make the bar red and highlight it
	IF $num = $maxnum
		$style1 = $st2cHi1
		$style2 = $st2cHi2
	ELSE
		$style1 = $st2c1
		$style2 = $st2c2
	ENDIF
	# Write the row data to the output variable
	$out = AddStr(1,"add","<!-- Table2Col Row-->" + $CR)
	$out = AddStr(1,"add","<tr><td style='$style1'>$text</td>" + $CR)
	$out = AddStr(1,"add","<td style='$style2'>$num</td>" + $CR)
	$out = AddStr(1,"add","<td style='$style2'>$percent %</td>" + $CR)
	$out = AddStr(1,"add","<td style='$style2' width='$maxwidth'>" + $CR)

	IF $maxnum = 0
		$maxnum = 1
	ENDIF

	$width = Int($maxwidth * $num / $maxnum)

	IF $width=0 AND $num >0
		$width = 1
	ENDIF

	IF $width>0
		GOSUB Name=HBar
	ENDIF
	$out = AddStr(1,"add","</td></tr>" + $CR)
ENDSUB #Table2ColRow
BEGINSUB Name=HBar
	# Output the horizontal bar for the 'graph' display

	IF $UseImageBars
		IF $num = $maxnum
			$image = $imagepath + $ImageRH
			$out = AddStr(1,"add","<img src='$image' border='0' width='$width' style='float:left;'")
		ELSE
			$image = $imagepath + $ImageBH
			$out = AddStr(1,"add","<img src='$image' border='0' width='$width' style='float:left;'")
		ENDIF
		$out = AddStr(1,"add","height='15' alt='$num' title='$num' />" + $CR)
	ELSE
		IF $UseHeatBars
			$heatnum = $num
			$heatmax = $maxnum
			GOSUB Name=GetHeatColor
			$out = AddStr(1,"add","<span title='$num' style='display:block; background: #$HeatColor; width:$width" + "px;'>&nbsp;</span>")
		ELSE
			IF $num = $maxnum
				$out = AddStr(1,"add","<span title='$num' style='display:block; background: $stRedBar; width:$width" + "px;'>&nbsp;</span>")
			ELSE
				$out = AddStr(1,"add","<span title='$num' style='display:block; background: $stBlueBar; width:$width" + "px;'>&nbsp;</span>")
			ENDIF
		ENDIF
	ENDIF
ENDSUB #HBar
BEGINSUB Name=NumbersLine
	# Add a line to the 'Some Number section, inputs are:
	# $text1 : Description of the data
	# $text2 : The data itself
	# $text7 : Flag Image if used
	$out = AddStr(1,"add","<tr>" + "$CR" + "<td style='$st2c1'>" + $CR)
	$out = AddStr(1,"add","$text1: </td>" + $CR)
#	IF $FlagIcons
#		$out = AddStr(1,"add","<td style='$st2c2'>$text7</td>" + $CR)
#	ENDIF
	IF $FlagIcons
		$out = AddStr(1,"add","<td style='$st2c2'>$text2 $text7</td>" + $CR + "</tr>" + $CR)
	ELSE
		$out = AddStr(1,"add","<td style='$st2c2'>$text2</td>" + $CR + "</tr>" + $CR)
	ENDIF
	# Clear out flag Image
	$text7 = ""
ENDSUB #NumbersLine

BEGINSUB Name=MilestonesLine
	# Add a line to the 'Milestones' section, inputs are:
	# $text1 : Cache find number
	# $text2 : Date
	# $text3 : Days later
	# $text4 : Code
	# $text5 : Name
	# $text6 : Cachetype Image
	# $text7 : Flag image url
	$out = AddStr(1,"add","<tr>" + "$CR" + "<td style='$st2c1'>" + $CR)
	$out = AddStr(1,"add","$text1</td>" + $CR)
	$out = AddStr(1,"add","<td style='$st2c2'>$text2</td>" + $CR)
	$out = AddStr(1,"add","<td style='$st2c2'>$text3</td>" + $CR)
	IF $FlagIcons
		$out = AddStr(1,"add","<td style='$st2c2'>$text7</td>" + $CR)
	ENDIF
	$out = AddStr(1,"add","<td style='$st2c2'>$text4</td>" + $CR)
	IF $miletypes
		$out = AddStr(1,"add","<td style='$st2c2'>$text6</td>" + $CR)
	ENDIF
	$out = AddStr(1,"add","<td style='$st2c1'>$text5</td>" + $CR + "</tr>" + $CR)
ENDSUB #MilestonesLine

BEGINSUB name=GetMaxMonth
	# Find best month for charts and Numbers
	#	$MostInMonth is the max count
	#	$MostInthisMonth is the month number
	# BestYear is the year number
	#	$BestInYear is the max annual count

	$_sql = "SELECT Count(lDate) as c, strftime('%m',lDate) as m, strftime('%Y',lDate) as y from Allfinds group by y,m order by c desc limit 1"
	$tmpS = Sqlite("sql",$_sql)
	$MostInMonth = Val(Extract($tmpS,";",1))
	$MostInthisMonth = Val(Extract($tmpS,";",2))
	$BestYear = Val(Extract($tmpS,";",3))
	$_sql = "SELECT Count(lDate) as c, strftime('%Y',lDate) as y from AllFinds  group by y order by c desc limit 1"
	$tmpS = Sqlite("sql",$_sql)
	$BestInYear = Val(Extract($tmpS,";",1))
ENDSUB

BEGINSUB Name=DoYearStats
	# Compile stats for year, $ThisYear
	# Initialise some variables
	$Month = 1		# Current working month, starting at Jan

	# First year and current year to date are less than 365 days
	$YearNow = Val(left(DateToString($RunDate),4))

	IF ($ThisYear = $YearNow) AND ($ThisYear = $FirstYear)
		$DaysInYear = dateDiff($DateFirstFind,$RunDate)+1
	ELSE
		IF $ThisYear = $YearNow
			$DaysInYear = dateDiff(StringToDate("$ThisYear" + "0101"),$RunDate)+1
		ELSE
			IF $ThisYear = $FirstYear
				$DaysInYear = dateDiff($DateFirstFind,StringToDate("$ThisYear" + "1231"))+1
			ELSE
				$DaysInYear = 365
			ENDIF
		ENDIF
	ENDIF
	$EndMonth = 12	# Last month of the year
	$YearFinds = 0					# Number of finds this year
	$MaxInMonth = 0					# Number of caches found in the best month
	$MaxInThisMonth = 0				# Which month it was
	$result = ""					# output strings
	$result2 = ""
	$TotalDaysCached = 0			# Count of days cached in the year

	# Step through each month
	WHILE $Month <= $Endmonth
		SHOWSTATUS msg="$LangStatus14 $Month $ThisYear" Width=350
		$_sql = "SELECT Count(lDate) from AllFinds WHERE strftime('%Y',lDate)+0=$ThisYear and strftime('%m',lDate)+0=$Month"
		$MonthNumber = Val(Sqlite("sql",$_sql))

		# Check if there were any finds this month
		IF $MonthNumber > 0
			# Add to results string
			$result = $result + "$MonthNumber;"
			# Update total finds in year count
			$YearFinds = $YearFinds + $MonthNumber
			# Update best month if this month is better than previous best
			IF $MonthNumber > $MaxInMonth
				$MaxInMonth = $MonthNumber
			ENDIF
			$dayscached = 0
			$lastdate = [20000101]
			$_sql = "SELECT count(lDate) from AllFinds WHERE strftime('%Y',lDate)+0=$ThisYear and  strftime('%m',lDate)+0=$Month GROUP BY lDate"
			$tmpS=Sqlite("sql",$_sql)
			$dayscached = RegExCount($_NewLine,$tmpS) + 1
			$result2 = $result2 + "$dayscached;"
			$TotalDaysCached = $TotalDaysCached + $dayscached
		ELSE
			# No caches found this month, keep results strings sane
			$result = $result + "0;"
			$result2 = $result2 + "0;"
		ENDIF
		# Go to next month
		$Month = $Month + 1
	ENDWHILE
	# No finds in the year? go back
	IF $YearFinds = 0
		EXITSUB
	ENDIF
	#open table
	$out = AddStr(1,"add","<table border='0'>" + $CR)
	$out = AddStr(1,"add","<tr><td style='$stYearTop' align='center' colspan='14'><b>$ThisYear</b></td></tr>" + $CR)
	$out = AddStr(1,"add","<tr align='center' valign='bottom' style='$stYearGrphRow'>" + $CR)
	$out = AddStr(1,"add","<td style='height: 92px'>&nbsp;</td>" + $CR)
	$index = 1
	# Generate yearly graph
	WHILE $index <=12
		SHOWSTATUS msg="$LangStatus15 $ThisYear, $index" Width=350
		# number found this month
		$num = Val(Extract($result, ";", $index))
		$out = AddStr(1,"add","<td style='width: 25px; vertical-align:bottom;'>")
		IF $num > 0
			$out = AddStr(1,"add","$num<br />")
			$height = Int(80 * $Num / $MostInMonth)
			#$height = Int(80 * Ln($Num) / Ln($MostInMonth))
			IF $UseImageBars
				IF $num = $MostInMonth
					$image = $imagepath + $ImageRV
					$out = AddStr(1,"add","<img src='$image' width='25' height='$height' alt='$num' title='$num'/>")
				ELSE
					IF $num = $MaxInMonth
						$image = $imagepath + $ImageYV
						$out = AddStr(1,"add","<img src='$image' width='25' height='$height' alt='$num' title='$num'/>")
					ELSE
						$image = $imagepath + $ImageGV
						$out = AddStr(1,"add","<img src='$image' width='25' height='$height' alt='$num' title='$num'/>")
					ENDIF
				ENDIF
			ELSE
				IF $UseHeatBars
					$heatnum = $num
					$heatmax = $MostinMonth
					GOSUB Name=GetHeatColor
					$out = AddStr(1,"add","<div title='$num' style='background: #$HeatColor; height: $height" + "px;'>&nbsp;</div>")
				ELSE
					IF $num = $MostInMonth
						$out = AddStr(1,"add","<div title='$num' style='background: $stRedBar; height: $height" + "px;'>&nbsp;</div>")
					ELSE
						IF $num = $MaxInMonth
							$out = AddStr(1,"add","<div title='$num' style='background: $stYellowBar; height: $height" + "px;'>&nbsp;</div>")
						ELSE
							$out = AddStr(1,"add","<div title='$num' style='background: $stGreenBar; height: $height" + "px;'>&nbsp;</div>")
						ENDIF
					ENDIF
				ENDIF
			ENDIF
		ENDIF
		$out = AddStr(1,"add","</td>" + $CR)
		$index = $index + 1
	ENDWHILE
	# output data block
	$perdayC = Alltrim(Str($YearFinds / $TotalDaysCached,5,1))
	$perdayO = Alltrim(Str($YearFinds / $DaysInYear,5,1))
	$perweek = Alltrim(Str(7 * $YearFinds / $DaysInYear,5,1))
	$permonth = Alltrim(Str(30.44 * $YearFinds / $DaysInYear,6,1))
	$out = AddStr(1,"add","<td  rowspan='4' valign='bottom'>" + $CR)
	$out = AddStr(1,"add","<table border='0' style='$stYearDataTab'>" + $CR)
	$out = AddStr(1,"add","<tr><td style='$stYearDataTit'>$Lang07</td>" + $CR)
	$out = AddStr(1,"add","<td style='$stYearDataInf' width='40px'>$YearFinds</td></tr>" + $CR)
	$out = AddStr(1,"add","<tr><td style='$stYearDataTit'>$Lang08</td>" + $CR)
	$out = AddStr(1,"add","<td style='$stYearDataInf'>$TotalDaysCached</td></tr>" + $CR)
	$out = AddStr(1,"add","<tr><td style='$stYearDataTit'>$Lang09</td>" + $CR)
	$out = AddStr(1,"add","<td style='$stYearDataInf'>$perdayC</td></tr>" + $CR)
	$out = AddStr(1,"add","<tr><td style='$stYearDataTit'>$Lang10</td>" + $CR)
	$out = AddStr(1,"add","<td style='$stYearDataInf'>$perdayO</td></tr>" + $CR)
	$out = AddStr(1,"add","<tr><td style='$stYearDataTit'>$Lang11</td>" + $CR)
	$out = AddStr(1,"add","<td style='$stYearDataInf'>$perweek</td></tr>" + $CR)
	$out = AddStr(1,"add","<tr><td style='$stYearDataTit'>$Lang11a</td>" + $CR)
	$out = AddStr(1,"add","<td style='$stYearDataInf'>$permonth</td></tr>" + $CR)
	$out = AddStr(1,"add","</table></td></tr>" + $CR)
	# output key to months
	$out = AddStr(1,"add","<tr style='$stRankRow'>" + $CR)
	$out = AddStr(1,"add","<td style='$stRankTit'>$Lang12</td>" + $CR)
	$out = AddStr(1,"add","<td>$Lang13</td><td>$Lang14</td><td>$Lang15</td><td>$Lang16</td><td>$Lang17</td><td>$Lang18</td>" + $CR)
	$out = AddStr(1,"add","<td>$Lang19</td><td>$Lang20</td><td>$Lang21</td><td>$Lang22</td><td>$Lang23</td><td>$Lang24</td>" + $CR)
	$out = AddStr(1,"add","</tr>" + $CR)
	# output 'days cached' line under graph
	$out = AddStr(1,"add","<tr style='$stRankRow'>" + $CR)
	$out = AddStr(1,"add","<td style='$stRankTit'>$Lang25</td>" + $CR)
	$index = 1
	WHILE $index <=12
		$num = Val(Extract($result2, ";", $index))
		IF $num >0
			$out = AddStr(1,"add","<td>$num</td>")
		ELSE
			$out = AddStr(1,"add","<td>&nbsp;</td>")
		ENDIF
		$index = $index + 1
	ENDWHILE
	$out = AddStr(1,"add","</tr>" + $CR)
	$out = AddStr(1,"add","</table>" + $CR)
	$out = AddStr(1,"add","<br />" + $CR)
ENDSUB #DoYearStats

BEGINSUB name=BuildTabString
	$TabHeader = ""
# Close last tab and whole tab structure if necessary
	IF $TabCount > 0
		$out = $out + "</div></div>"
		# Start Tab Header structure
		$TabHeader = "<div align='center'><br /><br />" + $CR
		$TabHeader = $TabHeader + "<div style='line-height:150%; width:95%'>"
	ENDIF
	$count = 1
	# Build tab buttons
	WHILE $count <= $TabCount
		$tmpS = Extract($TabString,";",$count)
		
		IF $StyleRounded
			IF $count = 1
				$TabHeader = $TabHeader + "<span id='tab" + "$count" + "' style='cursor:pointer; $stTabActive border-radius: 10px 10px 10px 10px; padding: 5px; font-weight:bold; font-size: 120%; white-space:nowrap; display:inline-block; margin:4px' " + $CR
			ELSE
				$TabHeader = $TabHeader + "<span id='tab" + "$count" + "' style='cursor:pointer; $stTabInActive border-radius: 10px 10px 10px 10px; padding: 5px; font-weight:bold; font-size: 120%; white-space:nowrap; display:inline-block; margin:4px' " + $CR
			ENDIF
			$TabHeader = $TabHeader + "onmousedown=" + $_Quote  + "getElementById('tab" + "$count" + "_details').style.display = 'block'; getElementById('tab" + "$count" + "').style.background = '" + RegExSub(": *(.*?);",$stTabActive,1,1) + "'; getElementById('tab" + "$count" + "').style.color = '" + RegExSub(": *(.*?);",$stTabActive,2,1) + "';"
		ELSE
			IF $count = 1
				$TabHeader = $TabHeader + "<span id='tab" + "$count" + "' style='cursor:pointer; background:#ffffff; border:2px outset; font-weight:bold; font-size: 120%; white-space:nowrap; display:inline-block; margin:4px' " + $CR
			ELSE
				$TabHeader = $TabHeader + "<span id='tab" + "$count" + "' style='cursor:pointer;" +  $st2c2 + " border:2px outset; font-weight:bold; font-size: 120%; white-space:nowrap; display:inline-block; margin:4px' " + $CR
			ENDIF
			$TabHeader = $TabHeader + "onmousedown=" + $_Quote  + "getElementById('tab" + "$count" + "_details').style.display = 'block'; getElementById('tab" + "$count" + "').style.background = '#ffffff';"
		ENDIF
			
				
		$tmpN = 1
		$tmpS1 = RegExSub(": *(.*?);",$st2c2,1,1)
		WHILE $tmpN <= $TabCount
			IF $tmpN <> $count
				IF $StyleRounded
					$TabHeader = $TabHeader + " getElementById('tab" + "$tmpN" + "_details').style.display = 'none'; getElementById('tab" + "$tmpN" + "').style.background = '" + RegExSub(": *(.*?);",$stTabInActive,1,1) + "'; getElementById('tab" + "$tmpN" + "').style.color = '" + RegExSub(": *(.*?);",$stTabInActive,2,1) + "';"
				ELSE
					$TabHeader = $TabHeader + " getElementById('tab" + "$tmpN" + "_details').style.display = 'none'; getElementById('tab" + "$tmpN" + "').style.background = '" + $tmpS1 + "';"
				ENDIF
			ENDIF
			$tmpN = $tmpN + 1
		ENDWHILE
		$TabHeader = $TabHeader + $_Quote + ">"
		$TabHeader = $TabHeader + "&nbsp; $tmpS &nbsp;" + "</span>" + $CR		
		$count = $count + 1
	ENDWHILE
	IF $TabCount > 0
		$TabHeader = $TabHeader + "</div>"
	ENDIF
	$out = Replace("!!tabs!!", $TabHeader, $out, TRUE)
ENDSUB

BEGINSUB Name=Output
	$out = AddStr(1,"get")
	SHOWSTATUS msg="$LangStatus16" Width=350
	GOSUB name=BuildTabString
	# Add the HTML Footer to the output variable, again source is down near the
	# bottom of this file
	$HTMLFooter = Replace("=VERSION="    , "V$Revision",  $HTMLFooter, true)
	$HTMLFooter = Replace("=GSAKVERSION=", $_Version,  $HTMLFooter, true)
	$HTMLFooter = Replace("=TIME="       , $TimeTaken, $HTMLFooter, true)
	$HTMLFooter = Replace("=LANGFILE="       , $LangFileAttribution, $HTMLFooter, true)
	$out =$out + $HTMLfooter
	
	
	# $out now contains a big fat <div> which can be pasted into the
	# geocaching.com profile page
	
	# Add surrounding <center> tags if wanted
	
	IF $Center
		$out = "<center>" + $CR + $out + $CR + "</center>"
	ENDIF

	# Make all GC links open in new tab/window
	# $out = Replace("<a href='http://www.geocaching.com","<a target='_blank' href='http://www.geocaching.com",$out,TRUE)

	# Make links in profile short (relative) style
	$tmpS = Replace("http://www.geocaching.com","..",$out,TRUE)
	$tmpS = Replace("","&deg;",$tmpS,TRUE)

	# Too long for profile? Remove target= again
	#	IF Len($tmpS) > 150000
	#		$tmpS = Replace("<a target='_blank'","<a",$tmpS,TRUE)
	#	ENDIF
	
	# Strip out the Javascript for the GC Version
	# $tmpS = RegExReplace("(?s)<!--BeginJavascript-->.*?<!--EndJavascript-->", $tmpS,"")
	
	#Compress the html for GC.com - thanks to javapgmr for this routine
	#$tmpS = Replace("$_newLine", "", $tmpS, TRUE)
	#$tmpS = RegExReplace("\x20+", $tmpS," ")
	#$tmpS = RegExReplace("<!--.+?-->", $tmpS,"")
	$tmpS = RegExReplace("<!--BeginJavascript-->", $tmpS,"")
	$tmpS = RegExReplace("<!--EndJavascript-->", $tmpS,"")
	
	CLIP Data=$tmpS
	
	# Add link to Profile edit page to local Version
	# $out = "<div><a href='http://www.geocaching.com/account/editprofiledetails.aspx' target='_blank'><img src='http://gsak.net/stats/profilepage.png' /></a></div>"+ $CR + "<br /><br />" + $out
	
	# Strip out the Javascript Comments only for the local Version
	$out = RegExReplace("<!--BeginJavascript-->", $out,"")
	$out = RegExReplace("<!--EndJavascript-->", $out,"")
	
	# Add the HTML header to the output variable, the source is in a
	# <data> block towards the end of this file, here we grab it and add the
	# user info to the title and page header
	
	$tmpN = $TotalFinds - $BenchmarkFinds - $WaymarkFinds
	$HTMLHeader = Replace("=USER=","$user $Lang01 $FindsWithDuplicates $Lang02 $tmpN $Lang03",$HTMLHeader, true)
	$out = $HTMLHeader + $out
	# Close off the output
	$out = $out + "</body></html>" + $CR
	IF $UseImageBars
		# write image files
		$tmpS = PutFile($htmlfilepath + "\yellow-v.png", MimeDecode($zyellowv))
		$tmpS = PutFile($htmlfilepath + "\blue-h.png",   MimeDecode($zblueh))
		$tmpS = PutFile($htmlfilepath + "\blue-v.png",   MimeDecode($zbluev))
		$tmpS = PutFile($htmlfilepath + "\green-h.png",  MimeDecode($zgreenh))
		$tmpS = PutFile($htmlfilepath + "\green-v.png",  MimeDecode($zgreenv))
		$tmpS = PutFile($htmlfilepath + "\red-h.png",    MimeDecode($zredh))
		$tmpS = PutFile($htmlfilepath + "\red-v.png",    MimeDecode($zredv))
		$tmpS = PutFile($htmlfilepath + "\yellow-h.png", MimeDecode($zyellowh))
	ENDIF

	$out = UTF8($out,"e")
	$FileName = $htmlfilepath + "\stats" + NumToStr($Settings) + ".html"
	$tmpS = PutFile($FileName,$out)
	IF Left($tmpS ,4) <> "*OK*"
		CANCEL Msg="Sorry! For some reason I couldn't generate the outputfile"
	ENDIF
	WEB URL="$FileName"
ENDSUB #Output
######################---Stats Generating Subroutines---########################

BEGINSUB name=CreateStyle
	
	IF $seed = ""
		$Seed = "#CAC089"
	ENDIF
	$Seed = AllTrim($Seed)
	IF At("#",$Seed) = 0
		$Seed = "#" + $Seed
	ENDIF
	$RedSeed = Substr($Seed,2,2)
	$GreenSeed = Substr($Seed,4,2)
	$BlueSeed = Substr($Seed,6,2)
	
	$Theme5 = "#" + $RedSeed + $GreenSeed + $BlueSeed
	$Theme2 = "#"
	$Theme3 = "#"
	$Theme4 = "#"
	$Theme1 = "#"
	$Theme6 = "#"
	$Theme7 = "#"
	$Theme8 = "#"
		
	$WhiteMask = 255
	$BlackMask = 100
	
	$Hex = $RedSeed
	GOSUB name=CreateStyleColors
		
	$Hex = $GreenSeed
	GOSUB name=CreateStyleColors
	
	$Hex = $BlueSeed
	GOSUB name=CreateStyleColors
ENDSUB name=CreateStyle
	
BEGINSUB name=CreateStyleColors
	GOSUB name=HexToDec
	$Base = $Dec
	$Dec = ($Base * 0.60) + ($WhiteMask * 0.40)
	GOSUB name=DecToHex
	$Theme6 = $Theme6 + $Hex
	$Dec = ($Base * 0.40) + ($WhiteMask * 0.60)
	GOSUB name=DecToHex
	$Theme7 = $Theme7 + $Hex
	$Dec = ($Base * 0.20) + ($WhiteMask * 0.80)
	GOSUB name=DecToHex
	$Theme8 = $Theme8 + $Hex
	
	$Dec = ($Base * 0.85) + ($BlackMask * 0.15)
	GOSUB name=DecToHex
	$Theme4 = $Theme4 + $Hex
	$Dec = ($Base * 0.70) + ($BlackMask * 0.30)
	GOSUB name=DecToHex
	$Theme3 = $Theme3 + $Hex
	$Dec = ($Base * 0.60) + ($BlackMask * 0.40)
	GOSUB name=DecToHex
	$Theme2 = $Theme2 + $Hex
	$Dec = ($Base * 0.40) + ($BlackMask * 0.60)
	GOSUB name=DecToHex
	$Theme1 = $Theme1 + $Hex
	#MSGOK msg="$Theme1 $Theme2 $Theme3 $Theme4 $Theme5 $Theme6 $Theme7 $Theme8 "
ENDSUB # CreateStyleColors


BEGINSUB Name=DiffTerr
	# Initialise Variables
	$rating  = 1
	$dif     = ""
	$terr    = ""
	$maxdif  = 0
	$maxterr = 0
	WHILE $rating <=5
		# Deal with use of "," as separator
		$text = replace(",",".",numtoStr($rating),true)
		SHOWSTATUS msg="$LangStatus17 $text" Width=350
		$_sql = "Select count(Code) from Allfinds WHERE Difficulty=$rating"
		$num = Val(Sqlite("sql",$_sql))
		IF $num>$maxdif
			$maxdif = $num
		ENDIF
		$dif = $dif + "$text,$num;"
		$_sql = "Select count(Code) from AllFinds WHERE Terrain=$rating"
		$num = Val(Sqlite("sql",$_sql))
		IF $num>$maxterr
			$maxterr = $num
		ENDIF
		$terr = $terr + "$text,$num;"
		$rating=$rating + 0.5
	ENDWHILE
	# Initialise Section variables
	$colspan = 2
	# Force Diff and Terr to be next to each other, they like it that way ;)
	$column = 1
	$text=$Lang26
	GOSUB Name=SectionHead
	$result=$dif
	$maxnum=$maxdif
	$note=""
	$maxwidth = 150
	$totalpercent = $FindsWithDuplicates
	IF $PieCharts
		GOSUB Name=Table2Pi
	ELSE
		GOSUB Name=Table2Col
	ENDIF
	# Initialise Section variables
	$colspan = 2
	$text=$Lang27
	GOSUB Name=SectionHead
	$result=$terr
	$maxnum=$maxterr
	$note=""
	$maxwidth = 150
	$totalpercent = $FindsWithDuplicates
	IF $PieCharts
		GOSUB Name=Table2Pi
	ELSE
		GOSUB Name=Table2Col
	ENDIF
#	IF $ShowDiffTerrChart
#		GOSUB  Name=DiffTerrChart
#	ENDIF
ENDSUB #DiffTerr

BEGINSUB Name=DiffTerrChart
	# Initialise Variables
	$terrain  = 1
	$difficulty = 1
	$diffterr     = ""
	$maxdiffterr  = 0
	$diffterr = "1,1.5,2,2.5,3,3.5,4,4.5,5,;"
	$count = 0
	
	$_sql = "Select count(Code) as c from Allfinds group by difficulty order by c desc limit 1"
	$maxdif = Val(Sqlite("sql",$_sql))
	
	$_sql = "Select count(Code) as c from Allfinds group by terrain order by c desc limit 1"
	$maxterr = Val(Sqlite("sql",$_sql))

	WHILE $difficulty <=5
		WHILE $terrain <=5
			SHOWSTATUS msg="$LangStatus18 $difficulty/$terrain" Width=350
			$_sql = "Select count(Code) from AllFinds WHERE Difficulty=$difficulty and Terrain=$terrain"
			$num = Val(Sqlite("sql",$_sql))
			$diffterr = $diffterr + "$num,"
			IF $num >0
				$count = $count + 1
			ENDIF
			IF $num>$maxdiffterr
				$maxdiffterr = $num
			ENDIF
			$terrain = $terrain + 0.5
		ENDWHILE
		$diffterr = $diffterr + ";"
		$difficulty = $difficulty + 0.5
		$terrain  = 1
	ENDWHILE

	$colspan = 1
	$text=$Lang28
	GOSUB Name=SectionHead
	$out = AddStr(1,"add","<table width='$maxtablewidth' style='text-align: left;'>" + $CR)

	$cellwidth = Int($maxtablewidth/12.5)
	$headerwidth = $maxtablewidth - (11 * $cellwidth)

	# Go through the data, one record at a time
	$indexd = 0
	$indext = 0
	$terrain  = 1
	$difficulty = 1

	# Title row

	$out = AddStr(1,"add","<tr><td style='$stTab2cHead'></td><td style='$stTab2cHead' colspan='10' align='center'><B>$Lang28b</B></td></tr>" + $CR)
	$out = AddStr(1,"add","<tr><td style='$stTab2cHead' rowspan='10' width='$headerwidth' valign='middle' align='center'><B>$Lang28a</B></td>" + $CR)

	$out = AddStr(1,"add","<td style='$st2c1'></td>")
	# Get one data line
	$data = Extract($diffterr, ";" , $indexd)
	WHILE $indext < 9
		$indext = $indext + 1
		# Get one result
		$text = Extract($data, ",", $indext)
		$out = AddStr(1,"add","<td style='$st2c1' width='$cellwidth' align='center'><B>$text</B></td>" + $CR)
	ENDWHILE
	# Row Total
	$out = AddStr(1,"add","<td width='$cellwidth'></td>" + $CR)
	$out = AddStr(1,"add","</tr>" + $CR)

	$indext = 0
	$indexd = 1

	WHILE $indexd < 10
		$indexd = $indexd + 1
		# Get one data line
		$data = Extract($diffterr, ";" , $indexd)
		$tindexd = replace(",",".",numtoStr($difficulty),true)
		$out = AddStr(1,"add","<tr><td style='$st2c1'><b> $tindexd</b></td>" + $CR)
		$tmpN = 0
		WHILE $indext < 9
			$indext = $indext + 1
			# Get one result
			$text = Extract($data, ",", $indext)
			$num = Val($text)
			$tmpN = $tmpN + $num
			GOSUB Name=OutputChartLine
			$terrain = $terrain + 0.5
		ENDWHILE
		# Output Row Total
		$num = $tmpN
		$text = NumToStr($num)
		IF $num >= $maxdif
			$Bold = "<B>"
			$boldoff = "</B>"
			$cellstyle = $stTab2cHead + " color: red;"
		ELSE
			$bold = ""
			$boldoff = ""
			$cellstyle = $stTab2cHead
		ENDIF
		$out = AddStr(1,"add","<td style='$cellstyle' width='$cellwidth' align='center'>$bold<i>$text</i>$boldoff</td>" + $CR)
		$indext = 0
		$out = AddStr(1,"add","</tr>" + $CR)
		$difficulty = $difficulty + 0.5
		$terrain  = 1
	ENDWHILE

	$out = AddStr(1,"add","<tr><td></td><td></td>" + $CR)
	$rating  = 1
	# Column Totals
	WHILE $rating <=5
		# Deal with use of "," as separator
		#$trating = replace(",",".",numtoStr($rating),true)
		$_sql = "Select count(Code) from AllFinds WHERE Terrain=$rating"
		$num = Val(Sqlite("sql",$_sql))
		$text = NumToStr($num)
		IF $num >= $maxterr
			$Bold = "<B>"
			$boldoff = "</B>"
			$cellstyle = $stTab2cHead + " color: red;"
		ELSE
			$bold = ""
			$boldoff = ""
			$cellstyle = $stTab2cHead
		ENDIF
		$out = AddStr(1,"add","<td style='$cellstyle' width='$cellwidth' align='center'>$bold<i>$text</i>$boldoff</td>" + $CR)
		$rating=$rating + 0.5
	ENDWHILE

	$out = AddStr(1,"add","</table>" + $CR + "<br />")

	# Count caches where difficulty/terrain is greater or equal to 3 as 'Hard' caches
	$_sql = "Select count(Code) from AllFinds WHERE Terrain >=3 OR Difficulty >=3"
	$num = Val(Sqlite("sql",$_sql))
	$tmpN = Int(1000*$num/$FindsWithDuplicates)/10
	$out = AddStr(1,"add","<i><b>$count</b>" + " $LangT5 " + $Lang104 + " <b>81</b> " + $Lang104a + "<br /><b>$num</b> ($tmpN" + "%) " + $Lang127 + "</i>" + $CR)

ENDSUB

BEGINSUB Name=GetHeatColor
	$begRed = 20
	$redChange = 180
	$begGreen = 50
	$greenChange = 150
	$begBlue = 0
	$blueChange = 0

	IF $heatmax > 0 AND $heatnum > 0
		# Use log scale to enhance color differences
		IF $heatmax = 1 AND $heatnum = 1
			$heatx = 1
		ELSE
			$heatx = Log($heatmax,$heatnum)
		ENDIF
		
		$heaty = 1-($heatnum/$heatmax)
		# Scale so one color is always at full intensity
		IF $heatx >= $heaty
			$heaty = $heaty/$heatx
			$heatx = 1
		ELSE
			$heatx = $heatx/$heaty
			$heaty = 1
		ENDIF
	ELSE
		$heatx = 0
		$heaty = 0
	ENDIF
	$red=$begRed+($redChange*$heatx)
	$dec=$red
	GOSUB Name=dectohex
	$redhex=$hex
	$green=$begGreen+($greenChange*$heaty)
	$dec=$green
	GOSUB Name=dectohex
	$greenhex=$hex
	$blue=$begBlue+($blueChange*$heatx)
	$dec=$blue
	GOSUB Name=dectohex
	$bluehex=$hex
	$heatcolor = $redhex + $greenhex + $bluehex
	$heatstyle = "background: #" + $redhex + $greenhex + $bluehex + "; color: #FFFFFF;"

ENDSUB #GetHeatColor

BEGINSUB Name=OutputChartLine
	$bold = ""
	$boldoff = ""
	$cellstyle = $st2c2
	
	$begRed = 20
	$redChange = 180
	$begGreen = 50
	$greenChange = 150
	$begBlue = 0
	$blueChange = 0

	IF $num > 0
		IF $num = $maxdiffterr
			$cellstyle = $stDiffTerrhi
			$bold = "<b>"
			$boldoff = "</b>"
		ELSE
			
			# Use heat map shading
			IF $UseHeatMap
				IF $maxdiffterr > 0
					# Use log scale to enhance color differences
					IF $maxdiffterr = 1 AND $num = 1
						$x = 1
					ELSE
						$x = Log($maxdiffterr,$num)
					ENDIF
					$y = 1-($num/$maxdiffterr)
					# Scale so one color is always at full intensity
					IF $x >= $y
						$y = $y/$x
						$x = 1
					ELSE
						$x = $x/$y
						$y = 1
					ENDIF
				ENDIF
				$cellstyle = $stDiffTerr
				$red=$begRed+($redChange*$x)
				$dec=$red
				GOSUB Name=dectohex
				$redhex=$hex
				$green=$begGreen+($greenChange*$y)
				$dec=$green
				GOSUB Name=dectohex
				$greenhex=$hex
				$blue=$begBlue+($blueChange*$x)
				$dec=$blue
				GOSUB Name=dectohex
				$bluehex=$hex
				$cellstyle = "background: #" + $redhex + $greenhex + $bluehex + "; color: #FFFFFF;"
			ELSE
				$cellstyle = $stDiffTerr
			ENDIF
					
		ENDIF
	ELSE
		$text = " "
	ENDIF
	IF $indext = 1
		$out = AddStr(1,"add","    <td style='$cellstyle' width='$cellwidth' align='center'>$bold$text$boldoff</td>" + $CR)
	ELSE
		$out = AddStr(1,"add","    <td style='$cellstyle' align='center'>$bold$text$boldoff</td>" + $CR)
	ENDIF
ENDSUB

BEGINSUB Name=FindsByFoundDate
$_sql = "DROP TABLE IF EXISTS FindsByDay"
$status = Sqlite("sql",$_sql)

# Initialise Variables
$day = 1
$month = 1
$maxcellF = 0                              # maximum value of found cell
$numcombF = 0                              # number of found Month/Day Combinations
$monthday = "1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,;"

$_sql = "CREATE table FindsByDay as Select cast(strftime('%m',lDate) as integer) as Month, cast(strftime('%d',lDate) as integer) as Day, Count(code) as Count, Sum(FTF) as FTF  from AllFinds group by strftime('%m',lDate), strftime('%d',lDate)"
$status = Sqlite("sql",$_sql)

SHOWSTATUS msg="Chart of month/day..." Width=350
	WHILE $month <= 12
		WHILE $day <= 31
			$_sql = "SELECT Count from FindsByDay where Month=$month AND Day=$day"
			$num = Val(Sqlite("sql",$_sql))
			$_sql = "SELECT CASE WHEN FTF>0 THEN 'F' ELSE '' END from FindsByDay where Month=$month AND Day=$day"
			$tmpS = Sqlite("sql",$_sql)
			$monthday = $monthday  + "$num" + $tmpS + ","
			IF $num > 0  # found cell
				$numcombF = $numcombF + 1
  			IF $num > $maxcellF
  				$maxcellF = $num
  			ENDIF
			ENDIF
			$day = $day + 1
		ENDWHILE
		$monthday = $monthday + ";"
		$month = $month + 1
		$day  = 1
	ENDWHILE
	
	# Max month count
	$_sql = "select Sum(Count) as sum from FindsByDay group by Month order by sum desc limit 1"
	$max = Val(Sqlite("sql",$_sql))
	
	# Max Day count
	$_sql = "select Sum(Count) as sum from FindsByDay group by Day order by sum desc limit 1"
	$maxitem = Val(Sqlite("sql",$_sql))
	
	$colspan = 1
	$text=$LangT26
	GOSUB Name=SectionHead

	$out = AddStr(1,"add","<table  cellspacing ='1'cellpadding = '0' width='$maxtablewidth' style='text-align: left; font-size: 9px;'>" + $CR)
	
	$cellwidth = Int($maxtablewidth/33)
	$headerwidth = $maxtablewidth - (32 * $cellwidth)

	# Go through the data, one record at a time
	$indexd = 0
	$indext = 0
	$day  = 1
	$month = 1
	
	# Title row
	#$out = AddStr(1,"add","<tr><td style='$stTab2cHead'></td><td style='$stTab2cHead' colspan='32' align='center'><B>$Lang32</B></td></tr>" + $CR)
	$out = AddStr(1,"add","<tr><td height='16' style='$stTab2cHead' colspan='32' align='center'><B>$Lang32</B></td></tr>" + $CR)
	#$out = AddStr(1,"add","<tr><td style='$stTab2cHead' rowspan='13' width='$headerwidth' align='center'><B>$Lang12</B></td>" + $CR)
	#$out = AddStr(1,"add","<tr><td style='$stTab2cHead' rowspan='13' width='2' align='center'></td>" + $CR)
	$out = AddStr(1,"add","<tr>" + $CR)

	$out = AddStr(1,"add","<td height='16' style='$st2c1'></td>")
	# Get one data line
	$data = Extract($monthday, ";" , $indexd)
	WHILE $indext < 31
		$indext = $indext + 1
		# Get one result
		$text = Extract($data, ",", $indext)
		$tmpB = FALSE
		$_sql = "select count(distinct substr(ldate,6)) from allfinds where cast (substr(ldate,9) as integer) = $text"
		$tmpN = Val(Sqlite("sql",$_sql))
		BEGINCASE
			CASE ($indext <= 29)
				$tmpB = $tmpN = 12
			CASE ($indext = 30)
				$tmpB = $tmpN = 11
			CASE ($indext = 31)
				$tmpB = $tmpN = 7
			ENDCASE
		IF $tmpB
			$out = AddStr(1,"add","<td style='$st2c1' width='$cellwidth' align='center'><B><font color='green'>$text</font></B></td>" + $CR)
		ELSE
			$out = AddStr(1,"add","<td style='$st2c1' width='$cellwidth' align='center'><B>$text</B></td>" + $CR)
		ENDIF
	ENDWHILE
	
	# Row Total
	$out = AddStr(1,"add","<td width='$cellwidth'></td>" + $CR)
	$out = AddStr(1,"add","</tr>" + $CR)
	
	# Month language string
	$tmpS = $Lang13 + ";" + $Lang14 + ";" + $Lang15 + ";" + $Lang16 + ";" + $Lang17 + ";" + $Lang18 + ";" + $Lang19 + ";" + $Lang20 + ";" + $Lang21 + ";" + $Lang22 + ";" + $Lang23 + ";" + $Lang24

	$indext = 0
	$indexd = 1

	WHILE $indexd < 13
		$indexd = $indexd + 1
		# Get one data line
		$data = Extract($monthday, ";" , $indexd)
		#$tindexd = replace(",",".",numtoStr($month),true)
		$tindexd = Extract($tmpS,";",$month)
		
		$tmpB = FALSE
		$_sql = "select count(distinct substr(ldate,9)) from allfinds where cast (substr(ldate,6,2) as integer) = $month"
		$tmpN = Val(Sqlite("sql",$_sql))
		BEGINCASE
			CASE ($month=2)
				$tmpB = $tmpN = 29
			CASE ($month=4 OR $month=6 OR $month = 9 OR $month=11)
				$tmpB = $tmpN = 30
			OTHERWISE
				$tmpB = $tmpN = 31
			ENDCASE
		IF $tmpB
			$out = AddStr(1,"add","<tr><td height='16' style='$st2c1' width='$cellwidth'><b><font color='green'> $tindexd</font></b></td>" + $CR)
		ELSE
			$out = AddStr(1,"add","<tr><td height='16' style='$st2c1' width='$cellwidth'><b> $tindexd</b></td>" + $CR)
		ENDIF
		$tmpN = 0
		WHILE $indext < 31
			$indext = $indext + 1
			# Get one result
			$text = Extract($data, ",", $indext)
			# Set $x > 0 to shade green showing has FTF on this date
			$x = At("F",$text)
			$text = Extract($text,"F", 1)			
			$num = Val($text)
			IF ($indexd = 3 AND $indext > 29) OR ($indexd = 10 AND $indext > 30) OR ($indexd = 5 AND $indext > 30) OR ($indexd = 7 AND $indext > 30) OR ($indexd = 12 AND $indext > 30)
				$Skipflag = TRUE
			ELSE
				$Skipflag = FALSE
			ENDIF
			$tmpN = $tmpN + $num
			GOSUB Name=OutputFoundChartLine
			$day = $day + 1
		ENDWHILE
				
		# Output Row Total
		$num = $tmpN
		$text = NumToStr($num)
		# Max count?
		
		IF $num >= $max
			$Bold = "<B>"
			$boldoff = "</B>"
			$cellstyle = $stTab2cHead + " color: red;"
		ELSE
			$bold = ""
			$boldoff = ""
			$cellstyle = $stTab2cHead
		ENDIF
		
		$out = AddStr(1,"add","<td style='$cellstyle' width='$cellwidth' align='center'>$bold<i>$text</i>$boldoff</td>" + $CR)
		$indext = 0
		$out = AddStr(1,"add","</tr>" + $CR)
		$month = $month + 1
		$day  = 1
	ENDWHILE

	$out = AddStr(1,"add","<tr><td></td>" + $CR)
	$day  = 1
	# Column Totals
	WHILE $day <= 31
		$_sql = "SELECT sum(Count) from FindsByDay where Day=$day"
  	$num = Val(Sqlite("sql",$_sql))
  	$text = NumToStr($num)
  	
  	IF $num >= $maxitem
			$Bold = "<B>"
			$boldoff = "</B>"
			$cellstyle = $stTab2cHead + " color: red;"
		ELSE
			$bold = ""
			$boldoff = ""
			$cellstyle = $stTab2cHead
		ENDIF
		
		$out = AddStr(1,"add","<td height='16' style='$cellstyle' width='$cellwidth' align='center'>$bold<i>$text</i>$boldoff</td>" + $CR)
		$day = $day + 1
	ENDWHILE

	$out = AddStr(1,"add","</table>" + $CR + "<br />")
	
	$tmpN = Int(1000*$numcombF/366)/10

	# Found statistics
  $out = AddStr(1,"add","<i><b>$numcombF</b> $Lang155 <b>366</b> ($tmpN" + "%) </i>" + $CR)
  
  # Number of FTF days
  
  $_sql = "SELECT count(*) from findsbyday where FTF"
  $numcombF = Val(Sqlite("sql",$_sql))
  $tmpN = Int(1000*$numcombF/366)/10
  $out = AddStr(1,"add","<br/><i><b>$numcombF</b> FTF $Lang155 <b>366</b> ($tmpN" + "%) </i>" + $CR)
    
  $out = AddStr(1,"add","<br/><span style='$stSmall'><i>$Lang177</i></span>" + $CR)
	
ENDSUB # Name=FindsByFoundDate

BEGINSUB Name=FindsByPlacedDay
$_sql = "DROP TABLE IF EXISTS FindsByDay"
$status = Sqlite("sql",$_sql)

# Initialise Variables
$day = 1
$month = 1
$maxcellF = 0                              # maximum value of found cell
$numcombF = 0                              # number of found Month/Day Combinations
$monthday = "1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,;"

$_sql = "CREATE table FindsByDay as Select cast(strftime('%m',PlacedDate) as integer) as Month, cast(strftime('%d',PlacedDate) as integer) as Day, Count(code) as Count from AllFinds group by strftime('%m',PlacedDate), strftime('%d',PlacedDate)"
$status = Sqlite("sql",$_sql)

SHOWSTATUS msg="Chart of placed day..." Width=350
	WHILE $month <= 12
		WHILE $day <= 31
			$_sql = "SELECT Count from FindsByDay where Month=$month AND Day=$day"
			$num = Val(Sqlite("sql",$_sql))
			$monthday = $monthday  + "$num" + ","
			IF $num > 0  # found cell
				$numcombF = $numcombF + 1
  			IF $num > $maxcellF
  				$maxcellF = $num
  			ENDIF
			ENDIF
			$day = $day + 1
		ENDWHILE
		$monthday = $monthday + ";"
		$month = $month + 1
		$day  = 1
	ENDWHILE
	
	# Max month count
	$_sql = "select Sum(Count) as sum from FindsByDay group by Month order by sum desc limit 1"
	$max = Val(Sqlite("sql",$_sql))
	
	# Max Day count
	$_sql = "select Sum(Count) as sum from FindsByDay group by Day order by sum desc limit 1"
	$maxitem = Val(Sqlite("sql",$_sql))
	
	$colspan = 1
	$text=$LangT33
	GOSUB Name=SectionHead

	$out = AddStr(1,"add","<table  cellspacing ='1'cellpadding = '0' width='$maxtablewidth' style='text-align: left; font-size: 9px;'>" + $CR)
	
	$cellwidth = Int($maxtablewidth/33)
	$headerwidth = $maxtablewidth - (32 * $cellwidth)

	# Go through the data, one record at a time
	$indexd = 0
	$indext = 0
	$day  = 1
	$month = 1
	
	# Title row
	#$out = AddStr(1,"add","<tr><td style='$stTab2cHead'></td><td style='$stTab2cHead' colspan='32' align='center'><B>$Lang32</B></td></tr>" + $CR)
	$out = AddStr(1,"add","<tr><td height='16' style='$stTab2cHead' colspan='32' align='center'><B>$Lang32</B></td></tr>" + $CR)
	#$out = AddStr(1,"add","<tr><td style='$stTab2cHead' rowspan='13' width='$headerwidth' align='center'><B>$Lang12</B></td>" + $CR)
	#$out = AddStr(1,"add","<tr><td style='$stTab2cHead' rowspan='13' width='2' align='center'></td>" + $CR)
	$out = AddStr(1,"add","<tr>" + $CR)

	$out = AddStr(1,"add","<td height='16' style='$st2c1'></td>")
	# Get one data line
	$data = Extract($monthday, ";" , $indexd)
	WHILE $indext < 31
		$indext = $indext + 1
		# Get one result
		$text = Extract($data, ",", $indext)
		
		$tmpB = FALSE
		$_sql = "select count(distinct month) from findsbyday where cast (day as integer) = $text"
		$tmpN = Val(Sqlite("sql",$_sql))
		BEGINCASE
			CASE ($indext <= 29)
				$tmpB = $tmpN = 12
			CASE ($indext = 30)
				$tmpB = $tmpN = 11
			CASE ($indext = 31)
				$tmpB = $tmpN = 7
			ENDCASE
		IF $tmpB
			$out = AddStr(1,"add","<td style='$st2c1' width='$cellwidth' align='center'><B><font color='green'>$text</font></B></td>" + $CR)
		ELSE
			$out = AddStr(1,"add","<td style='$st2c1' width='$cellwidth' align='center'><B>$text</B></td>" + $CR)
		ENDIF
	ENDWHILE
	
	# Row Total
	$out = AddStr(1,"add","<td width='$cellwidth'></td>" + $CR)
	$out = AddStr(1,"add","</tr>" + $CR)
	
	# Month language string
	$tmpS = $Lang13 + ";" + $Lang14 + ";" + $Lang15 + ";" + $Lang16 + ";" + $Lang17 + ";" + $Lang18 + ";" + $Lang19 + ";" + $Lang20 + ";" + $Lang21 + ";" + $Lang22 + ";" + $Lang23 + ";" + $Lang24

	$indext = 0
	$indexd = 1

	WHILE $indexd < 13
		$indexd = $indexd + 1
		# Get one data line
		$data = Extract($monthday, ";" , $indexd)
		#$tindexd = replace(",",".",numtoStr($month),true)
		$tindexd = Extract($tmpS,";",$month)
		$tmpB = FALSE
		$_sql = "select count(distinct day) from FindsByDay where cast (month as integer) = $month"
		$tmpN = Val(Sqlite("sql",$_sql))
		BEGINCASE
			CASE ($month=2)
				$tmpB = $tmpN = 29
			CASE ($month=4 OR $month=6 OR $month = 9 OR $month=11)
				$tmpB = $tmpN = 30
			OTHERWISE
				$tmpB = $tmpN = 31
			ENDCASE
		IF $tmpB
			$out = AddStr(1,"add","<tr><td height='16' style='$st2c1' width='$cellwidth'><b><font color='green'> $tindexd</font></b></td>" + $CR)
		ELSE
			$out = AddStr(1,"add","<tr><td height='16' style='$st2c1' width='$cellwidth'><b> $tindexd</b></td>" + $CR)
		ENDIF
		$tmpN = 0
		WHILE $indext < 31
			$indext = $indext + 1
			# Get one result
			$text = Extract($data, ",", $indext)
			# Set $x > 0 to shade green showing has FTF on this date
			$x = 0
			#$text = Extract($text,"F", 1)			
			$num = Val($text)
			IF ($indexd = 3 AND $indext > 29) OR ($indexd = 10 AND $indext > 30) OR ($indexd = 5 AND $indext > 30) OR ($indexd = 7 AND $indext > 30) OR ($indexd = 12 AND $indext > 30)
				$Skipflag = TRUE
			ELSE
				$Skipflag = FALSE
			ENDIF
			$tmpN = $tmpN + $num
			GOSUB Name=OutputFoundChartLine
			$day = $day + 1
		ENDWHILE
				
		# Output Row Total
		$num = $tmpN
		$text = NumToStr($num)
		# Max count?
		
		IF $num >= $max
			$Bold = "<B>"
			$boldoff = "</B>"
			$cellstyle = $stTab2cHead + " color: red;"
		ELSE
			$bold = ""
			$boldoff = ""
			$cellstyle = $stTab2cHead
		ENDIF
		
		$out = AddStr(1,"add","<td style='$cellstyle' width='$cellwidth' align='center'>$bold<i>$text</i>$boldoff</td>" + $CR)
		$indext = 0
		$out = AddStr(1,"add","</tr>" + $CR)
		$month = $month + 1
		$day  = 1
	ENDWHILE

	$out = AddStr(1,"add","<tr><td></td>" + $CR)
	$day  = 1
	# Column Totals
	WHILE $day <= 31
		$_sql = "SELECT sum(Count) from FindsByDay where Day=$day"
  	$num = Val(Sqlite("sql",$_sql))
  	$text = NumToStr($num)
  	
  	IF $num >= $maxitem
			$Bold = "<B>"
			$boldoff = "</B>"
			$cellstyle = $stTab2cHead + " color: red;"
		ELSE
			$bold = ""
			$boldoff = ""
			$cellstyle = $stTab2cHead
		ENDIF
		
		$out = AddStr(1,"add","<td height='16' style='$cellstyle' width='$cellwidth' align='center'>$bold<i>$text</i>$boldoff</td>" + $CR)
		$day = $day + 1
	ENDWHILE

	$out = AddStr(1,"add","</table>" + $CR + "<br />")
	
	$tmpN = Int(1000*$numcombF/366)/10

	# Placed Day statistics
  $out = AddStr(1,"add","<i><b>$numcombF</b> $Lang190 <b>366</b> ($tmpN" + "%) </i>" + $CR)
  	
ENDSUB # Name=FindsByPlacedDay



BEGINSUB Name=FindsByPlacedDate
$_sql = "DROP TABLE IF EXISTS FindsByMonth"
$status = Sqlite("sql",$_sql)

# Initialise Variables
$year = 2000
$month = 1
$maxcellF = 0                              # maximum value of found cell
$numcombF = 0                              # number of found Year/Month Combinations
$monthday = "$Lang13,$Lang14,$Lang15,$Lang16,$Lang17,$Lang18,$Lang19,$Lang20,$Lang21,$Lang22,$Lang23,$Lang24,;"

$_sql = "CREATE table FindsByMonth as Select cast(strftime('%Y',PlacedDate) as integer) as Year, cast(strftime('%m',PlacedDate) as integer) as Month, Count(code) as Count from AllFinds group by strftime('%Y',PlacedDate), strftime('%m',PlacedDate)"
$status = Sqlite("sql",$_sql)

SHOWSTATUS msg="Chart of year/month..." Width=350
	WHILE $year <= Val(left(DateToString($RunDate),4))
		WHILE $month <= 12
			$_sql = "SELECT Count from FindsByMonth where Year = $year AND Month=$month"
			$num = Val(Sqlite("sql",$_sql))
			$monthday = $monthday + "$num,"
			IF $num > 0  # found cell
				$numcombF = $numcombF + 1
  			IF $num > $maxcellF
  				$maxcellF = $num
  			ENDIF
			ENDIF
			$month = $month + 1
		ENDWHILE
		$monthday = $monthday + ";"
		$year = $year + 1
		$month  = 1
	ENDWHILE
	
	# Max month count
	$_sql = "select Sum(Count) as sum from FindsByMonth group by Month order by sum desc limit 1"
	$max = Val(Sqlite("sql",$_sql))
	
	# Max Year count
	$_sql = "select Sum(Count) as sum from FindsByMonth group by Year order by sum desc limit 1"
	$maxitem = Val(Sqlite("sql",$_sql))
	
	$colspan = 1
	$text=$LangT28
	GOSUB Name=SectionHead

	$out = AddStr(1,"add","<table  cellspacing ='1'cellpadding = '0' width='$maxtablewidth' style='text-align: left; font-size: 9px;'>" + $CR)
	
	$cellwidth = Int($maxtablewidth/12.5)
	$headerwidth = $maxtablewidth - (11 * $cellwidth)

	# Go through the data, one record at a time
	$indexd = 0
	$indext = 0
	$month = 1
	$year = 2000
	
	# Title row
	#$out = AddStr(1,"add","<tr><td style='$stTab2cHead'></td><td style='$stTab2cHead' colspan='32' align='center'><B>$Lang32</B></td></tr>" + $CR)
	$out = AddStr(1,"add","<tr><td height='16' style='$stTab2cHead' colspan='13' align='center'><B>$Lang32</B></td></tr>" + $CR)
	#$out = AddStr(1,"add","<tr><td style='$stTab2cHead' rowspan='13' width='$headerwidth' align='center'><B>$Lang12</B></td>" + $CR)
	#$out = AddStr(1,"add","<tr><td style='$stTab2cHead' rowspan='13' width='2' align='center'></td>" + $CR)
	$out = AddStr(1,"add","<tr>" + $CR)

	$out = AddStr(1,"add","<td height='16' style='$st2c1'></td>")
	# Get one data line
	$data = Extract($monthday, ";" , $indexd)
	WHILE $indext < 12
		$indext = $indext + 1
		# Get one result
		$text = Extract($data, ",", $indext)
		$out = AddStr(1,"add","<td style='$st2c1' width='$cellwidth' align='center'><B>$text</B></td>" + $CR)
	ENDWHILE
	
	# Row Total
	$out = AddStr(1,"add","<td width='$cellwidth'></td>" + $CR)
	$out = AddStr(1,"add","</tr>" + $CR)
	
	# Month language string
	$tmpS = $Lang13 + ";" + $Lang14 + ";" + $Lang15 + ";" + $Lang16 + ";" + $Lang17 + ";" + $Lang18 + ";" + $Lang19 + ";" + $Lang20 + ";" + $Lang21 + ";" + $Lang22 + ";" + $Lang23 + ";" + $Lang24

	$indext = 0
	$indexd = 1

	WHILE $indexd <= (Val(left(DateToString($RunDate),4)) - 1999)
		$indexd = $indexd + 1
		# Get one data line
		$data = Extract($monthday, ";" , $indexd)
		#$tindexd = replace(",",".",numtoStr($month),true)
		$tindexd = NumToStr(1998 + $indexd)
		$out = AddStr(1,"add","<tr><td height='16' style='$st2c1' width='$cellwidth'><b> $tindexd</b></td>" + $CR)
		$tmpN = 0
		WHILE $indext < 12
			$indext = $indext + 1
			# Get one result
			$text = Extract($data, ",", $indext)
			$num = Val($text)
			IF ($indexd = 2 AND $indext < 5)
				$Skipflag = TRUE
			ELSE
				$Skipflag = FALSE
			ENDIF
			$tmpN = $tmpN + $num
			# Set $x > 0 to shade green - not used here
			$x = 0
			GOSUB Name=OutputFoundChartLine
			#$day = $day + 1
		ENDWHILE
				
		# Output Row Total
		$num = $tmpN
		$text = NumToStr($num)
		# Max count?
		
		IF $num >= $maxitem
			$Bold = "<B>"
			$boldoff = "</B>"
			$cellstyle = $stTab2cHead + " color: red;"
		ELSE
			$bold = ""
			$boldoff = ""
			$cellstyle = $stTab2cHead
		ENDIF
		
		$out = AddStr(1,"add","<td style='$cellstyle' width='$cellwidth' align='center'>$bold<i>$text</i>$boldoff</td>" + $CR)
		$indext = 0
		$out = AddStr(1,"add","</tr>" + $CR)
		#$month = $month + 1
		#$day  = 1
	ENDWHILE

	$out = AddStr(1,"add","<tr><td></td>" + $CR)
	$month  = 1
	# Column Totals
	WHILE $month <= 12
		$_sql = "SELECT sum(Count) from FindsByMonth where Month=$month"
  	$num = Val(Sqlite("sql",$_sql))
  	$text = NumToStr($num)
  	
  	IF $num >= $max
			$Bold = "<B>"
			$boldoff = "</B>"
			$cellstyle = $stTab2cHead + " color: red;"
		ELSE
			$bold = ""
			$boldoff = ""
			$cellstyle = $stTab2cHead
		ENDIF
		
		$out = AddStr(1,"add","<td height='16' style='$cellstyle' width='$cellwidth' align='center'>$bold<i>$text</i>$boldoff</td>" + $CR)
		$month = $month + 1
	ENDWHILE

	$out = AddStr(1,"add","</table>" + $CR + "<br />")
	
	
	# Number of months since May 2000
	$_sql = "select 8 + 12*(strftime('%Y','now') - 2001) + strftime('%m','now')"
	$num = Val(Sqlite("sql",$_sql))
	
	$tmpN = Int(1000*$numcombF/$num)/10

	# Found statistics
  $out = AddStr(1,"add","<i><b>$numcombF</b> $Lang156 <b>$num</b> ($tmpN" + "%) </i>" + $CR)
	
ENDSUB # Name=FindsByPlacedDate



BEGINSUB name=Placed_Month_Chart
	# Initialise Section variables
	$colspan = 2
	$text=$Lang174
	$Placed = TRUE
	SHOWSTATUS msg="$text" Width=350
	GOSUB Name=SectionHead
	$Placed = FALSE

	$pc = 0
	$pc3 = 0
	
	#$_sql = "SELECT lDate from PlacedLogs WHERE lType <> 'Archive' ORDER by lDate LIMIT 1"
	#$FirstHideFoundDate = SqlToDate(Sqlite("sql",$_sql))
	$FirstHideFoundDate = $firstdate
	
	$FirstYear = Val(left(DateToString($FirstHideFoundDate),4))
	$ThisYear = $FirstYear
	$YearNow = Val(left(DateToString($RunDate),4))

	$_sql = "SELECT c FROM (SELECT Count(lDate) as c, strftime('%Y',lDate) as y from placedlogs WHERE lType <> 'Archive' group by y order by c desc limit 1)"
	$BestPlacedInYear = Val(Sqlite("sql",$_sql))

	$tmpS = RegExSub("background:\s*?#(.*?);",$stMainDiv,1,1)

	# Chart
	$out = AddStr(1,"add","<img src='http://chart.googleapis.com/chart?cht=lxy&chs=370x200&chf=bg,s,$tmpS&chxt=r,x,y&chxr=0,0,$TotalHides|2,0,$BestPlacedInYear")

	# Axes colors
	$out = AddStr(1,"add","&chxs=0,008000|2,FF0000")

	# Main chart data variables
	$text1 = "&chd=e:__,"
	$text9 = ""

	# Dynamic grid spacing
	BEGINCASE
	CASE $BestPlacedInYear <=250
		$tmpN = 25
	CASE $BestPlacedInYear >250 AND $BestPlacedInYear <=500
		$tmpN = 50
	CASE $BestPlacedInYear >500
		$tmpN = 100
	ENDCASE
	$text2 = NumToStr(Round(100 * $tmpN/$BestPlacedInYear,2))
	$text2 = Replace(",",".",$text2,TRUE)
	$text2 = "&chg=0," + $text2

	# Chart colors
	$text3 = "&chco=008000"

	# Labels
	$text4 = "&chxl=1:"

	# Chart shading
	$text5 = "&chm=B,80C65AE0,0,0,0"

	$text6 = ","

	# Line Styles
	$text10 = "&chls=2,1,0"

	$tmpN = 1

	# Calculate total number of months to be plotted

	$TotalMonths = 12 * (Val(SubStr(DateToString($RunDate),1,4)) - Val(SubStr(DateToString($FirstHideFoundDate),1,4)))
	$TotalMonths = $TotalMonths + Val(SubStr(DateToString($RunDate),5,2)) - Val(SubStr(DateToString($FirstHideFoundDate),5,2)) + 1

	$text7 = ""
	$text8 = ""

	WHILE $ThisYear <= $YearNow
		# Compile stats for year, $ThisYear
		# Initialise some variables
		$Month = 1		# Current working month, starting at Jan
		$EndMonth = 12	# Last month of the year
		$pc2 = 0

		# First year and current year to date are less than 12 months

		IF ($ThisYear = $YearNow) AND ($ThisYear = $FirstYear)
			$Month = Val(SubStr(DateToString($FirstHideFoundDate),5,2))
			$EndMonth = Val(SubStr(DateToString($RunDate),5,2))
		ELSE
			IF $ThisYear = $YearNow
				$EndMonth = Val(SubStr(DateToString($RunDate),5,2))
			ELSE
				IF $ThisYear = $FirstYear
					$Month = Val(SubStr(DateToString($FirstHideFoundDate),5,2))
				ENDIF
			ENDIF
		ENDIF

		IF ($ThisYear = $FirstYear) AND $Month = 12
			$tmpB = FALSE
		ELSE
			$tmpB = TRUE
		ENDIF

		# Step through each month in ThisYear
		WHILE $Month <= $Endmonth
			$_sql = "SELECT Count(lDate) from PlacedLogs WHERE strftime('%Y',lDate)+0=$ThisYear and strftime('%m',lDate)+0=$Month AND lType <> 'Archive'"
			$num = Val(Sqlite("sql",$_sql))

			#$text2 = $text2 + "|" + "$Month"
			$pc = $pc + ($num/$TotalHides) * 4095
			$z = Int($pc)
			GOSUB name=Extended
			$text1 = $text1 + $tmpS

			# $pc2 accumulates the year stats into $text7, $pc3 accumulates the x coordinate for each year stats into $text8
			$pc2 = $pc2 + ($num/$BestPlacedInYear) * 4095
			$z = Int($pc2)
			GOSUB name=Extended
			$text7 = $text7 + $tmpS

			IF $TotalMonths <= 1
				$pc3 = 0
			ELSE
				$pc3 = ($tmpN-1) * 4095 / ($TotalMonths-1)
			ENDIF
			$z = Int($pc3)
			GOSUB name=Extended
			$text8 = $text8 + $tmpS

			IF $tmpN = 1
				$text4 = $text4 + "|"# + "$ThisYear"
			ENDIF
			IF $Month = 1 AND $tmpN<>1
				$num = $tmpN - 2
				$text4 = $text4 + "|" + "$ThisYear"
				$text5 = $text5 + "|v,008000,0," + "$num" + ",1.0"
			ELSE
				IF (NOT(($Month=$Endmonth) AND ($ThisYear = $YearNow))) AND $tmpN <> 1
					$text4 = $text4 + "|"
				ENDIF
			ENDIF
			IF ($Month=$Endmonth) AND NOT($ThisYear = $YearNow)
				$text7 = $text7 + ","
			ENDIF
			$tmpN = $tmpN + 1
			$Month = $Month + 1
		ENDWHILE
		$text8 = $text8 + ","

		# skip a single value year if it's also the first year
		IF $tmpB
			$text6 = $text6 + $text8 + $text7
		ELSE
			$text6 = ","
		ENDIF

		$ThisYear = $ThisYear + 1
		$text3 = $text3 + ",ff0000"

		# Add artifical zero value at the beginning of each year (AA is zero in extended encoding)
		$text7 = "AA"
		$text8 = "$tmpS"
		$text10 = $text10 + "|2,2,4"

	ENDWHILE

	$out = AddStr(1,"add",$text1 + $text6 + $text4 + "|" + $text3 + $text5 + $text2 + $text10 + "' />" + $CR)

#	# Div for legend overlay
#	$out = AddStr(1,"add","<div style = 'height: 0px;'>" + $CR)
#	$out = AddStr(1,"add","<div style='border: 1px solid black; position: relative; top: -190px; left: -250px; width: 100px; height: 24px; background-color: rgb(255, 255, 255);'>" + $CR)
#	$out = AddStr(1,"add","<font color='#0000FF'>$Lang135</font>" + "<br />" + "<font color='#FF0000'>$Lang136</font>" + $CR)
#	$out = AddStr(1,"add","</div>" + $CR)
#	$out = AddStr(1,"add","</div>" + $CR)

ENDSUB # name=Placed_Month_Chart

BEGINSUB name=Karma_Chart
	# Initialise Section variables
	$colspan = 2
	$text="Caching Karma"
	$Placed = TRUE
	SHOWSTATUS msg="$text" Width=350
	GOSUB Name=SectionHead
	$Placed = FALSE

	$pc = 0
	
	IF $DateFirstFind > $FirstHideFoundDate
		$FirstHideFoundDate = $DateFirstFind
	ENDIF
	$Date = DateToSql($FirstHideFoundDate)
	
	
	$FirstYear = Val(left(DateToString($FirstHideFoundDate),4))
	$ThisYear = $FirstYear
	$YearNow = Val(left(DateToString($RunDate),4))
	
	$tmpS = RegExSub("background:\s*?#(.*?);",$stMainDiv,1,1)

	# Chart
	$out = AddStr(1,"add","<img src='http://chart.googleapis.com/chart?cht=lxy&chs=370x200&chf=bg,s,$tmpS&chxt=y,x")

	# Axes colors
	$out = AddStr(1,"add","&chxs=0,008000")

	# Main chart data variables
	$text1 = "&chd=e:__,"
	$text9 = ""

	# Chart colors
	$text3 = "&chco=008000"

	# Labels
	$text4 = "&chxl=1:"

	# Chart shading
	$text5 = "&chm=B,80C65AE0,1,1,0"
	
	$text6 = ","

	# Line Styles
	$text10 = "&chls=2,1,0"
	

	# Calculate total number of months to be plotted

	$TotalMonths = 12 * (Val(SubStr(DateToString($RunDate),1,4)) - Val(SubStr(DateToString($FirstHideFoundDate),1,4)))
	$TotalMonths = $TotalMonths + Val(SubStr(DateToString($RunDate),5,2)) - Val(SubStr(DateToString($FirstHideFoundDate),5,2)) + 1

	$text7 = ""
	$text8 = ""
	
	# Calculate max karma
	$MaxKarma = 0
	WHILE $ThisYear <= $YearNow
		# Initialise some variables
		$Month = 1		# Current working month, starting at Jan
		$EndMonth = 12	# Last month of the year

		# First year and current year to date are less than 12 months
		IF ($ThisYear = $YearNow) AND ($ThisYear = $FirstYear)
			$Month = Val(SubStr(DateToString($FirstHideFoundDate),5,2))
			$EndMonth = Val(SubStr(DateToString($RunDate),5,2))
		ELSE
			IF $ThisYear = $YearNow
				$EndMonth = Val(SubStr(DateToString($RunDate),5,2))
			ELSE
				IF $ThisYear = $FirstYear
					$Month = Val(SubStr(DateToString($FirstHideFoundDate),5,2))
				ENDIF
			ENDIF
		ENDIF

		# Step through each month in ThisYear
		WHILE $Month <= $Endmonth
			$_sql = "SELECT Count(lDate) from PlacedLogs WHERE strftime('%Y%m',lDate)+0<=100*$ThisYear+$Month AND lType <> 'Archive' AND lDate >= '$Date'"
			$num = Val(Sqlite("sql",$_sql))
						
			$_sql = "SELECT Count(lDate) from AllFinds WHERE strftime('%Y%m',lDate)+0<=100*$ThisYear+$Month"
			$x = Val(Sqlite("sql",$_sql)) + 0.01
			$num = $num/$x
			
			IF $num > $MaxKarma
				$MaxKarma = $num
			ENDIF
			
			$Month = $Month + 1
		ENDWHILE

		$ThisYear = $ThisYear + 1

	ENDWHILE
	
	$tmpN = Int($MaxKarma * 1000)/1000
	$tmpS1 = Replace(",",".","$tmpN",TRUE)
	$out = AddStr(1,"add","&chxr=0,0,$tmpS1")

	# Dynamic grid spacing
	BEGINCASE
	CASE $MaxKarma <=2
		$tmpN = 0.10
	CASE $MaxKarma >2 AND $MaxKarma <=4
		$tmpN = 0.20
	CASE $MaxKarma >4
		$tmpN = 1.0
	ENDCASE
				
	$text2 = NumToStr(Round(100 * $tmpN/$MaxKarma,3))
	$text2 = Replace(",",".",$text2,TRUE)
	$text2 = "&chg=0," + $text2
	
	$ThisYear = $FirstYear
	$tmpN = 1

	WHILE $ThisYear <= $YearNow
		# Compile stats for year, $ThisYear
		# Initialise some variables
		$Month = 1		# Current working month, starting at Jan
		$EndMonth = 12	# Last month of the year
		$pc2 = 0

		# First year and current year to date are less than 12 months

		IF ($ThisYear = $YearNow) AND ($ThisYear = $FirstYear)
			$Month = Val(SubStr(DateToString($FirstHideFoundDate),5,2))
			$EndMonth = Val(SubStr(DateToString($RunDate),5,2))
		ELSE
			IF $ThisYear = $YearNow
				$EndMonth = Val(SubStr(DateToString($RunDate),5,2))
			ELSE
				IF $ThisYear = $FirstYear
					$Month = Val(SubStr(DateToString($FirstHideFoundDate),5,2))
				ENDIF
			ENDIF
		ENDIF

		IF ($ThisYear = $FirstYear) AND $Month = 12
			$tmpB = FALSE
		ELSE
			$tmpB = TRUE
		ENDIF

		# Step through each month in ThisYear
		WHILE $Month <= $Endmonth
			$_sql = "SELECT Count(lDate) from PlacedLogs WHERE strftime('%Y%m',lDate)+0<=100*$ThisYear+$Month  AND lType <> 'Archive' AND lDate >= '$Date'"
			$num = Val(Sqlite("sql",$_sql))
						
			$_sql = "SELECT Count(lDate) from AllFinds WHERE strftime('%Y%m',lDate)+0<=100*$ThisYear+$Month"
			$x = Val(Sqlite("sql",$_sql)) + 0.01
			$num = $num/$x
			
			#$text2 = $text2 + "|" + "$Month"
			$pc = ($num/$MaxKarma) * 4095
			$z = Int($pc)
			GOSUB name=Extended
			$text1 = $text1 + $tmpS

			IF $tmpN = 1
				$text4 = $text4 + "|" #+ "$ThisYear"
			ENDIF
			IF $Month = 1 AND $tmpN<>1
				$num = $tmpN - 2
				$text4 = $text4 + "|" + "$ThisYear"
				$text5 = $text5 + "|v,008000,0," + "$num" + ",1.0"
			ELSE
				IF (NOT(($Month=$Endmonth) AND ($ThisYear = $YearNow))) AND $tmpN <> 1
					$text4 = $text4 + "|"
				ENDIF
			ENDIF
			$tmpN = $tmpN + 1
			$Month = $Month + 1
		ENDWHILE

		$ThisYear = $ThisYear + 1

	ENDWHILE
	
	$out = AddStr(1,"add",$text1 + $text4 + "|" + $text3 + $text5 + $text2 + $text10 + "' />" + $CR)

ENDSUB # name=Karma_Chart



BEGINSUB Name=OutputFoundChartLine
	$bold = ""
	$boldoff = ""
	
  BEGINCASE
  CASE $Skipflag
  	$cellstyle = $st2c1
  	$text = "X"
	CASE $num > 0  # number of found caches
		
		IF $UseHeatMap
			$heatnum = $num
	  	$heatmax = $maxcellF
	  	GOSUB Name=GetHeatColor
	  ENDIF
	  
	  IF $num = $maxcellF
	  	# Check if also a FTF this date
	  	IF $x > 0
	  		$cellstyle = $stDiffTerrhi
	  		$cellstyle = Replace("#B00000","url(" +$Imageurl + "foundftf.gif)",$cellstyle)
	  	ELSE
	  		IF $UseHeatMap
	  			$cellstyle = $heatstyle
	  		ELSE
		  		$cellstyle = $stDiffTerrhi
		  	ENDIF
			ENDIF
		  $bold = "<b>"
			$boldoff = "</b>"
	  ELSE
	  	# Check if have any FTFs this date - $x > 0
	  	IF $UseHeatMap
	  			$cellstyle = $heatstyle
	  	ELSE
		  		$cellstyle = $stDiffTerr
		  ENDIF
	  	IF $x > 0
	  		IF $UseHeatMap
	  			$cellstyle = $cellstyle + "font-style:italic;font-weight:bold;"
	  			$cellstyle = Replace("color: #FFFFFF;","color: #000000;",$cellstyle)
	  		ELSE
	  			$cellstyle = $cellstyle + "font-style:italic;font-weight:bold;"
		  		$cellstyle = Replace("005BB7","488E48",$cellstyle)
		  	ENDIF
		  ENDIF
			
		ENDIF
	OTHERWISE
		$cellstyle = $stTab2cHead
		$text = " "
	ENDCASE
	IF $indext = 1
		$out = AddStr(1,"add","    <td style='$cellstyle' width='$cellwidth' align='center'>$bold$text$boldoff</td>" + $CR)
	ELSE
		$out = AddStr(1,"add","    <td style='$cellstyle' align='center'>$bold$text$boldoff</td>" + $CR)
	ENDIF
ENDSUB




BEGINSUB name=Month_Chart_Post
	# Initialise Section variables
	$colspan = 1
	$text=$Lang134
	$PostData = ""
	GOSUB Name=SectionHead

	$pc = 0
	$pc3 = 0

	$FirstYear = Val(left(DateToString($DateFirstFind),4))
	$ThisYear = $FirstYear
	$YearNow = Val(left(DateToString($RunDate),4))

	$tmpS = RegExSub("background:\s*?#(.*?);",$stMainDiv,1,1)
	
	#Make best guess at OwnerID
	$_sql = "SELECT lOwnerid FROM (SELECT lOwnerid, Count(lOwnerID) AS c FROM Allfinds GROUP BY lownerid ORDER BY c DESC LIMIT 1)"
	$OwnerID = Sqlite("sql",$_sql)

	# Chart
	
	$PostData = "'cht','lxy','chs','740x300','chf','bg,s,$tmpS','chxt','r,x,y','chxr','0,0,$FindsWithDuplicates|2,0,$BestInYear'"

	# Axes colors
	
	$PostData = $PostData + ",'chxs','0,0000FF|2,FF0000'"

	# Main chart data variables
	$text1 = ",'chd','e:__,"
	$text9 = ""

	# Dynamic grid spacing
	BEGINCASE
	CASE $BestInYear <=250
		$tmpN = 25
	CASE $BestInYear >250 AND $BestInYear <=500
		$tmpN = 50
	CASE $BestInYear >500
		$tmpN = 100
	ENDCASE
	$text2 = NumToStr(Round(100 * $tmpN/$BestInYear,2))
	$text2 = Replace(",",".",$text2,TRUE)
	$text2 = ",'chg','0," + $text2

	# Chart colors
	$text3 = ",'chco','0000ff"

	# Labels
	$text4 = ",'chxl','1:"

	# Chart shading
	$text5 = ",'chm','B,76A4FBB0,0,0,0"
	
	# Comment 2-5-11 - this can now be done with a repeating vertical line marker
	# chm=B,76A4FBB0,0,0,0|v,6060ff,0,11:84:12,1
	# v,color,up to line #,from:to:spacing,size

	$text6 = ","

	# Line Styles
	$text10 = ",'chls','2,1,0"

	$tmpN = 1

	# Calculate total number of months to be plotted

	$TotalMonths = 12 * (Val(SubStr(DateToString($RunDate),1,4)) - Val(SubStr(DateToString($DateFirstFind),1,4)))
	$TotalMonths = $TotalMonths + Val(SubStr(DateToString($RunDate),5,2)) - Val(SubStr(DateToString($DateFirstFind),5,2)) + 1

	$text7 = ""
	$text8 = ""

	WHILE $ThisYear <= $YearNow
		# Compile stats for year, $ThisYear
		# Initialise some variables
		$Month = 1		# Current working month, starting at Jan
		$EndMonth = 12	# Last month of the year
		$pc2 = 0

		# First year and current year to date are less than 12 months

		IF ($ThisYear = $YearNow) AND ($ThisYear = $FirstYear)
			$Month = Val(SubStr(DateToString($DateFirstFind),5,2))
			$EndMonth = Val(SubStr(DateToString($RunDate),5,2))
		ELSE
			IF $ThisYear = $YearNow
				$EndMonth = Val(SubStr(DateToString($RunDate),5,2))
			ELSE
				IF $ThisYear = $FirstYear
					$Month = Val(SubStr(DateToString($DateFirstFind),5,2))
				ENDIF
			ENDIF
		ENDIF

		IF ($ThisYear = $FirstYear) AND $Month = 12
			$tmpB = FALSE
		ELSE
			$tmpB = TRUE
		ENDIF

		# Step through each month in ThisYear
		WHILE $Month <= $Endmonth
			$_sql = "SELECT Count(lDate) from AllFinds WHERE strftime('%Y',lDate)+0=$ThisYear and strftime('%m',lDate)+0=$Month"
			$num = Val(Sqlite("sql",$_sql))

			#$text2 = $text2 + "|" + "$Month"
			$pc = $pc + ($num/$FindsWithDuplicates) * 4095
			$z = Int($pc)
			GOSUB name=Extended
			$text1 = $text1 + $tmpS

			# $pc2 accumulates the year stats into $text7, $pc3 accumulates the x coordinate for each year stats into $text8
			$pc2 = $pc2 + ($num/$BestInYear) * 4095
			$z = Int($pc2)
			GOSUB name=Extended
			$text7 = $text7 + $tmpS

			IF $TotalMonths <= 1
				$pc3 = 0
			ELSE
				$pc3 = ($tmpN-1) * 4095 / ($TotalMonths-1)
			ENDIF
			$z = Int($pc3)
			GOSUB name=Extended
			$text8 = $text8 + $tmpS

			IF $tmpN = 1
				$text4 = $text4 + "|" + "$ThisYear"
			ENDIF
			IF $Month = 1 AND $tmpN<>1
				$num = $tmpN - 2
				$text4 = $text4 + "|" + "$ThisYear"
				$text5 = $text5 + "|v,6060FF,0," + "$num" + ",1.0"
			ELSE
				IF (NOT(($Month=$Endmonth) AND ($ThisYear = $YearNow))) AND $tmpN <> 1
					$text4 = $text4 + "|"
				ENDIF
			ENDIF
			IF ($Month=$Endmonth) AND NOT($ThisYear = $YearNow)
				$text7 = $text7 + ","
			ENDIF
			$tmpN = $tmpN + 1
			$Month = $Month + 1
		ENDWHILE
		$text8 = $text8 + ","

		# skip a single value year if it's also the first year
		IF $tmpB
			$text6 = $text6 + $text8 + $text7
		ELSE
			$text6 = ","
		ENDIF

		$ThisYear = $ThisYear + 1
		$text3 = $text3 + ",ff0000"

		# Add artifical zero value at the beginning of each year (AA is zero in extended encoding)
		$text7 = "AA"
		$text8 = "$tmpS"
		$text10 = $text10 + "|2,2,4"

	ENDWHILE

	$PostData = $PostData + $text1 + $text6 + "'" + $text4 + "|'" + $text3 + "'" + $text5 + "'" + $text2 + "'" + $text10 + "'"
	
	
	$URL = "http://gsak.net/stats/charts/monthchart.php"
	$PostData = $PostData + ",'name','$OwnerID','settings','$Settings'"
	
#	CLIP data=$PostData
#	CANCEL
	
	$result = PostUrl($url,$PostData)
	
	$tmpN=Random(0)
	$tmpS = Remove("$tmpN",".0","C")
	
	$url = "http://gsak.net/stats/charts/usermonthcharts/" + $OwnerID + "_" + "$Settings" + ".png" + "?" + $tmpS
		
	$out = AddStr(1,"add","<img src='$url'/>" + $CR)



	# Div for legend overlay
	$out = AddStr(1,"add","<div style = 'height: 0px;'>" + $CR)
	$out = AddStr(1,"add","<div style='border: 1px solid black; position: relative; top: -288px; left: -250px; width: 150px; height: 34px; background-color: rgb(255, 255, 255);'>" + $CR)
	$out = AddStr(1,"add","<font color='#0000FF'>$Lang135</font>" + "<br />" + "<font color='#FF0000'>$Lang136</font>" + $CR)
	$out = AddStr(1,"add","</div>" + $CR)
	$out = AddStr(1,"add","</div>" + $CR)

ENDSUB # name=Month_Chart_Post



#
#BEGINSUB name=Month_Chart
#	# Initialise Section variables
#	$colspan = 1
#	$text=$Lang134
#	GOSUB Name=SectionHead
#
#	$pc = 0
#	$pc3 = 0
#
#	$FirstYear = Val(left(DateToString($DateFirstFind),4))
#	$ThisYear = $FirstYear
#	$YearNow = Val(left(DateToString($RunDate),4))
#
#	$tmpS = RegExSub("background:\s*?#(.*?);",$stMainDiv,1,1)
#
#	# Chart
#	$out = AddStr(1,"add","<img src='http://chart.googleapis.com/chart?cht=lxy&chs=740x300&chf=bg,s,$tmpS&chxt=r,x,y&chxr=0,0,$FindsWithDuplicates|2,0,$BestInYear")
#
#	# Axes colors
#	$out = AddStr(1,"add","&chxs=0,0000FF|2,FF0000")
#
#	# Main chart data variables
#	$text1 = "&chd=e:__,"
#	$text9 = ""
#
#	# Dynamic grid spacing
#	BEGINCASE
#	CASE $BestInYear <=250
#		$tmpN = 25
#	CASE $BestInYear >250 AND $BestInYear <=500
#		$tmpN = 50
#	CASE $BestInYear >500
#		$tmpN = 100
#	ENDCASE
#	$text2 = NumToStr(Round(100 * $tmpN/$BestInYear,2))
#	$text2 = Replace(",",".",$text2,TRUE)
#	$text2 = "&chg=0," + $text2
#
#	# Chart colors
#	$text3 = "&chco=0000ff"
#
#	# Labels
#	$text4 = "&chxl=1:"
#
#	# Chart shading
#	$text5 = "&chm=B,76A4FBB0,0,0,0"
#	
#	# Comment 2-5-11 - this can now be done with a repeating vertical line marker
#	# chm=B,76A4FBB0,0,0,0|v,6060ff,0,11:84:12,1
#	# v,color,up to line #,from:to:spacing,size
#
#	$text6 = ","
#
#	# Line Styles
#	$text10 = "&chls=2,1,0"
#
#	$tmpN = 1
#
#	# Calculate total number of months to be plotted
#
#	$TotalMonths = 12 * (Val(SubStr(DateToString($RunDate),1,4)) - Val(SubStr(DateToString($DateFirstFind),1,4)))
#	$TotalMonths = $TotalMonths + Val(SubStr(DateToString($RunDate),5,2)) - Val(SubStr(DateToString($DateFirstFind),5,2)) + 1
#
#	$text7 = ""
#	$text8 = ""
#
#	WHILE $ThisYear <= $YearNow
#		# Compile stats for year, $ThisYear
#		# Initialise some variables
#		$Month = 1		# Current working month, starting at Jan
#		$EndMonth = 12	# Last month of the year
#		$pc2 = 0
#
#		# First year and current year to date are less than 12 months
#
#		IF ($ThisYear = $YearNow) AND ($ThisYear = $FirstYear)
#			$Month = Val(SubStr(DateToString($DateFirstFind),5,2))
#			$EndMonth = Val(SubStr(DateToString($RunDate),5,2))
#		ELSE
#			IF $ThisYear = $YearNow
#				$EndMonth = Val(SubStr(DateToString($RunDate),5,2))
#			ELSE
#				IF $ThisYear = $FirstYear
#					$Month = Val(SubStr(DateToString($DateFirstFind),5,2))
#				ENDIF
#			ENDIF
#		ENDIF
#
#		IF ($ThisYear = $FirstYear) AND $Month = 12
#			$tmpB = FALSE
#		ELSE
#			$tmpB = TRUE
#		ENDIF
#
#		# Step through each month in ThisYear
#		WHILE $Month <= $Endmonth
#			$_sql = "SELECT Count(lDate) from AllFinds WHERE strftime('%Y',lDate)+0=$ThisYear and strftime('%m',lDate)+0=$Month"
#			$num = Val(Sqlite("sql",$_sql))
#
#			#$text2 = $text2 + "|" + "$Month"
#			$pc = $pc + ($num/$FindsWithDuplicates) * 4095
#			$z = Int($pc)
#			GOSUB name=Extended
#			$text1 = $text1 + $tmpS
#
#			# $pc2 accumulates the year stats into $text7, $pc3 accumulates the x coordinate for each year stats into $text8
#			$pc2 = $pc2 + ($num/$BestInYear) * 4095
#			$z = Int($pc2)
#			GOSUB name=Extended
#			$text7 = $text7 + $tmpS
#
#			IF $TotalMonths <= 1
#				$pc3 = 0
#			ELSE
#				$pc3 = ($tmpN-1) * 4095 / ($TotalMonths-1)
#			ENDIF
#			$z = Int($pc3)
#			GOSUB name=Extended
#			$text8 = $text8 + $tmpS
#
#			IF $tmpN = 1
#				$text4 = $text4 + "|" + "$ThisYear"
#			ENDIF
#			IF $Month = 1 AND $tmpN<>1
#				$num = $tmpN - 2
#				$text4 = $text4 + "|" + "$ThisYear"
#				$text5 = $text5 + "|v,6060FF,0," + "$num" + ",1.0"
#			ELSE
#				IF (NOT(($Month=$Endmonth) AND ($ThisYear = $YearNow))) AND $tmpN <> 1
#					$text4 = $text4 + "|"
#				ENDIF
#			ENDIF
#			IF ($Month=$Endmonth) AND NOT($ThisYear = $YearNow)
#				$text7 = $text7 + ","
#			ENDIF
#			$tmpN = $tmpN + 1
#			$Month = $Month + 1
#		ENDWHILE
#		$text8 = $text8 + ","
#
#		# skip a single value year if it's also the first year
#		IF $tmpB
#			$text6 = $text6 + $text8 + $text7
#		ELSE
#			$text6 = ","
#		ENDIF
#
#		$ThisYear = $ThisYear + 1
#		$text3 = $text3 + ",ff0000"
#
#		# Add artifical zero value at the beginning of each year (AA is zero in extended encoding)
#		$text7 = "AA"
#		$text8 = "$tmpS"
#		$text10 = $text10 + "|2,2,4"
#
#	ENDWHILE
#
#	$out = AddStr(1,"add",$text1 + $text6 + $text4 + "|" + $text3 + $text5 + $text2 + $text10 + "' />" + $CR)
#
#	# Div for legend overlay
#	$out = AddStr(1,"add","<div style = 'height: 0px;'>" + $CR)
#	$out = AddStr(1,"add","<div style='border: 1px solid black; position: relative; top: -288px; left: -250px; width: 150px; height: 34px; background-color: rgb(255, 255, 255);'>" + $CR)
#	$out = AddStr(1,"add","<font color='#0000FF'>$Lang135</font>" + "<br />" + "<font color='#FF0000'>$Lang136</font>" + $CR)
#	$out = AddStr(1,"add","</div>" + $CR)
#	$out = AddStr(1,"add","</div>" + $CR)
#
#ENDSUB # name=Month_Chart

BEGINSUB name=Extended
	# Enter with value from 0-4095 in $z, exits with encoded value in $tmpS
	$tmpS = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-."
	$x = Int($z/64)
	$y = $z - (64 *$x)
	$tmpS = SubStr($tmpS,($x + 1),1) + SubStr($tmpS,($y + 1),1)
ENDSUB

BEGINSUB Name=Month

	IF $Cumulative
		GOSUB Name=Month_Chart_Post		# Full width - Graph of finds over time
	ENDIF

	# Initialise Section variables
	$colspan = 1
	$text=$Lang29
	GOSUB Name=SectionHead
	SHOWSTATUS msg="$LangStatus19" Width=350

	#$out = AddStr(1,"add","<i>$Lang132</i><br /><br />" + $CR)

	$FirstYear = Val(left(DateToString($DateFirstFind),4))
	$ThisYear = $FirstYear
	$YearNow = Val(left(DateToString($RunDate),4))
	$out = AddStr(1,"add","<div id='tgl' style='display:none'></div>" + $CR)
	$tmpS ="var s=(getElementById('tgl').style.display != 'none' ? 'none' : ''); "
	IF $YearsDescending
		$ThisYear = $YearNow
		
		# Start of Javascript section
		$out = AddStr(1,"add","<!--BeginJavascript-->")
		WHILE $ThisYear >= $FirstYear
			$_sql = "SELECT Count(lDate) from Allfinds WHERE strftime('%Y',lDate)+0=$ThisYear"
			$tmpN = Val(Sqlite("sql",$_sql))
			IF $tmpN >0
				IF ($YearNow - $ThisYear = 10)
					$out = AddStr(1,"add","<br /><br />" +$CR)
				ENDIF
				$out = AddStr(1,"add","<span style='cursor:pointer; border: 1px solid #000000' onmousedown=" + Quote("document.getElementById('$ThisYear').style.display = (getElementById('$ThisYear').style.display != 'none' ? 'none' : '');") + "><i><b>&nbsp; $ThisYear &nbsp;</b></i></span> " + $CR)
				$out = AddStr(1,"add"," &nbsp; ")
				$tmpS = $tmpS + "document.getElementById('$ThisYear').style.display=s; "
			ENDIF
			$ThisYear = $ThisYear - 1
		ENDWHILE
		$tmpS = $tmpS + "document.getElementById('tgl').style.display=s; "
		$out = AddStr(1,"add","<span style='cursor:pointer; border: 1px solid #000000' onmousedown=" + Quote($tmpS) + "><i><b>&nbsp; $Lang133 &nbsp;</b></i></span> " + $CR)
		$out = AddStr(1,"add","<br /><br />" +$CR)
		$ThisYear = $YearNow
		$out = AddStr(1,"add","<!--EndJavascript-->")
		# End of Javascript section

		WHILE $ThisYear >= $FirstYear
			$_sql = "SELECT Count(lDate) from Allfinds WHERE strftime('%Y',lDate)+0=$ThisYear"
			$tmpN = Val(Sqlite("sql",$_sql))
			IF $tmpN >0
				$tmpS = "none"
				IF $ThisYear >= $YearNow-1 OR $YearsAll
					$tmpS = "block"
				ENDIF
				$out = AddStr(1,"add","<div id='$ThisYear' ")
				$out = AddStr(1,"add","<!--BeginJavascript-->")
				$out = AddStr(1,"add","style='display:$tmpS'")
				$out = AddStr(1,"add","<!--EndJavascript-->")
				$out = AddStr(1,"add",">" + $CR)
				GOSUB Name=DoYearStats
				$out = AddStr(1,"add","</div>" + $CR)
#				$out = AddStr(1,"add","<br />" +$CR)
			ENDIF
			$ThisYear = $ThisYear - 1
		ENDWHILE
	ELSE
		$ThisYear = $FirstYear
		
		# Start of Javascript section
		$out = AddStr(1,"add","<!--BeginJavascript-->")
		WHILE $ThisYear <= $YearNow
			$_sql = "SELECT Count(lDate) from Allfinds WHERE strftime('%Y',lDate)+0=$ThisYear"
			$tmpN = Val(Sqlite("sql",$_sql))
			IF $tmpN >0
				IF ($ThisYear - $FirstYear = 10)
					$out = AddStr(1,"add","<br /><br />" +$CR)
				ENDIF
				$out = AddStr(1,"add","<span style='cursor:pointer; border: 1px solid #000000' onmousedown=" + Quote("document.getElementById('$ThisYear').style.display = (getElementById('$ThisYear').style.display != 'none' ? 'none' : '');") + "><i><b>&nbsp; $ThisYear &nbsp; </b></i></span> " + $CR)
				$out = AddStr(1,"add"," &nbsp; ")
				$tmpS = $tmpS + "document.getElementById('$ThisYear').style.display=s; "
			ENDIF
			$ThisYear = $ThisYear + 1
		ENDWHILE
		$tmpS = $tmpS + "document.getElementById('tgl').style.display=s; "
		$out = AddStr(1,"add","<span style='cursor:pointer; border: 1px solid #000000' onmousedown=" + Quote($tmpS) + "><i><b>&nbsp; $Lang133 &nbsp;</b></i></span> " + $CR)
		$out = AddStr(1,"add","<br /><br />" +$CR)
		$ThisYear = $FirstYear
		$out = AddStr(1,"add","<!--EndJavascript-->")
		# End of Javascript section
		
		WHILE $ThisYear <= $YearNow
			$_sql = "SELECT Count(lDate) from Allfinds WHERE strftime('%Y',lDate)+0=$ThisYear"
			$tmpN = Val(Sqlite("sql",$_sql))
			IF $tmpN >0
				$tmpS = "none"
				IF $ThisYear >= $YearNow-1 OR $YearsAll
					$tmpS = "block"
				ENDIF
				$out = AddStr(1,"add","<div id='$ThisYear' ")
				$out = AddStr(1,"add","<!--BeginJavascript-->")
				$out = AddStr(1,"add","style='display:$tmpS'")
				$out = AddStr(1,"add","<!--EndJavascript-->")
				$out = AddStr(1,"add",">" + $CR)
				GOSUB Name=DoYearStats
				$out = AddStr(1,"add","</div>" + $CR)
#				$out = AddStr(1,"add","<br />" +$CR)
			ENDIF
			$ThisYear = $ThisYear + 1
		ENDWHILE
	ENDIF
ENDSUB #Month

BEGINSUB Name=Placed
	
	# Total finds on our caches
	$_sql = "Select Sum(Finds) from PlacedStatsData"
	$TotalHides = Val(Sqlite("sql",$_sql))

	IF NOT($TotalHides > 0)
		EXITSUB
	ENDIF

	# Get all hides into a list
	$_sql = "Select * from PlacedStatsData order by Placed, Name"
	$lastdate = $RunDate
	$tmps = Sqlite("sql",$_sql)
	$list = List("sql","replace",$tmps)
	$count = Val(List("sql","count",""))
	$Hidden = $count

	$tmps = NumToStr($count)
	$list = List("sql","item",$tmps)
	IF Extract($list,";",1) = ""
		$count = $count-1
	ENDIF

	$list = List("sql","item","1")
	$firstdate = SqlToDate(Extract($list,";",4))
	
	IF $firstdate < $StartDate
		$firstdate = $StartDate
	ENDIF

	IF $placedTotals
		GOSUB Name=HideStats
	ENDIF

	IF $placedList
		GOSUB Name=HideTable
	ENDIF
	
	IF $placedcharts
		GOSUB name=Placed_Month_Chart
		GOSUB name=Karma_Chart
	ENDIF

	IF $placedFinders
		$_sql = "SELECT count(lOwnerid) as c FROM PlacedLogs  WHERE lOwnerid = 'G0' or lOwnerid = 'T0'"
		$tmpN = Val(Sqlite("sql",$_sql))
		IF $tmpN >0
			$_sql = "SELECT lParent, lDate,lBy FROM PlacedLogs WHERE lOwnerid = 'G0' or lOwnerid = 'T0'"
			$result = Sqlite("sql",$_sql)
			$MissingMemo = Replace(";",Chr(9),$result,TRUE)
			$result = Form($form12,"")
			#$msg = "There is no owner ID for these logs in your placed caches, placed list skipped:" + $CR + $CR + $result
		ELSE
			GOSUB Name=Finder
		ENDIF
	ENDIF

ENDSUB #Placed

BEGINSUB Name=HideTable
	# Initialise Section header
	
	IF NOT($IncludeOwn)
		$tmpS = "G" + "$MyId"
	ELSE
		$tmpS = ""
	ENDIF
	
	# Get total number of finders
	$_sql = "SELECT Count(DISTINCT lOwnerid) from PlacedLogs WHERE (lOwnerid<>'G0' AND lOwnerid<>'T0' AND lOwnerid<>'$tmpS') AND lType <> 'Archive'"
	$tmps = Sqlite("sql",$_sql)
	$text="$tmpS Geocachers $Lang184 $TotalHides $Lang103 $count $Lang90 $user"
	$colspan = 1
	$Placed = TRUE
	GOSUB Name=SectionHead

	# Javascript count variable for archived caches
	$j = 0
	$_sql = "Select count(code) from PlacedStatsData where Status='Archived'"
	IF $_Version >= "8.0.0.0"
		$tmpN = 5 * Val(Sqlite("sql",$_sql))
	ELSE
		$tmpN = 4 * Val(Sqlite("sql",$_sql))
	ENDIF

	IF $PlacedSort
		$out = AddStr(1,"add","<!--BeginJavascript-->")
		$out = AddStr(1,"add","<span style='cursor:pointer; border: 1px solid #000000' onmousedown=" + Quote("document.getElementById('t1').style.display = 'block'; document.getElementById('t2').style.display = 'none'; document.getElementById('t3').style.display = 'none'; document.getElementById('t4').style.display = 'none';document.getElementById('t5').style.display = 'none';") + "><i>&nbsp; $Lang129 &nbsp;</i></span> &nbsp; &nbsp; " + $CR)
		$out = AddStr(1,"add","<span style='cursor:pointer; border: 1px solid #000000' onmousedown=" + Quote("document.getElementById('t2').style.display = 'block'; document.getElementById('t1').style.display = 'none'; document.getElementById('t3').style.display = 'none'; document.getElementById('t4').style.display = 'none';document.getElementById('t5').style.display = 'none';") + "><i>&nbsp; $Lang130 &nbsp;</i></span> &nbsp; &nbsp; " + $CR)
		$out = AddStr(1,"add","<span style='cursor:pointer; border: 1px solid #000000' onmousedown=" + Quote("document.getElementById('t3').style.display = 'block'; document.getElementById('t1').style.display = 'none'; document.getElementById('t2').style.display = 'none'; document.getElementById('t4').style.display = 'none';document.getElementById('t5').style.display = 'none';") + "><i>&nbsp; $Lang161 &nbsp;</i></span> &nbsp; &nbsp;" + $CR)
		IF $_Version >= "8.0.0.0"
			$out = AddStr(1,"add","<span style='cursor:pointer; border: 1px solid #000000' onmousedown=" + Quote("document.getElementById('t4').style.display = 'block'; document.getElementById('t1').style.display = 'none'; document.getElementById('t2').style.display = 'none'; document.getElementById('t3').style.display = 'none';document.getElementById('t5').style.display = 'none';") + "><i>&nbsp; $Lang194 &nbsp;</i></span> &nbsp;" + $CR)
		ENDIF
		$out = AddStr(1,"add","<span style='cursor:pointer; border: 1px solid #000000' onmousedown=" + Quote("document.getElementById('t5').style.display = 'block'; document.getElementById('t1').style.display = 'none'; document.getElementById('t2').style.display = 'none'; document.getElementById('t3').style.display = 'none';document.getElementById('t4').style.display = 'none';") + "><i>&nbsp; $Lang195 &nbsp;</i></span> &nbsp; &nbsp;" + $CR)
		$out = AddStr(1,"add","<br /><br />" + $CR)
		$out = AddStr(1,"add","<span style='cursor:pointer; border: 1px solid #000000' onmousedown=" + Quote("for(var i = 1; i <= " + "$tmpN" +"; i++) {document.getElementById('arc' + i).style.display = 'none';}") + "><i>&nbsp; $Lang139 &nbsp;</i></span> &nbsp; &nbsp; " + $CR)
		$out = AddStr(1,"add","<span style='cursor:pointer; border: 1px solid #000000' onmousedown=" + Quote("for(var i = 1; i <= " + "$tmpN" +"; i++) {document.getElementById('arc' + i).style.display = '';}") + "><i>&nbsp; $Lang138 &nbsp;</i></span><br /><br />" + $CR)
		$out = AddStr(1,"add","<!--EndJavascript-->")
		$_sql = "Select * from PlacedStatsData order by Placed DESC, Name COLLATE NOCASE"
		$out = AddStr(1,"add","<div id='t1' style='display:block'>" + $CR + "<table width='$maxtablewidth' style='text-align: left;'>" + $CR)
		GOSUB name=HideTable1
		#$out = AddStr(1,"add","<!--BeginJavascript-->")
		$_sql = "Select * from PlacedStatsData order by Finds DESC, Name COLLATE NOCASE"
		$out = AddStr(1,"add","<div id='t2' style='display:none'>" + $CR + "<table width='$maxtablewidth' style='text-align: left;'>" + $CR)
		GOSUB name=HideTable1
		#$out = AddStr(1,"add","<!--EndJavascript-->")
		$_sql = "Select * from PlacedStatsData order by AvgDays ASC, Name COLLATE NOCASE"
		$out = AddStr(1,"add","<div id='t3' style='display:none'>" + $CR + "<table width='$maxtablewidth' style='text-align: left;'>" + $CR)
		GOSUB name=HideTable1
		IF $_Version >= "8.0.0.0"
			$_sql = "Select * from PlacedStatsData order by FavPoints DESC, Name COLLATE NOCASE"
			$out = AddStr(1,"add","<div id='t4' style='display:none'>" + $CR + "<table width='$maxtablewidth' style='text-align: left;'>" + $CR)
			GOSUB name=HideTable1
		ENDIF
		$_sql = "Select * from PlacedStatsData order by (SELECT lDate FROM PlacedLogs WHERE lParent = code and lType <> 'Archive' ORDER by ldate desc limit 1) DESC, Name COLLATE NOCASE"
		$out = AddStr(1,"add","<div id='t5' style='display:none'>" + $CR + "<table width='$maxtablewidth' style='text-align: left;'>" + $CR)
		GOSUB name=HideTable1
		$out = AddStr(1,"add","<!--BeginJavascript-->")
	ELSE
		$out = AddStr(1,"add","<!--BeginJavascript-->")
		$out = AddStr(1,"add","<span style='cursor:pointer; border: 1px solid #000000' onmousedown=" + Quote("for(var i = 1; i <= " + "$tmpN" +"; i++) {document.getElementById('arc' + i).style.display = 'none';}") + "><i>&nbsp; $Lang139 &nbsp;</i></span> &nbsp; &nbsp; " + $CR)
		$out = AddStr(1,"add","<span style='cursor:pointer; border: 1px solid #000000' onmousedown=" + Quote("for(var i = 1; i <= " + "$tmpN" +"; i++) {document.getElementById('arc' + i).style.display = '';}") + "><i>&nbsp; $Lang138 &nbsp;</i></span><br /><br />" + $CR)
		$out = AddStr(1,"add","<!--EndJavascript-->")
		$_sql = "Select * from PlacedStatsData order by Placed DESC, Name COLLATE NOCASE"
		$out = AddStr(1,"add","<div>" + $CR + "<table width='$maxtablewidth' style='text-align: left;'>" + $CR)
		GOSUB name=HideTable1
	ENDIF
	
#	$_sql = "Select * from PlacedStatsData order by Placed DESC, Name COLLATE NOCASE"
#	$out = AddStr(1,"add","<div>" + $CR + "<table width='$maxtablewidth' style='text-align: left;'>" + $CR)
#	GOSUB name=HideTable1

	IF $count > $NumPlaced
		$tmpN = $count - $NumPlaced
		$out = AddStr(1,"add","<br /><i>$user also owns <b>$tmpN</b> other caches</i>" + $CR)
	ENDIF

ENDSUB

BEGINSUB Name=HideTable1
	# Table of Hides

	#$sql = "Select * from PlacedStatsData order by Placed, Name"
	$tmps = Sqlite("sql",$_sql)
	$list = List("sql","replace",$tmps)
	$count = Val(List("sql","count",""))

	$Placed = FALSE
	#$out = AddStr(1,"add","<table width='$maxtablewidth' style='text-align: left;'>" + $CR)
	# Column Heads
	$text1 = "<b>$Lang91</b>"
	$text = "<b>$Lang128</b>"
	$text2 = "<b>$Lang92</b>"
	$text3 = "<b>$Lang93</b>"
	$text4 = "<b>$Lang94</b>"
	$text5 = "<b>$Lang95</b>"
	$text9 = "<b>Fav</b>"

	$out = AddStr(1,"add","<tr>" + "$CR" + "<td style='$stTab2cHead'>" + $CR)
	$out = AddStr(1,"add","$text1</td>" + $CR)
	$out = AddStr(1,"add","<td style='$stTab2cHead'>$text</td>" + $CR)
	$out = AddStr(1,"add","<td style='$stTab2cHead'>$text2</td>" + $CR)
	$out = AddStr(1,"add","<td style='$stTab2cHead'>$text3</td>" + $CR)
	IF $_Version >= "8.0.0.0"
		$out = AddStr(1,"add","<td style='$stTab2cHead'>$text9</td>" + $CR)
	ENDIF
	IF $FlagIcons
		$out = AddStr(1,"add","<td style='$stTab2cHead'>&nbsp;</td>" + $CR)
	ENDIF
	$out = AddStr(1,"add","<td style='$stTab2cHead'>$text4</td>" + $CR)
	IF $miletypes
		$out = AddStr(1,"add","<td style='$stTab2cHead'>&nbsp;</td>" + $CR)
	ENDIF
	$out = AddStr(1,"add","<td style='$stTab2cHead'>$text5</td>" + $CR + "</tr>" + $CR)

	$i = 1

	# Name;URL;Code;Placed;Age;Type;Difficulty;Terrain;Status;Finds;AvgDays;LogMin;LogMax;LogAverage;Adopted;Logid;Exclude;CacheType;Country
	WHILE $i <= $count AND $i <= $NumPlaced
		$tmps = NumToStr($i)
		$list = List("sql","item",$tmps)

		# Output data
		$FindDate = Extract($list,";",4)
		$text2 = Extract($list,";",10)
		$text3 = Extract($list,";",11)
		$text4 = Extract($list,";",3)
		$text5 = Extract($list,";",1)
		$text6 = ""
		$text7 = Extract($list,";",19)
		IF $_Version >= "8.0.0.0"
			$text9 = Extract($list,";",24)
		ENDIF

		IF Val($text3) = 9998
			$text3 = "NA"
		ELSE
			$text3 = NumToStr(Val($text3)/10)
		ENDIF
		IF Extract($list,";",9) = "Archived"
			$text5 = "<strike>" + $text5 + "</strike>"
			$j = $j +1
			$text6 = " id='arc" + "$j" +"'"
#			$text6 = $text6 + " style='display:none'"
		ENDIF
		
		IF $FlagIcons
			# Country flag into $text7
			$FullName = $text7
			GOSUB Name=FlagImage
		ELSE
			$text7 = ""
		ENDIF

		# Adopted?
		IF Extract($list,";",15) = "1"
			$text5 = "<font color='#606060'><i>" + $text5 + "</i><font>"
		ENDIF

		$LogDateDate = SqlToDate($FindDate)
		$FindDate = DateFormat($LogDateDate)
		$text1 = $FindDate

		#		# Store first date
		#		IF $i = 1
		#			$firstdate = $LogDateDate
		#		ENDIF

		# Get last find date

		$_sql = "SELECT lDate FROM PlacedLogs WHERE lParent = '$text4' and lType <> 'Archive' ORDER by ldate desc limit 1"
		$work = Sqlite("sql",$_sql)

		IF Len($work) > 0 AND Left($work,7) <> "*ERROR*"
			$LogDateDate = SqlToDate($work)
			$text = DateFormat($LogDateDate)
		ELSE
			$LogDateDate = $RunDate
			$text = " "
		ENDIF

		IF $miletypes
			$stripcode = $text4
			$tmpB = TRUE
			GOSUB Name=StripCodeType
			$text8 = $TypeImage
		ELSE
			$text8 = ""
		ENDIF

		$list = Extract($list,";",2)
		IF left("$text4",2) = "GC"
			$list = "http://www.geocaching.com/seek/cache_details.aspx?wp=" + $text4
			$list = $list + "&log=y&decrypt=#NumVisits"
		ENDIF

		#$list = Extract($list,";",2) + "&log=y&decrypt=#NumVisits"
		$text4 = "<a href='$list'>$text4</a>"

		$out = AddStr(1,"add","<tr" + $text6 + ">" + "$CR" + "<td style='$st2c1'>" + $CR)
		$out = AddStr(1,"add","$text1</td>" + $CR)
		$out = AddStr(1,"add","<td style='$st2c2'>$text</td>" + $CR)
		$out = AddStr(1,"add","<td style='$st2c2'>$text2</td>" + $CR)
		$out = AddStr(1,"add","<td style='$st2c2'>$text3</td>" + $CR)
		IF $_Version >= "8.0.0.0"
			$out = AddStr(1,"add","<td style='$st2c2'>$text9</td>" + $CR)
		ENDIF
		IF $FlagIcons
			$out = AddStr(1,"add","<td style='$st2c2'>$text7</td>" + $CR)
		ENDIF
		$out = AddStr(1,"add","<td style='$st2c2'>$text4</td>" + $CR)
		IF $miletypes
			$out = AddStr(1,"add","<td style='$st2c2'>$text8</td>" + $CR)
		ENDIF
		$out = AddStr(1,"add","<td style='$st2c1'>$text5</td>" + $CR + "</tr>" + $CR)

		$i = $i + 1
	ENDWHILE

	$out = AddStr(1,"add","</table></div>" + $CR)

	# End table of Hides
ENDSUB #Name=HideTable1

BEGINSUB Name=HideStats
	# Hide Stats
	$colspan = 1
	$text=$Lang96
	$text7 = ""
	$text8 = ""
	$Placed = TRUE
	GOSUB Name=SectionHead
	$Placed = FALSE
	$out = AddStr(1,"add","<table width='$maxtablewidth' style='text-align: left;'>" + $CR)

	# Number of caches Owned
	$text1 = $Lang140
	$text2 = "<b>" + NumToStr($count) + "</b>"

	# Number Adopted
	$_sql = "Select count(Adopted) from PlacedStatsData where Adopted = '1'"
	$tmpN = Val(Sqlite("sql",$_sql))
	IF $tmpN >0
		$text2 = $text2 + " ($tmpN $Lang141)"
	ENDIF

	# Number Archived
	$_sql = "Select count(code) from PlacedStatsData where Status='Archived'"
	$tmpN = Val(Sqlite("sql",$_sql))
	IF $tmpN >0
		$pc = 100 * $tmpN / $count
		$percent = left("$pc",4)
		$text2 = $text2 + ", <i>$tmpN $Lang117, ($percent" + "%</i>)"
	ENDIF

	GOSUB Name=NumbersLine

	$TotalDays = DateDiff($firstdate, $lastdate) + 1
	$perdayO = Alltrim(Str($TotalHides / $TotalDays,5,2))
	$perweek = Alltrim(Str(7 * $TotalHides / $TotalDays,6,2))
	$permonth = Alltrim(Str(30.44 * $TotalHides / $TotalDays,6,2))
	$text1 = $Lang97
	$text2 = "<b>$TotalHides</b> $Lang57 <b>$TotalDays</b> $Lang59, <b>$perdayO</b>$Lang61 <b>$perweek</b>$Lang62 <b>$permonth</b>$Lang63"
	GOSUB Name=NumbersLine

	$text1 = $Lang98
	$text2 = "<b>$FindsWithDuplicates</b>"
	GOSUB Name=NumbersLine

	$text1 = $Lang99
	$Karma = Alltrim(Str($TotalHides / $FindsWithDuplicates,5,2))
	$text2 = "<b>$Karma</b> ($TotalHides/$FindsWithDuplicates)"
	GOSUB Name=NumbersLine

	# Most Finds
	$_sql = "Select * from PlacedStatsData order by Finds DESC LIMIT 1"
	$list = Sqlite("sql",$_sql)
	$Name = Extract($list,";",1)
	$Hides = Extract($list,";",10)
	$URL = Extract($list,";",2)
	$Code = Extract($list,";",3)

	IF Len($Name) > 40
		$ShrunkName = Left($Name,38) + "..."
	ELSE
		$ShrunkName = $Name
	ENDIF

	$text1 = $Lang100
	$text2 = "<b>$Hides</b>, $ShrunkName <a href='$Url'>$Code</a>"
	GOSUB Name=NumbersLine

# Most FavPoints
	IF $_Version >= "8.0.0.0"
		$_sql = "Select * from PlacedStatsData order by Favpoints DESC LIMIT 1"
		$list = Sqlite("sql",$_sql)
		$Name = Extract($list,";",1)
		$Hides = Extract($list,";",24)
		$URL = Extract($list,";",2)
		$Code = Extract($list,";",3)

		IF Len($Name) > 40
			$ShrunkName = Left($Name,38) + "..."
		ELSE
			$ShrunkName = $Name
		ENDIF

		$text1 = $Lang193
		$text2 = "<b>$Hides</b>, $ShrunkName <a href='$Url'>$Code</a>"
		GOSUB Name=NumbersLine
	ENDIF

	# Most frequently found
	$_sql = "Select * from PlacedStatsData WHERE Type <> 'Event' AND Exclude <> '1' order by AvgDays, Finds DESC LIMIT 1"
	$list = Sqlite("sql",$_sql)
	$Name = Extract($list,";",1)
	$Days = Extract($list,";",11)
	$Days = NumToStr(Val($Days)/10)
	$URL = Extract($list,";",2)
	$Code = Extract($list,";",3)

	IF Len($Name) > 40
		$ShrunkName = Left($Name,38) + "..."
	ELSE
		$ShrunkName = $Name
	ENDIF

	# Pluralize
	IF Val($Days)=1
		$text3 = $Lang36a
	ELSE
		IF Val($Days)<1
			$text3 = $Lang36d
		ELSE # >1
			$text3 = $Lang36b
		ENDIF
	ENDIF

	$text1 = $Lang101
	$text2 = "$Lang102 <b>$Days</b> $text3, $ShrunkName <a href='$Url'>$Code</a>"
	GOSUB Name=NumbersLine

	# Log Lengths

	$_sql = "SELECT sum(Finds * LogAverage) from placedStatsData"
	$num = Val(Sqlite("sql",$_sql))
	$_sql = "SELECT sum(Finds) from placedStatsData"
	$tmpN = Val(Sqlite("sql",$_sql))
	IF $tmpN > 0
		$num = $num/$tmpN
		$tmpS = NumToStr(Int($num))
	ELSE
		$tmpS = "N/A"
	ENDIF
	$tmpS = NumToStr(Int($num))
	$text1 = $Lang123
	$text2 = $Lang124 + ": <b>$tmpS</b>, "

	$_sql = "SELECT LogMax, Code, Logid from placedStatsData order by LogMax desc"
	$work = Sqlite("sql",$_sql)
	$list = list("sql","replace",$work)
	$tmpS = List("sql","item","1")
	$Code = Extract($tmpS,";",2)
	$Log = Extract($tmpS,";",3)
	$tmpS = Extract($tmpS,";",1)
	#Strip off the suffix code if necessary
	$StripCode = Extract($Code,"_",1)
		
	BEGINCASE
			CASE Left($StripCode,2)="GC"
				$text2 = $text2 + $Lang125 + ": <a href='http://www.geocaching.com/seek/log.aspx?LID=$Log'>$StripCode</a> <b>$tmpS</b>"
			CASE Left($StripCode,2)="GA"
				$text2 = $text2 + $Lang125 + ": <a href='http://geocaching.com.au/log/$Log'>$StripCode</a> <b>$tmpS</b>"
			OTHERWISE
				$text2 = $text2 + $Lang125 + ": $StripCode <b>$tmpS</b>"
	ENDCASE
	
	
	#$text2 = $text2 + $Lang125 + ": <a href='$URL'>$StripCode</a> <b>$tmpS</b>"

	#	$sql = "SELECT LogMin, Code, URL from placedStatsData order by #LogMin asc"
	#	$work = sql($sql,"")
	#	$list = list("sql","replace",$work)
	#  $tmpS = List("sql","item","1")
	#  $Code = Extract($tmpS,";",2)
	#  $URL = Extract($tmpS,";",3)
	#	$tmpS = Extract($tmpS,";",1)
	#	#Strip off the suffix code if necessary
	#	$StripCode = Extract($Code,"_",1)
	#	$text2 = $text2 + $Lang126 + ": <a href='$URL'>$StripCode</a> <b>$tmpS</b>"

	GOSUB Name=NumbersLine

	$out = AddStr(1,"add","</table>" + $CR)

ENDSUB #Name= HideStats

BEGINSUB Name=Milestones

	SHOWSTATUS msg="$LangStatus20" Width=350

	# Initialise Section variables
	$colspan = 1
	$countbackwards = FALSE
	$InMilestones = TRUE

	# Initialize base SQL List
	IF $UseCurrentSort
		# Use the currently set sort for milestone calculation
		$_sql = "SELECT Name,URL,Code,PlacedDate,CacheType,Difficulty,Terrain,FoundByMeDate,OwnerID,OwnerName,State,Country,Distance,Archived,FTF,Container,Latitude,Longitude,Usersort,CacheID,UserNote,Bearing,County,Userdata,User2,User3,User4,Exclude,lParent,lType,lText,lBy,lDate,lLogid,lOwnerid,Loglength,Weeknumber,CenLat,Cenlon,Elevation,Resolution FROM Allfinds"
	ELSE
		# Sort by Find date + Log ID #
		$_sql = "SELECT Name,URL,Code,PlacedDate,CacheType,Difficulty,Terrain,FoundByMeDate,OwnerID,OwnerName,State,Country,Distance,Archived,FTF,Container,Latitude,Longitude,Usersort,CacheID,UserNote,Bearing,County,Userdata,User2,User3,User4,Exclude,lParent,lType,lText,lBy,lDate,lLogid,lOwnerid,Loglength,Weeknumber,CenLat,Cenlon,Elevation,Resolution FROM Allfinds ORDER BY lDate, lLogid"
	ENDIF

	$work = Sqlite("sql",$_sql,"crlfcvt=<br>")
	$list = list("LL","replace",$work)
	$LogTotal = $_SqlRows
	#Initialize Variables
	#$LogTotal = val(list("LL","count",""))

	IF $LogTotal=0
		MsgOK Msg="You have no caches logged under name $user.$CR Did you spell it correctly? Milestones section skipped..."
		EXITSUB
	ENDIF

	# Initialise Section header
	$text=$Lang30
	GOSUB Name=SectionHead
	$out = AddStr(1,"add","<table width='$maxtablewidth' style='text-align: left;'>" + $CR)
	# Column Heads
	$text1 = "<b>$Lang31</b>"
	$text2 = "<b>$Lang32</b>"
	$text3 = "<b>$Lang33</b>"
	$text4 = "<b>$Lang34</b>"
	$text5 = "<b>$Lang35</b>"

	$out = AddStr(1,"add","<tr>" + "$CR" + "<td style='$stTab2cHead'>" + $CR)
	$out = AddStr(1,"add","$text1</td>" + $CR)
	$out = AddStr(1,"add","<td style='$stTab2cHead'>$text2</td>" + $CR)
	$out = AddStr(1,"add","<td style='$stTab2cHead'>$text3</td>" + $CR)
	IF $FlagIcons
		$out = AddStr(1,"add","<td style='$stTab2cHead'>&nbsp;</td>" + $CR)
	ENDIF
	$out = AddStr(1,"add","<td style='$stTab2cHead'>$text4</td>" + $CR)
	IF $miletypes
		$out = AddStr(1,"add","<td style='$stTab2cHead'>&nbsp;</td>" + $CR)
	ENDIF
	$out = AddStr(1,"add","<td style='$stTab2cHead'>$text5</td>" + $CR + "</tr>" + $CR)

	$LogRecord = 0
	$lastdate = [00000000]
	$daysdiff=""

	# First Find
	IF NOT($milestone=1)
		$count = 1
		GOSUB Name=MilestoneLogs
	ENDIF

	# Pick out the caches at intervals of $milestone
	$last = 1
	$count = $milestone

	# First time through we need one less than $milestone for incrementing the pointer
	$incptr = $milestone - 1

	WHILE $count < $LogTotal
		# Save $count
		$counter = $count
		# Check if there are any correction additions between
		# last position $last and next $count
		
		$_sql = "Select mmilestone FROM Milestone WHERE msettings='$settings' AND mmilestone > '$last' AND mmilestone < '$count' ORDER by mmilestone"
		
		$work = Sqlite("sql",$_sql)
		$list = list("sql","replace",$work)
		$x = $_sqlrows
		$tmpN1 = 1
		
		# Skip if count = 0
		IF $x <>0
			WHILE $tmpN1 <= $x
				$work = List("sql","item","$tmpN1")
				$count = Val($work)
				GOSUB Name=GoToListPosition
				GOSUB Name=MilestoneLogs
				$tmpN1 = $tmpN1 + 1
			ENDWHILE
		ENDIF
		#Restore $count
		$count = $counter
		
		#Step through the records
		# Use our sorted list
		GOSUB Name=GoToListPosition
		$incptr = $milestone
		GOSUB Name=MilestoneLogs
		IF Frac($count/10)=0
			SHOWSTATUS msg="$LangStatus20 $count" Width=350
		ENDIF
		$last = $count
		$count = $count + $milestone
				
		# For last time round loop check for any additions all the way to $LogTotal
		IF $count >= $LogTotal
			# Save $count
			$counter = $count
			$_sql = "Select mmilestone FROM Milestone WHERE msettings='$settings' AND mmilestone > '$last' AND mmilestone < '$LogTotal' ORDER by mmilestone"
			$work = Sqlite("sql",$_sql)
			$list = list("sql","replace",$work)
			$x = $_sqlrows
			$tmpN1 = 1
		
			# Skip if count = 0
			IF $x <>0
				WHILE $tmpN1 <= $x
					$work = List("sql","item","$tmpN1")
					$count = Val($work)
					GOSUB Name=GoToListPosition
					GOSUB Name=MilestoneLogs
					$tmpN1 = $tmpN1 + 1
				ENDWHILE
			ENDIF
			#Restore $count
			$count = $counter
		ENDIF
		
	ENDWHILE

	$count = $count - $milestone

	# Skip repeating last if it happens to be a milestone
	IF $count < $LogTotal
		#Show last Find
		$count = $LogTotal
		GOSUB Name=GoToListPosition
		GOSUB Name=MilestoneLogs
	ENDIF

	$out = AddStr(1,"add","</table>" + $CR)

	# Predictions
	$lastdate = $RunDate

	# Use last 365 days as basis for prediction
	$tmpS = DateToSql($lastdate - 365)

	# number of finds over last year
	$_sql = "SELECT count(code) from AllFinds WHERE lDate >'$tmpS'"
	$num = Val(Sqlite("sql",$_sql))

	$_sql = "SELECT lDate, count(code) from AllFinds WHERE lDate >'$tmpS' GROUP BY lDate ORDER BY lDate"
	$work = Sqlite("sql",$_sql)
	$list = list("sql","replace",$work)
	$count = $_SqlRows

	# Skip predictions if $count = 0, i.e. no finds in last year
	IF $count =0
		EXITSUB
	ENDIF

	$tmpS = list("sql","item","1")
	$firstdate = SqlToDate(Extract($tmpS,";",1))
	$tmpS = list("sql","item","$count")
	$CachingDays = $count
	$TotalDays = DateDiff($firstdate, $lastdate) + 1

	$Goal100 = 100*(1 + Int($FindsWithDuplicates/100))
	$Goal500 = 0
	$Goal1000 = 0

	IF $FindsWithDuplicates >= 100 AND $FindsWithDuplicates < 400
		$Goal1000 = 500*(1 + Int($FindsWithDuplicates/500))
	ENDIF

	IF $FindsWithDuplicates >= 400
		$Goal500 = 500*(1 + Int($FindsWithDuplicates/500))
		$Goal1000 = 1000*(1 + Int($FindsWithDuplicates/1000))
	ENDIF

	IF $Goal1000 = $Goal500
		$Goal1000 = 0
	ENDIF

	IF $Goal500 = $Goal100
		$Goal500 = 0
	ENDIF

	$Date100 = DateFormat($lastdate + Int(($Goal100 - $FindsWithDuplicates)/($num/$Totaldays) + 1.0))
	$Caching100 = Int(($Goal100 - $FindsWithDuplicates)/($num/$TotalDays) + 1.0)
	$Caching100C = Int(($Goal100 - $FindsWithDuplicates)/($num/$CachingDays) + 1.0)

	$out = AddStr(1,"add","<i><br />$User $Lang105" + " <b>$Goal100</b> "  + "$Lang106" + " <b>$Caching100</b> " + "$Lang36c" + " (<b>$Caching100C</b> " + "$Lang107)" + " $Lang71 <b>$Date100</b> $lang116</i><br />" + $CR)

	IF $Goal500 <> 0
		$Date500 = DateFormat($lastdate + Int(($Goal500 - $FindsWithDuplicates)/($num/$Totaldays) + 1.0))
		$Caching500 = Int(($Goal500 - $FindsWithDuplicates)/($num/$TotalDays) + 1.0)
		$Caching500C = Int(($Goal500 - $FindsWithDuplicates)/($num/$CachingDays) + 1.0)
		$out = AddStr(1,"add","<i><b>$Goal500</b> "  + "$Lang106" + " <b>$Caching500</b> " + "$Lang36c" + " (<b>$Caching500C</b> " + "$Lang107)" + " $Lang71 <b>$Date500</b> $Lang116</i><br />" + $CR)
	ENDIF

	IF $Goal1000 <> 0
		$Date1000 = DateFormat($lastdate + Int(($Goal1000 - $FindsWithDuplicates)/($num/$Totaldays) + 1.0))
		$Caching1000 = Int(($Goal1000 - $FindsWithDuplicates)/($num/$TotalDays) + 1.0)
		$Caching1000C = Int(($Goal1000 - $FindsWithDuplicates)/($num/$CachingDays) + 1.0)
		$out = AddStr(1,"add","<i>$Lang108" + " <b>$Goal1000</b> "  + "$Lang106" + " <b>$Caching1000</b> " + "$Lang36c" + " (<b>$Caching1000C</b> " + "$Lang107)" + " $Lang71 <b>$Date1000</b> $Lang116</i>" + $CR)
	ENDIF

ENDSUB #Milestones

BEGINSUB Name=GoToListPosition
	# Use our sorted list
	$GetMilestone = list("LL","item","$count")
	#Extract the date
	$LogDateDate = SqlToDate(Extract($GetMilestone,";",33))
ENDSUB

BEGINSUB Name=MilestoneLogs
	# Create the output lines for milestones and FTFs

	$GetMilestone = list("LL","item","$count")
	#Extract the date
	$LogDateDate = SqlToDate(Extract($GetMilestone,";",33))

	$s=""

	#Strip off the suffix code if necessary
	$StripCode = Extract($GetMilestone,";",3)
	$StripCode = Extract($StripCode,"_",1)

	#Reverse numbering if necessary
	IF $countbackwards
		$tmpN = $num - $count + 1
	ELSE
		$tmpN = $count
	ENDIF

	# Override Milestones if necessary
	IF $InMilestones
		$_sql = "Select mcode, mdate FROM Milestone WHERE mmilestone='$count' AND msettings='$settings'"
		$work = Sqlite("sql",$_sql)
		IF $work<>""
			$StripCode = Extract($work,";",1)
			$LogDateDate = SqlToDate(Extract($work,";",2))
			$_sql = "SELECT Name,URL,Code,PlacedDate,CacheType,Difficulty,Terrain,FoundByMeDate,OwnerID,OwnerName,State,Country,Distance,Archived,FTF,Container,Latitude,Longitude,Usersort,CacheID,UserNote,Bearing,County,Userdata,User2,User3,User4,Exclude,lParent,lType,lText,lBy,lDate,lLogid,lOwnerid,Loglength,Weeknumber,CenLat,Cenlon,Elevation,Resolution FROM Allfinds WHERE Code like '$StripCode' LIMIT 1"
			$GetMilestone = Sqlite("sql",$_sql)
			#$GetMilestone = Extract($work,$_NewLine,1)
		ENDIF
	ENDIF

	# Format the date to users standard format for display
	$FindDate = DateFormat($LogDateDate)

	# Log ID for URL link to log
	$LogidSubstitute = Val(Extract($GetMilestone,";",34))
	IF $LogidSubstitute <>0
		BEGINCASE
			CASE Left($StripCode,2)="GC"
				$text2 = "<a href='http://www.geocaching.com/seek/log.aspx?LID=$LogidSubstitute'>$FindDate</a>"
			CASE Left($StripCode,2)="GA"
				$text2 = "<a href='http://geocaching.com.au/log/$LogidSubstitute'>$FindDate</a>"
			OTHERWISE
				$text2 = "$FindDate"
		ENDCASE
	ELSE
		$text2 = "$FindDate"
	ENDIF

	# Calculate days between milestones
	IF not($lastdate = [00000000])

		#Pluralize correctly
		IF DateDiff($lastdate, $LogDateDate)=1
			$daysdiff = NumToStr(Abs(DateDiff($lastdate, $LogDateDate))) + " $lang36a"
		ELSE
			IF DateDiff($lastdate, $LogDateDate)<1
				$daysdiff = NumToStr(Abs(DateDiff($lastdate, $LogDateDate))) + " $lang36d"
			ELSE # >1
				$daysdiff = NumToStr(Abs(DateDiff($lastdate, $LogDateDate))) + " $Lang36b"
			ENDIF
		ENDIF
	ENDIF

	$lastdate = $LogDateDate

	# Output data
	$text1 = "<b>$tmpN</b>"
	# $text2 = "$FindDate"
	$text3 = "$daysdiff"
	$text4 = Extract($GetMilestone,";",2)
	$text4 = "<a href='$text4'>$StripCode</a>"
	$text5 = Extract($GetMilestone,";",1)
	$text5 = "$text5"
	IF $miletypes
		$tmpB = FALSE
		GOSUB Name=StripCodeType
		$text6 = $TypeImage
	ELSE
		$text6 = ""
	ENDIF
		
	IF $FlagIcons
		# Country flag
		$FullName = Extract($GetMilestone,";",12)
		GOSUB Name=FlagImage
	ENDIF
	
	GOSUB Name=MilestonesLine
ENDSUB #MilestoneLogs

BEGINSUB Name=FlagImage
	# Enter with $FullName containing the country name
	# Exits with $text7 containing the html to the flag Image
	$text7 = ""
	$tmpS1 = $FullName
	$FullName = "=" + $FullName + ","
	IF At($FullName,$world)>0
		$text7 = SubStr($world,At($FullName,$world)-2,2)
		IF $tmpS1 = "Hong Kong"
			$text7 = "HK"
		ENDIF
		IF $tmpS1 = "Macau"
			$text7 = "MO"
		ENDIF
		$text7 = "<img align ='top' vspace='1'  alt='$tmpS1' title='$tmpS1' src='" + $ImageURL + "flags/" + $text7 + ".gif'/>"
	ENDIF
ENDSUB # FlagImage

BEGINSUB Name=FirstCacheByCountry
	
	# Exclude locationless?
	IF $Excludelocationless
		$Locationless = "Cachetype <>'L' AND Exclude <> '1'"
	ELSE
		$Locationless = "1"
	ENDIF
		
	$_sql = "SELECT rowid, ldate, country, code, cachetype, name, llogid, url FROM allfinds WHERE rowid IN (SELECT min(rowid) FROM allfinds WHERE $Locationless GROUP BY country)"
	$work = Sqlite("sql",$_sql)
	
	#Initialize Variables
	$LogTotal = $_SqlRows
	

	# Initialise Section header
	$colspan = 1
	$text=$LangT34
	GOSUB Name=SectionHead
	$out = AddStr(1,"add","<table width='$maxtablewidth' style='text-align: left;'>" + $CR)
	# Column Heads
	$text1 = "<b>$Lang31</b>" # Milestone
	$text2 = "<b>$Lang32</b>" # Date
	# $text7 = Flag image
	$text3 = "<b>$Lang49</b>" # Country
	$text4 = "<b>$Lang34</b>" # Code
	# $text6 = Type icon
	$text5 = "<b>$Lang35</b>" # Name

	$out = AddStr(1,"add","<tr>" + "$CR" + "<td style='$stTab2cHead'>" + $CR)
	$out = AddStr(1,"add","$text1</td>" + $CR)
	$out = AddStr(1,"add","<td style='$stTab2cHead'>$text2</td>" + $CR)
	IF $FlagIcons
		$out = AddStr(1,"add","<td style='$stTab2cHead'>&nbsp;</td>" + $CR)
	ENDIF
	$out = AddStr(1,"add","<td style='$stTab2cHead'>$text3</td>" + $CR)
	$out = AddStr(1,"add","<td style='$stTab2cHead'>$text4</td>" + $CR)
	IF $miletypes
		$out = AddStr(1,"add","<td style='$stTab2cHead'>&nbsp;</td>" + $CR)
	ENDIF
	$out = AddStr(1,"add","<td style='$stTab2cHead'>$text5</td>" + $CR + "</tr>" + $CR)

	# Initialize variables

	$count = 1

WHILE $count <= $LogTotal
	$GetMilestone = Extract($work,$CR,$count)
	#Extract the date
	$LogDateDate = SqlToDate(Extract($GetMilestone,";",2))

	#Strip off the suffix code if necessary
	$StripCode = Extract($GetMilestone,";",4)
	$StripCode = Extract($StripCode,"_",1)

	# Format the date to users standard format for display
	$FindDate = DateFormat($LogDateDate)

	# Log ID for URL link to log
	$LogidSubstitute = Val(Extract($GetMilestone,";",7))
	IF $LogidSubstitute <>0
		BEGINCASE
		CASE Left($StripCode,2)="GC"
			$text2 = "<a href='http://www.geocaching.com/seek/log.aspx?LID=$LogidSubstitute'>$FindDate</a>"
		CASE Left($StripCode,2)="GA"
			$text2 = "<a href='http://geocaching.com.au/log/$LogidSubstitute'>$FindDate</a>"
		OTHERWISE
			$text2 = "$FindDate"
		ENDCASE
	ELSE
		$text2 = "$FindDate"
	ENDIF


	# Output data
	$text1 = "<b>" + Extract($GetMilestone,";",1) + "</b>"
	# $text2 = "$FindDate"
	$text3 = Extract($GetMilestone,";",3)
	$text4 = Extract($GetMilestone,";",8)
	$text4 = "<a href='$text4'>$StripCode</a>"
	$text5 = Extract($GetMilestone,";",6)
	$text5 = "$text5"
	IF $miletypes
		$tmpB = FALSE
		GOSUB Name=StripCodeType
		$text6 = $TypeImage
	ELSE
		$text6 = ""
	ENDIF

	IF $FlagIcons
		# Country flag
		$FullName = $text3
		GOSUB Name=FlagImage
	ENDIF

	$out = AddStr(1,"add","<tr>" + "$CR" + "<td style='$st2c1'>" + $CR)
	$out = AddStr(1,"add","$text1</td>" + $CR)
	$out = AddStr(1,"add","<td style='$st2c2'>$text2</td>" + $CR)
	IF $FlagIcons
		$out = AddStr(1,"add","<td style='$st2c2'>$text7</td>" + $CR)
	ENDIF
	$out = AddStr(1,"add","<td style='$st2c2'>$text3</td>" + $CR)
	
	$out = AddStr(1,"add","<td style='$st2c2'>$text4</td>" + $CR)
	IF $miletypes
		$out = AddStr(1,"add","<td style='$st2c2'>$text6</td>" + $CR)
	ENDIF
	$out = AddStr(1,"add","<td style='$st2c1'>$text5</td>" + $CR + "</tr>" + $CR)
	$count = $count + 1
ENDWHILE


	$out = AddStr(1,"add","</table>" + $CR)

ENDSUB #FirstCacheByCountry



BEGINSUB Name=Ftf
	# Initialise Section variables
	$countbackwards = FALSE
	$InMilestones = FALSE

	#filter for finds with FTF checked
	$_sql = "SELECT count(Code) from Allfinds WHERE FTF='1'"
	$num = Val(Sqlite("sql",$_sql))

	# Exit if we don't have any ftfs
	IF $num = 0
		EXITSUB
	ENDIF

	IF $ftfsep = 0
		$ftfsep = 1
	ENDIF

	$ftfsepAbs = Abs($ftfsep)

	IF $ftfsep < 0
		$countbackwards = TRUE
		# Sort by Find date + Log ID #
		$_sql = "SELECT Name,URL,Code,PlacedDate,CacheType,Difficulty,Terrain,FoundByMeDate,OwnerID,OwnerName,State,Country,Distance,Archived,FTF,Container,Latitude,Longitude,Usersort,CacheID,UserNote,Bearing,County,Userdata,User2,User3,User4,Exclude,lParent,lType,lText,lBy,lDate,lLogid,lOwnerid,Loglength,Weeknumber,CenLat,Cenlon,Elevation,Resolution FROM Allfinds WHERE FTF='1' ORDER BY rowid DESC"
	ELSE
		# Sort by Find date + Log ID #
		$_sql = "SELECT Name,URL,Code,PlacedDate,CacheType,Difficulty,Terrain,FoundByMeDate,OwnerID,OwnerName,State,Country,Distance,Archived,FTF,Container,Latitude,Longitude,Usersort,CacheID,UserNote,Bearing,County,Userdata,User2,User3,User4,Exclude,lParent,lType,lText,lBy,lDate,lLogid,lOwnerid,Loglength,Weeknumber,CenLat,Cenlon,Elevation,Resolution FROM Allfinds WHERE FTF='1' ORDER BY rowid"
	ENDIF

	$work = Sqlite("sql",$_sql)
	$list = list("LL","replace",$work)

	#Initialize Variables
	$LogTotal = $_SqlRows

	$pc = 100 * $num / ($TotalFinds - $BenchMarkFinds - $WaymarkFinds)
	$percent = left("$pc",4)

	# Average distance
	$_sql = "Select Avg(Distance) from AllFinds WHERE FTF='1'"
	$tmpN = Val(Sqlite("sql",$_sql))
	$tmpS = Alltrim(Str($tmpN,10,1))

	IF $num > 1
		# Average time in days
		$_sql = "Select lDate from AllFinds WHERE FTF='1' ORDER by lDate LIMIT 1"
		$firstdate = SqlToDate(Sqlite("sql",$_sql))

		$_sql = "Select lDate from AllFinds WHERE FTF='1' ORDER by lDate DESC LIMIT 1"
		$tmpN = DateDiff($firstdate,SqlToDate(Sqlite("sql",$_sql)))
		$tmpN = Int((10*$tmpN)/($num-1))/10
	ELSE
		$tmpN = 0
	ENDIF

	# Initialise Section header
	$colspan = 1
	$text="$user $Lang01a $num $LangT15 ($percent %) - $Lang131 $tmpS $distunits, $Lang124" + "&nbsp;" + $Lang33+ "&nbsp;" + "$tmpN" + "&nbsp;" + $Lang36b
	GOSUB Name=SectionHead
	$out = AddStr(1,"add","<table width='$maxtablewidth' style='text-align: left;'>" + $CR)
	# Column Heads
	$text1 = "<b>$Lang37</b>"
	$text2 = "<b>$Lang32</b>"
	$text3 = "<b>$Lang33</b>"
	$text4 = "<b>$Lang34</b>"
	$text5 = "<b>$Lang35</b>"

	$out = AddStr(1,"add","<tr>" + "$CR" + "<td style='$stTab2cHead'>" + $CR)
	$out = AddStr(1,"add","$text1</td>" + $CR)
	$out = AddStr(1,"add","<td style='$stTab2cHead'>$text2</td>" + $CR)
	$out = AddStr(1,"add","<td style='$stTab2cHead'>$text3</td>" + $CR)
	IF $FlagIcons
		$out = AddStr(1,"add","<td style='$stTab2cHead'>&nbsp;</td>" + $CR)
	ENDIF
	$out = AddStr(1,"add","<td style='$stTab2cHead'>$text4</td>" + $CR)
	IF $miletypes
		$out = AddStr(1,"add","<td style='$stTab2cHead'>&nbsp;</td>" + $CR)
	ENDIF
	$out = AddStr(1,"add","<td style='$stTab2cHead'>$text5</td>" + $CR + "</tr>" + $CR)

	# Initialize variables

	$lastdate = [00000000]
	$daysdiff=""

	$count = 1

	WHILE $count<=$num
		$tmpN = $ftfsepAbs
		IF $Countbackwards
			IF $count<10
				$tmpN = 1
			ENDIF
		ELSE
			IF $count > $num-10
				$tmpN = 1
			ENDIF
		ENDIF
		IF ($count = 1) OR Frac($count/$tmpN)=0 OR ($count=$num)
			GOSUB Name=GoToListPosition
			GOSUB Name=MilestoneLogs
		ENDIF
		$count = $count + 1
	ENDWHILE

	$out = AddStr(1,"add","</table>" + $CR)

ENDSUB #Ftf

BEGINSUB name=ElevationInternal
	# Initialise Section variables
	$colspan = 1
	$text = $Lang158
	GOSUB Name=SectionHead
	SHOWSTATUS msg="$text" Width=350
	$dbs = SqlQuote($db)	
	
	# Exclude locationless?
	IF $Excludelocationless
		$Locationless = " AND Cachetype <>'L' AND Exclude <> '1'"
	ELSE
		$Locationless = ""
	ENDIF
	
  
  IF $distunits = "Miles"
		$text10 = "ft"
		$conversion = 3.2808399
	ELSE
		$text10 = "m"		
		$conversion = 1
	ENDIF
		
	# Output top and bottom 10 elevations
	
	$out = AddStr(1,"add","<table width='$maxtablewidth' style='text-align: left;'>" + $CR)
	# Column Heads
	$text1 = "<b>$Lang34</b>"
	$text2 = "<b>$Lang35</b>"
	$text3 = "<b>$Lang49</b>"
	$text4 = "<b>$Lang169</b>"
	$text5 = "<b>$Lang159</b>"
	$text6 = "<b>$Lang160</b>"

	$out = AddStr(1,"add","<tr>" + "$CR" + "<td style='$stTab2cHead'>" + $CR)
	$out = AddStr(1,"add","$text1</td>" + $CR)
	$out = AddStr(1,"add","<td style='$stTab2cHead'>$text2</td>" + $CR)
	IF $miletypes
		$out = AddStr(1,"add","<td style='$stTab2cHead'>&nbsp;</td>" + $CR)
	ENDIF
	$out = AddStr(1,"add","<td style='$stTab2cHead'>$text3</td>" + $CR)
	IF $FlagIcons
		$out = AddStr(1,"add","<td style='$stTab2cHead'>&nbsp;</td>" + $CR)
	ENDIF
	$out = AddStr(1,"add","<td style='$stTab2cHead'>$text4</td>" + $CR)
	$out = AddStr(1,"add","<td style='$stTab2cHead'>$text5</td>" + $CR)
	$out = AddStr(1,"add","<td style='$stTab2cHead'>$text6</td>" + $CR + "</tr>" + $CR)
	
			
	$_sql = "select distinct code, name, country, state, resolution, CAST(round('$conversion' * elevation) AS Integer) AS Elevation, url from Allfinds WHERE resolution <> '' $Locationless order by elevation desc limit $elevationlimit"
	$status = Sqlite("sql",$_sql,"")

	$_sql = "select distinct code from Allfinds WHERE resolution <> '' $Locationless"
	$tmpS = Sqlite("sql",$_sql,"")
	$rows = $_SqlRows

	$_sql = "select distinct code, name, country, state, resolution, CAST(round('$conversion' * elevation) AS Integer) AS Elevation, url from Allfinds WHERE resolution <> '' $Locationless order by elevation desc LIMIT ($rows-$elevationlimit),$elevationlimit"
	$status = $status + $_NewLine + "...;...;...;...;...;..." + $_NewLine + Sqlite("sql",$_sql,"")	

	
	$list = list("sql","replace",$status)
	$count = Val(list("sql","count","")) # Number of elevations to list
	$tmpN1 = 1
	$ZeroElevation = FALSE
	
	WHILE $tmpN1 <= $count
		$list = List("sql","item","$tmpN1")
		$text1 = Extract($list,";",1) # code
		$text2 = Extract($list,";",2) # name
		$text3 = Extract($list,";",3) # country
		$text4 = Extract($list,";",4) # state
		$text5 = Extract($list,";",5) # resolution
		$text6 = Extract($list,";",6) # elevation
		$text8 = Extract($list,";",7)	# url
				
		IF $miletypes AND Not($text1 = "...")
			$StripCode = $text1
			$tmpB = FALSE
			GOSUB Name=StripCodeType
			$text9 = $TypeImage
		ELSE
			$text9 = ""
		ENDIF
		
		IF $text4 = "Nil"
			$text4 = "-"
		ENDIF
		
		IF $text6 <> "..."
			$text6 = "$text6 $text10"
		ENDIF
		
		IF $text1 <> "..."
			$text1 = "<a href='$text8'>$text1</a>"
		ENDIF
		
		IF $FlagIcons AND Not($text1 = "...")
			# Country flag into $text7
			$FullName = $text3
			GOSUB Name=FlagImage
		ELSE
			$text7 = ""
		ENDIF
		
		IF Not($ZeroElevation) OR Val(Extract($list,";",6)) <> 0
			GOSUB name=ElevationLine
		ENDIF
		
		# Skip terminal zeroes apart from first one
		IF Val(Extract($list,";",6)) = 0 AND $text6 <> "..." AND $SuppressZeroes
			$ZeroElevation = TRUE
		ENDIF
		
		$tmpN1 = $tmpN1 + 1
	ENDWHILE
	
	$out = AddStr(1,"add","</table>" + $CR + "<br />")
	
	# Average elevation
	
	$_sql = "select avg('$conversion' * elevation) from (SELECT elevation from AllFinds WHERE 1 $Locationless group by code)"
	$tmpS = NumToStr(Round(Val(Sqlite("sql",$_sql)),1))
		
  $out = AddStr(1,"add","<i>$Lang167: <b>$tmpS $text10</b></i>" + $CR  )
    
	IF $ExcludeLocationLess
		$out = AddStr(1,"add","<br/><span style='$stSmall'><i>$Lang38a</i></span>" + $CR)
	ENDIF
		
	########################
	
	IF $ShowElevationChart
		$out = AddStr(1,"add","<br /><br />")
		GOSUB Name=ElevationChart
	ENDIF
  		
		
ENDSUB #ElevationInternal


BEGINSUB name=UpdateInternalElevations
	#Copy over from old database and check for any missing elevations
	$dbs = SqlQuote($db)	
	
	# Exclude locationless?
	IF $Excludelocationless
		$Locationless = " AND Cachetype <>'L' AND Exclude <> '1'"
	ELSE
		$Locationless = ""
	ENDIF
	
	# Attach our main database	
	$sqlinputfile = SqlQuote($_CurrentDataPath + "\sqlite.db3")
	$_sql = "ATTACH $sqlinputfile AS gsakdb"
	$status = Sqlite("sql",$_sql)
 	
	# Check if old table exists and do a one time conversion if so
	# Set up the old SQL table address
	$tmpS = $_Install + "\macros\elevationdataSQL.db3"
	$status = ""

	IF FileExists($tmpS)
		$tmpS = SqlQuote($tmpS)
		$_sql = "ATTACH $tmpS AS elevationdataSQL"
		$status = Sqlite("sql",$_sql)
		
		# Now copy them across if blank resolution
		$_sql = "UPDATE gsakdb.caches SET elevation = (SELECT CASE WHEN units = 'ft' THEN elevation/3.2808399 ELSE elevation END FROM elevationdata WHERE gsakdb.caches.code = elevationdata.code AND elevationdata.database=$dbs), resolution = (SELECT resolution FROM elevationdata WHERE gsakdb.caches.code = elevationdata.code AND elevationdata.database=$dbs) WHERE (gsakdb.caches.resolution = '' OR gsakdb.caches.resolution ISNULL) AND (SELECT elevation + resolution FROM elevationdata WHERE gsakdb.caches.code = elevationdata.code AND elevationdata.database=$dbs) NOTNULL"
		$status = Sqlite("sql",$_sql)
		RESYNC
		$_sql = "DETACH elevationdataSQL"
		$status = Sqlite("sql",$_sql)
		
		# Rename old elevation file
		$tmpS = $_Install + "\macros\elevationdataSQL.db3"
		$tmpS1 = $tmpS + ".old"
		FILECOPY From=$tmpS To=$tmpS1
		FILEERASE File=$tmpS OnError=Continue
	ENDIF

# Filter down to the caches where we have no elevation data
	
	$Timeout = FALSE
		
	$_sql = "SELECT count(*) FROM gsakdb.caches WHERE (Resolution = '' or Resolution ISNULL) AND Found"
	$TotalCount = Val(Sqlite("sql",$_sql))
	
	IF $TotalCount > 0	
	$Form14 = Editform($Form14,"ElevationLabel","caption","Your database contains $TotalCount missing elevations")
	$result = Form($Form14,"")
   	BEGINCASE
       CASE $ElevationUpdateOK
       	# Carry on
       OTHERWISE
       	# Drop the main database again
				$_sql = "DETACH gsakdb"
				$status = Sqlite("sql",$_sql)
       	EXITSUB
       	# CANCEL Msg="Macro Cancelled"
   	ENDCASE
  ENDIF
	
	IF $TotalCount > 0
		$count = 1
		$_sql = "SELECT name, code, latitude, longitude, country FROM gsakdb.caches WHERE (Resolution = '' or Resolution ISNULL) AND Found"
		$work = Sqlite("sql",$_sql)
		$list = List("sql","replace",$work)
		
		WHILE $count <= $TotalCount
			$list = List("sql","item","$count")
			$namefield = Extract($list,";",1)
			$code = Replace("'","''",Extract($list,";",2))
			$latitude = Extract($list,";",3)
			$longitude = Extract($list,";",4)
			$country = Extract($list,";",5)
			$data = ""
			
			GOSUB name=GetElevationsFromWeb

			IF Len($data) > 0
				$elevation = Val($data)
				IF $elevation = -9999
					$elevation = 0
				ENDIF
				$elevation = Round($elevation,1)
				
				IF Seek($code)
					$d_elevation = $elevation
					$d_resolution = $resolution
				ENDIF
				
				#$_sql = "UPDATE gsakdb.caches SET elevation = '$elevation', resolution = '$resolution' WHERE code='$code'"
				#$status = Sqlite("sql",$_sql)
				SHOWSTATUS msg="Posting Elevation for $namefield: $elevation" Width=350  Title="$count of $TotalCount"
					
			ENDIF
			$count = $count + 1
		ENDWHILE
		SHOWSTATUS msg="End" Width=350 Display=Off
	ENDIF
	
	# Drop the main database again
	$_sql = "DETACH gsakdb"
	$status = Sqlite("sql",$_sql)

	CANCELFILTER
	
ENDSUB # UpdateInternalElevations


BEGINSUB name=GetElevationsFromWeb
		# First try USA 3m/10m - Thanks to Cairngorm for this code! :-)
		IF $Country = "United States"
			$url = "http://gisdata.usgs.net//xmlwebservices2/elevation_service.asmx/getElevation?X_Value=" + $Longitude + "&Y_Value=" + $Latitude + "&Elevation_Units=meters&Source_Layer=-1&Elevation_Only=1"
			$text1 = GetUrl($url)
			#FIRST GET ELEVATION
			$data = RegExSub("<elevation>(.*?)</elevation>",$text1,1,1)
		
			#NOW GET RESOLUTION
			$text2 = RegExSub("<Data_ID>(.*?)</Data_ID>",$text1,1,1)

			BEGINCASE
			CASE Left($text2,5) = "Elev_"
				$resolution = "3m"
			CASE  At("_13",$text2) > 0
				$resolution = "10m"
			OTHERWISE
				$resolution = "30m"
			ENDCASE
			
			IF $data = "-1.79769313486231E+308" OR $data = ""
				$data = ""
				$resolution = ""
			ENDIF
			
		ENDIF
		
		# Next try Geonames Aster 30m if we haven't timed out in this run
		IF Not($Timeout) AND $data = "" AND $UseAster
			$url = "http://ws.geonames.org/astergdem?lat=" + $Latitude + "&lng=" + $Longitude
			SHOWSTATUS msg="Getting 30m resolution Elevation for $code" Width=350 Title="$Count of $TotalCount"
			$data = GetUrl($url,"",10)
			$resolution = "30m"
			IF Len($data) = 0 OR Len($data) > 20
				$Timeout = TRUE
			ENDIF
		ENDIF
	
		# If no 30m data then try Geonames 90m if we haven't timed out
		IF (Val($data) = -9999 OR $data = "") AND Not($Timeout)
			$url = "http://ws.geonames.org/srtm3?lat=" + $Latitude + "&lng=" + $Longitude
			SHOWSTATUS msg="Getting 90m resolution Elevation for $code" Width=350 Title="$Count of $TotalCount"
			$data = GetUrl($url,"",10)
			$resolution = "90m"
			IF Len($data) = 0 OR Len($data) > 20
				$Timeout = TRUE
			ENDIF
		ENDIF
		
		# If no 90m data and we haven't timed out then try Geonames 1km resolution
		IF Val($data) = -32768 AND Not($Timeout)
			$url = "http://ws.geonames.org/gtopo30?lat=" + $Latitude + "&lng=" + $Longitude
			SHOWSTATUS msg="Getting 1km resolution Elevation for $code" Width=350  Title="$Count of $TotalCount"
			$data = GetUrl($url,"",10)
			$resolution = "1km"
			IF Len($data) = 0 OR Len($data) > 20
				$Timeout = TRUE
			ENDIF
		ENDIF
		
		# If all else fails then try Google
		IF Val($data) = -9999 OR $Timeout
			$url = "http://maps.google.com/maps/api/elevation/xml?locations=" + $Latitude + "," + $Longitude + "&sensor=false"
			SHOWSTATUS msg="Getting Google Elevation for $code" Width=350 Title="$Count of $TotalCount"
			$data = GetUrl($url,"")
			$resolution = RegExSub("<resolution>(.*?)</resolution>",$data,1,1)
			$data = RegExSub("<elevation>(.*?)</elevation>",$data,1,1)
			$resolution = $resolution + "m"
		ENDIF

ENDSUB # GetElevationsFromWeb


BEGINSUB Name=ElevationLine
	# Add a line to the 'Elevation' section, inputs are:
	# $text1 : Code
	# $text2 : Name
	# $text3 : Country
	# $text4 : State
	# $text5 : Resolution
	# $text6 : Elevation
	# $text7 : Country Flag image
	# $text9 : Cachetype Image
		
	$out = AddStr(1,"add","<tr>" + "$CR" + "<td style='$st2c1'>" + $CR)
	$out = AddStr(1,"add","$text1</td>" + $CR)
	$out = AddStr(1,"add","<td style='$st2c2'>$text2</td>" + $CR)
	IF $miletypes
		$out = AddStr(1,"add","<td style='$st2c2'>$text9</td>" + $CR)
	ENDIF
	$out = AddStr(1,"add","<td style='$st2c2'>$text3</td>" + $CR)
	IF $FlagIcons
		$out = AddStr(1,"add","<td style='$st2c2'>$text7</td>" + $CR)
	ENDIF
	$out = AddStr(1,"add","<td style='$st2c2'>$text4</td>" + $CR)
	$out = AddStr(1,"add","<td style='$st2c2'><i>$text5</i></td>" + $CR)
	$out = AddStr(1,"add","<td style='$st2c1'><b>$text6</b></td>" + $CR + "</tr>" + $CR)
ENDSUB #ElevationLine

BEGINSUB Name=ElevationChart
	#open table
	$out = AddStr(1,"add","<table border='0' width = '740'>" + $CR)
	$out = AddStr(1,"add","<tr><td style='$stYearTop' align='center' colspan='22'><b>$Lang168</b></td></tr>" + $CR)
	$out = AddStr(1,"add","<tr align='center' valign='bottom' style='$stYearGrphRow'>" + $CR)
	$out = AddStr(1,"add","<td style='height:92px; vertical-align:bottom;'>&nbsp;</td>" + $CR)
	$index = 1
		
	$_sql = "select Round('$conversion' * max(elevation)) from Allfinds WHERE 1 $Locationless"
	$max = Val(Sqlite("sql",$_sql,""))
	
	$_sql = "select Round('$conversion' * min(elevation)) from Allfinds WHERE 1 $Locationless"
	$min = Val(Sqlite("sql",$_sql,""))
	
	# Work out the best size for the elevation bands
	# For ft pick the best that is a multiple of 100 but <= 500
	# For m pick the best that is a multiple of 25 but <= 150
	
	IF Not($AutomaticIntervals) AND Abs(Val($ElevationIntervals)) > 0
		$z = Abs(Val($ElevationIntervals))
	ELSE
		IF $distunits = "Miles"
			BEGINCASE
			CASE $max/20 > 500
				$z = 500
			OTHERWISE
				$z = 100 * Int($max/2000)
			ENDCASE
			IF $z = 0
				$z = 100
			ENDIF
		ELSE
			BEGINCASE
			CASE $max/20 > 150
				$z = 150
			OTHERWISE
				$z = 25 * Int($max/500)
			ENDCASE
			IF $z = 0
				$z = 25
			ENDIF
		ENDIF
	ENDIF
	
	
	$y = -$z
	$maxnum = -$z
	# Get largest band
	WHILE $index <=21
		# number found this elevation band
		IF $index = 1
			$x = $min
		ELSE
			$x = $y
		ENDIF
		$y = $y + $z
		
		IF $index = 21 AND $max > $y
			$y = $max + 1
		ENDIF
				
		$_sql = "select Count(distinct code) from Allfinds WHERE 1 $Locationless AND '$conversion' * elevation >= $x AND '$conversion' * elevation < $y"
		$num = Val(Sqlite("sql",$_sql))
		
		IF $num > $maxnum
			$maxnum = $num
		ENDIF

		$index = $index + 1
	ENDWHILE
	$index = 1
	$y = -$z
	# Generate elevation graph
	WHILE $index <=21
		SHOWSTATUS msg="Elevation Graph" Width=350
		# number found this elevation band
		$x = $y
		$y = $y + $z
		
		IF $index = 21 AND $max > $y
			$y = $max + 1
		ENDIF
				
		$_sql = "select Count(distinct code) from Allfinds WHERE 1 $Locationless AND '$conversion' * elevation >= $x AND '$conversion' * elevation < $y"
		$num = Val(Sqlite("sql",$_sql))
				
		$out = AddStr(1,"add","<td style='width: 25px; vertical-align:bottom;'>")
		IF $num > 0
			$out = AddStr(1,"add","$num<br />")
			$height = Int(100 * $Num / $Maxnum)
			IF $height = 0 AND $Num > 0
				$height = 1
			ENDIF
			IF $UseImageBars
				IF $num = $Maxnum
					$image = $imagepath + $ImageRV
					$out = AddStr(1,"add","<img src='$image' width='25' height='$height' alt='$num' title='$num'/>")
				ELSE
					$image = $imagepath + $ImageGV
					$out = AddStr(1,"add","<img src='$image' width='25' height='$height' alt='$num' title='$num'/>")
				ENDIF
			ELSE
				IF $UseHeatBars
					$heatnum = $num
					$heatmax = $Maxnum
					GOSUB Name=GetHeatColor
					$out = AddStr(1,"add","<div title='$num' style='background: #$HeatColor; height: $height" + "px;'>&nbsp;</div>")
				ELSE
					IF $num = $Maxnum
						$out = AddStr(1,"add","<div title='$num' style='background: $stRedBar; height: $height" + "px;'>&nbsp;</div>")
					ELSE
						$out = AddStr(1,"add","<div title='$num' style='background: $stGreenBar; height: $height" + "px;'>&nbsp;</div>")
					ENDIF
				ENDIF
			ENDIF
		ENDIF
		$out = AddStr(1,"add","</td>" + $CR)
		$index = $index + 1
	ENDWHILE
	# output key to elevations
	$out = AddStr(1,"add","<tr style='$stRankRow'>" + $CR)
	$out = AddStr(1,"add","<td style='$stRankTit'>$Lang160</td>" + $CR)
		
	IF $max > ((20*$z) - 1)
		$maxitem = $max
	ELSE
		$maxitem = ((20*$z) - 1)
	ENDIF
			
	$out = AddStr(1,"add","<td>< 0</td>")
	$x = 0
	WHILE $x < 19
		$out = AddStr(1,"add","<td>" + NumToStr($z*$x) + "<br />-<br />" + NumToStr(($z*($x+1)) - 1) + "</td>")
		$x = $x + 1
	ENDWHILE
	
	$out = AddStr(1,"add","<td>" + NumToStr($z*$x) + "<br />-<br />" + NumToStr($maxitem) + "</td>")
			
	$out = AddStr(1,"add","</tr>" + $CR)
	$out = AddStr(1,"add","</table>" + $CR)
	$out = AddStr(1,"add","<br />" + $CR)
	
ENDSUB #ElevationChart

BEGINSUB name=Favorites
	# Initialise Section variables
	$colspan = 1
	$text = $Lang191
	GOSUB Name=SectionHead
	SHOWSTATUS msg="$text" Width=350
		
	# Exclude locationless?
	IF $Excludelocationless
		$Locationless = " AND Cachetype <>'L' AND Exclude <> '1'"
	ELSE
		$Locationless = ""
	ENDIF
		
	# Output top 10 Favorite caches
	
	$out = AddStr(1,"add","<table width='$maxtablewidth' style='text-align: left;'>" + $CR)
	# Column Heads
	$text1 = "<b>$Lang34</b>"
	$text2 = "<b>$Lang35</b>"
	$text3 = "<b>$Lang49</b>"
	$text4 = "<b>$Lang169</b>"
	$text5 = "<b>$Lang192</b>"
	

	$out = AddStr(1,"add","<tr>" + "$CR" + "<td style='$stTab2cHead'>" + $CR)
	$out = AddStr(1,"add","$text1</td>" + $CR)
	$out = AddStr(1,"add","<td style='$stTab2cHead'>$text2</td>" + $CR)
	IF $miletypes
		$out = AddStr(1,"add","<td style='$stTab2cHead'>&nbsp;</td>" + $CR)
	ENDIF
	$out = AddStr(1,"add","<td style='$stTab2cHead'>$text3</td>" + $CR)
	IF $FlagIcons
		$out = AddStr(1,"add","<td style='$stTab2cHead'>&nbsp;</td>" + $CR)
	ENDIF
	$out = AddStr(1,"add","<td style='$stTab2cHead'>$text4</td>" + $CR)
	
	$out = AddStr(1,"add","<td style='$stTab2cHead'>$text5</td>" + $CR + "</tr>" + $CR)
	
			
	$_sql = "select distinct code, name, country, state, favpoints, url from Allfinds WHERE favpoints>0 $Locationless order by favpoints desc limit 10"
	$status = Sqlite("sql",$_sql,"")
		
	$list = list("sql","replace",$status)
	$count = Val(list("sql","count","")) # Number of favorites to list
	$tmpN1 = 1
	
	
	WHILE $tmpN1 <= $count
		$list = List("sql","item","$tmpN1")
		$text1 = Extract($list,";",1) # code
		$text2 = Extract($list,";",2) # name
		$text3 = Extract($list,";",3) # country
		$text4 = Extract($list,";",4) # state
		$text5 = Extract($list,";",5) # favpoints
		$text8 = Extract($list,";",6) # url
				
		IF $miletypes
			$StripCode = $text1
			$tmpB = FALSE
			GOSUB Name=StripCodeType
			$text9 = $TypeImage
		ELSE
			$text9 = ""
		ENDIF
		
		IF $text4 = "Nil"
			$text4 = "-"
		ENDIF
				
		$text1 = "<a href='$text8'>$text1</a>"
				
		IF $FlagIcons
			# Country flag into $text7
			$FullName = $text3
			GOSUB Name=FlagImage
		ELSE
			$text7 = ""
		ENDIF
		
		GOSUB name=FavoritesLine
				
		$tmpN1 = $tmpN1 + 1
	ENDWHILE
	
	$out = AddStr(1,"add","</table>" + $CR + "<br />")
	    
	IF $ExcludeLocationLess
		$out = AddStr(1,"add","<br/><span style='$stSmall'><i>$Lang38a</i></span>" + $CR)
	ENDIF
			
ENDSUB #favorites


BEGINSUB Name=FavoritesLine
	# Add a line to the 'Favorites' section, inputs are:
	# $text1 : Code
	# $text2 : Name
	# $text3 : Country
	# $text4 : State
	# $text5 : Favpoints
	# $text6 : 
	# $text7 : Country Flag image
	# $text9 : Cachetype Image
		
	$out = AddStr(1,"add","<tr>" + "$CR" + "<td style='$st2c1'>" + $CR)
	$out = AddStr(1,"add","$text1</td>" + $CR)
	$out = AddStr(1,"add","<td style='$st2c2'>$text2</td>" + $CR)
	IF $miletypes
		$out = AddStr(1,"add","<td style='$st2c2'>$text9</td>" + $CR)
	ENDIF
	$out = AddStr(1,"add","<td style='$st2c2'>$text3</td>" + $CR)
	IF $FlagIcons
		$out = AddStr(1,"add","<td style='$st2c2'>$text7</td>" + $CR)
	ENDIF
	$out = AddStr(1,"add","<td style='$st2c2'>$text4</td>" + $CR)
	
	$out = AddStr(1,"add","<td style='$st2c1'><b>$text5</b></td>" + $CR + "</tr>" + $CR)
ENDSUB #FavoritesLine

BEGINSUB Name=Distance
	# Initialise Section variables
	$colspan = 2
	$text = "$LangStatus22a $distunits $LangStatus22b"
	GOSUB Name=SectionHead
	SHOWSTATUS msg="$text" Width=350
	$Bands = "10,20,30,40,50,100,200,500,1000,999999999"
	$NumItems = RegExCount(",",$Bands )
	$index = 0
	$last = 0
	$maxnum = 0
	$result = ""
	WHILE $index <= $NumItems
		$index = $index + 1
		$this = Val(Extract($Bands, "," , $Index))
		IF $ExcludeLocationless
			$_sql = "SELECT count(Distance) from AllFinds WHERE Distance>=$last and Distance<$this and CacheType <>'L' and Exclude <> '1'"
		ELSE
			$_sql = "SELECT count(Distance) from AllFinds WHERE Distance>=$last and Distance<$this"
		ENDIF
		$num = Val(Sqlite("sql",$_sql))
		#write data
		IF $last = 0
			$text = "%lt $this"
		ELSE
			IF $this = 999999999
				$text = "%gt $last"
			ELSE
				$text = "$last - $this"
			ENDIF
		ENDIF
		SHOWSTATUS msg="$LangStatus23a $distunits $LangStatus23b $text" Width=350
		IF $num > $maxnum
			$maxnum = $num
		ENDIF
		$result = $result + "$text,$num;"
		$last = $this
	ENDWHILE
	IF $excludeLocationLess
		$note="<i>$Lang38a</i>"
	ELSE
		$note=""
	ENDIF
	$maxwidth = 150
	$totalpercent = $FindsWithDuplicates
	GOSUB Name=Table2Col
	
	IF $ExcludeLocationless
		$_sql = "SELECT avg(Distance) from AllFinds WHERE CacheType <>'L' and Exclude <> '1'"
	ELSE
		$_sql = "SELECT avg(Distance) from AllFinds"
	ENDIF
	$num = Int(Val(Sqlite("sql",$_sql)))
		
	$out = AddStr(1,"add","<br /><i>$Lang131: <b>$num</b> $distunits</i>" + $CR)
		
ENDSUB #Distance

BEGINSUB Name=Type
	# Initialise Section variables
	$colspan = 2
	$text = $LangStatus24
	SHOWSTATUS msg="$text" Width=350
	GOSUB Name=SectionHead
	$Types = "A,B,C,E,G,L,M,R,T,U,V,W,Z,X,I,Y,F,H,D,P,O"
	$Typenums = "9,5,13,6,27,12,3,137,2,8,4,11,453,2134,1858,waymark,3653,3773,3774,4738,other"
	# 10 year is 3653, HQ is 3773, Lost and Found is 3774, O is other, P is Block Party
	#TypeImageBase = "http://www.geocaching.com/images/wpttypes/sm/???.gif"
	$Names = "Project Ape,Letterbox,CITO,Event,Benchmark,Locationless,Multi,Earth,Traditional,Mystery,Virtual,Webcam,Mega Event,GPS Adventures Exhibit,Wherigo,Waymark,10 Years! Event,Groundspeak HQ,Lost and Found Celebration,Block Party,Other"
	$GCIDs = "tx=2555690d-b2bc-4b55-b5ac-0cb704c0b768,tx=4bdd8fb2-d7bc-453f-a9c5-968563b15d24,tx=57150806-bc1a-42d6-9cf0-538d171a2d22,tx=69eb8534-b718-4b35-ae3c-a856a55b0874,"
	$GCIDs = $GCIDs + "benchmark,tx=8f6dd7bc-ff39-4997-bd2e-225a0d2adf9d,tx=a5f6d0ad-d2f2-4011-8c14-940a9ebf3c74,tx=c66f5cf3-9523-4549-b8dd-759cd2f18db8,tx=32bc9333-5e52-4957-b0f6-5a2c8fc7b257,"
	$GCIDs = $GCIDs + "tx=40861821-1835-4e11-b666-8d41064d03fe,tx=294d4360-ac86-4c83-84dd-8113ef678d7e,tx=31d2ae3c-c358-4b5f-8dcd-2185bf472d3d,tx=69eb8535-b718-4b35-ae3c-a856a55b0874,"
	$GCIDs = $GCIDs + "tx=72e69af2-7986-4990-afd9-bc16cbbb4ce3,tx=0544fa55-772d-4e5c-96a9-36a51ebcf5c9,waymark,tx=3ea6533d-bb52-42fe-b2d2-79a3424d4728,tx=416f2494-dc17-4b6a-9bab-1a29dd292d8c,tx=af820035-787a-47af-b52b-becc8b0c0c88,tx=bc2f3df2-1aab-4601-b2ff-b5091f6c02e3,other"
	$GCIDPrefix = "<a href='http://www.geocaching.com/seek/nearest.aspx?"
	$GCIDSuffix = "&ul=" + HttpEncode($user) + "'>"
	#Make best guess at OwnerID
	$_sql = "SELECT lOwnerid FROM (SELECT lOwnerid, Count(lOwnerID) AS c FROM Allfinds GROUP BY lownerid ORDER BY c DESC LIMIT 1)"
	$OwnerID = Sqlite("sql",$_sql)
	
	$NumItems = RegExCount(",",$Types )
	$index = 0
	$maxnum =0
	$result = ""
	WHILE $index <= $NumItems
		$index = $index + 1
		$thistype	= Extract($Types, "," , $Index)
		$text	= Extract($Names, "," , $Index)
		$text1 = $text
		$GCID = Extract($GCIDs, ",", $Index)
		$text2	= Extract($Typenums, "," , $Index)
		BEGINCASE
		CASE $thistype = "Y"
			$TypeImage = "<img align='top' src='http://gsak.net/stats/wm16.gif' />"
		CASE $thistype = "L"
			$TypeImage = "<img align='top' src='http://gsak.net/stats/1216.gif' />"
		CASE $thistype = "O"
			$TypeImage = "<img align='top' src='http://gsak.net/stats/othersmall.gif' />"
		OTHERWISE
			$TypeImage = "<img align='top' src='http://www.geocaching.com/images/wpttypes/sm/" + $text2 + ".gif' />"
		ENDCASE
		
		IF $thistype = "G"
			$text = $TypeImage + " " + "<a href='http://www.geocaching.com/mark/nearest.aspx?a=" + $OwnerID + "'>" + $text + "</a>"
		ELSE
			$text = $TypeImage + " " + $GCIDPrefix + $GCID + $GCIDSuffix + $text + "</a>"
		ENDIF

		SHOWSTATUS msg="$LangStatus25 $text1" Width=350
		$_sql = "SELECT count(Code) from AllFinds WHERE CacheType='$thistype'"
		$num = Val(Sqlite("sql",$_sql))
		# Include benchmarks here
		IF $thistype = "G"
			$num = $BenchmarkFinds
		ENDIF
		# Include waymarks here
		IF $thistype = "Y"
			$num = $WaymarkFinds
		ENDIF
		IF $num > $maxnum
			$maxnum = $num
		ENDIF
		IF $num >0
			$result = $result + "$text,$num;"
		ENDIF
	ENDWHILE
	GOSUB Name=SortResult
	$note = ""
	$maxwidth = 120
	#$totalpercent = $TotalFinds
	$totalpercent = $FindsWithDuplicates + $BenchmarkFinds + $WaymarkFinds
	GOSUB Name=Table2Col
ENDSUB #Type

BEGINSUB Name=Container
	# Initialise Section variables
	$colspan = 2
	$text = $LangStatus26
	SHOWSTATUS msg="$text" Width=350
	GOSUB Name=SectionHead
	$Cont = "Large;Micro;Not chosen;Other;Regular;Small;Virtual"
	$NumItems = RegExCount(";",$Cont )
	$index = 0
	$maxnum =0
	$result = ""
	WHILE $index <= $NumItems
		$index = $index + 1
		$text = Extract($Cont, ";" , $Index)
		SHOWSTATUS msg="$LangStatus27 $text" Width=350
		$_sql = "SELECT count(Code) from AllFinds WHERE Container='$text'"
		$num = Val(Sqlite("sql",$_sql))
		IF $num > $maxnum
			$maxnum = $num
		ENDIF
		$result = $result + "$text,$num;"
	ENDWHILE
	GOSUB Name=SortResult
	$note = ""
	$maxwidth = 150
	$totalpercent = $FindsWithDuplicates
	IF $PieCharts
		GOSUB Name=Table2Pi
	ELSE
		GOSUB Name=Table2Col
	ENDIF
ENDSUB #Container

BEGINSUB Name=Owner
	# Determine the number of finds you've made by owner
	SHOWSTATUS msg="$LangStatus28" Width=350
	# Determine the cutoff poInt for listing owners based on number of
	# their caches found
	$Cutoff = 5
	# Generate an unduplicated list of the owners of all found caches in the database

	#Initialize Variables
	$ThisRecord = 0
	$Count = 0
	$_sql = "SELECT Count(Code) as c, OwnerID, OwnerName from AllFinds GROUP BY OwnerID ORDER BY c DESC, OwnerName COLLATE NOCASE"
	$work = Sqlite("sql",$_sql)
	$list = list("sql","replace",$work)

	#Sorted list of Owners, largest # finds at the top.
	$list = List("sql","item","1")
	$maxnum = Val(Extract($list,";",1))
	$index = 0
	$result = ""
	$result2 = ""
	$result3 = ""
	$tmpB = TRUE
	$totalowners = $_SqlRows

	WHILE $index < $totalowners AND $tmpB = TRUE
		$tmpN = $index + 1
		$list = List("sql","item","$tmpN")
		$UserSort = Val(Extract($list,";",1))
		$OwnerID = Extract($list,";",2)
		$OwnerName = Extract($list,";",3)
		IF $index >19 AND $UserSort > $Cutoff
			GOSUB Name=MakeUserLink
			$index=$index+1
			$indexstring = Str($index,2,0)
			$result3 = $result3 + "$UserLink,$UserSort;"
		ENDIF
		IF $index <=19 and $index >9
			GOSUB Name=MakeUserLink
			$index=$index+1
			$indexstring = Str($index,2,0)
			$result2 = $result2 + "$indexstring - $UserLink,$UserSort;"
		ENDIF
		IF $index <=9
			GOSUB Name=MakeUserLink
			$index=$index+1
			$indexstring = Str($index,2,0)
			$result = $result + "$indexstring - $UserLink,$UserSort;"
		ENDIF
		IF $index >19 AND $UserSort <= $Cutoff
			$tmpB = FALSE
		ENDIF
	ENDWHILE
	$listedowners = $index
	IF $listedowners > 40
		$listedowners = 40
	ENDIF
	$unlistedowners = $totalowners - $listedowners

	# Generate output
	$text="$Lang39"
	# Initialise Section variables
	$colspan = 1
	$note=""
	$maxwidth=50
	$totalpercent = $FindsWithDuplicates
	GOSUB Name=SectionHead
	GOSUB Name=Open2Col
	GOSUB Name=Table2Col
	GOSUB Name=Mid2Col
	$result = $result2
	GOSUB Name=Table2Col
	GOSUB Name=Close2col
	IF $result3 <> ""
		$out = AddStr(1,"add","<b><i>$Lang40</i></b><table style='text-align: left;'>")
		$out = AddStr(1,"add",$CR+ "<tr>" + $CR)
		$result = $result3
		$index = 0
		$NumItems = RegExCount(";",$result)
		WHILE $index < $NumItems AND $index < 20
			$index = $index + 1
			$data = Extract($result, ";" , $Index)
			$text = Extract($data, ",", 1)
			$num  = Val(Extract($data, ",", 2))
			$out = AddStr(1,"add","<td style='$stOwners3'><span >$text ($num)</span></td>" + $CR)
			IF $index/4 = Int($index/4) AND $index <> 20
				$out = AddStr(1,"add","</tr><tr>" + $CR)
			ENDIF
		ENDWHILE
		$out = AddStr(1,"add","</tr>" + $CR)
		$out = AddStr(1,"add","</table>" + $CR)
	ENDIF
	IF $unlistedowners >0
		$out = AddStr(1,"add","<br /><i>$user $Lang41 ")
		$out = AddStr(1,"add","<b>$unlistedowners</b> $Lang42</i>" + $CR)
	ENDIF
ENDSUB # Owner

BEGINSUB Name=Finder

	# Determine the number of finds by each finder on your cache
	SHOWSTATUS msg="$LangStatus28" Width=350
	# Determine the cutoff point for listing owners based on number of
	# their caches found
	$Cutoff = 5
	# Generate an unduplicated list of the owners of all found caches in the database and search that
	
	# Generate output
	$text="$Lang121"
	# Initialise Section variables
	$colspan = 1
	$note=""
	$maxwidth=50
	$Placed = TRUE
	GOSUB Name=SectionHead
	$Placed = FALSE

	$out = AddStr(1,"add","<!--BeginJavascript-->")
	$out = AddStr(1,"add","<span style='cursor:pointer; border: 1px solid #000000' onmousedown=" + Quote("document.getElementById('p1').style.display = 'block'; document.getElementById('p2').style.display = 'none';") + "><i>&nbsp; $Lang138 &nbsp;</i></span> &nbsp; &nbsp; " + $CR)
	$out = AddStr(1,"add","<span style='cursor:pointer; border: 1px solid #000000' onmousedown=" + Quote("document.getElementById('p2').style.display = 'block'; document.getElementById('p1').style.display = 'none';") + "><i>&nbsp; $Lang139 &nbsp;</i></span> &nbsp; &nbsp; " + $CR)
	$out = AddStr(1,"add","<br /><br />" + $CR)
	$out = AddStr(1,"add","<!--EndJavascript-->")

	IF NOT($IncludeOwn)
		$tmpS = "G" + "$MyId"
	ELSE
		$tmpS = ""
	ENDIF
	
	# Full list
	$_sql = "Select count(code) from PlacedStatsData"
	$totalpercent = Val(Sqlite("sql",$_sql))
	$_sql = "SELECT count(*) as c, lOwnerid, lBy FROM (SELECT DISTINCT lOwnerid, lBy, lParent, lType from PlacedLogs WHERE (lOwnerid<>'G0' AND lOwnerid<>'T0' AND lOwnerid<>'$tmpS') ORDER BY lLogid ASC) WHERE lType <> 'Archive' GROUP BY lOwnerid ORDER BY c DESC, lBy COLLATE NOCASE"
	$out = AddStr(1,"add","<div id='p1' style='display:block'>" + $CR)
	GOSUB Name=FinderList
	$out = AddStr(1,"add","</div>" + $CR)
	
	# Excluding archived caches
	$_sql = "Select count(code) from PlacedStatsData where Status<>'Archived'"
	$totalpercent = Val(Sqlite("sql",$_sql))
	$_sql = "SELECT count(*) as c, lOwnerid, lBy FROM (SELECT DISTINCT lOwnerid, lBy, lParent, lType from PlacedLogs WHERE (lOwnerid<>'G0' AND lOwnerid<>'T0' AND lOwnerid<>'$tmpS' AND lParent IN (SELECT code from PlacedStatsData WHERE status <> 'Archived' )) ORDER BY lLogid ASC) WHERE lType <> 'Archive' GROUP BY lOwnerid ORDER BY c DESC, lBy COLLATE NOCASE"
	$out = AddStr(1,"add","<div id='p2' style='display:none'>" + $CR)
	GOSUB Name=FinderList
	$out = AddStr(1,"add","</div>" + $CR)
	
ENDSUB # Finder

BEGINSUB Name=FinderList
		
	$work = Sqlite("sql",$_sql)
	$list = list("sql","replace",$work)

	#Sorted list of Owners, largest # finds at the top.
	$list = List("sql","item","1")
	$maxnum = Val(Extract($list,";",1))
	$index = 0
	$result = ""
	$result2 = ""
	$result3 = ""
	$tmpB = TRUE
	$totalowners = Val(List("sql","count",""))

	WHILE $index < $totalowners AND $tmpB = TRUE
		$tmpN = $index + 1
		$list = List("sql","item","$tmpN")
		$UserSort = Val(Extract($list,";",1))
		$OwnerID = Extract($list,";",2)
		$OwnerName = Extract($list,";",3)
		IF $index >19 AND $UserSort > $Cutoff
			GOSUB Name=MakeUserLink
			$index=$index+1
			$indexstring = Str($index,2,0)
			$result3 = $result3 + "$UserLink,$UserSort;"
		ENDIF
		IF $index <=19 and $index >9
			GOSUB Name=MakeUserLink
			$index=$index+1
			$indexstring = Str($index,2,0)
			$result2 = $result2 + "$indexstring - $UserLink,$UserSort;"
		ENDIF
		IF $index <=9
			GOSUB Name=MakeUserLink
			$index=$index+1
			$indexstring = Str($index,2,0)
			$result = $result + "$indexstring - $UserLink,$UserSort;"
		ENDIF
		IF $index >19 AND $UserSort <= $Cutoff
			$tmpB = FALSE
		ENDIF
	ENDWHILE
	$listedowners = $index
	IF $listedowners > 40
		$listedowners = 40
	ENDIF
	$unlistedowners = $totalowners - $listedowners
	
	#$totalpercent = $Hidden

	GOSUB Name=Open2Col
	GOSUB Name=Table2Col
	GOSUB Name=Mid2Col
	$result = $result2
	GOSUB Name=Table2Col
	GOSUB Name=Close2col
	IF $result3 <> ""
		$out = AddStr(1,"add","<b><i>$Lang40</i></b><table style='text-align: left;'>")
		$out = AddStr(1,"add",$CR+ "<tr>" + $CR)
		$result = $result3
		$index = 0
		$NumItems = RegExCount(";",$result)
		WHILE $index < $NumItems AND $index < 20
			$index = $index + 1
			$data = Extract($result, ";" , $Index)
			$text = Extract($data, ",", 1)
			$num  = Val(Extract($data, ",", 2))
			$out = AddStr(1,"add","<td style='$stOwners3'><span >$text ($num)</span></td>" + $CR)
			IF $index/4 = Int($index/4) AND $index <> 20
				$out = AddStr(1,"add","</tr><tr>" + $CR)
			ENDIF
		ENDWHILE
		$out = AddStr(1,"add","</tr>" + $CR)
		$out = AddStr(1,"add","</table>" + $CR)
	ENDIF
	IF $unlistedowners >0
		$out = AddStr(1,"add","<br /><i><b>$unlistedowners</b> $Lang42a ")
		$out = AddStr(1,"add","$Lang122 $user</i>" + $CR)
	ENDIF
ENDSUB # FinderList

BEGINSUB Name=State
	# Display a map showing finds by state in USA
	# Initialise Section variables
	$colspan = 1
	SHOWSTATUS msg="$LangStatus30" Width=350
	
	$_sql = "Drop table if exists Countries"
	$status = Sqlite("sql",$_sql,"")

	# Create Countries table 1;AW;Aruba
	$Data = "id text,state text,name text"
	$_sql = "CREATE TABLE Countries ($Data)"
	$status = Sqlite("sql",$_sql,"")

	# Import the master list of states to the SQL table
	$status = sqlite("import",AllTrim($StatesSQL),"table=Countries")
	

$_sql = "select avg(length(state)) from allfinds where country = 'United States'"
	$tmpN1 = Val(Sqlite("sql",$_sql))

	# Exclude locationless?
	IF $Excludelocationless
		$Locationless = " AND Cachetype <>'L' AND Exclude <> '1'"
	ELSE
		$Locationless = ""
	ENDIF

	IF $tmpN1 > 3
		$_sql = "SELECT id FROM countries WHERE countries.name IN (select state from allfinds WHERE country= 'United States' $Locationless group by state) order by countries.name"
	ELSE
		$_sql = "SELECT id FROM countries WHERE countries.state IN (select state from allfinds WHERE country= 'United States' $Locationless group by state) order by countries.state"
	ENDIF
			
	$status = Sqlite("sql",$_sql)
	$polygons = Replace($_NewLine,",",$status)
	
	$UseMasterFile = FALSE
	$UseOverlay = TRUE
	$UsePageBackground = FALSE
	
	$FileName = "FindStatGenMap_USStateShadingFile.dat"
	$tmpS = SysInfo("MacroPath") + "\" + $FileName
	IF (FileExists($tmpS))
		MACRO File=$tmpS
	ELSE
		$tmpS = SysInfo("MacroPath") + "\FindStatGenData\" + $FileName
		IF (FileExists($tmpS))
			MACRO File=$tmpS
		ELSE
			MSGOK msg="Sorry, I cannot find the US States Map Shading file $tmpS"
		ENDIF
	ENDIF

	GOSUB name=MapShading
	
	IF $tmpN1 > 3	
		$_sql = "SELECT $_sql FROM (SELECT count(*) cnt from allfinds WHERE country = 'United States' AND state in (SELECT name from countries) $Locationless group by state order by state)"
	ELSE
		$_sql = "SELECT $_sql FROM (SELECT count(*) cnt from allfinds WHERE country = 'United States' AND state in (SELECT state from countries) $Locationless group by state order by state)"
	ENDIF
	
	$status = Sqlite("sql",$_sql)
	$colors = Replace($_NewLine,"",$status)

	#MSGOK msg=$shades ; $colors


	#Make best guess at OwnerID
	$_sql = "SELECT lOwnerid FROM (SELECT lOwnerid, Count(lOwnerID) AS c FROM Allfinds GROUP BY lownerid ORDER BY c DESC LIMIT 1)"
	$OwnerID = Sqlite("sql",$_sql)

	# Background color
	#$MapCol4 = "93CEED"
	$Mapcol4 = Substr($MapCol4,2,6)
	
	$URL = "http://gsak.net/stats/polymaps/usastatemapshaded.php"
	$PostData = "'id','$polygons','name','$OwnerID','settings','$Settings','color2','$MapCol4','col1','$shades','s','$colors','over','$UseOverlay'"
	
	#CLIP data=$PostData
	#CANCEL
	
	$result = PostUrl($url,$PostData)

	#MSGOK msg=$result
	
	$tmpN=Random(0)
	$tmpS = Remove("$tmpN",".0","C")

	$url = "http://gsak.net/stats/polymaps/usastatemaps/" + $OwnerID + "_" + "$Settings" + ".png" + "?" + $tmpS
	

	IF $ExcludeLocationLess
		$_sql = "SELECT count(Code) from AllFinds WHERE country = 'United States' AND CacheType <>'L' and Exclude <> '1'"
	ELSE
		$_sql = "SELECT count(Code) from AllFinds WHERE country = 'United States'"
	ENDIF

	$usatotal = val(Sqlite("sql",$_sql))


	IF $tmpN1 > 3
		IF $ExcludeLocationLess
			$_sql = "SELECT count(Code) as n, allfinds.state, countries.state from AllFinds, countries on allfinds.state = countries.name WHERE country = 'United States' AND CacheType <>'L' and Exclude <> '1' GROUP BY allfinds.state ORDER BY n DESC, allfinds.state"
		ELSE
			$_sql = "SELECT count(Code) as n, allfinds.state, countries.state from AllFinds, countries on allfinds.state = countries.name WHERE country = 'United States' GROUP BY allfinds.state ORDER BY n DESC, allfinds.state"
		ENDIF
	ELSE
		IF $ExcludeLocationLess
			$_sql = "SELECT count(Code) as n, allfinds.state, countries.state from AllFinds, countries on allfinds.state = countries.state WHERE country = 'United States' AND CacheType <>'L' and Exclude <> '1' GROUP BY allfinds.state ORDER BY n DESC, allfinds.state"
		ELSE
			$_sql = "SELECT count(Code) as n, allfinds.state, countries.state from AllFinds, countries on allfinds.state = countries.state WHERE country = 'United States' GROUP BY allfinds.state ORDER BY n DESC, allfinds.state"
		ENDIF
	ENDIF
	$work = Sqlite("sql",$_sql)
	$list = list("sql","replace",$work)
	$tmpM = $_SqlRows # Number of Countries
	
	$count = 0

	$tmpN = 1
	$MapList = ""
	WHILE $tmpN <= $tmpM
		$list = List("sql","item","$tmpN")
		$State = Extract($list,";",2)
		$work = Extract($list,";",1)
		$count = $count + 1
		$tmpS = "<nobr><img style='align:top; margin:1px;' src='" + $ImageURL + "flags/states/" + Extract($list,";",3) + ".gif'/>"
		$MapList = $MapList + $tmpS + "&nbsp;" + Replace(" ","&nbsp;",$State,TRUE) + ":$work</nobr>"
			IF $tmpN < $tmpM
				$MapList = $MapList + ", "
			ENDIF
		$tmpN = $tmpN + 1
	ENDWHILE

	IF $count>1
		$s = "$Lang44b"
	ELSE
		$s = "$Lang44a"
	ENDIF
	
	$tmpN = Round(100*$count/50,1)
	$text = "$Lang111 - $usatotal $Lang43 $count $s - ($tmpN%)"
	GOSUB name=SectionHead
	
	IF Val(List("breaks","count","")) <=2
		$legendTable = ""
	ENDIF

	$out = AddStr(1,"add","<div style='align: center;'>")
	$out = AddStr(1,"add","<img height='400' width='740' src='$URL' ")
	$out = AddStr(1,"add","alt='States cached in' /><br />$legendTable</div><br /><div style='$stSmall'>")
	
	$out = AddStr(1,"add","<div style='width: 600px; margin:0px;'><i>$MapList</i></div>")
	IF $excludeLocationLess = true
		$out = AddStr(1,"add","<i>$Lang38a</i>")
	ENDIF
	$out = AddStr(1,"add","</div>")
ENDSUB # State


BEGINSUB Name=ParseMapList
	$RunMapCount = 1
	WHILE ($RunMapCount <= (RegExCount(";",$MapString) + 1)) AND (Len($MapString) > 0)
		$Map = Extract($MapString,";",$RunMapCount)
		IF $Map <> "Master Shading File" AND $Map <> "US County Shading File" AND $Map <> "World Country Shading File" AND $Map <> "Europe Country Shading File" AND $Map <> "Canada Country Shading File" AND $Map <> "US State Shading File" AND $Map <> "Australia State Shading File"
			GOSUB Name=UniversalCountryMap
		ENDIF
		$RunMapCount = $RunMapCount + 1
	ENDWHILE
ENDSUB # ParseMapList

BEGINSUB Name=UniversalCountryMap

	#############################################################################
	##Germany
	## Map definition file for FindStatGen3
	## V0.4 5-10-08
	#
	#$Country ="Germany"
	#$CountryLocalName = "Deutschland"
	#$AllStates = "BW,BY,BE,BB,HB,HH,HE,MV,NI,NW,RP,SL,SN,ST,SH,TH,NN,"  # NN = NotNamed
	#$Xstates = "100,165,205,235,75,105,95,190,125,50,45,29,230,170,125,153,245"
	#$Ystates = "294,274,104,139,105,86,204,59,114,164,234,262,184,149,49,194,234,"
	#$ColorStates = "0,0,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0"
	#$xFillState = "100,165,229,235,99,133,95,190,125,50,45,29,230,170,125,153,245"
	#$yFillState = "294,274,117,139,92,70,204,59,114,164,234,262,184,149,49,194,234,"
	#
	#$xMap = 293
	#$yMap = 370
	#
	#$xOffset = -135
	#$yOffset = 0
	#
	#$MapCol1 = "#202020" # Optional color value for sea map text
	#$MapCol2 = "#202020" # Optional color value for normal map text
	#
	#$MapCol3 = "FF8800" # Optional color for found regions
	#$MapCol4 = "337700" # Optional color for background
	#
	#$RegionName = "Bundesland"
	#$RegionNamePlural = "Bundeslndern"
	#
	#<data> Varname=$NameStates
	#BW =Baden-Wrttemberg,BY =Bayern,BE =Berlin,BB =Brandenburg,HB =Bremen,
	#HH =Hamburg,HE =Hessen,MV =Mecklenburg-Vorpommern,NI =Niedersachsen,
	#NW =Nordrhein-Westfalen,RP =Rheinland-Pfalz,SL =Saarland,SN =Sachsen,ST =Sachsen-Anhalt,
	#SH =Schleswig-Holstein,TH =Thringen,NN =Nil,
	#<enddata>
	#
	## End of file
	############################################################################

	$count = 1
	$FileName = ""
	$ImagePathCountry=""
	$MapCol1 = "#FFFF00"
	$MapCol2 = "#202020"
	
	# Increment Map ID count (for javascript ID)
	$MapIDCount = $MapIDCount + 1
	
	$MapName = ""
	
	# Default to looking in the county field (if not a state map)
	$MapDataSource = "County"

	# Default Shading colors
	$color1 = "#FFEEEE"
	$color2 = ""
	$color3 = ""
	$color4 = ""
	$color5 = ""
	$color6 = ""
	$color7 = ""
	$color8 = ""
	$color9 = ""
	$color10 = "#FF0000"
	
	# Default xsea and ysea
	$xsea = "2"
	$ysea = "2"
		
	$UseMasterFile = FALSE
	$UsePageBackground = FALSE
	
	$StateLocalName = ""
	
	$UseOverlay = TRUE

	WHILE $count <= $MapCount
		IF $Map = Extract($MapMasterList,";",$count)
			$FileName = Extract($DirListMap,";",$count)
		ENDIF
		$count = $count + 1
	ENDWHILE
	$StateChosen = ""
	$Country = "No country chosen"
	$MapFile = SysInfo("MacroPath") + "\" + $FileName
	IF (FileExists($MapFile))
		MACRO File=$MapFile
	ELSE
		$MapFile = SysInfo("MacroPath") + "\FindStatGenData\" + $FileName
		IF (FileExists($MapFile))
			MACRO File=$MapFile
		ELSE
			PAUSE msg="Sorry, I cannot find Map file $MapFile"
			EXITSUB
			EXITSUB
		ENDIF
	ENDIF
	
	IF $UseMasterFile
		$FileName = "FindStatGenMap_MasterShadingFile.dat"
		$tmpS = SysInfo("MacroPath") + "\" + $FileName
		IF (FileExists($tmpS))
			MACRO File=$tmpS
		ELSE
			$tmpS = SysInfo("MacroPath") + "\FindStatGenData\" + $FileName
			IF (FileExists($tmpS))
				MACRO File=$tmpS
				ELSE
				MSGOK msg="Sorry, I cannot find the Master Map Shading file $tmpS"
			ENDIF
		ENDIF
	ENDIF
	
	# Match map background to page background
	
	IF $UsePageBackground
		$mapcol4 = RegExSub("background:\s*?(#.*?);",$stMainDiv,1,1)
	ENDIF

	IF $StateChosen = ""
		GOSUB name=CustomCountryMap
	ELSE
		GOSUB name=CustomCountyMap
	ENDIF

ENDSUB

BEGINSUB name=CustomCountryMap
	# Display a map showing finds by state in Any country
	# Initialise Section variables
	$colspan = 1
	$StateList = ""
	$laststate = ""
	$tmpN = 1
	$tmpB = FALSE
	$MapList = ""
	$ListStates = ""
	SHOWSTATUS msg="$LangStatus34" Width=350

	IF $ExcludeLocationLess
		$_sql = "SELECT count(Code) from AllFinds WHERE Country='$Country' and CacheType <>'L' and Exclude <> '1'"
	ELSE
		$_sql = "SELECT count(Code) from AllFinds WHERE Country='$Country'"
	ENDIF

	$Countrytotal = val(Sqlite("sql",$_sql))

	IF $Countrytotal = 0
		PAUSE msg="Sorry, you have no finds in $Country in this database, no map"
		EXITSUB
		EXITSUB
	ENDIF
	
	IF $MapName = ""
		$MapName = $country
	ENDIF

	IF $ExcludeLocationLess
		$_sql = "SELECT count(Code) as n, State from AllFinds WHERE Country='$Country' and CacheType <>'L' and Exclude <> '1' GROUP BY State ORDER BY n DESC, State"
	ELSE
		$_sql = "SELECT count(Code) as n, State from AllFinds WHERE Country='$Country' GROUP BY State ORDER BY n DESC, State"
	ENDIF
	$work = Sqlite("sql",$_sql)
	$list = list("sql","replace",$work)
	$count = $_SqlRows # Number of States

	WHILE $tmpN <= $count
		$list = List("sql","item","$tmpN")
		$work = Extract($list,";",1)
		$State = Extract($list,";",2)
		$FullName = "=" + $State + ","

		IF Len($State) > 2 AND At($FullName,$NameStates) >0
			$StateList = $StateList + SubStr($NameStates,At($FullName,$NameStates)-3,2)
			$ListStates = $ListStates + $State + ","
			#Build flags string
			$tmpS = "<nobr><img style='align:top; margin:1px;' src='" + $ImageURL + "flags/$MapName/" + SubStr($NameStates,At($FullName,$NameStates)-3,2) + ".gif'>"
			IF $State = "Nil"
				$State = $Lang137
				$tmpB = TRUE
			ENDIF

			# MapList is flags string
			$MapList = $MapList + $tmpS + "&nbsp;" + Replace(" ","&nbsp;",$State,TRUE) + ":$work</nobr>"
			IF $tmpN < $count
				$MapList = $MapList + ", "
				#				IF Frac($tmpN/7) = 0
				#					$MapList = $MapList + "<br />"
				#				ENDIF
			ENDIF
		ELSE
			IF Len($State) <= 2 AND At(Left($State,2),$AllStates) >0
				$StateList = $StateList + Left($State,2)
				$ListStates = $ListStates + $State + ","
				#Build flags string
				$tmpS = "<nobr><img style='align:top; margin:1px;' src='" + $ImageURL + "flags/$MapName/" + Left($State,2) + ".gif'>"
				$MapList = $MapList + $tmpS + "&nbsp;$State:$work</nobr>"
				IF $tmpN < $count
					$MapList = $MapList + ", "
					#					IF Frac($tmpN/7) = 0
					#						$MapList = $MapList + "<br />"
					#					ENDIF
				ENDIF
			ELSE
				MSGOK msg="You have an unrecognized $Country State name, $State, in your database"
			ENDIF
		ENDIF
		$tmpN = $tmpN + 1
	ENDWHILE

	# Remove Unknown States from Total
	IF $tmpB
		$count = $count - 1
	ENDIF

	# Pluralize correctly
	IF $count>1
		$s = $RegionNamePlural
	ELSE
		$s = $RegionName
	ENDIF
	$text = "$CountryLocalName - $Countrytotal $Lang43 $count $s"
	GOSUB name=SectionHead
	#$out = AddStr(1,"add","<div style='position: relative; align: center;'>")
	$out = AddStr(1,"add","<div style='align: center;'>")
	$out = AddStr(1,"add","<img height='$ymap' width='$xmap' src='" + $ImageURL + "blank.gif'")
	$out = AddStr(1,"add","alt='States cached in' /><br /><div style='$stSmall'>" + $CR)

	$preamble = "<div style='margin-top: -" + "$ymap" + "px;'><img height='$ymap' width='$xmap' alt='States cached in'"

	# Did the Map Definition file ask for a callback?
	IF $ImagePathCountry="callagain"
		IF (FileExists($MapFile))
			MACRO File=$MapFile
		ENDIF
	ENDIF

	$StateNum = Len($StateList)/2

	SHOWSTATUS msg="$LangStatus32"

	$URL = "dummy=" + $StateList
	GOSUB name=AddTextToMap

	IF $ImagePathCountry=""
		#$ImagePathCountry = $ImageURL + "flags/$Country/$Country" + ".gif"
		$ImagePathCountry = $ImageURL + "newmaps/custommap.php?map=" + $MapName + "&x=" + $xFill + "&y=" + $yFill
		IF NOT($MapCol3 = "")
			$ImagePathCountry = $ImagePathCountry + "&col1=" + $MapCol3
		ENDIF
		IF NOT($MapCol4 = "")
			$ImagePathCountry = $ImagePathCountry + "&col2=" + $MapCol4
		ENDIF
	ENDIF

	$out = AddStr(1,"add","$preamble src='$ImagePathCountry' /></div></div>" + $CR)

	# Add numbers
	$out = AddStr(1,"add",$numbertext)
	
	$out = AddStr(1,"add","</div>")

	# Add state list and flag images
	$out = AddStr(1,"add","<div style='font: 10px Verdana, Arial, sans-serif; width: 600px'><i>$MapList</i></div>")

	IF $excludeLocationLess = true
		$out = AddStr(1,"add","<div style='font: 10px Verdana, Arial, sans-serif;'><i>$Lang38a</i>")
	ELSE
		$out = AddStr(1,"add","<div style='font: 10px Verdana, Arial, sans-serif;'>")
	ENDIF
	$out = AddStr(1,"add","</div></p>")

ENDSUB # CustomCountryMap

BEGINSUB name=CustomCountyMap
	
	# Display a map showing finds by state in Any country
	# Initialise Section variables
	$colspan = 1

	SHOWSTATUS msg="Loading County Definitions" Width=350

	########## Default variable setup
	# flag for test mode or normal operation
	# 1 = testing (show all counties filled for selected state)
	# 0 = normal (only show counties where a cache exists in current db/filter)
	$TestMode = 0
	########## End default variable setup

	$status=""

	$_sql = "drop table if exists Counties; drop table if exists mapfinds"
	$status = Sqlite("sql",$_sql,"")

	# Create counties table
	$Data = "County text,xFill text,yFill text"
	$_sql = "CREATE TABLE Counties ($Data)"
	$status = Sqlite("sql",$_sql,"")

	# Import the master list of Counties to the SQL table
	$status = sqlite("import",AllTrim($CountiesSQlFile),"table=Counties")

	GOSUB name=MainCountyMap

ENDSUB #CustomCountyMap

BEGINSUB name=MainCountyMap
	$colspan = 1
	# Exclude locationless?
	IF $Excludelocationless
		$Locationless = " AND Cachetype <>'L' AND Exclude <> '1'"
	ELSE
		$Locationless = ""
	ENDIF

	# Figure out if we are using full state names or abbreviations
	$_sql = "SELECT AVG(LENGTH(state)) from AllFinds WHERE country='$Country'"
	$tmpN = Val(Sqlite("SQL",$_sql,""))

	IF $tmpN > 3 OR $StateChosen = "%"
		$SearchState = $StateChosen
	ELSE
		# Use the state abbreviation
		$SearchState = $StateAbbreviation
	ENDIF
	
	IF $MapDataSource = "County"
		$_sql = "SELECT Code From Allfinds WHERE country like '$Country' AND State like '$SearchState' AND County = '' $Locationless"
		$result = Sqlite("SQL",$_sql,"")
	
		IF Len($result) <> 0
			# Update the County fields
			#	MSGOK msg="$MapDataSource - $result"
			
    	$result = Form($Form13,"")
    	BEGINCASE
        CASE $CountyUpdateOK
        	$UpdateCounty = TRUE
					# Clear out all the sql tables
					$_sql = "DROP TABLE IF EXISTS RawCaches; "
					$_sql = $_sql + "DROP TABLE IF EXISTS RawLogs; "
					$_sql = $_sql + "DROP TABLE IF EXISTS AllFinds"
					$status = Sqlite("sql",$_sql)
					GOSUB name=CopyToNewDatabase
        OTHERWISE
        	# CANCEL Msg="Macro Cancelled"
    	ENDCASE
		ENDIF
	ENDIF
	
	
	# Create temp table for just this country and state
	# Special case for Delaware/Maryland Delorme map
	IF $StateAbbreviation = "DM"
		IF $tmpN > 3
     $_sql = "CREATE temp Table mapfinds as SELECT * From Allfinds WHERE country='$Country' and (State like 'Maryland' OR State like 'Delaware') $Locationless"
    ELSE
    	$_sql = "CREATE temp Table mapfinds as SELECT * From Allfinds WHERE country='$Country' and (State like 'MD' OR State like 'DE') $Locationless"
    ENDIF
  ELSE
  	$_sql = "CREATE temp Table mapfinds as SELECT * From Allfinds WHERE country like '$Country' and State like '$SearchState' $Locationless"
  ENDIF	
	$result = Sqlite("SQL",$_sql,"")
			
	#	# build link to the mapping script
	#	IF $StateAbbreviation = "VI"
	#		$MapName = "pr"
	#	ELSE
	#		$MapName = lower($StateAbbreviation)
	#	ENDIF

	

	# encoded x/y coords
	$encodingString = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-."

	$list = List("breaks", "replace", "")
	$list = List("colors", "replace", "")

	# set up list of break points for groups
	IF Val($limit1) > 0
		$list = List("breaks", "add", $limit1)
	ENDIF
	IF Val($limit2) > 0
		$list = List("breaks", "add", $limit2)
	ENDIF
	IF Val($limit3) > 0
		$list = List("breaks", "add", $limit3)
	ENDIF
	IF Val($limit4) > 0
		$list = List("breaks", "add", $limit4)
	ENDIF
	IF Val($limit5) > 0
		$list = List("breaks", "add", $limit5)
	ENDIF
	IF Val($limit6) > 0
		$list = List("breaks", "add", $limit6)
	ENDIF
	IF Val($limit7) > 0
		$list = List("breaks", "add", $limit7)
	ENDIF
	IF Val($limit8) > 0
		$list = List("breaks", "add", $limit8)
	ENDIF
	IF Val($limit9) > 0
		$list = List("breaks", "add", $limit9)
	ENDIF

	$list = List("breaks", "add", "9999999")

	$list = List("colors", "add", $color1)
	$list = List("colors", "add", $color2)
	$list = List("colors", "add", $color3)
	$list = List("colors", "add", $color4)
	$list = List("colors", "add", $color5)
	$list = List("colors", "add", $color6)
	$list = List("colors", "add", $color7)
	$list = List("colors", "add", $color8)
	$list = List("colors", "add", $color9)
	$list = List("colors", "add", $color10)

	$count=0
	$count=Val(List("breaks","count",""))-1

	# add shading for number of caches in that county
	$BeginColor = $color1
	$EndColor = $color10

	# get the decimal values of the step changes for each shade
	# Red value
	$hex=Substr($BeginColor,2,2)
	GOSUB Name=hextodec
	$begRed=$dec
	$hex=Substr($EndColor,2,2)
	GOSUB Name=hextodec
	$endRed=$dec
	$redChange = Round(($endRed - $begRed) / $count,0)

	# Green value
	$hex=Substr($BeginColor,4,2)
	GOSUB Name=hextodec
	$begGreen=$dec
	$hex=Substr($EndColor,4,2)
	GOSUB Name=hextodec
	$endGreen=$dec
	$greenChange = Round(($endGreen - $begGreen) / $count,0)

	# Blue value
	$hex=Substr($BeginColor,6,2)
	GOSUB Name=hextodec
	$begBlue=$dec
	$hex=Substr($EndColor,6,2)
	GOSUB Name=hextodec
	$endBlue=$dec
	$blueChange = Round(($endBlue - $begBlue) / $count,0)

	$tmpN=0
	$shades=""
	$lowBreak="0"
	$rows=1
	$_sql = " case "
	$legendTable = "<table style='width: 600px; margin: auto auto; font-size: xx-small; text-align: left;' border=0><tr>"

	WHILE $tmpN < $count
		$list = List("colors","item",NumtoStr($tmpN + 1))

		IF len($list) = 0
			$red=$begRed+($redChange*$tmpN)
			$dec=$red
			GOSUB Name=dectohex
			$redhex=$hex

			$green=$begGreen+($greenChange*$tmpN)
			$dec=$green
			GOSUB Name=dectohex
			$greenhex=$hex

			$blue=$begBlue+($blueChange*$tmpN)
			$dec=$blue
			GOSUB Name=dectohex
			$bluehex=$hex
		ELSE
			$redhex=Substr($list,2,2)
			$greenhex=Substr($list,4,2)
			$bluehex=Substr($list,6,2)

			$hex=$redhex
			GOSUB Name=hextodec
			$red=$dec

			$hex=$greenhex
			GOSUB Name=hextodec
			$green=$dec

			$hex=$bluehex
			GOSUB Name=hextodec
			$blue=$dec
		ENDIF

		$shades = $shades + $redhex + $greenhex + $bluehex

		$Break = List("breaks","item",NumtoStr($tmpN+1))
		$_sql = $_sql + " when cnt > $lowBreak and cnt <= $Break then '$tmpN'"

		IF Val($lowBreak) = 0
			IF Val($Break) = 1
				$Label = $Break
			ELSE
				$Label = "1 - " + $Break
			ENDIF
		ELSE
			IF (Val($lowBreak) + 1) = Val($Break)
  			$Label = $Break
 			ELSE
				$Label = NumtoStr((Val($lowBreak) + 1)) + " - " + $Break
			ENDIF
		ENDIF
		IF $rows < 5
			$legendTable = $legendTable + "<td style='width:10px;height:10px;border:1px solid #000000;background-color:#$redhex$greenhex$bluehex'>&nbsp;</td><td>" + $Label + "</td>"
			$rows = $rows + 1
		ELSE
			$legendTable = $legendTable + "<td style='width:10px;height:10px;border:1px solid #000000;background-color:#$redhex$greenhex$bluehex'>&nbsp;</td><td>" + $Label + "</td></tr><tr>"
			$rows = 1
		ENDIF
		$tmpN = $tmpN + 1
		$lowBreak = $Break
	ENDWHILE

	$dec=$endRed
	GOSUB Name=dectohex
	$redhex=$hex

	$dec=$endGreen
	GOSUB Name=dectohex
	$greenhex=$hex

	$dec=$endBlue
	GOSUB Name=dectohex
	$bluehex=$hex

	$shades = $shades + $redhex + $greenhex + $bluehex

	$Break = List("breaks","item",NumtoStr($tmpN+1))
	$Label = NumtoStr((Val($lowBreak) + 1)) + "+"

	$_sql = $_sql + " when cnt > $lowBreak and cnt <= $Break then '$tmpN' end"

	$legendTable = $legendTable + "<td style='width:10px;height:10px;border:1px solid #000000;background-color:#$redhex$greenhex$bluehex'>&nbsp;</td><td>" + $Label + "</td></tr></table>"

	#test code to load ALL counties shaded at highest level
	IF $TestMode = 1
		$_sql = " '$tmpN' "
	ENDIF
	SHOWSTATUS msg="Shading County Map" Width=350
	#test code to load ALL counties
	
#	$MapDataSource = "county"

	# Save $_sql
	$tmpS1 = $_sql


# Order by Counts

	IF $TestMode = 1
		#$_sql = "SELECT substr('$encodingString', (round((xFill / 64)-0.5))+1,1) || substr('$encodingString',(xFill % 64)+1,1) xfill, substr('$encodingString', (round((yFill / 64)-0.5))+1,1) || substr('$encodingString',(yFill % 64)+1,1) yfill, $_sql, Counties.county, cnt FROM Counties, (select Counties.county, count(*) cnt from Counties WHERE State like '$StateChosen' GROUP BY Counties.county) counts WHERE State = '$StateChosen' and counts.county like Counties.county GROUP BY xfill,yfill order by cnt desc, Counties.county asc"
		$_sql = "SELECT substr('$encodingString', floor(xFill/64)+1,1) || substr('$encodingString',(xFill % 64)+1,1) xfill, substr('$encodingString', floor(yFill/64)+1,1) || substr('$encodingString',(yFill % 64)+1,1) yfill, $_sql, Counties.county, cnt FROM Counties, (select Counties.county, count(*) cnt from Counties WHERE State like '$StateChosen' GROUP BY Counties.county) counts WHERE State = '$StateChosen' and counts.county like Counties.county GROUP BY xfill,yfill order by cnt desc, Counties.county asc"
	ELSE  # Normal mode
		#$_sql = "SELECT substr('$encodingString', (round((xFill / 64)-0.5))+1,1) || substr('$encodingString',(xFill % 64)+1,1) xfill, substr('$encodingString', (round((yFill / 64)-0.5))+1,1) || substr('$encodingString',(yFill % 64)+1,1) yfill, $_sql, Counties.county, cnt FROM Counties, mapfinds, (select mapfinds.$MapDataSource, count(*) cnt from mapfinds WHERE mapfinds.$MapDataSource != '' GROUP BY mapfinds.$MapDataSource) counts WHERE mapfinds.$MapDataSource != '' and Counties.County like mapfinds.$MapDataSource and mapfinds.$MapDataSource like counts.$MapDataSource GROUP BY xfill,yfill order by cnt desc, Counties.county asc"
		$_sql = "SELECT substr('$encodingString', floor(xFill/64)+1,1) || substr('$encodingString',(xFill % 64)+1,1) xfill, substr('$encodingString', floor(yFill/64)+1,1) || substr('$encodingString',(yFill % 64)+1,1) yfill, $_sql, Counties.county, cnt FROM Counties, mapfinds, (select mapfinds.$MapDataSource, count(*) cnt from mapfinds WHERE mapfinds.$MapDataSource != '' GROUP BY mapfinds.$MapDataSource) counts WHERE mapfinds.$MapDataSource != '' and Counties.County like mapfinds.$MapDataSource and mapfinds.$MapDataSource like counts.$MapDataSource GROUP BY xfill,yfill order by cnt desc, Counties.county asc"
	ENDIF

	$result = Sqlite("SQL",$_sql,"")

	#$result = Replace(" ","",$result,true)
	$result = Replace("$_NewLine", ";",$result,true)

	$list = list("CtyTable","replace",$result)
	$count = Val(list("CtyTable","count",""))

	$tmpN = 1
	$rows = 1
	$TotList = ""
	$c_x=""
	$c_y=""
	$c_s=""
	
	IF $StateLocalName = ""
		$StateLocalName = $StateChosen
	ENDIF
	
	WHILE $tmpN < $count
		$c_x = $c_x + List("CtyTable","item",NumtoStr($tmpN))
		$c_y = $c_y + List("CtyTable","item",NumtoStr($tmpN+1))
		$c_s = $c_s + List("CtyTable","item",NumtoStr($tmpN+2))
		$countyName = List("CtyTable","item",NumtoStr($tmpN+3))
		$PreviousCountyName = List("CtyTable","item",NumtoStr($tmpN-2))

		# avoid duplicate county names for counties with multiple coord entries
		IF $countyName <> List("CtyTable","item",NumtoStr($tmpN-2))
			$countyCnt = List("CtyTable","item",NumtoStr($tmpN+4))
			$TotList = $TotList + "<td style='$st2c2'>$countyName:$countyCnt"
			IF $tmpN < $count
				IF $rows < 5
					$TotList = $TotList + "</td>"
					$rows = $rows + 1
				ELSE
					$TotList = $TotList + "</td></tr><tr>"
					$rows=1
				ENDIF
			ELSE
				$TotList = $TotList + "</td></tr>"
			ENDIF
		ENDIF

		$tmpN = $tmpN+5
	ENDWHILE

	# Restore $_sql
	$_sql = $tmpS1

# Order by County name
	IF $TestMode = 1
		#$_sql = "SELECT substr('$encodingString', (round((xFill / 64)-0.5))+1,1) || substr('$encodingString',(xFill % 64)+1,1) xfill, substr('$encodingString', (round((yFill / 64)-0.5))+1,1) || substr('$encodingString',(yFill % 64)+1,1) yfill, $_sql, Counties.county, cnt FROM Counties, (select Counties.county, count(*) cnt from Counties WHERE State like '$StateChosen' GROUP BY Counties.county) counts WHERE State = '$StateChosen' and counts.county like Counties.county GROUP BY xfill,yfill order by Counties.county asc"
		$_sql = "SELECT substr('$encodingString', floor(xFill/64)+1,1) || substr('$encodingString',(xFill % 64)+1,1) xfill, substr('$encodingString', floor(yFill/64)+1,1) || substr('$encodingString',(yFill % 64)+1,1) yfill, $_sql, Counties.county, cnt FROM Counties, (select Counties.county, count(*) cnt from Counties WHERE State like '$StateChosen' GROUP BY Counties.county) counts WHERE State = '$StateChosen' and counts.county like Counties.county GROUP BY xfill,yfill order by Counties.county asc"
	ELSE  # Normal mode
		#$_sql = "SELECT substr('$encodingString', (round((xFill / 64)-0.5))+1,1) || substr('$encodingString',(xFill % 64)+1,1) xfill, substr('$encodingString', (round((yFill / 64)-0.5))+1,1) || substr('$encodingString',(yFill % 64)+1,1) yfill, $_sql, Counties.county, cnt FROM Counties, mapfinds, (select mapfinds.$MapDataSource, count(*) cnt from mapfinds WHERE mapfinds.$MapDataSource != '' GROUP BY mapfinds.$MapDataSource) counts WHERE mapfinds.$MapDataSource != '' and Counties.County like mapfinds.$MapDataSource and mapfinds.$MapDataSource like counts.$MapDataSource GROUP BY xfill,yfill order by Counties.county asc"
		$_sql = "SELECT substr('$encodingString', floor(xFill/64)+1,1) || substr('$encodingString',(xFill % 64)+1,1) xfill, substr('$encodingString', floor(yFill/64)+1,1) || substr('$encodingString',(yFill % 64)+1,1) yfill, $_sql, Counties.county, cnt FROM Counties, mapfinds, (select mapfinds.$MapDataSource, count(*) cnt from mapfinds WHERE mapfinds.$MapDataSource != '' GROUP BY mapfinds.$MapDataSource) counts WHERE mapfinds.$MapDataSource != '' and Counties.County like mapfinds.$MapDataSource and mapfinds.$MapDataSource like counts.$MapDataSource GROUP BY xfill,yfill order by Counties.county asc"
	ENDIF

	$result = Sqlite("SQL",$_sql,"")
	
	$result = Replace("$_NewLine", ";",$result,true)

	$list = list("CtyTable","replace",$result)
	$count = Val(list("CtyTable","count",""))

	$tmpN = 1
	$rows = 1
	$TotList2 = ""
		
	WHILE $tmpN < $count
		$countyName = List("CtyTable","item",NumtoStr($tmpN+3))
		$PreviousCountyName = List("CtyTable","item",NumtoStr($tmpN-2))

		# avoid duplicate county names for counties with multiple coord entries
		IF $countyName <> List("CtyTable","item",NumtoStr($tmpN-2))
			$countyCnt = List("CtyTable","item",NumtoStr($tmpN+4))
			$TotList2 = $TotList2 + "<td style='$st2c2'>$countyName:$countyCnt"
			IF $tmpN < $count
				IF $rows < 5
					$TotList2 = $TotList2 + "</td>"
					$rows = $rows + 1
				ELSE
					$TotList2 = $TotList2 + "</td></tr><tr>"
					$rows=1
				ENDIF
			ELSE
				$TotList2 = $TotList2 + "</td></tr>"
			ENDIF
		ENDIF

		$tmpN = $tmpN+5
	ENDWHILE



	#$code= "http://gsak.net/stats/counties/custommap.php?map=" + $MapName + "&enc=1" + "&over=$UseOverlay"

	# build the url
	#$url = $code + "&x=" + $c_x + "&y=" + $c_y + "&col1=" + $shades + "&s=" + $c_s + "&col2=" + Substr($MapCol4,2,6)
		
	#Make best guess at OwnerID
	$_sql = "SELECT lOwnerid FROM (SELECT lOwnerid, Count(lOwnerID) AS c FROM Allfinds GROUP BY lownerid ORDER BY c DESC LIMIT 1)"
	$OwnerID = Sqlite("sql",$_sql)
	
	$URL = "http://gsak.net/stats/counties/custommapstore.php"
	
	$xsea = NumToStr(Abs(Int(Val($xsea))))
	$ysea = NumToStr(Abs(Int(Val($ysea))))
	
	IF Val($xsea) = 0 AND Val($ysea) = 0
		$xsea = "2"
		$ysea = "2"
	ENDIF
		
	$tmpS = Substr($MapCol4,2,6)
	$PostData = "'map','$MapName','enc','1','over','$UseOverlay','x','$c_x','y','$c_y','col1','$shades','s','$c_s','col2','$tmpS','name','$OwnerID','settings','$Settings','xsea','$xsea','ysea','$ysea'"
		
	$result = PostUrl($url,$PostData)
	#CLIP data=$postData
	#MSGOK	msg=$result
		
	$tmpN=Random(0)
	$tmpS = Remove("$tmpN",".0","C")

	
	$url = "http://gsak.net/stats/counties/usermaps/" + $OwnerID + "_" + $MapName + "_" + "$Settings" + ".png" + "?" + $tmpS

	#WEB URL=$code
	
	IF Val(List("breaks","count","")) <=2
		$legendTable = ""
	ENDIF

	$code = "<div style='align: center;'><table style='width: 600px; margin: auto auto; font-size: xx-small; text-align: left;' border=0><tr><td colspan='5' align='center'><img src=" + $url + "><br />$legendTable"  + $CR
			
	$code = $code + "<br /><span style='cursor:pointer; border: 1px solid #000000' onmousedown=" + Quote("document.getElementById('map1_$MapIDCount').style.display = (getElementById('map1_$MapIDCount').style.display != 'none' ? 'none' : '');getElementById('map2_$MapIDCount').style.display = 'none';") + "><i><b>&nbsp; $RegionName $LangForm51 $Lang172 &nbsp;</b></i></span>&nbsp; &nbsp; " + $CR
	$code = $code + "<span style='cursor:pointer; border: 1px solid #000000' onmousedown=" + Quote("document.getElementById('map2_$MapIDCount').style.display = (getElementById('map2_$MapIDCount').style.display != 'none' ? 'none' : '');getElementById('map1_$MapIDCount').style.display = 'none';") + "><i><b>&nbsp; $RegionName $LangForm51 $Lang173 &nbsp;</b></i></span> " + $CR
	
	$code = $code + "<div id='map1_$MapIDCount' style='display:none'><table style='width: 600px; margin: auto auto; font-size: xx-small; text-align: left;' border=0><br /></td></tr><tr>" + $TotList + "</table></div>"  + $CR
	$code = $code + "<div id='map2_$MapIDCount' style='display:none'><table style='width: 600px; margin: auto auto; font-size: xx-small; text-align: left;' border=0><br /></td></tr><tr>" + $TotList2 + "</table></div></table></div>"  + $CR
		
	$_sql = "SELECT $MapDataSource From mapfinds WHERE Upper($MapDataSource) in (Select distinct upper(county) from counties)"
	$result = Sqlite("SQL",$_sql,"")
	$Countrytotal = $_sqlrows
	
	$_sql = "SELECT distinct Upper($MapDataSource) From mapfinds WHERE Upper($MapDataSource) in (Select distinct upper(county) from counties)"
	$result = Sqlite("SQL",$_sql,"")
	$count = $_sqlrows
	
	$_sql = "SELECT Count(DISTINCT county) FROM counties"
	$tmpS = Sqlite("SQL",$_sql,"")
	
	# Pluralize correctly
	IF $count>1
		$s = $RegionNamePlural
	ELSE
		$s = $RegionName
	ENDIF

	
	IF $stateChosen = "%"
		$text = "$CountryLocalName - $Countrytotal $Lang43 $count/$tmpS $s"
	ELSE
		$text = "$CountryLocalName - $StateLocalName - $Countrytotal $Lang43 $count/$tmpS $s"
	ENDIF
	GOSUB name=SectionHead
	$out = AddStr(1,"add",$code)

ENDSUB #Main

BEGINSUB Name=EditMaps
# Edit map data file

# Write out the color picker
$FileName = $datafilepath + "\FindStatGenData\colorpicker\colorpicker.zip"
$tmpS = PutFile($FileName,MimeDecode($colorpicker))
IF Left($tmpS ,4) <> "*OK*"
	PAUSE Msg="Sorry! For some reason I couldn't generate the colorpicker file"
ENDIF

$Folder = $datafilepath + "\FindStatGenData\colorpicker\"
#unzip the files to the destination folder
$tmpS = ZipFile("unzip",$FileName,$Folder)

# error check
IF Left($tmpS,7) = "*Error*"
	PAUSE Msg=$Tmps
ENDIF

$StateChosen = ""

GOSUB Name=SetFormColors

$url="file:///" + $datafilepath + "\FindStatGenData\colorpicker\colorpicker.html"

$form11 = EditForm($form11,"Browser1","url",$url)
$form11 = EditForm($form11,"EditMapString","Values","$LangForm88;" + $MapMasterList)

# Show the main form in a loop
WHILE TRUE
  $result = Form($form11,"")
# Reset the screen position of the menu form to where the user left it
  $form11 = EditForm($form11,"form11","Top",$_FormTop)
  $form11 = EditForm($form11,"form11","Left",$_FormLeft)
  GOSUB name=SetFormColors
  BEGINCASE #Buttons
    CASE $Refresh
    CASE $result = "EditMapString"
    	GOSUB name=LoadMap
    CASE $Save
    	GOSUB Name=UpdateMapDataFile
    	$Error = PutFile($MapFile,$MapDataFile)
    CASE $MapEditOK
    	GOSUB Name=UpdateMapDataFile
    	$Error = PutFile($MapFile,$MapDataFile)
    	BREAK
    CASE $MapEditCancel
    	BREAK
    OTHERWISE
      BREAK
  ENDCASE
ENDWHILE # Form Loop

ENDSUB #Name=EditMaps

BEGINSUB name=LoadMap
$count = 1
$Country = ""
$CountryLocalName = ""
$StateLocalName = ""
$StateChosen = ""
$StateAbbreviation = ""
$RegionName = ""
$RegionNamePlural = ""
$MapDataSource = ""
$UseOverlay = TRUE

IF $EditMapString = $LangForm88
	$Form11 = Editform($Form11,"CurrentMap","caption",$LangForm88)
	EXITSUB
ENDIF

WHILE $count <= $MapCount
		IF $EditMapString = Extract($MapMasterList,";",$count)
			$FileName = Extract($DirListMap,";",$count)
		ENDIF
		$count = $count + 1
	ENDWHILE
	$StateChosen = ""
	$MapFile = SysInfo("MacroPath") + "\" + $FileName
	IF (FileExists($MapFile))
		$StateChosen = ""
		$MapDataSource = "County"
		$UseMasterFile = FALSE
		$UsePageBackground = FALSE
		$MasterFile = FALSE
		MACRO File=$MapFile
		$MapDataFile = GetFile($MapFile)
		GOSUB name=SetFormColors
	ELSE
		$MapFile = SysInfo("MacroPath") + "\FindStatGenData\" + $FileName
		IF (FileExists($MapFile))
			$StateChosen = ""
			$MapDataSource = "County"
			$UseMasterFile = FALSE
			$UsePageBackground = FALSE
			$MasterFile = FALSE
			MACRO File=$MapFile
			$MapDataFile = GetFile($MapFile)
			GOSUB name=SetFormColors
		ELSE
			PAUSE msg="Sorry, I cannot find Map file $MapFile"
			EXITSUB
			EXITSUB
		ENDIF
	ENDIF
	$Form11 = Editform($Form11,"CurrentMap","caption","$EditMapString")
ENDSUB


BEGINSUB Name=UpdateMapDataFile
	$mapdatafile = RegExReplace("(?m)\$" + "limit1\D.*$",$mapdatafile,"$" + "limit1 = " + Quote($limit1))
	$mapdatafile = RegExReplace("(?m)\$" + "limit2\D.*$",$mapdatafile,"$" + "limit2 = " + Quote($limit2))
	$mapdatafile = RegExReplace("(?m)\$" + "limit3\D.*$",$mapdatafile,"$" + "limit3 = " + Quote($limit3))
	$mapdatafile = RegExReplace("(?m)\$" + "limit4\D.*$",$mapdatafile,"$" + "limit4 = " + Quote($limit4))
	$mapdatafile = RegExReplace("(?m)\$" + "limit5\D.*$",$mapdatafile,"$" + "limit5 = " + Quote($limit5))
	$mapdatafile = RegExReplace("(?m)\$" + "limit6\D.*$",$mapdatafile,"$" + "limit6 = " + Quote($limit6))
	$mapdatafile = RegExReplace("(?m)\$" + "limit7\D.*$",$mapdatafile,"$" + "limit7 = " + Quote($limit7))
	$mapdatafile = RegExReplace("(?m)\$" + "limit8\D.*$",$mapdatafile,"$" + "limit8 = " + Quote($limit8))
	$mapdatafile = RegExReplace("(?m)\$" + "limit9\D.*$",$mapdatafile,"$" + "limit9 = " + Quote($limit9))
		
	$mapdatafile = RegExReplace("(?m)\$" + "color1\D.*$",$mapdatafile,"$" + "color1 = " + Quote($color1))
	
	$tmpS = RegExData("(?m)\$" + "color1\D.*$",$mapdatafile,1)
	IF RegEx("(?m)\$" + "color2\D.*$",$mapdatafile)
		$mapdatafile = RegExReplace("(?m)\$" + "color2\D.*$",$mapdatafile,"$" + "color2 = " + Quote($color2))
	ELSE
		$mapdatafile = RegExReplace("(?m)\$" + "color1\D.*$",$mapdatafile,$tmpS + $_NewLine + "$" + "color2 = " + Quote($color2))
	ENDIF
	
	$tmpS = RegExData("(?m)\$" + "color2\D.*$",$mapdatafile,1)
	IF RegEx("(?m)\$" + "color3\D.*$",$mapdatafile)
		$mapdatafile = RegExReplace("(?m)\$" + "color3\D.*$",$mapdatafile,"$" + "color3 = " + Quote($color3))
	ELSE
		$mapdatafile = RegExReplace("(?m)\$" + "color2\D.*$",$mapdatafile,$tmpS + $_NewLine + "$" + "color3 = " + Quote($color3))
	ENDIF
	
	$tmpS = RegExData("(?m)\$" + "color3\D.*$",$mapdatafile,1)
	IF RegEx("(?m)\$" + "color4\D.*$",$mapdatafile)
		$mapdatafile = RegExReplace("(?m)\$" + "color4\D.*$",$mapdatafile,"$" + "color4 = " + Quote($color4))
	ELSE
		$mapdatafile = RegExReplace("(?m)\$" + "color3\D.*$",$mapdatafile,$tmpS + $_NewLine + "$" + "color4 = " + Quote($color4))
	ENDIF
	
	$tmpS = RegExData("(?m)\$" + "color4\D.*$",$mapdatafile,1)
	IF RegEx("(?m)\$" + "color5\D.*$",$mapdatafile)
		$mapdatafile = RegExReplace("(?m)\$" + "color5\D.*$",$mapdatafile,"$" + "color5 = " + Quote($color5))
	ELSE
		$mapdatafile = RegExReplace("(?m)\$" + "color4\D.*$",$mapdatafile,$tmpS + $_NewLine + "$" + "color5 = " + Quote($color5))
	ENDIF
	
	$tmpS = RegExData("(?m)\$" + "color5\D.*$",$mapdatafile,1)
	IF RegEx("(?m)\$" + "color6\D.*$",$mapdatafile)
		$mapdatafile = RegExReplace("(?m)\$" + "color6\D.*$",$mapdatafile,"$" + "color6 = " + Quote($color6))
	ELSE
		$mapdatafile = RegExReplace("(?m)\$" + "color5\D.*$",$mapdatafile,$tmpS + $_NewLine + "$" + "color6 = " + Quote($color6))
	ENDIF
	
	$tmpS = RegExData("(?m)\$" + "color6\D.*$",$mapdatafile,1)
	IF RegEx("(?m)\$" + "color7\D.*$",$mapdatafile)
		$mapdatafile = RegExReplace("(?m)\$" + "color7\D.*$",$mapdatafile,"$" + "color7 = " + Quote($color7))
	ELSE
		$mapdatafile = RegExReplace("(?m)\$" + "color6\D.*$",$mapdatafile,$tmpS + $_NewLine + "$" + "color7 = " + Quote($color7))
	ENDIF
	
	$tmpS = RegExData("(?m)\$" + "color7\D.*$",$mapdatafile,1)
	IF RegEx("(?m)\$" + "color8\D.*$",$mapdatafile)
		$mapdatafile = RegExReplace("(?m)\$" + "color8\D.*$",$mapdatafile,"$" + "color8 = " + Quote($color8))
	ELSE
		$mapdatafile = RegExReplace("(?m)\$" + "color7\D.*$",$mapdatafile,$tmpS + $_NewLine + "$" + "color8 = " + Quote($color8))
	ENDIF
	
	$tmpS = RegExData("(?m)\$" + "color8\D.*$",$mapdatafile,1)
	IF RegEx("(?m)\$" + "color9\D.*$",$mapdatafile)
		$mapdatafile = RegExReplace("(?m)\$" + "color9\D.*$",$mapdatafile,"$" + "color9 = " + Quote($color9))
	ELSE
		$mapdatafile = RegExReplace("(?m)\$" + "color8\D.*$",$mapdatafile,$tmpS + $_NewLine + "$" + "color9 = " + Quote($color9))
	ENDIF
	
	$tmpS = RegExData("(?m)\$" + "color9\D.*$",$mapdatafile,1)
	IF RegEx("(?m)\$" + "color10\D.*$",$mapdatafile)
		$mapdatafile = RegExReplace("(?m)\$" + "color10\D.*$",$mapdatafile,"$" + "color10 = " + Quote($color10))
	ELSE
		$mapdatafile = RegExReplace("(?m)\$" + "color9\D.*$",$mapdatafile,$tmpS + $_NewLine + "$" + "color10 = " + Quote($color10))
	ENDIF
	
	
	$tmpS = RegExData("(?m)# Shading bands.*$",$mapdatafile,1)
	IF $MasterFile
		IF RegEx("(?m)\$" + "UseMasterFile\D.*$",$mapdatafile)
			# Do nothing
		ELSE
			$mapdatafile = RegExReplace("(?m)# Shading bands.*$",$mapdatafile,$tmpS + $_NewLine + "$" + "UseMasterFile = $" + "UseMasterFile")
		ENDIF
	ELSE
		IF RegEx("(?m)\$" + "UseMasterFile\D.*$",$mapdatafile)
			$mapdatafile = RegExReplace("(?m)\$" + "UseMasterFile\D.*$",$mapdatafile,"$" + "UseMasterFile = " + "$UseMasterFile")
		ELSE
			$mapdatafile = RegExReplace("(?m)# Shading bands.*$",$mapdatafile,$tmpS + $_NewLine + "$" + "UseMasterFile = " + "$UseMasterFile")
		ENDIF
	ENDIF
	
	$tmpS = RegExData("(?m)\$" + "UseMasterFile\D.*$",$mapdatafile,1)
	IF RegEx("(?m)\$" + "UseOverlay\D.*$",$mapdatafile)
		$mapdatafile = RegExReplace("(?m)\$" + "UseOverlay\D.*$",$mapdatafile,"$" + "UseOverlay = " + "$UseOverlay")
	ELSE
		$mapdatafile = RegExReplace("(?m)\$" + "UseMasterFile\D.*$",$mapdatafile,$tmpS + $_NewLine + "$" + "UseOverlay = " + "$UseOverlay")
	ENDIF
	
	
	$tmpS = RegExData("(?m)\$" + "UseOverlay\D.*$",$mapdatafile,1)
	IF RegEx("(?m)\$" + "UsePageBackground\D.*$",$mapdatafile)
		$mapdatafile = RegExReplace("(?m)\$" + "UsePageBackground\D.*$",$mapdatafile,"$" + "UsePageBackground = " + "$UsePageBackground")
	ELSE
		$mapdatafile = RegExReplace("(?m)\$" + "UseOverlay\D.*$",$mapdatafile,$tmpS + $_NewLine + "$" + "UsePageBackground = " + "$UsePageBackground")
	ENDIF
	
		
	$mapdatafile = RegExReplace("(?m)\$" + "MapCol4\D.*$",$mapdatafile,"$" + "MapCol4 = " + Quote($MapCol4) + " # Background color")
		
	$mapdatafile = RegExReplace("(?m)\$" + "CountryLocalName.*$",$mapdatafile,"$" + "CountryLocalName = " + Quote($CountryLocalName))
	$mapdatafile = RegExReplace("(?m)\$" + "RegionName\W.*$",$mapdatafile,"$" + "RegionName = " + Quote($RegionName))
	$mapdatafile = RegExReplace("(?m)\$" + "RegionNamePlural.*$",$mapdatafile,"$" + "RegionNamePlural = " + Quote($RegionNamePlural))
	
	$mapdatafile = RegExReplace("(?m)\$" + "MapDataSource.*$",$mapdatafile,"$" + "MapDataSource = " + Quote($MapDataSource))
			
ENDSUB

BEGINSUB Name=SetFormColors
	IF $MasterFile
		$form11 = EditForm($form11,"Groupbox6","Visible","No")
		$form11 = EditForm($form11,"Groupbox7","Visible","Yes")
	ELSE
		$form11 = EditForm($form11,"Groupbox6","Visible","Yes")
		$form11 = EditForm($form11,"Groupbox7","Visible","No")
	ENDIF
	
	IF $StateChosen = "" AND Not($MasterFile)
		$form11 = EditForm($form11,"Groupbox4","Visible","No")
		$form11 = EditForm($form11,"Groupbox3","Visible","Yes")
		$form11 = EditForm($form11,"Groupbox5","Visible","No")
		$form11 = EditForm($form11,"Groupbox6","Visible","No")
		$form11 = EditForm($form11,"Groupbox7","Visible","No")
	ELSE
		$form11 = EditForm($form11,"Groupbox4","Visible","Yes")
		$form11 = EditForm($form11,"Groupbox3","Visible","No")
		$form11 = EditForm($form11,"Groupbox5","Visible","Yes")
	ENDIF
	
	
	
	# Calculate intermediate shading values
	$BeginColor = $color1
	$EndColor = $color10
	$count = 9

	# get the decimal values of the step changes for each shade
	# Red value
	$hex=Substr($BeginColor,2,2)
	GOSUB Name=hextodec
	$begRed=$dec
	$hex=Substr($EndColor,2,2)
	GOSUB Name=hextodec
	$endRed=$dec
	$redChange = Round(($endRed - $begRed) / $count,0)

	# Green value
	$hex=Substr($BeginColor,4,2)
	GOSUB Name=hextodec
	$begGreen=$dec
	$hex=Substr($EndColor,4,2)
	GOSUB Name=hextodec
	$endGreen=$dec
	$greenChange = Round(($endGreen - $begGreen) / $count,0)

	# Blue value
	$hex=Substr($BeginColor,6,2)
	GOSUB Name=hextodec
	$begBlue=$dec
	$hex=Substr($EndColor,6,2)
	GOSUB Name=hextodec
	$endBlue=$dec
	$blueChange = Round(($endBlue - $begBlue) / $count,0)
	  
  $tmpN = 1
  $color = $color1
  GOSUB name=FillSample
  $form11 = EditForm($form11,"sample1","color",NumtoStr(RGBColor($red,$green,$blue)))
     
  $tmpN = 2
  $color = $color2
  GOSUB name=FillSample
  $form11 = EditForm($form11,"sample2","color",NumtoStr(RGBColor($red,$green,$blue)))
  
  $tmpN = 3
  $color = $color3
  GOSUB name=FillSample
  $form11 = EditForm($form11,"sample3","color",NumtoStr(RGBColor($red,$green,$blue)))
  
  $tmpN = 4
  $color = $color4
  GOSUB name=FillSample
  $form11 = EditForm($form11,"sample4","color",NumtoStr(RGBColor($red,$green,$blue)))
  
  $tmpN = 5
  $color = $color5
  GOSUB name=FillSample
  $form11 = EditForm($form11,"sample5","color",NumtoStr(RGBColor($red,$green,$blue)))
  
  $tmpN = 6
  $color = $color6
  GOSUB name=FillSample
  $form11 = EditForm($form11,"sample6","color",NumtoStr(RGBColor($red,$green,$blue)))
  
  $tmpN = 7
  $color = $color7
  GOSUB name=FillSample
  $form11 = EditForm($form11,"sample7","color",NumtoStr(RGBColor($red,$green,$blue)))
  
  $tmpN = 8
  $color = $color8
  GOSUB name=FillSample
  $form11 = EditForm($form11,"sample8","color",NumtoStr(RGBColor($red,$green,$blue)))
  
  $tmpN = 9
  $color = $color9
  GOSUB name=FillSample
  $form11 = EditForm($form11,"sample9","color",NumtoStr(RGBColor($red,$green,$blue)))
  
  $tmpN = 10
  $color = $color10
  GOSUB name=FillSample
  $form11 = EditForm($form11,"sample10","color",NumtoStr(RGBColor($red,$green,$blue)))
  
  $hex=Substr($MapCol4,2,2)
  GOSUB name=hextodec
  $red=$dec

  $hex=Substr($MapCol4,4,2)
  GOSUB name=hextodec
  $green=$dec

  $hex=Substr($MapCol4,6,2)
  GOSUB name=hextodec
  $blue=$dec
  
  $form11 = EditForm($form11,"samplebackground","color",NumtoStr(RGBColor($red,$green,$blue)))

ENDSUB #SetFormColors

BEGINSUB name=FillSample
	$tmpN = $tmpN - 1
	IF len($color) = 0
		$red=$begRed+($redChange*$tmpN)
		$blue=$begBlue+($blueChange*$tmpN)
		$green=$begGreen+($greenChange*$tmpN)
	ELSE
		$hex=Substr($color,2,2)
		GOSUB name=hextodec
		$red=$dec

		$hex=Substr($color,4,2)
		GOSUB name=hextodec
		$green=$dec

		$hex=Substr($color,6,2)
		GOSUB name=hextodec
		$blue=$dec
	ENDIF
ENDSUB # Fillsample

BEGINSUB Name=hextodec
	# assumes variables $hex and $dec are already defined in the macro
	# $hex should be set before subroutine is called
	# $dec is set by the subroutine

	$HTDSUBnumDigits=len($hex)

	IF $HTDSUBnumDigits = 0
		$dec=-1 # an error condition. no hex characters were passed
	ELSE
		$hex=Upper($hex)
		$dec=0
		$HTDSUBhexcodes="0123456789ABCDEF"
		$HTDSUBcounter=1
		WHILE $HTDSUBcounter <= $HTDSUBnumDigits
			$dec=16*$dec + (AT(Substr($hex, $HTDSUBcounter, 1), $HTDSUBhexcodes)-1)
			$HTDSUBcounter = $HTDSUBcounter + 1
		ENDWHILE
	ENDIF
ENDSUB #hextodec

BEGINSUB name=dectohex
	# Takes input from 0-255 as a decimal number in $dec
	# and returns it as a two character hex string in $hex

	$hexlookup="0123456789ABCDEF"
	$c_d = Int($dec)
	$c_q = Int($c_d/16)
	$c_r = $c_d - ($c_q*16)
	$hex = SubStr($hexlookup,$c_q+1,1) + SubStr($hexlookup,$c_r+1,1)
ENDSUB

BEGINSUB Name=Australia
	# Display a map showing finds by State in Australia
	# Initialise Section variables
	$colspan = 1
	SHOWSTATUS msg="$LangStatus31" Width=350
	
	$_sql = "Drop table if exists Countries"
	$status = Sqlite("sql",$_sql,"")

	# Create Countries table 1;AW;Aruba
	$Data = "id text,state text,name text"
	$_sql = "CREATE TABLE Countries ($Data)"
	$status = Sqlite("sql",$_sql,"")

	# Import the master list of States to the SQL table
	$status = sqlite("import",AllTrim($AustraliaSQL),"table=Countries")
	

$_sql = "select avg(length(state)) from allfinds where country = 'Australia'"
	$tmpN1 = Val(Sqlite("sql",$_sql))

	# Exclude locationless?
	IF $Excludelocationless
		$Locationless = " AND Cachetype <>'L' AND Exclude <> '1'"
	ELSE
		$Locationless = ""
	ENDIF

	IF $tmpN1 > 3
		$_sql = "SELECT id FROM countries WHERE countries.name IN (select state from allfinds WHERE country= 'Australia' $Locationless group by state) order by countries.name"
	ELSE
		$_sql = "SELECT id FROM countries WHERE countries.state IN (select state from allfinds WHERE country= 'Australia' $Locationless group by state) order by countries.state"
	ENDIF
			
	$status = Sqlite("sql",$_sql)
	$polygons = Replace($_NewLine,",",$status)
	
	$UseMasterFile = FALSE
	$UsePageBackground = FALSE
	$UseOverlay = TRUE
	
	$FileName = "FindStatGenMap_AustraliaStateShadingFile.dat"
	$tmpS = SysInfo("MacroPath") + "\" + $FileName
	IF (FileExists($tmpS))
		MACRO File=$tmpS
	ELSE
		$tmpS = SysInfo("MacroPath") + "\FindStatGenData\" + $FileName
		IF (FileExists($tmpS))
			MACRO File=$tmpS
		ELSE
			MSGOK msg="Sorry, I cannot find the Australia State Map Shading file $tmpS"
		ENDIF
	ENDIF

	GOSUB name=MapShading
	
	IF $tmpN1 > 3	
		$_sql = "SELECT $_sql FROM (SELECT count(*) cnt from allfinds WHERE country = 'Australia' AND state in (SELECT name from countries) $Locationless group by state order by state)"
	ELSE
		$_sql = "SELECT $_sql FROM (SELECT count(*) cnt from allfinds WHERE country = 'Australia' AND state in (SELECT state from countries) $Locationless group by state order by state)"
	ENDIF
		
	$status = Sqlite("sql",$_sql)
	$colors = Replace($_NewLine,"",$status)

	#MSGOK msg=$shades ; $colors


	#Make best guess at OwnerID
	$_sql = "SELECT lOwnerid FROM (SELECT lOwnerid, Count(lOwnerID) AS c FROM Allfinds GROUP BY lownerid ORDER BY c DESC LIMIT 1)"
	$OwnerID = Sqlite("sql",$_sql)

	# Background color
	#$MapCol4 = "93CEED"
	$Mapcol4 = Substr($MapCol4,2,6)
	
	$URL = "http://gsak.net/stats/polymaps/australiastatemapshaded.php"
	$PostData = "'id','$polygons','name','$OwnerID','settings','$Settings','color2','$MapCol4','col1','$shades','s','$colors','over','$UseOverlay'"
	
	#CLIP data=$PostData
	#CANCEL
	
	$result = PostUrl($url,$PostData)

	#MSGOK msg=$result
	
	$tmpN=Random(0)
	$tmpS = Remove("$tmpN",".0","C")

	$url = "http://gsak.net/stats/polymaps/australiastatemaps/" + $OwnerID + "_" + "$Settings" + ".png" + "?" + $tmpS
	

	IF $ExcludeLocationLess
		$_sql = "SELECT count(Code) from AllFinds WHERE country = 'Australia' AND CacheType <>'L' and Exclude <> '1'"
	ELSE
		$_sql = "SELECT count(Code) from AllFinds WHERE country = 'Australia'"
	ENDIF

	$australiatotal = val(Sqlite("sql",$_sql))


	IF $tmpN1 > 3
		IF $ExcludeLocationLess
			$_sql = "SELECT count(Code) as n, allfinds.state, countries.state from AllFinds, countries on allfinds.state = countries.name WHERE country = 'Australia' AND CacheType <>'L' and Exclude <> '1' GROUP BY allfinds.state ORDER BY n DESC, allfinds.state"
		ELSE
			$_sql = "SELECT count(Code) as n, allfinds.state, countries.state from AllFinds, countries on allfinds.state = countries.name WHERE country = 'Australia' GROUP BY allfinds.state ORDER BY n DESC, allfinds.state"
		ENDIF
	ELSE
		IF $ExcludeLocationLess
			$_sql = "SELECT count(Code) as n, allfinds.state, countries.state from AllFinds, countries on allfinds.state = countries.state WHERE country = 'Australia' AND CacheType <>'L' and Exclude <> '1' GROUP BY allfinds.state ORDER BY n DESC, allfinds.state"
		ELSE
			$_sql = "SELECT count(Code) as n, allfinds.state, countries.state from AllFinds, countries on allfinds.state = countries.state WHERE country = 'Australia' GROUP BY allfinds.state ORDER BY n DESC, allfinds.state"
		ENDIF
	ENDIF
	$work = Sqlite("sql",$_sql)
	$list = list("sql","replace",$work)
	$tmpM = $_SqlRows # Number of Countries
	
	$count = 0

	$tmpN = 1
	$MapList = ""
	WHILE $tmpN <= $tmpM
		$list = List("sql","item","$tmpN")
		$State = Extract($list,";",2)
		$work = Extract($list,";",1)
		$count = $count + 1
		$tmpS = "<nobr><img style='align:top; margin:1px;' src='" + $ImageURL + "flags/australia/" + Left(Extract($list,";",3),2) + ".gif'/>"
		$MapList = $MapList + $tmpS + "&nbsp;" + Replace(" ","&nbsp;",$State,TRUE) + ":$work</nobr>"
			IF $tmpN < $tmpM
				$MapList = $MapList + ", "
			ENDIF
		$tmpN = $tmpN + 1
	ENDWHILE

	IF $count>1
		$s = "$Lang44b"
	ELSE
		$s = "$Lang44a"
	ENDIF
	
	$tmpN = Round(100*$count/8,1)
	$text = "Australia - $australiatotal $Lang43 $count $s"
	GOSUB name=SectionHead
	
	IF Val(List("breaks","count","")) <=2
		$legendTable = ""
	ENDIF

	$out = AddStr(1,"add","<div style='align: center;'>")
	$out = AddStr(1,"add","<img height='400' width='740' src='$URL' ")
	$out = AddStr(1,"add","alt='Australian States cached in' /><br />$legendTable</div><br /><div style='$stSmall'>")
	
	$out = AddStr(1,"add","<div style='width: 600px; margin:0px;'><i>$MapList</i></div>")
	IF $excludeLocationLess = true
		$out = AddStr(1,"add","<i>$Lang38a</i>")
	ENDIF
	$out = AddStr(1,"add","</div>")
ENDSUB # Australia


BEGINSUB Name=Province
	# Display a map showing finds by Province in Canada
	# Initialise Section variables
	$colspan = 1
	SHOWSTATUS msg="$LangStatus33" Width=350
	
	$_sql = "Drop table if exists Countries"
	$status = Sqlite("sql",$_sql,"")

	# Create Countries table 1;AW;Aruba
	$Data = "id text,state text,name text"
	$_sql = "CREATE TABLE Countries ($Data)"
	$status = Sqlite("sql",$_sql,"")

	# Import the master list of Provinces to the SQL table
	$status = sqlite("import",AllTrim($ProvincesSQL),"table=Countries")
	

$_sql = "select avg(length(state)) from allfinds where country = 'Canada'"
	$tmpN1 = Val(Sqlite("sql",$_sql))

	# Exclude locationless?
	IF $Excludelocationless
		$Locationless = " AND Cachetype <>'L' AND Exclude <> '1'"
	ELSE
		$Locationless = ""
	ENDIF

	IF $tmpN1 > 3
		$_sql = "SELECT id FROM countries WHERE countries.name IN (select state from allfinds WHERE country= 'Canada' $Locationless group by state) order by countries.name"
	ELSE
		$_sql = "SELECT id FROM countries WHERE countries.state IN (select state from allfinds WHERE country= 'Canada' $Locationless group by state) order by countries.state"
	ENDIF
			
	$status = Sqlite("sql",$_sql)
	$polygons = Replace($_NewLine,",",$status)
	
	$UseMasterFile = FALSE
	$UsePageBackground = FALSE
	$UseOverlay = TRUE
	
	$FileName = "FindStatGenMap_CanadaCountryShadingFile.dat"
	$tmpS = SysInfo("MacroPath") + "\" + $FileName
	IF (FileExists($tmpS))
		MACRO File=$tmpS
	ELSE
		$tmpS = SysInfo("MacroPath") + "\FindStatGenData\" + $FileName
		IF (FileExists($tmpS))
			MACRO File=$tmpS
		ELSE
			MSGOK msg="Sorry, I cannot find the Canada Country Map Shading file $tmpS"
		ENDIF
	ENDIF

	GOSUB name=MapShading
	
	IF $tmpN1 > 3	
		$_sql = "SELECT $_sql FROM (SELECT count(*) cnt from allfinds WHERE country = 'Canada' AND state in (SELECT name from countries) $Locationless group by state order by state)"
	ELSE
		$_sql = "SELECT $_sql FROM (SELECT count(*) cnt from allfinds WHERE country = 'Canada' AND state in (SELECT state from countries) $Locationless group by state order by state)"
	ENDIF
		
	$status = Sqlite("sql",$_sql)
	$colors = Replace($_NewLine,"",$status)

	#MSGOK msg=$shades ; $colors


	#Make best guess at OwnerID
	$_sql = "SELECT lOwnerid FROM (SELECT lOwnerid, Count(lOwnerID) AS c FROM Allfinds GROUP BY lownerid ORDER BY c DESC LIMIT 1)"
	$OwnerID = Sqlite("sql",$_sql)

	# Background color
	#$MapCol4 = "93CEED"
	$Mapcol4 = Substr($MapCol4,2,6)
	
	$URL = "http://gsak.net/stats/polymaps/canadamapshaded.php"
	$PostData = "'id','$polygons','name','$OwnerID','settings','$Settings','color2','$MapCol4','col1','$shades','s','$colors','over','$UseOverlay'"
	
	#CLIP data=$PostData
	#CANCEL
	
	$result = PostUrl($url,$PostData)

	#MSGOK msg=$result
	
	$tmpN=Random(0)
	$tmpS = Remove("$tmpN",".0","C")

	$url = "http://gsak.net/stats/polymaps/canadamaps/" + $OwnerID + "_" + "$Settings" + ".png" + "?" + $tmpS
	

	IF $ExcludeLocationLess
		$_sql = "SELECT count(Code) from AllFinds WHERE country = 'Canada' AND CacheType <>'L' and Exclude <> '1'"
	ELSE
		$_sql = "SELECT count(Code) from AllFinds WHERE country = 'Canada'"
	ENDIF

	$canadatotal = val(Sqlite("sql",$_sql))


	IF $tmpN1 > 3
		IF $ExcludeLocationLess
			$_sql = "SELECT count(Code) as n, allfinds.state, countries.state from AllFinds, countries on allfinds.state = countries.name WHERE country = 'Canada' AND CacheType <>'L' and Exclude <> '1' GROUP BY allfinds.state ORDER BY n DESC, allfinds.state"
		ELSE
			$_sql = "SELECT count(Code) as n, allfinds.state, countries.state from AllFinds, countries on allfinds.state = countries.name WHERE country = 'Canada' GROUP BY allfinds.state ORDER BY n DESC, allfinds.state"
		ENDIF
	ELSE
		IF $ExcludeLocationLess
			$_sql = "SELECT count(Code) as n, allfinds.state, countries.state from AllFinds, countries on allfinds.state = countries.state WHERE country = 'Canada' AND CacheType <>'L' and Exclude <> '1' GROUP BY allfinds.state ORDER BY n DESC, allfinds.state"
		ELSE
			$_sql = "SELECT count(Code) as n, allfinds.state, countries.state from AllFinds, countries on allfinds.state = countries.state WHERE country = 'Canada' GROUP BY allfinds.state ORDER BY n DESC, allfinds.state"
		ENDIF
	ENDIF
	$work = Sqlite("sql",$_sql)
	$list = list("sql","replace",$work)
	$tmpM = $_SqlRows # Number of Countries
	
	$count = 0

	$tmpN = 1
	$MapList = ""
	WHILE $tmpN <= $tmpM
		$list = List("sql","item","$tmpN")
		$State = Extract($list,";",2)
		$work = Extract($list,";",1)
		$count = $count + 1
		$tmpS = "<nobr><img style='align:top; margin:1px;' src='" + $ImageURL + "flags/provinces/" + Extract($list,";",3) + ".gif'/>"
		$MapList = $MapList + $tmpS + "&nbsp;" + Replace(" ","&nbsp;",$State,TRUE) + ":$work</nobr>"
			IF $tmpN < $tmpM
				$MapList = $MapList + ", "
			ENDIF
		$tmpN = $tmpN + 1
	ENDWHILE

	IF $count>1
		$s = "$Lang46b"
	ELSE
		$s = "$Lang46a"
	ENDIF
	
	$tmpN = Round(100*$count/13,1)
	$text = "$Lang110 - $canadatotal $Lang43 $count $s - ($tmpN%)"
	GOSUB name=SectionHead
	
	IF Val(List("breaks","count","")) <=2
		$legendTable = ""
	ENDIF

	$out = AddStr(1,"add","<div style='align: center;'>")
	$out = AddStr(1,"add","<img height='400' width='740' src='$URL' ")
	$out = AddStr(1,"add","alt='Canadian Provinces cached in' /><br />$legendTable</div><br /><div style='$stSmall'>")

	$out = AddStr(1,"add","<div style='width: 600px; margin:0px;'><i>$MapList</i></div>")
	IF $excludeLocationLess = true
		$out = AddStr(1,"add","<i>$Lang38a</i>")
	ENDIF
	$out = AddStr(1,"add","</div>")
ENDSUB # Province



BEGINSUB Name=Countries
	# Display a map showing finds by Country
	# Initialise Section variables
	$colspan = 1
	SHOWSTATUS msg="$LangStatus34" Width=350
	
	$_sql = "Drop table if exists Countries"
	$status = Sqlite("sql",$_sql,"")

	# Create Countries table 1;AW;Aruba
	$Data = "id text,state text,name text"
	$_sql = "CREATE TABLE Countries ($Data)"
	$status = Sqlite("sql",$_sql,"")

	# Import the master list of Countries to the SQL table
	$status = sqlite("import",AllTrim($CountriesSQL),"table=Countries")


	# Exclude locationless?
	IF $Excludelocationless
		$Locationless = " AND Cachetype <>'L' AND Exclude <> '1'"
	ELSE
		$Locationless = ""
	ENDIF
		
	$_sql = "SELECT id FROM countries WHERE countries.name IN (select country from allfinds WHERE 1 $Locationless group by country) order by countries.name"	
	$status = Sqlite("sql",$_sql)
	$polygons = Replace($_NewLine,",",$status)
	
	$UseMasterFile = FALSE
	$UsePageBackground = FALSE
	$UseOverlay = TRUE
	
	$FileName = "FindStatGenMap_WorldCountryShadingFile.dat"
	$tmpS = SysInfo("MacroPath") + "\" + $FileName
	IF (FileExists($tmpS))
		MACRO File=$tmpS
	ELSE
		$tmpS = SysInfo("MacroPath") + "\FindStatGenData\" + $FileName
		IF (FileExists($tmpS))
			MACRO File=$tmpS
		ELSE
			MSGOK msg="Sorry, I cannot find the World Country Map Shading file $tmpS"
		ENDIF
	ENDIF

	GOSUB name=MapShading
		
	$_sql = "SELECT $_sql FROM (SELECT count(*) cnt from allfinds  WHERE country in (select name from countries) $Locationless group by country order by country)"
	$status = Sqlite("sql",$_sql)
	$colors = Replace($_NewLine,"",$status)

	#MSGOK msg=$shades ; $colors


	#Make best guess at OwnerID
	$_sql = "SELECT lOwnerid FROM (SELECT lOwnerid, Count(lOwnerID) AS c FROM Allfinds GROUP BY lownerid ORDER BY c DESC LIMIT 1)"
	$OwnerID = Sqlite("sql",$_sql)

	# Background color
	#$MapCol4 = "93CEED"
	$Mapcol4 = Substr($MapCol4,2,6)
	
	$URL = "http://gsak.net/stats/polymaps/worldmapshaded.php"
	$PostData = "'id','$polygons','name','$OwnerID','settings','$Settings','color2','$MapCol4','col1','$shades','s','$colors','over','$UseOverlay'"
	
	#CLIP data=$PostData
	#CANCEL
	
	$result = PostUrl($url,$PostData)

	#MSGOK msg=$result
	
	$tmpN=Random(0)
	$tmpS = Remove("$tmpN",".0","C")

	$url = "http://gsak.net/stats/polymaps/worldmaps/" + $OwnerID + "_" + "$Settings" + ".png" + "?" + $tmpS
	

	IF $ExcludeLocationLess
		$_sql = "SELECT count(Code) from AllFinds WHERE CacheType <>'L' and Exclude <> '1'"
	ELSE
		$_sql = "SELECT count(Code) from AllFinds"
	ENDIF

	$worldtotal = val(Sqlite("sql",$_sql))

	IF $ExcludeLocationLess
		$_sql = "SELECT count(Code) as n, Country, countries.state from AllFinds, countries on allfinds.country = countries.name WHERE CacheType <>'L' and Exclude <> '1' GROUP BY Country ORDER BY n DESC, country"
	ELSE
		$_sql = "SELECT count(Code) as n, Country, countries.state from AllFinds, countries on allfinds.country = countries.name GROUP BY Country ORDER BY n DESC, country"
	ENDIF
	$work = Sqlite("sql",$_sql)
	$list = list("sql","replace",$work)
	$tmpM = $_SqlRows # Number of Countries
	
	$count = 0

	$tmpN = 1
	$MapList = ""
	WHILE $tmpN <= $tmpM
		$list = List("sql","item","$tmpN")
		$State = Extract($list,";",2)
		$work = Extract($list,";",1)
		$count = $count + 1
		$tmpS = "<nobr><img style='align:top; margin:1px;' src='" + $ImageURL + "flags/" + Extract($list,";",3) + ".gif'/>"
		$MapList = $MapList + $tmpS + "&nbsp;" + Replace(" ","&nbsp;",$State,TRUE) + ":$work</nobr>"
			IF $tmpN < $tmpM
				$MapList = $MapList + ", "
			ENDIF
		$tmpN = $tmpN + 1
	ENDWHILE

	IF $count>1
		$s = "$Lang48"
	ELSE
		$s = "$Lang49"
	ENDIF
	$text = "$Lang47 - $worldtotal $Lang43 $count $s"
	GOSUB name=SectionHead
	
	IF Val(List("breaks","count","")) <=2
		$legendTable = ""
	ENDIF

	$out = AddStr(1,"add","<div style='align: center;'>")
	$out = AddStr(1,"add","<img height='462' width='740' src='$URL' ")
	$out = AddStr(1,"add","alt='Countries cached in' /><br />$legendTable</div><br /><div style='$stSmall'>")

	$out = AddStr(1,"add","<div style='width: 600px; margin:0px;'><i>$MapList</i></div>")
	IF $excludeLocationLess = true
		$out = AddStr(1,"add","<i>$Lang38a</i>")
	ENDIF
	$out = AddStr(1,"add","</div>")
ENDSUB # Countries


BEGINSUB Name=Europe
	# Display a map showing finds by Country in Europe
	# Initialise Section variables
	$colspan = 1
	SHOWSTATUS msg="$LangStatus35" Width=350
	
	$_sql = "Drop table if exists Countries"
	$status = Sqlite("sql",$_sql,"")

	# Create Countries table 1;AW;Aruba
	$Data = "id text,state text,name text"
	$_sql = "CREATE TABLE Countries ($Data)"
	$status = Sqlite("sql",$_sql,"")

	# Import the master list of Countries to the SQL table
	$status = sqlite("import",AllTrim($CountriesSQL),"table=Countries")

	$EuropeCountries = "'Aland Islands','Albania','Andorra','Armenia','Austria','Azerbaijan','Belarus','Belgium','Bosnia and Herzegovina','Bulgaria','Croatia','Cyprus','Czech Republic','Denmark','Estonia','Faroe Islands','Finland','France','Georgia','Germany','Gibraltar','Greece','Guernsey','Hungary','Iceland','Ireland','Isle of Man','Italy','Jersey','Kazakhstan','Kosovo','Latvia','Liechtenstein','Lithuania','Luxembourg','Macedonia','Malta','Moldova','Monaco','Montenegro','Netherlands','Norway','Poland','Portugal','Romania','Russia','San Marino','Serbia','Slovakia','Slovenia','Spain','Svalbard and Jan Mayen','Sweden','Switzerland','Turkey','Ukraine','United Kingdom','Vatican City State'"

	# Exclude locationless?
	IF $Excludelocationless
		$Locationless = " AND Cachetype <>'L' AND Exclude <> '1'"
	ELSE
		$Locationless = ""
	ENDIF
		
	$_sql = "SELECT id FROM countries WHERE countries.name IN (select country from allfinds WHERE country in ($EuropeCountries) $Locationless group by country) order by countries.name"
	$status = Sqlite("sql",$_sql)
	$polygons = Replace($_NewLine,",",$status)
	
	$UseMasterFile = FALSE
	$UsePageBackground = FALSE
	$UseOverlay = TRUE
	
	$FileName = "FindStatGenMap_EuropeCountryShadingFile.dat"
	$tmpS = SysInfo("MacroPath") + "\" + $FileName
	IF (FileExists($tmpS))
		MACRO File=$tmpS
	ELSE
		$tmpS = SysInfo("MacroPath") + "\FindStatGenData\" + $FileName
		IF (FileExists($tmpS))
			MACRO File=$tmpS
		ELSE
			MSGOK msg="Sorry, I cannot find the Europe Country Map Shading file $tmpS"
		ENDIF
	ENDIF

	GOSUB name=MapShading
		
	$_sql = "SELECT $_sql FROM (SELECT count(*) cnt from allfinds WHERE country in ($EuropeCountries) $Locationless group by country order by country)"
	$status = Sqlite("sql",$_sql)
	$colors = Replace($_NewLine,"",$status)

	#MSGOK msg=$shades ; $colors


	#Make best guess at OwnerID
	$_sql = "SELECT lOwnerid FROM (SELECT lOwnerid, Count(lOwnerID) AS c FROM Allfinds GROUP BY lownerid ORDER BY c DESC LIMIT 1)"
	$OwnerID = Sqlite("sql",$_sql)

	# Background color
	#$MapCol4 = "93CEED"
	$Mapcol4 = Substr($MapCol4,2,6)
	
	$URL = "http://gsak.net/stats/polymaps/europemapshaded.php"
	$PostData = "'id','$polygons','name','$OwnerID','settings','$Settings','color2','$MapCol4','col1','$shades','s','$colors','over','$UseOverlay'"
	
	#CLIP data=$PostData
	#CANCEL
	
	$result = PostUrl($url,$PostData)

	#MSGOK msg=$result
	
	$tmpN=Random(0)
	$tmpS = Remove("$tmpN",".0","C")

	$url = "http://gsak.net/stats/polymaps/europemaps/" + $OwnerID + "_" + "$Settings" + ".png" + "?" + $tmpS
	

	IF $ExcludeLocationLess
		$_sql = "SELECT count(Code) from AllFinds WHERE country in ($EuropeCountries) AND CacheType <>'L' and Exclude <> '1'"
	ELSE
		$_sql = "SELECT count(Code) from AllFinds WHERE country in ($EuropeCountries)"
	ENDIF

	$europetotal = val(Sqlite("sql",$_sql))

	IF $ExcludeLocationLess
		$_sql = "SELECT count(Code) as n, Country, countries.state from AllFinds, countries on allfinds.country = countries.name WHERE country in ($EuropeCountries) AND CacheType <>'L' and Exclude <> '1' GROUP BY Country ORDER BY n DESC, country"
	ELSE
		$_sql = "SELECT count(Code) as n, Country, countries.state from AllFinds, countries on allfinds.country = countries.name WHERE country in ($EuropeCountries) GROUP BY Country ORDER BY n DESC, country"
	ENDIF
	$work = Sqlite("sql",$_sql)
	$list = list("sql","replace",$work)
	$tmpM = $_SqlRows # Number of Countries
	
	$count = 0

	$tmpN = 1
	$MapList = ""
	WHILE $tmpN <= $tmpM
		$list = List("sql","item","$tmpN")
		$State = Extract($list,";",2)
		$work = Extract($list,";",1)
		$count = $count + 1
		$tmpS = "<nobr><img style='align:top; margin:1px;' src='" + $ImageURL + "flags/" + Extract($list,";",3) + ".gif'/>"
		$MapList = $MapList + $tmpS + "&nbsp;" + Replace(" ","&nbsp;",$State,TRUE) + ":$work</nobr>"
			IF $tmpN < $tmpM
				$MapList = $MapList + ", "
			ENDIF
		$tmpN = $tmpN + 1
	ENDWHILE

	IF $count>1
		$s = "$Lang48"
	ELSE
		$s = "$Lang49"
	ENDIF
	$text = "$Lang109 - $europetotal $Lang43 $count $s"
	GOSUB name=SectionHead
	
	IF Val(List("breaks","count","")) <=2
		$legendTable = ""
	ENDIF

	$out = AddStr(1,"add","<div style='align: center;'>")
	$out = AddStr(1,"add","<img height='480' width='700' src='$URL' ")
	$out = AddStr(1,"add","alt='European Countries cached in' /><br />$legendTable</div><br /><div style='$stSmall'>")

	$out = AddStr(1,"add","<div style='width: 600px; margin:0px;'><i>$MapList</i></div>")
	IF $excludeLocationLess = true
		$out = AddStr(1,"add","<i>$Lang38a</i>")
	ENDIF
	$out = AddStr(1,"add","</div>")
ENDSUB # Europe

BEGINSUB Name=GoogleEurope
	# Display a Google map showing finds by Country in Europe
	# Initialise Section variables
	$colspan = 1
	SHOWSTATUS msg="$LangStatus35" Width=350
	
	$_sql = "Drop table if exists Countries"
	$status = Sqlite("sql",$_sql,"")

	# Create Countries table 1;AW;Aruba
	$Data = "id text,state text,name text"
	$_sql = "CREATE TABLE Countries ($Data)"
	$status = Sqlite("sql",$_sql,"")

	# Import the master list of Countries to the SQL table
	$status = sqlite("import",AllTrim($CountriesSQL),"table=Countries")

	$EuropeCountries = "'Aland Islands','Albania','Andorra','Armenia','Austria','Azerbaijan','Belarus','Belgium','Bosnia and Herzegovina','Bulgaria','Croatia','Cyprus','Czech Republic','Denmark','Estonia','Faroe Islands','Finland','France','Georgia','Germany','Gibraltar','Greece','Guernsey','Hungary','Iceland','Ireland','Isle of Man','Italy','Jersey','Kazakhstan','Kosovo','Latvia','Liechtenstein','Lithuania','Luxembourg','Macedonia','Malta','Moldova','Monaco','Montenegro','Netherlands','Norway','Poland','Portugal','Romania','Russia','San Marino','Serbia','Slovakia','Slovenia','Spain','Svalbard and Jan Mayen','Sweden','Switzerland','Turkey','Ukraine','United Kingdom','Vatican City State'"

	# Exclude locationless?
	IF $Excludelocationless
		$Locationless = " AND Cachetype <>'L' AND Exclude <> '1'"
	ELSE
		$Locationless = ""
	ENDIF
	
	
	$_sql = "SELECT count(*), (select state from countries where name = country) from allfinds WHERE country in ($EuropeCountries) $Locationless group by country order by country"
	$status = Sqlite("sql",$_sql)
	
	
	$UseMasterFile = FALSE
	$UsePageBackground = FALSE
	$UseOverlay = TRUE
	

	#MSGOK msg=$shades ; $colors
	
	$count = $_sqlrows
	$text1 = ""
	$text2 = ""
	$tmpN = 0
	# Build strings
	# $text1 = country abbreviations pipe separated
	# $text2 = find count fAbbreviation+count,000000,0,0,10
	WHILE $tmpN <= $count
		$line = Extract($status, $_NewLine, $tmpN)
		$text3 = Extract($line,";",2)
		IF $text3 = "UK"
			$text3 = "GB"
		ENDIF
		$tmpN1 = $tmpN - 1
		IF $tmpN = 1
			$text1 = $text3
			$text2 = "f" + $text3 + "+" + Extract($line,";",1) + ",000000,0," + "$tmpN1" +",10"
		ELSE
			$text1 = $text1 + "|" + $text3
			$text2 = $text2 + "|f" + $text3 + "+" + Extract($line,";",1) + ",000000,0," + "$tmpN1" +",10"
		ENDIF
		$tmpN = $tmpN + 1
	ENDWHILE
	
	#https://chart.googleapis.com/chart?cht=map:fixed=34,-24,71,50&chs=600x500&chld=GB|CY|MT|AZ|SE|IS|NO&chco=a0a0a0|FF0000&chtt=Europe&chm=f23,000000,0,0,10
	$URL = "https://chart.googleapis.com/chart?cht=map:fixed=34,-24,71,50&chs=600x500&chld="
	$URL = $URL + $text1 + "&chco=a0a0a0|FF0000&chtt=Europe&chm=" + $text2

	

	# Background color
	#$MapCol4 = "93CEED"
	$Mapcol4 = Substr($MapCol4,2,6)
		
	#CANCEL
	
	$result = PostUrl($url,$PostData)

	#MSGOK msg=$result
		

	IF $ExcludeLocationLess
		$_sql = "SELECT count(Code) from AllFinds WHERE country in ($EuropeCountries) AND CacheType <>'L' and Exclude <> '1'"
	ELSE
		$_sql = "SELECT count(Code) from AllFinds WHERE country in ($EuropeCountries)"
	ENDIF

	$europetotal = val(Sqlite("sql",$_sql))

	IF $ExcludeLocationLess
		$_sql = "SELECT count(Code) as n, Country, countries.state from AllFinds, countries on allfinds.country = countries.name WHERE country in ($EuropeCountries) AND CacheType <>'L' and Exclude <> '1' GROUP BY Country ORDER BY n DESC, country"
	ELSE
		$_sql = "SELECT count(Code) as n, Country, countries.state from AllFinds, countries on allfinds.country = countries.name WHERE country in ($EuropeCountries) GROUP BY Country ORDER BY n DESC, country"
	ENDIF
	$work = Sqlite("sql",$_sql)
	$list = list("sql","replace",$work)
	$count = $_SqlRows # Number of Countries
	
	IF $count>1
		$s = "$Lang48"
	ELSE
		$s = "$Lang49"
	ENDIF
	$text = "$Lang109 - $europetotal $Lang43 $count $s"
	GOSUB name=SectionHead

	$out = AddStr(1,"add","<div style='align: center;'>")
	$out = AddStr(1,"add","<img height='500' width='600' src='$URL' ")
	$out = AddStr(1,"add","alt='European Countries cached in' /><br /></div><br /><div style='$stSmall'>")
	IF $excludeLocationLess = true
		$out = AddStr(1,"add","<i>$Lang38a</i>")
	ENDIF
	$out = AddStr(1,"add","</div>")
ENDSUB # GoogleEurope

BEGINSUB name=USAMapText
	$Xstates = "76,405,357,199,250,128,537,508,508,449,434,31,175,384,409,347,306,422,362,551,507,546,421,340,380,356,217,297,156,549,519,244,500,472,290,438,319,124,481,543,456,294,410,303,198,522,475,128,454,380,233"
	$Ystates =   "246,163,150,153,116,133,100,116,132,204,166,184,80,108,105,91,121,125,184,60,124,84,77,55,166,120,48,95,114,76,108,151,77,142,43,102,145,78,96,92,156,69,139,176,116,58,125,47,117,70,83"
	$ColorStates = "0,0,0,0,0,0,1,1,1,0,0,-.1,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,.1,0,0,0,0,0"
	$NameStates = $States
	$Country ="United States"
	$xMap = 580
	$yMap = 300
	$xOffset = -290
	$yOffset = 0
	$MapCol1 = "#FFFF00"
	$MapCol2 = "#202020"
	$xFillState = ""
	$yFillState = ""
	GOSUB name=addTextToMap
	$out = AddStr(1,"add",$numbertext)
ENDSUB #USAMapText

BEGINSUB name=EuropeMapText
	$AllStates = "AL,AN,AR,AU,AX,AZ,BE,BH,BL,BU,CR,CY,CZ,DK,GB,EE,FI,FR,GE,GG,GI,GR,HU,IC,IE,IT,LE,LI,LT,LU,MA,MC,ML,MO,NL,NO,PO,PT,RO,RU,SA,SE,SL,SM,ES,SV,SW,TU,UK,VC,ME,SP,IM,JE,GN"
	$Xstates = "350,213,529,311,360,555,241,329,406,396,323,448,313,273,193,392,387,213,278,520,170,368,347,70,145,312,392,379,274,249,364,258,317,418,245,271,339,137,383,518,298,317,312,356,168,346,267,455,446,286,342,356,170,170,170"
	$Ystates =   "246,230,250,190,98,246,167,216,142,228,208,289,174,124,151,104,78,193,163,233,280,261,196,59,150,240,114,130,204,175,235,225,288,191,155,87,154,255,207,99,219,96,200,220,245,183,196,261,178,234,230,220,145,175,185"
	$ColorStates = "0,0,0,0,-1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,-1,0,0,1,0,0,0,0,0,0,0,0,-1,0,0,-1,-1,-1"
	$NameStates = $Europe
	$Country ="Europe"
	$xMap = 580
	$yMap = 300
	$xOffset = -290
	$yOffset = 0
	$MapCol1 = "#FFFF00"
	$MapCol2 = "#202020"
	$xFillState = ""
	$yFillState = ""
	GOSUB name=addTextToMap
	$out = AddStr(1,"add",$numbertext)
ENDSUB #EuropeText

BEGINSUB name=CanadaMapText
	$AllStates = "AL,BC,MA,NB,NL,NT,NS,NU,ON,PE,QU,SA,YU"
	$Xstates = "190,131,300,488,520,144,510,294,365,510,454,245,55"
	$Ystates = "204,204,204,248,206,148,267,137,224,245,207,204,154"
	$ColorStates = "0,0,0,0,0,0,1,0,0,0.1,0,0,0"
	$NameStates = $Provinces
	$Country ="Canada"
	$xMap = 580
	$yMap = 300
	$xOffset = -290
	$yOffset = 0
	$MapCol1 = "#FFFF00"
	$MapCol2 = "#202020"
	$xFillState = ""
	$yFillState = ""
	GOSUB name=addTextToMap
	$out = AddStr(1,"add",$numbertext)
ENDSUB #CanadaMapText

BEGINSUB name=AddTextToMap
	$xFill = ""
	$yFill = ""
	$numbertext = ""

	#Strip off the end of the URL after the =
	$StateList = Extract($URL,"=",2)
	$StateNum = Len($StateList)/2

	#	MSGOK msg="$StateNum, $StateList"

	$numbertext = $numbertext + "<div style='font: Bold 7pt Verdana, Arial, sans-serif; line-height: 1em; height: 1em; width: 16em;'> $_Newline"
	$numbertext = $numbertext + "<div style='margin-top:0.5em;position: relative;'></div> $_Newline"
	$count = 0
	WHILE $count < $StateNum
		# Get number of caches in this state
		$j = 1 + $count
		$ThisState = Extract($ListStates,",",$j)
		$ThisState = Replace("'","''",$ThisState)
		
		IF $country = "Europe"
			IF $ExcludeLocationLess
				$_sql = "SELECT count(Code) from AllFinds WHERE Country='$ThisState' and CacheType <>'L' and Exclude <> '1'"
			ELSE
				$_sql = "SELECT count(Code) from AllFinds WHERE Country='$ThisState'"
			ENDIF
		ELSE
			IF $ExcludeLocationLess
				$_sql = "SELECT count(Code) from AllFinds WHERE Country='$Country' and State='$ThisState' and CacheType <>'L' and Exclude <> '1'"
			ELSE
				$_sql = "SELECT count(Code) from AllFinds WHERE Country='$Country' and State='$ThisState'"
			ENDIF
		ENDIF
		$NState = Val(Sqlite("sql",$_sql))

		# Get map coordinates
		$i = 1 + ($count * 2)
		$StateName = SubStr($StateList,$i,2)
		$Snum = At($StateName,$AllStates)
		$Snum = 1 + ($Snum - 1)/3
		#		msgok msg="$StateName, $count, $i, $Snum"
		$xCoord = Val(Extract($Xstates,",",$Snum))
		$yCoord = Val(Extract($Ystates,",",$Snum))
		$StateColor = Extract($ColorStates,",",$Snum)
		$FullName = Extract($NameStates,",",$Snum)
		$FullName = Extract($FullName,"=",1)
		$FullName = Replace($_NewLine,"",$FullName,TRUE)

		# Flood fill coordinates
		IF NOT(Left($FullName,2) = "NN")
			IF $j > 1 AND Len($xFill) > 0
				$xFill = $xFill + ","
				$yFill = $yFill + ","
			ENDIF
			$xFill = $xFill + Extract($xFillState,",",$Snum)
			$yFill = $yFill + Extract($yFillState,",",$Snum)
		ENDIF

		# Apply offsets
		#$xCoord = $xCoord + $xOffset + 365 # 365 is half width of div
		#$yCoord = $yCoord + $yOffset - 7 # 7 is height of text
		
		$xCoord = $xCoord + $xOffset 
		$yCoord = $yCoord -$yMap + $yOffset

		# Set color of text and prefix
		IF $StateColor <> "0"
			#$SCol = "#FFFF00"
			$SCol = $MapCol1
			$Sprefix = $FullName + " "
		ELSE
			#$SCol = "#202020"
			$SCol = $MapCol2
			$Sprefix = ""
		ENDIF

		$Stag = $Sprefix + "$Nstate"

		# We want most tags centered but the ones off coast should be justified or offset, +1 gives left justified, -1 right justified
		$xCoord = Int($xCoord + (2 * (Len($Stag)-1) * Val($StateColor)))
		$xCoordText = "$xCoord" + "px"
		$yCoordText = "$yCoord" + "px"
		$numbertext = $numbertext + "<div style='margin-top:-1em;position: relative; color:$SCol; top: $yCoordText; left: $xCoordText'>$Stag</div>$_Newline"
		IF Left($FullName,2) = "NN" # The NN states or states where we have no name add explanation text below
			$yCoord = $yCoord + 10
			$yCoordText = "$yCoord" + "px"
			$Stag = $Lang137
			#$numbertext = $numbertext + "<div style='position: absolute; width: 40px; color:$SCol; top: $yCoordText; left: $xCoordText'>$Stag</div>$_Newline"
			$numbertext = $numbertext + "<div style='margin-top:-1em;position: relative; color:$SCol; top: $yCoordText; left: $xCoordText'>$Stag</div>$_Newline"
		ENDIF

		SHOWSTATUS msg="$LangStatus36 $FullName, $Nstate"
		$count = $count + 1
	ENDWHILE
	$numbertext = $numbertext + "</div>"

ENDSUB # AddTextToMap

BEGINSUB Name=Weekday
	# Determine the number of finds you've made on each weekday
	# Initialise Section variables
	$colspan = 2
	SHOWSTATUS msg="$LangStatus37" Width=350

	#Initialize Variables
	$result = ""
	$maxnum = 0
	#a bit of a fudge so the week starts on Monday (2)
	$day = 0
	WHILE $day < 7
		$day = $day + 1
		IF $day = 7
			$daynum = 0
		ELSE
			$daynum = $day
		ENDIF
		$dayname = Extract("$Lang51",";", $daynum + 1)
		#SHOWSTATUS msg="$LangStatus39a $dayname$LangStatus39b" Width=350
		$_sql = "SELECT count(Code) from AllFinds WHERE strftime('%w',ldate) = '$daynum'"
		$tmpN = Val(Sqlite("sql",$_sql))
		$result = $result + "$dayname, $tmpN;"
		IF $tmpN > $maxnum
			$maxnum = $tmpN
		ENDIF
	ENDWHILE
	# Generate output
	$text="$Lang50"
	$note=""
	$maxwidth=150
	$totalpercent = $FindsWithDuplicates
	GOSUB Name=SectionHead
	IF $PieCharts
		GOSUB Name=Table2Pi
	ELSE
		GOSUB Name=Table2Col
	ENDIF

# x weekend (xx%), y weekday (yy%)
# Weekend finds
$_sql="SELECT count(Code) from AllFinds WHERE strftime('%w',ldate) in('0','6')"
$num = Val(Sqlite("sql",$_sql))
$pc = Int(1000*$num/$FindsWithDuplicates)/10
$out = AddStr(1,"add","<span style='$stSmall'><i><b>$num</b> $Lang162 ($pc%) :" )
$num = $FindsWithDuplicates - $num
$pc = 100 - $pc
$out = AddStr(1,"add"," <b>$num</b> $Lang163 ($pc%)</i><br /></span>" )
ENDSUB # Weekday

BEGINSUB Name=PerMonth
	# Determine the number of finds you've made in each month
	# Initialise Section variables
	$colspan = 2
	SHOWSTATUS msg="$LangStatus37" Width=350

	#Initialize Variables
	$result = ""
	$maxnum = 0
	$month = 1
	$tmpS = $Lang13 + ";" + $Lang14 + ";" + $Lang15 + ";" + $Lang16 + ";" + $Lang17 + ";" + $Lang18 + ";" + $Lang19 + ";" + $Lang20 + ";" + $Lang21 + ";" + $Lang22 + ";" + $Lang23 + ";" + $Lang24
	WHILE $month <= 12
		$dayname = Extract("$tmpS",";",$month)
		$text6 = Right("0" + "$month",2)
		$_sql = "SELECT count(Code) from AllFinds WHERE strftime('%m',ldate) = '$text6'"
		$tmpN = Val(Sqlite("sql",$_sql))
		$result = $result + "$dayname, $tmpN;"
		IF $tmpN > $maxnum
			$maxnum = $tmpN
		ENDIF
		$month = $month + 1
	ENDWHILE
	# Generate output
	$text=$Lang150
	$note=""
	$maxwidth=150
	$totalpercent = $FindsWithDuplicates
	GOSUB Name=SectionHead
	IF $PieCharts
		GOSUB Name=Table2Pi
	ELSE
		GOSUB Name=Table2Col
	ENDIF

ENDSUB # PerMonth

BEGINSUB Name=PlacedYear
	# Determine the number of finds you've made by year placed
	# Initialise Section variables
	$colspan = 2
	SHOWSTATUS msg="Placed Year" Width=350

	#Initialize Variables
	$result = ""
	$maxnum = 0
	$y = 0

	WHILE TRUE
		$_sql = "SELECT strftime('%Y',PlacedDate), count(*) FROM allfinds GROUP BY strftime('%Y',PlacedDate) ORDER BY strftime('%Y',PlacedDate) LIMIT 1 OFFSET $y"
		$tmpS = Sqlite("sql",$_sql)
		IF $tmpS = ""
			BREAK
		ENDIF
		$dayname = Extract("$tmpS",";",1)
		$text6 = Extract("$tmpS",";",2)
		$tmpN = Val($text6)
		$result = $result + "$dayname, $text6;"
		IF $tmpN > $maxnum
			$maxnum = $tmpN
		ENDIF
		$y = $y + 1
	ENDWHILE

	# Generate output
	$text=$Lang152
	$note=""
	$maxwidth=150
	$totalpercent = $FindsWithDuplicates
	GOSUB Name=SectionHead
	IF $PieCharts
		GOSUB Name=Table2Pi
	ELSE
		GOSUB Name=Table2Col
	ENDIF
	SHOWSTATUS msg="Processing" Width=350

ENDSUB # PlacedYear

BEGINSUB Name=FindsToDate
	# Determine the number of finds you've made each year to today's date
	# Initialise Section variables
	$colspan = 2
	SHOWSTATUS msg="Finds to Date" Width=350

	#Initialize Variables
	$result = ""
	$maxnum = 0
	$y = 0

	WHILE TRUE
		$_sql = "SELECT strftime('%Y',lDate), count(*) FROM allfinds WHERE strftime('%j',lDate)+0 <= strftime('%j','$Today')+0 GROUP BY strftime('%Y',lDate) ORDER BY strftime('%Y',lDate) LIMIT 1 OFFSET $y"
		$tmpS = Sqlite("sql",$_sql)
		IF $tmpS = ""
			BREAK
		ENDIF
		$dayname = Extract("$tmpS",";",1)
		$text6 = Extract("$tmpS",";",2)
		$tmpN = Val($text6)
		$result = $result + "$dayname, $text6;"
		IF $tmpN > $maxnum
			$maxnum = $tmpN
		ENDIF
		$y = $y + 1
	ENDWHILE
	
	# Take percentage of the best year
	$_sql = "SELECT count(*) as c FROM allfinds WHERE strftime('%j',lDate)+0 <= strftime('%j','$Today')+0 GROUP BY strftime('%Y',lDate) ORDER BY c DESC LIMIT 1"
	$totalpercent = Val(Sqlite("sql",$_sql))

	$tmpS = "$Lang13;$Lang14;$Lang15;$Lang16;$Lang17;$Lang18;$Lang19;$Lang20;$Lang21;$Lang22;$Lang23;$Lang24"
	$_sql = "SELECT Strftime('%m','$Today')"
	$tmpN = Val(Sqlite("sql",$_sql))
	$tmpS = Extract($tmpS,";",$tmpN)
		
	$_sql = "SELECT ltrim(Strftime('%d','$Today'),'0')"
	$tmpS = Sqlite("sql",$_sql) + " " + $tmpS 
	
	$text= "$Lang170 $tmpS $Lang171"
	# Generate output
	#$text2=$Lang154
	$note=""
	$maxwidth=150
	
	GOSUB Name=SectionHead
	IF $PieCharts
		GOSUB Name=Table2Pi
	ELSE
		GOSUB Name=Table2Col
	ENDIF
	SHOWSTATUS msg="Processing" Width=350

ENDSUB # FindsToDate



BEGINSUB Name=Bearing
	# Determine the number of finds you've made on each bearing
	# Initialise Section variables
	$colspan = 2
	SHOWSTATUS msg="Bearing" Width=350

	#Initialize Variables
	$text1 = "N,NE,E,SE,S,SW,W,NW"

	# Generate output
	$text=$Lang149
	$note=""
	$maxwidth=150

	$_sql = "select count(code) as c from allfinds group by bearing order by c desc limit 1"
	$totalpercent = Val(Sqlite("sql",$_sql))

	GOSUB Name=SectionHead
	$count = 1

	# http://chart.googleapis.com/chart?cht=r&chs=260x220&chd=t:77,66,15,0,31,48,100,70,77&chco=0000FF&chls=3,3,0&chxt=x&chxl=0:|N|NE|E|SE|S|SW|W|NW&chxr=0,0.0,360.0&chm=B,76A4FB80,0,0,0

	$tmpS = RegExSub("background:\s*?#(.*?);",$stMainDiv,1,1)
	$out = AddStr(1,"add","<div align='center'><img src='http://chart.googleapis.com/chart?cht=r&chs=260x220&chco=0000FF&chls=3,3,0&chxt=x&chxr=0,0.0,360.0&chm=B,76A4FB80,0,0,0|h,808080,0,0.9,1|h,808080,0,0.5,1&chf=bg,s,$tmpS")

	$text4 = "&chd=t:"
	$text5 = "&chxl=0:"
	WHILE $count <=8
		$text2 = Extract($text1,",",$count)
		IF $ExcludeLocationLess
			$_sql = "SELECT count(Code) from AllFinds WHERE bearing='$text2' and CacheType <>'L' and Exclude <> '1'"
		ELSE
			$_sql = "SELECT count(Code) from AllFinds WHERE bearing='$text2'"
		ENDIF
		$tmpN = Val(Sqlite("sql",$_sql))
		$text6 = "$tmpN"
		$tmpN = Int(100*$tmpN/$totalpercent)
		$text4 = $text4 + "$tmpN" + ","
		$text5 = $text5 + "|$text2 ($text6)"
		$count = $count + 1
	ENDWHILE

	# Close the graph by repeating the North point
	IF $ExcludeLocationLess
		$note = "<i>$Lang38a</i>"
		$_sql = "SELECT count(Code) from AllFinds WHERE bearing='N' and CacheType <>'L' and Exclude <> '1'"
	ELSE
		$note = ""
		$_sql = "SELECT count(Code) from AllFinds WHERE bearing='N'"
	ENDIF
	$tmpN = Val(Sqlite("sql",$_sql))
	$text6 = "$tmpN"
	$tmpN = Int(100*$tmpN/$totalpercent)
	$text4 = $text4 + "$tmpN"

	$out = AddStr(1,"add",$text4 + $text5 + "' /></div>")

	IF $note <> ""
		$out = AddStr(1,"add","<span style='$stSmall'>$note</span>" + $CR)
	ENDIF

ENDSUB # Bearing


BEGINSUB Name=BearingDistance
	# Determine the average distance for Finds you've made on each bearing
	# Initialise Section variables
	$colspan = 2
	SHOWSTATUS msg="Bearing" Width=350

	#Initialize Variables
	$text1 = "N,NE,E,SE,S,SW,W,NW"

	# Generate output
	$text=$Lang176
	$note=""
	$maxwidth=150

	$_sql = "select avg(distance) as c from allfinds group by bearing order by c desc limit 1"
	$totalpercent = Int(Val(Sqlite("sql",$_sql)))

	GOSUB Name=SectionHead
	$count = 1

	# http://chart.googleapis.com/chart?cht=r&chs=260x220&chd=t:77,66,15,0,31,48,100,70,77&chco=0000FF&chls=3,3,0&chxt=x&chxl=0:|N|NE|E|SE|S|SW|W|NW&chxr=0,0.0,360.0&chm=B,76A4FB80,0,0,0

	$tmpS = RegExSub("background:\s*?#(.*?);",$stMainDiv,1,1)
	$out = AddStr(1,"add","<div align='center'><img src='http://chart.googleapis.com/chart?cht=r&chs=260x220&chco=0000FF&chls=3,3,0&chxt=x&chxr=0,0.0,360.0&chm=B,76A4FB80,0,0,0|h,808080,0,0.9,1|h,808080,0,0.5,1&chxs=0,,10&chf=bg,s,$tmpS")

	$text4 = "&chd=t:"
	$text5 = "&chxl=0:"
	WHILE $count <=8
		$text2 = Extract($text1,",",$count)
		IF $ExcludeLocationLess
			$_sql = "SELECT avg(distance) from AllFinds WHERE bearing='$text2' and CacheType <>'L' and Exclude <> '1'"
		ELSE
			$_sql = "SELECT avg(distance) from AllFinds WHERE bearing='$text2'"
		ENDIF
		$tmpN = Int(Val(Sqlite("sql",$_sql)))
		$text6 = "$tmpN" + " " + Left($Distunits,2)
		$tmpN = Int(100*$tmpN/$totalpercent)
		$text4 = $text4 + "$tmpN" + ","
		$text5 = $text5 + "|$text2 ($text6)"
		$count = $count + 1
	ENDWHILE

	# Close the graph by repeating the North point
	IF $ExcludeLocationLess
		$note = "<i>$Lang38a</i>"
		$_sql = "SELECT avg(distance) from AllFinds WHERE bearing='N' and CacheType <>'L' and Exclude <> '1'"
	ELSE
		$note = ""
		$_sql = "SELECT avg(distance) from AllFinds WHERE bearing='N'"
	ENDIF
	$tmpN = Int(Val(Sqlite("sql",$_sql)))
	$text6 = "$tmpN"
	$tmpN = Int(100*$tmpN/$totalpercent)
	$text4 = $text4 + "$tmpN"

	$out = AddStr(1,"add",$text4 + $text5 + "' /></div>")

	IF $note <> ""
		$out = AddStr(1,"add","<span style='$stSmall'>$note</span>" + $CR)
	ENDIF

ENDSUB # BearingDistance

BEGINSUB name=FindsPerDay
	# Chart of Number of days versus Finds/Day
	# Initialise Section variables
	$colspan = 1
	SHOWSTATUS msg="Finds Per Day" Width=350

	#Initialize Variables
	$count = 2

	# Generate output
	$text="$Lang178"
	$note=""
	$maxwidth=150
	
	GOSUB Name=SectionHead

	$_sql = "select c, count(c) FROM (select count(code) as c from allfinds group by lDate) group by c order by c"
	
	# Get maximum finds in a day
	$_sql ="select count(code) as c from allfinds group by lDate order by c desc limit 1"
	$max = Int(Val(Sqlite("sql",$_sql)))
	
	# Get maximum finds in a day that is greater than 1 and less than or equal to 100
	$_sql ="select count(code) as c from allfinds group by lDate having C <= 100 AND C > 1 order by c desc limit 1"
	$maxitem = Int(Val(Sqlite("sql",$_sql)))
		
	# Get maximum days with a single find rate
	$_sql = "select count(c) FROM (select count(code) as c from allfinds group by lDate) group by c having c > 1 order by count(c) desc limit 1"
	$totalpercent = Int(Val(Sqlite("sql",$_sql)))
	
	IF $totalpercent = 0
		$_sql = "select count(c) FROM (select count(code) as c from allfinds group by lDate) group by c having c >= 1 order by count(c) desc limit 1"
		$totalpercent = Int(Val(Sqlite("sql",$_sql)))
	ENDIF
	
	# y axis Increment
	BEGINCASE
		CASE $totalpercent < 20
			$tmpN = 1
		CASE $totalpercent < 50
			$tmpN = 2
		CASE $totalpercent < 100
			$tmpN = 5
		CASE $totalpercent < 250
			$tmpN = 10
		OTHERWISE
			$tmpN = 5*Int($totalpercent/100)
	ENDCASE
	$text2 = "$tmpN"
	
	# http://chart.googleapis.com/chart?cht=bvs&chs=740x300&chbh=a&chco=0044BB&chd=t:77,66,15,0,31,48,100,70,77,100,23,45,67&chxt=x&chxl=0:|1|2|3|4|5|6|7|8|9|10|11|12|13
	
	$tmpS = RegExSub("background:\s*?#(.*?);",$stMainDiv,1,1)
	$out = AddStr(1,"add","<div align='center'><img src='http://chart.googleapis.com/chart?cht=bvs&chs=740x300&chxs=0,,9|1,,9&chbh=a&chxt=x,y,x&chxr=1,0,$totalpercent,$text2&chf=bg,s,$tmpS")
	# grid lines &chg=9.53,9.52,3,3,-.5,0
	
	# Grid spacing
	BEGINCASE
		CASE $totalpercent <10
			$tmpN = 1
		CASE $totalpercent <20
			$tmpN = 2
		CASE $totalpercent <50
			$tmpN = 5
		CASE $totalpercent <100
			$tmpN = 10
		CASE $totalpercent <200
			$tmpN = 20
		CASE $totalpercent <500
			$tmpN = 50
		CASE $totalpercent <1000
			$tmpN = 100
		OTHERWISE
			$tmpN = 100*Int($totalpercent/1000)
	ENDCASE
		
	$tmpN = Int(100* $tmpN * 100/$totalpercent)/100
	
	$text3 = "&chg=0," + "$tmpN" + ",3,3,0,0"

	$text4 = "&chd=t:"
	$text5 = "&chxl=0:"
	
	IF $UseHeatBars
		$text7 = "&chco="
	ELSE
		$text7 = "&chco=0044BB"
	ENDIF
	
	WHILE $count <=$maxitem
		IF $ExcludeLocationLess
		$note = "<i>$Lang38a</i>"
		$_sql = "select ceiling(100.0*count(c)/$totalpercent) FROM (select count(code) as c from allfinds WHERE CacheType <>'L' and Exclude <> '1' group by lDate) WHERE c = $count"
	ELSE
		$note = ""
		$_sql = "select ceiling(100.0*count(c)/$totalpercent) FROM (select count(code) as c from allfinds group by lDate) WHERE c = $count"
	ENDIF
		$tmpN = Val(Sqlite("sql",$_sql))
		$text6 = "$tmpN"
		$text4 = $text4 + "$tmpN"
		
		# Get heat map color
		IF $UseHeatBars
			$heatnum = $tmpN
			$heatmax = $totalpercent
			GOSUB Name=GetHeatColor
			$text7 = $text7 + $HeatColor
		ENDIF
				
				
		IF $maxitem > 50
			IF $count < 100
				IF $count/2 = Int($count/2)
					$text5 = $text5 + "|$count"
				ELSE
					$text5 = $text5 + "|"
				ENDIF
			ELSE
				IF $count/5 = Int($count/5)
					$text5 = $text5 + "|$count"
				ELSE
					$text5 = $text5 + "|"
				ENDIF
			ENDIF
		ELSE
			$text5 = $text5 + "|$count"
		ENDIF
		
		IF $count < $maxitem
			$text4 = $text4 + ","
			IF $UseHeatBars
				$text7 = $text7 + "|"
			ENDIF
		ENDIF
		
		$count = $count + 1
		
	ENDWHILE
	
	$text5 = $text5 + "|2:||||||||||$Lang179&chdl=" + $Lang183 + "&chdlp=t"
	$out = AddStr(1,"add",$text7 + $text3 + $text4 + $text5 + "' /></div>")
	
	$_sql="select count(c) from (select count(code) as c from allfinds group by lDate having c = 1)"
	$tmpN = Int(Val(Sqlite("sql",$_sql)))
	IF $tmpN > 0
		IF $tmpN > 1
			$tmpS = $Lang36b
		ELSE
			$tmpS =$Lang36a
		ENDIF
		$text6 = "$tmpN $tmpS with one find and "
	ELSE 
		$text6 = ""
	ENDIF
	
	IF $max > $count - 1
		$_sql="select count(c) from (select count(code) as c from allfinds group by lDate having c > 100)"
		$tmpN = Int(Val(Sqlite("sql",$_sql)))
		IF $tmpN > 1
			$tmpS = $Lang36b
		ELSE
			$tmpS =$Lang36a
		ENDIF
		$out = AddStr(1,"add","<br /><i>$user $Lang187 $text6$tmpN $tmpS $Lang188.</i>" + $CR)
	ELSE
		$out = AddStr(1,"add","<br /><i>$user $Lang187 $tmpN $tmpS $Lang189.</i>" + $CR)
	ENDIF



	IF $note <> ""
		$out = AddStr(1,"add","<br /><span style='$stSmall'>$note</span>" + $CR)
	ENDIF
	
ENDSUB # FindsPerDay

BEGINSUB Name=PlugInNotes
	
	# Add carriage return after title if present
	$PlugInNotes = RegExReplace("(<fsgtitle>.*?</fsgtitle>)",$PlugInNotes,"$1" + $_CrLf,"$")
	
	# Strip out comment lines
		$PlugInNotes = RegExReplace("(?m)^\s*?#.*?$",$PlugInNotes,"")
		
	# Any title?
	$text = RegExSub("<fsgtitle>(.*?)</fsgtitle>",$PlugInNotes,1,1)
	# Initialise Section variables
	$colspan = 1
	IF $text = ""
		$ShowTitle = FALSE
	ENDIF
	
	$text1 = RegExReplace("<fsgtitle>(.*?)</fsgtitle>(\r\n|)",$PlugInNotes,"")
	
	$TabHtml = ""
	IF $Before
		# Check for <tab>...</tab> tags and build the html
		$TotalCount = RegExCount("<tab>(.*?)</tab>",$text1)
		IF $Totalcount > 0
			# Close last tab if necessary
			IF $TabCount > 0
				$TabHtml = "</div>"
			ENDIF
			# Increment tab count
			$TabCount = $TabCount + 1
			# Extract and clean up tab name
			$TabName = RegExSub("<tab>(.*?)</tab>",$text1,1,1)
			$TabName = Replace(";",",",$TabName)
			#Build tab string
			$TabString = $TabString + $TabName + ";"
		
			$text1 = RegExReplace("<tab>(.*?)</tab>",$text1,"")
		
			$TabHtml = $TabHtml + "<div id='tab" + "$TabCount" + "_details'"
			$tmpS = RegExSub("background:\s*?(#.*?);",$stMainDiv,1,1)
			IF $TabCount > 1
				$TabHtml = $TabHtml + " style='display:none'>"
			ELSE
				$TabHtml = $TabHtml + ">"
			ENDIF
		ENDIF
	ENDIF
	
	IF $TotalCount = 0 OR Not($Before)
		# Use Placed color scheme if <placed> tag is present
		IF At("<placed>",$text1) <> 0
			$Placed = TRUE
			$text1 = RegExReplace("<placed>",$text1,"")
		ENDIF
		GOSUB Name=SectionHead
	
		$Placed = FALSE
					
		GOSUB Name=BuildNote
					
		$out = AddStr(1,"add","<div style='width: 750px; font-family: Verdana, Arial, sans-serif; font-size: 13px; text-align: center;'>" + $CR)					
		$out = AddStr(1,"add",$text1 + $CR)
		$out = AddStr(1,"add","</div>" + $CR)
	
	ENDIF

ENDSUB # PlugInNotes


BEGINSUB Name=Notes
	# Add carriage return after title if present
	$notes = RegExReplace("(<fsgtitle>.*?</fsgtitle>)",$notes,"$1" + $_CrLf,"$")
	
	# Strip out comment lines
	$notes = RegExReplace("(?m)^\s*?#.*?$",$notes,"")
	
	# Any title?
	$text = RegExSub("<fsgtitle>(.*?)</fsgtitle>",$notes,1,1)
	# Initialise Section variables
	$colspan = 1
	IF $text = ""
		$text="$Lang89"
	ENDIF
	
	# Suppress title if <notitle/> tag is present
	IF At("<notitle/>",$notes) <> 0
		$ShowTitle = FALSE
	ENDIF
	
	# Use Placed color scheme if <placed> tag is present
	IF At("<placed>",$notes) <> 0
		$Placed = TRUE
	ENDIF
	
	GOSUB Name=SectionHead
	$Placed = FALSE
	
	$text1 = RegExReplace("<fsgtitle>(.*?)</fsgtitle>(\r\n|)",$notes,"")
	$text1 = RegExReplace("<notitle/>",$text1,"")
	$text1 = RegExReplace("<placed>",$text1,"")
	
	GOSUB Name=BuildNote
	
	$out = AddStr(1,"add","<div style='width: 750px; font-family: Verdana, Arial, sans-serif; font-size: 13px; text-align: center;'>" + $CR)
	$out = AddStr(1,"add",$text1 + $CR)
	$out = AddStr(1,"add","</div>" + $CR)

ENDSUB # Notes

BEGINSUB Name=NotesB
	# Add carriage return after title if present
	$notesB = RegExReplace("(<fsgtitle>.*?</fsgtitle>)",$notesB,"$1" + $_CrLf,"$")
	
	# Strip out comment lines
	$notesB = RegExReplace("(?m)^\s*?#.*?$",$notesB,"")
	
	# Any title?
	$text = RegExSub("<fsgtitle>(.*?)</fsgtitle>",$notesB,1,1)
	# Initialise Section variables
	$colspan = 1
	IF $text = ""
		$text="$Lang89"
	ENDIF
	
	# Suppress title if <notitle/> tag is present
	IF At("<notitle/>",$notesB) <> 0
		$ShowTitle = FALSE
	ENDIF
	
	# Use Placed color scheme if <placed> tag is present
	IF At("<placed>",$notesB) <> 0
		$Placed = TRUE
	ENDIF
	
	GOSUB Name=SectionHead
	$Placed = FALSE
	
	$text1 = RegExReplace("<fsgtitle>(.*?)</fsgtitle>(\r\n|)",$notesB,"")
	$text1 = RegExReplace("<notitle/>",$text1,"")
	$text1 = RegExReplace("<placed>",$text1,"")
	
	GOSUB Name=BuildNote
	
	$out = AddStr(1,"add","<div style='width: 750px; font-family: Verdana, Arial, sans-serif; font-size: 13px; text-align: center;'>" + $CR)
	$out = AddStr(1,"add",$text1 + $CR)
	$out = AddStr(1,"add","</div>" + $CR)

ENDSUB # NotesB

BEGINSUB Name=NotesC
	# Add carriage return after title if present
	$notesC = RegExReplace("(<fsgtitle>.*?</fsgtitle>)",$notesC,"$1" + $_CrLf,"$")
	
	# Strip out comment lines
	$notesC = RegExReplace("(?m)^\s*?#.*?$",$notesC,"")
	
	# Any title?
	$text = RegExSub("<fsgtitle>(.*?)</fsgtitle>",$notesC,1,1)
	# Initialise Section variables
	$colspan = 1
	IF $text = ""
		$text="$Lang89"
	ENDIF
	
	# Suppress title if <notitle/> tag is present
	IF At("<notitle/>",$notesC) <> 0
		$ShowTitle = FALSE
	ENDIF
	
	# Use Placed color scheme if <placed> tag is present
	IF At("<placed>",$notesC) <> 0
		$Placed = TRUE
	ENDIF
	
	GOSUB Name=SectionHead
	$placed = FALSE
	
	$text1 = RegExReplace("<fsgtitle>(.*?)</fsgtitle>(\r\n|)",$notesC,"")
	$text1 = RegExReplace("<notitle/>",$text1,"")
	$text1 = RegExReplace("<placed>",$text1,"")
	
	GOSUB Name=BuildNote
	
	$out = AddStr(1,"add","<div style='width: 750px; font-family: Verdana, Arial, sans-serif; font-size: 13px; text-align: center;'>" + $CR)
	$out = AddStr(1,"add",$text1 + $CR)
	$out = AddStr(1,"add","</div>" + $CR)

ENDSUB # NotesC

BEGINSUB Name=BuildNoteTest
	# Add the sub section headers
	$text1 = Replace("<subhead>","<div style='width:" + "$width" + "px; $stSectHead'>",$text1)
	$text1 = Replace("</subhead>","</div>",$text1)
	
	# Check for and add any <file>...</file> tags and insert the text file(s)
	$TotalCount = RegExCount("<file>(.*?)</file>",$text1)
	IF $Totalcount > 0
		$count = 1
		WHILE $count <= $Totalcount
			$FileName = RegExSub("<file>(.*?)</file>",$text1,1,1)
			$FileName = $datafilepath + "\$FileName"
			IF (FileExists($FileName))
				$file = GetFile($FileName)
				IF Left($file,7) <> "*Error*"
					$text2 = RegExData("<file>(.*?)</file>",$text1,1)
					$text1 = Replace($text2,"<div>" + $file + "</div>",$text1)
				ENDIF
			ENDIF
			$count = $count + 1
		ENDWHILE
	ENDIF
	
	# Check for any  <plugin>...</plugin> tags and run the macros
	$TotalCount = RegExCount("<plugin>(.*?)</plugin>",$text1)
	IF $Totalcount > 0
		$count = 1
		WHILE $count <= $Totalcount
			$FileName = RegExSub("<plugin>(.*?)</plugin>",$text1,1,1)
			$FileMask = Extract($FileName,".gsk",1)
			$FileMask = Extract($FileMask,"?",1)+ ".gsk"
			$FileName = $datafilepath + "\$FileName"
			$FileMask = $datafilepath + "\$FileMask"
			IF (FileExists($FileMask))
				$text2 = RegExData("<plugin>(.*?)</plugin>",$text1,1)
				$text4 = RegExSub("<plugin>(.*?)</plugin>",$text1,1,1)
				$text3 = "Result from Plug-In " + $text4 + " will appear here."
			ELSE
				$text2 = RegExData("<plugin>(.*?)</plugin>",$text1,1)
				$text4 = RegExSub("<plugin>(.*?)</plugin>",$text1,1,1)
				$text3 = "Plug-In " + $text4 + " not found."
			ENDIF
			$text1 = Replace($text2,"<div>" + $text3 + "</div>",$text1)
			$count = $count + 1
		ENDWHILE
	ENDIF
	
	
	ENDSUB #BuildNoteTest


BEGINSUB Name=BuildNote
	# Add the sub section headers
	$text1 = Replace("<subhead>","<div style='width:" + "$width" + "px; $stSectHead'>",$text1)
	$text1 = Replace("</subhead>","</div>",$text1)
	
	# Check for and add any <file>...</file> tags and insert the text file(s)
	$TotalCount = RegExCount("<file>(.*?)</file>",$text1)
	IF $Totalcount > 0
		$count = 1
		WHILE $count <= $Totalcount
			$FileName = RegExSub("<file>(.*?)</file>",$text1,1,1)
			$FileName = $datafilepath + "\$FileName"
			IF (FileExists($FileName))
				$file = GetFile($FileName)
				$text2 = RegExData("<file>(.*?)</file>",$text1,1)
				$text1 = Replace($text2,"<div>" + $file + "</div>",$text1)
			ENDIF
			$count = $count + 1
		ENDWHILE
	ENDIF
	
	# Check for any  <plugin>...</plugin> tags and run the macros
	$TotalCount = RegExCount("<plugin>(.*?)</plugin>",$text1)
	IF $Totalcount > 0
		$count = 1
		WHILE $count <= $Totalcount
			$FileName = RegExSub("<plugin>(.*?)</plugin>",$text1,1,1)
			$FileMask = Extract($FileName,".gsk",1)
			$FileMask = Extract($FileMask,"?",1)+ ".gsk"
			$FileName = $datafilepath + "\$FileName"
			$FileMask = $datafilepath + "\$FileMask"
			IF (FileExists($FileMask))
				# Check for illegal commands in plugin
				IF RegExCount("Sqlite\("+$_Quote+"open|Sqlite\("+$_Quote+"close|database *name=|attach database",GetFile($FileMask)) > 0
				#IF FALSE
					$p_FSGData = "Incorrect Plugin: $FileName"
				ELSE
					$p_FSGData = ""
					$out = AddStr(1,"get")
					$tmps = AddStr(1,"clear")
					MACRO File=$FileName VarScope=GlobalRestore
					$tmps = AddStr(1,"clear")
					$out = AddStr(1,"add",$out)
				ENDIF
				# Return data in $p_FSGData
				$text2 = RegExData("<plugin>(.*?)</plugin>",$text1,1)
				$text1 = Replace($text2,"<div>" + $p_FSGData + "</div>",$text1)
			ENDIF
			$count = $count + 1
		ENDWHILE
	ENDIF
	
	
	ENDSUB #BuildNote


BEGINSUB Name=Numbers
	# Initialise Section variables
	$colspan = 1
	$text="$Lang52"
	GOSUB Name=SectionHead
	$out = AddStr(1,"add","<table width='$maxtablewidth' style='text-align: left;'>" + $CR)
	$out = AddStr(1,"add","<col width='250px' />" + $CR)
	$text7 = ""
	
	IF $numTotals
		GOSUB Name=numTotals
		GOSUB Name=num365
	ENDIF
	IF $numConsecutive
		GOSUB Name=numConsec
	ENDIF
	IF $numPeriods
		GOSUB Name=numBestWeekend
		GOSUB Name=numBestWeek
		GOSUB Name=numBestMonth
		GOSUB name=numMostTypes
		GOSUB name=numMostCountries
		GOSUB name=numMostStates
		GOSUB name=numMostCounties
	ENDIF
	IF $numFastest
		GOSUB Name=numFastest100
		GOSUB Name=numFastest1000
	ENDIF
	IF $numDistance
		GOSUB Name=numTotalDistance
	ENDIF
	$text7 = ""
	IF $numClosest
		GOSUB Name=numClosest
	ENDIF
	$text7 = ""
	IF $numExtremes
		GOSUB name=numLatitude
		$text7 = ""
		GOSUB name=numLongitude
	ENDIF
	$text7 = ""
	IF $numCentroid
		GOSUB name=numCenterOfMass
	ENDIF
	$text7 = ""
	IF $numOldest
		GOSUB Name=numOldest
	ENDIF
	$text7 = ""
	IF $numArchived
		GOSUB Name=numArchived
	ENDIF
	IF $numFTF
		$_sql = "SELECT Enabled from OrderMenu WHERE Settings = $settings and ID='15'"
		$status = Sqlite("sql",$_sql,"")
		IF $status = "0"
			GOSUB Name=numFtf
		ENDIF
		GOSUB Name=numMostFTF
		GOSUB Name=numConsecFTF
	ENDIF
	IF $numLogs
		GOSUB name=numLogs
	ENDIF
	$out = AddStr(1,"add","</table>" + $CR)
ENDSUB #Numbers

BEGINSUB name=numCenterOfMass
	
#	# Set up the Elevation SQL table
#	$tmpS = $_Install + "\macros\elevationdataSQL.db3"
#	$tmpS = SqlQuote($tmpS)
#		
#	$_sql = "ATTACH $tmpS AS elevationdataSQL"
#	$status = Sqlite("sql",$_sql)
#	
#	$dbs = SqlQuote($db)
	
	# Exclude locationless?
	IF $Excludelocationless
		$note = "<i>$Lang38a</i>"
		#$Locationless = " WHERE database = '$db' AND Cachetype <>'L' AND Exclude <> '1'"
		$Locationless = " WHERE Cachetype <>'L' AND Exclude <> '1'"
	ELSE
		$note = ""
		#$Locationless = "WHERE database = '$db'"
		$Locationless = ""
	ENDIF
	
	# Parameters for WGS84 ellipsoid
	# $ecc is eccentricity squared
	$axis = 6378137
	$ecc = 0.00669438038
	
	$x = 0
	$y = 0
	$z = 0
	$pi = 3.14159265359
	
	IF $_Version >= "7.5.3.12"
		# x
		$_sql = "SELECT AVG(($axis / (SQRT(1-($ecc * SIN(RADIANS(Latitude + 0))) * SIN(RADIANS(Latitude + 0))))) * (COS(RADIANS(latitude + 0)) * SIN(RADIANS(longitude + 0)))) FROM allfinds $Locationless"
		#$_sql = "SELECT AVG(($axis / (SQRT(1-($ecc * SIN(RADIANS(Latitude + 0))) * SIN(RADIANS(Latitude + 0)))) + elevation) * (COS(RADIANS(latitude + 0)) * SIN(RADIANS(longitude + 0)))) FROM allfinds LEFT JOIN elevationdata ON allfinds.code = elevationdata.code $locationless"
		$x = Val(Sqlite("sql",$_sql))
		
		# y
		$_sql = "SELECT AVG(($axis / (SQRT(1-($ecc * SIN(RADIANS(Latitude + 0))) * SIN(RADIANS(Latitude + 0))))) * (-1 * COS(RADIANS(latitude + 0)) * COS(RADIANS(longitude + 0)))) FROM allfinds $Locationless"
		#$_sql = "SELECT AVG(($axis / (SQRT(1-($ecc * SIN(RADIANS(Latitude + 0))) * SIN(RADIANS(Latitude + 0)))) + elevation) * (-1 * COS(RADIANS(latitude + 0)) * COS(RADIANS(longitude + 0)))) FROM allfinds LEFT JOIN elevationdata ON allfinds.code = elevationdata.code $Locationless"
		$y = Val(Sqlite("sql",$_sql))

		# z
		$_sql = "SELECT AVG(($axis / (SQRT(1-($ecc * SIN(RADIANS(Latitude + 0))) * SIN(RADIANS(Latitude + 0))))) * (1 - $ecc) * SIN(RADIANS(latitude + 0))) FROM allfinds $Locationless"
		#$_sql = "SELECT AVG(($axis / (SQRT(1-($ecc * SIN(RADIANS(Latitude + 0))) * SIN(RADIANS(Latitude + 0)))) + elevation) * (1 - $ecc) * SIN(RADIANS(latitude + 0))) FROM allfinds LEFT JOIN elevationdata ON allfinds.code = elevationdata.code $Locationless"
		$z = Val(Sqlite("sql",$_sql))

	ELSE
		
		$_sql = "SELECT Latitude, Longitude from AllFinds $Locationless"
		$work = Sqlite("sql",$_sql)
		$list = List("sql","replace",$work)
		$ThisRecord = 1
		$count = $_SqlRows
		
		WHILE $ThisRecord <= $count
			IF Frac($ThisRecord/10) = 0
				SHOWSTATUS msg="$Lang120, $ThisRecord" Width=350
			ENDIF

			$tmpS = List("sql","item","$ThisRecord")
			$Latitude = Extract($tmpS,";",1)
			$Longitude = Extract($tmpS,";",2)

			# Convert to Decimal degrees then to Radians
			#  	$tmpS = $Latitude + " " + $Longitude
			#  	$tmpS = GCalc($tmpS,"FormatDegrees")
			#  	$LatitudeN = Val(Extract($tmpS,";",1))
			#  	$LongitudeN = Val(Extract($tmpS,";",2))
			$LatitudeN = Val($Latitude) * $pi / 180
			$LongitudeN = Val($Longitude) * $pi / 180

			# Calculate 3D cartesian coordinates and average them
			$v = $axis / (Sqrt(1-($ecc * Sin($LatitudeN) * Sin($LatitudeN))))
			$x = $x + $v * (Cos($LatitudeN) * Sin($LongitudeN))
			$y = $y + $v * ( -1 * Cos($LatitudeN) * Cos($LongitudeN))
			$z = $z + $v * (1 - $ecc) * Sin($LatitudeN)

			$ThisRecord = $ThisRecord + 1
		ENDWHILE
		$x = $x/$count
		$y = $y/$count
		$z = $z/$count

	ENDIF


	# Project the average point back up to the surface of the WGS84 Ellipsoid
	# Note this requires iteration

	# Longitude = ArcTan2(x, -y)
	$y = -$y

	$longitudeN = ArcTan2($x,$y)

	# Latitude = ArcTan2(z, sqrt(x*x + y*y))

	$y = Sqrt(Sqr($x) + Sqr($y))

	$latitudeN = ArcTan2($z,($y * (1 - $ecc)))
	$v = $axis / (Sqrt(1-($ecc * Sin($LatitudeN) * Sin($LatitudeN))))
	$errvalue = 1
	$tmpN = 0

	$tmpM = 0
	WHILE $errvalue > 0.000001 AND $tmpM <5
		$tmpM = $tmpM + 1
		$x = ($ecc * $v * Sin($LatitudeN))
		$tmpN = ArcTan2($z + $x, $y)
		$errvalue = Abs($tmpN - $LatitudeN)
		$LatitudeN = $tmpN
	ENDWHILE

	# Convert from radians to degrees and format as decimal minutes

	$latitudeN = 180 * $latitudeN / $pi
	$longitudeN = 180 * $longitudeN / $pi

	$latitude = NumToStr($latitudeN)
	$longitude = NumToStr($longitudeN)

	# Deal with commas as decimal separator
	$latitude = Replace(",",".",$latitude,TRUE)
	$longitude = Replace(",",".",$longitude,TRUE)

	$last_lat = $latitude
	$last_lon = $longitude

	$tmpS = $Latitude + " " + $Longitude
	$tmpS = GCalc($tmpS,"FormatMinutes")
	$Latitude = Extract($tmpS,";",1)
	$Longitude = Extract($tmpS,";",2)
	
	# Calculate distance from current home position
	$text8 = SysInfo("gsakini;LastCenter;Lat")
	$text9 = SysInfo("gsakini;LastCenter;Lon")
	
	$tmpS1 = $text8 + " " + $text9 + ";" + $last_lat + " " + $last_lon
	$tmpS1 = GCalc($tmpS1,"CalcDistance")
	$tmpN = Val($tmpS1)
	IF $tmpN < 10
		$tmpN = Round($tmpN,1)
	ELSE
		$tmpN = Int($tmpN)
	ENDIF
	
	# Get country or ocean
	
	$url = "http://ws.geonames.org/countrySubdivision?lat=" + $last_lat + "&lng=" + $last_lon
	SHOWSTATUS msg="Getting country information for centroid" Width=350 Title=""
	$data = GetUrl($url,"")
	$text3 = UTF8(RegExSub("<countryName>(.*?)</countryName>",$data,1,1),"d")
	$text4 = UTF8(RegExSub("<adminName1>(.*?)</adminName1>",$data,1,1),"d")
	$text5 = UTF8(RegExSub("<countryCode>(.*?)</countryCode>",$data,1,1),"d")
	$text7 = ""
	
	# no result, try an ocean
	IF Len($text3) = 0
		$url = "http://ws.geonames.org/ocean?lat=" + $last_lat + "&lng=" + $last_lon
		SHOWSTATUS msg="Getting ocean information for centroid" Width=350 Title=""
		$data = GetUrl($url,"")
		$text3 = UTF8(RegExSub("<name>(.*?)</name>",$data,1,1),"d")
	ENDIF
	
	IF Len($text4) >0
		$text4 = "Centroid $Lang185 $tmpN $distunits $Lang186: $text4,"
	ELSE
		IF Len($Text3) > 0
			$text4 = "Centroid $Lang185 $tmpN $distunits $Lang186:"
		ENDIF
	ENDIF
	
	IF Len($text5) > 0
		$text7 = " <img align ='top' vspace='1'  alt='$text3' title='$text3' src='" + $ImageURL + "flags/" + $text5 + ".gif'/>"
	ENDIF

#	$tmpS = " <a target='_blank' href='http://maps.google.com/maps?q=Centroid@" + $last_lat + "," + $last_lon + "&z=8'><img align ='top' vspace='1' border = 'none' src='http://gsak.net/stats/mapbutton.png'/></a>"
	
	$tmpS = " <a href ='#' onclick=" + Quote("document.getElementById('centmap').style.display = (getElementById('centmap').style.display != 'none' ? 'none' : '');return false;") + "><img align ='top' vspace='1' border = 'none' src='http://gsak.net/stats/mapbutton.png'/></a>" + $CR
	$text2 = "<b>$Latitude $Longitude</b> $note " + $tmpS + "<br />$text4 $text3" + $CR
	
#	$text2 = "<b>$Latitude $Longitude</b> $note<br />" + $tmpS + " $text4 $text3"

	$text1 = "<a target='_blank' href='http://en.wikipedia.org/wiki/Centroid'>" + $Lang120 + "</a>"
	GOSUB Name=NumbersLine
	
	$out = AddStr(1,"add","<tr id='centmap' style='display:none'><td colspan='2'><center><div style='width:600px; border:2px outset blue'><a target='_blank' href='http://maps.google.com/maps?q=Centroid@" + $last_lat + "," + $last_lon + "&z=8'><img style='border-style: none' src='http://maps.google.com/maps/api/staticmap?center=$last_lat,$last_lon&zoom=8&size=600x400&markers=color:yellow|label:C|$last_lat,$last_lon&sensor=false'></a></div></center></td></tr>" + $CR)

#	$_sql = "DETACH elevationdataSQL"
#	$status = Sqlite("sql",$_sql)

ENDSUB  #CenterOfMass

BEGINSUB name=numMostFTF
	#filter for finds with FTF checked
	$_sql = "SELECT count(Code) from AllFinds WHERE FTF='1'"
	$num = Val(Sqlite("sql",$_sql))

	# Exit if we don't have any ftfs
	IF $num = 0
		EXITSUB
	ENDIF

	$_sql = "SELECT count(Code) as n, lDate from AllFinds WHERE FTF='1' GROUP By lDate ORDER by n DESC, lDate"
	$work = Sqlite("sql",$_sql)
	$list = list("sql","replace",$work)
	$count = $_SqlRows
	#$tmpS = List("sql","item","1")
	$text1 = $Lang118
	$text2 = ""
	$tmpN = 1

	# Loop through first three top days
	WHILE $tmpN <= $count AND $tmpN <=3
		$tmpS = list("sql","item","$tmpN")
		$MostInADay = Val(Extract($tmpS,";",1))
		$MostInADayDate = SqlToDate((Extract($tmpS,";",2)))
		$text2 = $text2 + "<b>$MostInADay</b> $Lang71 <b>$MostInADayDate</b>"
		IF $tmpN<>$count AND $tmpN <>3
			$text2 = $text2 + "; "
		ENDIF
		$tmpN = $tmpN + 1
	ENDWHILE

	GOSUB Name=NumbersLine

	$_sql = "SELECT count(Code) as n, Strftime('%m-%Y',lDate) as m from AllFinds WHERE FTF='1' GROUP By m ORDER by n DESC, m LIMIT 1"
	$work = Sqlite("sql",$_sql)
	$tmpN = Val(Extract($work,";",1))
	$tmpS1 = Extract($work,";",2)
	$tmpM = Val(Extract($tmpS1,"-",1))
	$tmpS = "$Lang13;$Lang14;$Lang15;$Lang16;$Lang17;$Lang18;$Lang19;$Lang20;$Lang21;$Lang22;$Lang23;$Lang24"
	$tmpS = Extract($tmpS,";",$tmpM)
	$text1 = $Lang144
	$text2 = "<b>$tmpN</b>, $Lang74 <b>"
	$text2 = $text2 + "$tmpS" + " "
	$text2 = $text2 + Extract($tmpS1,"-",2) + "</b>"
	GOSUB Name=NumbersLine
ENDSUB #numMostFTF

BEGINSUB name=numMostTypes
	$_sql = "SELECT count(DISTINCT Cachetype) as n, lDate from AllFinds GROUP By lDate order by n DESC, lDate LIMIT 1"
	$work = Sqlite("sql",$_sql)
		
	#$tmpS = List("sql","item","1")
	$text1 = $Lang153
	$text2 = ""
	$counter = 1
	$text3 = ""
		
	$MostInADay = Val(Extract($work,";",1))
	$MostInADayDate = SqlToDate((Extract($work,";",2)))
	$tmpS = Extract($work,";",2)
	
	IF $miletypes
		$_sql = "SELECT code from AllFinds WHERE lDate = '$tmpS' GROUP By CacheType"
		$work = Sqlite("sql",$_sql)
		$count = $_SqlRows
	
		WHILE $counter <= $count
			$tmpS = Extract($work,$CR,$counter)
			$StripCode = $tmpS
			$tmpB = FALSE
			GOSUB Name=StripCodeType
			$text3 = $text3 + $TypeImage + " "
			$counter = $counter + 1
		ENDWHILE
		$text3 = "( $text3)"
	ENDIF
				
	$text2 = "<b>$MostInADay</b> $text3 $Lang71 <b>$MostInADayDate</b>"
		
	GOSUB Name=NumbersLine
ENDSUB #numMostTypes

BEGINSUB name=numMostCountries
	IF $ExcludeLocationLess
		$note = "<i>$Lang38a</i>"
		$_sql = "SELECT count(DISTINCT Country) as n, lDate from AllFinds WHERE Cachetype <>'L' AND Exclude <> '1' GROUP By lDate order by n DESC, lDate LIMIT 1"
	ELSE
		$_sql = "SELECT count(DISTINCT Country) as n, lDate from AllFinds GROUP By lDate order by n DESC, lDate LIMIT 1"
		$note = "<i>$Lang38b</i>"
	ENDIF
	$work = Sqlite("sql",$_sql)

	#$tmpS = List("sql","item","1")
	$text1 = $Lang180
	$text2 = ""
	$counter = 1
	$text3 = ""

	$MostInADay = Val(Extract($work,";",1))

# Exclude locationless?
	IF $Excludelocationless
		$Locationless = " AND Cachetype <>'L' AND Exclude <> '1'"
	ELSE
		$Locationless = ""
	ENDIF
	
	IF $MostInADay > 1
		$MostInADayDate = SqlToDate((Extract($work,";",2)))
		$tmpS = Extract($work,";",2)
		IF $FlagIcons
			# Enter with $FullName containing the country name
			# Exits with $text7 containing the html to the flag Image
			$_sql = "SELECT country from AllFinds WHERE lDate = '$tmpS' $locationless GROUP By Country ORDER BY lLogid"
			$work = Sqlite("sql",$_sql)
			$count = $_SqlRows
			WHILE $counter <= $count
				$FullName = Extract($work,$CR,$counter)
				GOSUB Name=FlagImage
				$text3 = $text3 + $text7 + " "
				$counter = $counter + 1
			ENDWHILE
			$text3 = "($text3)"
		ENDIF
		$text7 = ""
		$text2 = "<b>$MostInADay</b> $text3 $Lang71 <b>$MostInADayDate</b> $note"
		GOSUB Name=NumbersLine
	ENDIF
ENDSUB #numMostCountries

BEGINSUB name=numMostStates
	IF $ExcludeLocationLess
		$note = "<i>$Lang38a</i>"
		$_sql = "SELECT count(DISTINCT State || Country) as n, lDate from AllFinds WHERE State NOT IN('Nil', 'nil', '') AND Cachetype <>'L' AND Exclude <> '1' GROUP By lDate order by n DESC, lDate LIMIT 1"
	ELSE
		$_sql = "SELECT count(DISTINCT State || COuntry) as n, lDate from AllFinds WHERE State NOT IN('Nil', 'nil', '') GROUP By lDate order by n DESC, lDate LIMIT 1"
		$note = "<i>$Lang38b</i>"
	ENDIF
	$work = Sqlite("sql",$_sql)

	#$tmpS = List("sql","item","1")
	$text1 = $Lang181
	$text2 = ""
	$counter = 1
	$text3 = ""
	
	# Exclude locationless?
	IF $Excludelocationless
		$Locationless = " AND Cachetype <>'L' AND Exclude <> '1'"
	ELSE
		$Locationless = ""
	ENDIF

	$MostInADay = Val(Extract($work,";",1))
	IF $MostInADay > 1
		$MostInADayDate = SqlToDate((Extract($work,";",2)))
		$tmpS = Extract($work,";",2)
		$_sql = "SELECT State || ' : ' || Country from AllFinds WHERE lDate = '$tmpS' AND State NOT IN('Nil', 'nil', '') $locationless GROUP By State || Country ORDER BY lLogid"
		#$_sql = "SELECT State from AllFinds WHERE lDate = '$tmpS' $locationless GROUP By State ORDER BY lLogid"
		$work = Sqlite("sql",$_sql)
		$text3 = Replace($CR,", ",$work)
		$text3 = "($text3)"
		$text7 = ""
		$text2 = "<b>$MostInADay</b> $text3 $Lang71 <b>$MostInADayDate</b> $note"
		GOSUB Name=NumbersLine
	ENDIF
ENDSUB #numMostStates

BEGINSUB name=numMostCounties
	IF $ExcludeLocationLess
		$note = "<i>$Lang38a</i>"
		$_sql = "SELECT count(DISTINCT County || State) as n, lDate from AllFinds WHERE County NOT IN('Nil', 'nil', '') AND Cachetype <>'L' AND Exclude <> '1' GROUP By lDate order by n DESC, lDate LIMIT 1"
	ELSE
		$_sql = "SELECT count(DISTINCT County || State) as n, lDate from AllFinds WHERE County NOT IN('Nil', 'nil', '') GROUP By lDate order by n DESC, lDate LIMIT 1"
		$note = "<i>$Lang38b</i>"
	ENDIF
	$work = Sqlite("sql",$_sql)

	#$tmpS = List("sql","item","1")
	$text1 = $Lang182
	$text2 = ""
	$counter = 1
	$text3 = ""
	
# Exclude locationless?
	IF $Excludelocationless
		$Locationless = " AND Cachetype <>'L' AND Exclude <> '1'"
	ELSE
		$Locationless = ""
	ENDIF
	$MostInADay = Val(Extract($work,";",1))
	IF $MostInADay > 1
		$MostInADayDate = SqlToDate((Extract($work,";",2)))
		$tmpS = Extract($work,";",2)
		$_sql = "SELECT County || ' : ' || State from AllFinds WHERE lDate = '$tmpS' AND County NOT IN('Nil', 'nil', '') $locationless GROUP By County || State ORDER BY lLogid"
		$work = Sqlite("sql",$_sql)
		$text3 = Replace($CR,", ",$work)
		$text3 = "($text3)"
		$text7 = ""
		$text2 = "<b>$MostInADay</b> $text3 $Lang71 <b>$MostInADayDate</b> $note"
		GOSUB Name=NumbersLine
	ENDIF
ENDSUB #numMostCounties



BEGINSUB name=numLogs
	$_sql = "SELECT Sum(LogLength) from AllFinds"
	$num = Val(Sqlite("sql",$_sql))
	$_sql = "SELECT Sum(Length(lText)) from AllFinds"
	$tmpN = Val(Sqlite("sql",$_sql))
	$tmpS = NumToStr(Int($num/$FindsWithDuplicates))
	$text1 = $Lang123
	$text2 = "$Lang164: <b>$num</b>" + ", " + $Lang124 + ": <b>$tmpS</b>, ($Lang165: <b>$tmpN</b>)<br />"
	$_sql = "SELECT Code, lLogID, LogLength from AllFinds WHERE lLogID <> '0' ORDER BY LogLength DESC LIMIT 1"
	$tmpS = Sqlite("sql",$_sql)
	$Code = Extract($tmpS,";",1)
	$Log = Extract($tmpS,";",2)
	$tmpS = Extract($tmpS,";",3)
	#Strip off the suffix code if necessary
	$StripCode = Extract($Code,"_",1)
	
	BEGINCASE
			CASE Left($StripCode,2)="GC"
				$text2 = $text2 + $Lang125 + ": <a href='http://www.geocaching.com/seek/log.aspx?LID=$Log'>$StripCode</a> <b>$tmpS</b>, "
			CASE Left($StripCode,2)="GA"
				$text2 = $text2 + $Lang125 + ": <a href='http://geocaching.com.au/log/$Log'>$StripCode</a> <b>$tmpS</b>, "
			OTHERWISE
				$text2 = $text2 + $Lang125 + ": $StripCode <b>$tmpS</b>, "
	ENDCASE
	
	
	
	$_sql = "SELECT Code, lLogID, LogLength from AllFinds WHERE lLogID <> '0' ORDER BY LogLength ASC LIMIT 1"
	$tmpS = Sqlite("sql",$_sql)
	$Code = Extract($tmpS,";",1)
	$Log = Extract($tmpS,";",2)
	$tmpS = Extract($tmpS,";",3)
	#Strip off the suffix code if necessary
	$StripCode = Extract($Code,"_",1)
	
	BEGINCASE
			CASE Left($StripCode,2)="GC"
				$text2 = $text2 + $Lang126 + ": <a href='http://www.geocaching.com/seek/log.aspx?LID=$Log'>$StripCode</a> <b>$tmpS</b>"
			CASE Left($StripCode,2)="GA"
				$text2 = $text2 + $Lang126 + ": <a href='http://geocaching.com.au/log/$Log'>$StripCode</a> <b>$tmpS</b>"
			OTHERWISE
				$text2 = $text2 + $Lang126 + ": $StripCode <b>$tmpS</b>"
	ENDCASE
	
	
	GOSUB Name=NumbersLine
ENDSUB #numLogs

BEGINSUB name=numLatitude
	IF $ExcludeLocationLess
		$note = "<i>excluding locationless</i>"
		$_sql = "SELECT Code, Name, Latitude, URL, Country from AllFinds WHERE CacheType <>'L' and Exclude <> '1' ORDER BY cast(Latitude as real) DESC"
	ELSE
		$_sql = "SELECT Code, Name, Latitude, URL, Country from AllFinds ORDER BY cast(Latitude as real) DESC"
		$note = "<i>including locationless</i>"
	ENDIF
	$work = Sqlite("sql",$_sql)
	$list = list("sql","replace",$work)
	$count = $_SqlRows
	$text1 = $Lang112
	$tmpN = 1
	GOSUB name=numLatitudeLine
	$tmpN = $count
	$text1 = $Lang113
	GOSUB name=numLatitudeLine
ENDSUB #numExtremes

BEGINSUB name=numLatitudeLine
	$tmpS = list("sql","item","$tmpN")
	$Code = Extract($tmpS,";",1)
	$Name = Extract($tmpS,";",2)
	$latitude = Extract($tmpS,";",3)
	$URL = Extract($tmpS,";",4)
	$FullName = Extract($tmpS,";",5)

	#Strip off the suffix code if necessary
	$StripCode = Extract($Code,"_",1)
	IF Len($Name) > 40
		$ShrunkName = Left($Name,38) + "..."
	ELSE
		$ShrunkName = $Name
	ENDIF
	$tmpS = GCalc("$latitude 0","FormatMinutes")
	$tmpS = Extract($tmpS,";",1)
	$text2 = "<b>$tmpS</b>, $ShrunkName <a href='$Url'>$StripCode</a>"
	IF $FlagIcons
		# Country flag into $text7
		GOSUB Name=FlagImage
	ENDIF
	GOSUB Name=NumbersLine
ENDSUB #numLatitudeLine

BEGINSUB name=numLongitude
	
	# From home option
	# SELECT Code, Name,  case when (Longitude+97) < 180 then (longitude+97) else (longitude+97)-360 end as l , URL, Country from AllFinds WHERE CacheType <>'L' and Exclude <> '1' ORDER BY l DESC
	
	IF $ExcludeLocationLess
		$note = "<i>excluding locationless</i>"
		$_sql = "SELECT Code, Name, Longitude, URL, Country from AllFinds WHERE CacheType <>'L' and Exclude <> '1' ORDER BY cast(Longitude as real) DESC"
	ELSE
		$_sql = "SELECT Code, Name, Longitude, URL, Country from AllFinds ORDER BY cast(Longitude as real) DESC"
		$note = "<i>including locationless</i>"
	ENDIF
	$work = Sqlite("sql",$_sql)
	$list = list("sql","replace",$work)
	$count = $_SqlRows
	$text1 = $Lang115
	$tmpN = 1
	GOSUB name=numLongitudeLine
	$tmpN = $count
	$text1 = $Lang114
	GOSUB name=numLongitudeLine
ENDSUB #numExtremes

BEGINSUB name=numLongitudeLine
	$tmpS = list("sql","item","$tmpN")
	$Code = Extract($tmpS,";",1)
	$Name = Extract($tmpS,";",2)
	$longitude = Extract($tmpS,";",3)
	$URL = Extract($tmpS,";",4)
	$FullName = Extract($tmpS,";",5)

	#Strip off the suffix code if necessary
	$StripCode = Extract($Code,"_",1)
	IF Len($Name) > 40
		$ShrunkName = Left($Name,38) + "..."
	ELSE
		$ShrunkName = $Name
	ENDIF
	$tmpS = GCalc("0 $longitude","FormatMinutes")
	$tmpS = Extract($tmpS,";",2)
	$text2 = "<b>$tmpS</b>, $ShrunkName <a href='$Url'>$StripCode</a>"
	IF $FlagIcons
		# Country flag into $text7
		GOSUB Name=FlagImage
	ENDIF
	GOSUB Name=NumbersLine
ENDSUB #numLongitudeLine

BEGINSUB name=numClosest
	IF $ExcludeLocationLess
		$note = "<i>excluding locationless</i>"
		$_sql = "SELECT Code, Name, Distance, URL, Country from AllFinds WHERE CacheType <>'L' and Exclude <> '1' ORDER BY Distance"
	ELSE
		$_sql = "SELECT Code, Name, Distance, URL, Country from AllFinds ORDER BY Distance"
		$note = "<i>including locationless</i>"
	ENDIF
	$work = Sqlite("sql",$_sql)
	$list = list("sql","replace",$work)
	$count = $_SqlRows
	$text1 = "$Lang53"
	$tmpN = 1
	GOSUB name=numClosestLine
	$tmpN = $count
	$text1 = "$Lang54"
	GOSUB name=numClosestLine
ENDSUB #numClosest

BEGINSUB name=numClosestLine
	$tmpS = list("sql","item","$tmpN")
	$Code = Extract($tmpS,";",1)
	$Name = Extract($tmpS,";",2)
	$Distance = NumToStr(Val(Extract($tmpS,";",3)))
	$URL = Extract($tmpS,";",4)
	$FullName = Extract($tmpS,";",5)

	#Strip off the suffix code if necessary
	$StripCode = Extract($Code,"_",1)
	IF Len($Name) > 40
		$ShrunkName = Left($Name,38) + "..."
	ELSE
		$ShrunkName = $Name
	ENDIF
	$tmpS = $distunits
	IF Val($Distance) < $Closest
		$text2 = "$ShrunkName <a href='$Url'>$StripCode</a>"
	ELSE
		IF Val($Distance) < 0.1 AND $distunits = "Miles"
			$Distance = NumToStr(Int(5280 * Val($distance)))
			$tmpS = "feet"
		ENDIF
		IF Val($Distance) < 1 AND $distunits <> "Miles"
			$Distance = NumToStr(Int(1000 * Val($distance)))
			$tmpS = "metres"
		ENDIF
		$text2 = "<b>$Distance</b> $tmpS, $ShrunkName <a href='$Url'>$StripCode</a>"
	ENDIF
	IF $FlagIcons
		# Country flag into $text7
		GOSUB Name=FlagImage
	ENDIF
	GOSUB Name=NumbersLine
ENDSUB #numClosestLine

BEGINSUB name=numOldest
	$_sql = "SELECT Code, Name, lDate, PlacedDate, URL, cacheID, Country from AllFinds ORDER BY PlacedDate, cast(cacheID AS integer)"
	$work = Sqlite("sql",$_sql)
	$list = list("sql","replace",$work)
	$count = $_SqlRows

	$tmpN = $count
	$tmpS = list("sql","item","$tmpN")
	$C_FoundDate = SqlToDate(Extract($tmpS,";",3))
	$C_PlacedDate = SqlToDate(Extract($tmpS,";",4))

	# Check if the placed date has been changed (as in a repeating event)
	WHILE ($C_FoundDate < $C_PlacedDate) AND $tmpN>=1
		$tmpN = $tmpN -1
		$tmpS = list("sql","item","$tmpN")
		$C_FoundDate = SqlToDate(Extract($tmpS,";",3))
		$C_PlacedDate = SqlToDate(Extract($tmpS,";",4))
	ENDWHILE
	$text1 = "$Lang55"
	GOSUB name=numOldestLine
	$tmpN = 1
	$text1 = "$Lang56"
	GOSUB name=numOldestLine
ENDSUB #numOldest

BEGINSUB name=numOldestLine
	$tmpS = list("sql","item","$tmpN")
	$Code = Extract($tmpS,";",1)
	$Name = Extract($tmpS,";",2)
	$URL = Extract($tmpS,";",5)
	$C_PlacedDate = SqlToDate(Extract($tmpS,";",4))
	$FullName = Extract($tmpS,";",7)

	#Strip off the suffix code if necessary
	$StripCode = Extract($Code,"_",1)
	# Format the date to users standard format for display
	$tmpS = DateFormat($C_PlacedDate)
	IF Len($Name) > 44
		$ShrunkName = Left($Name,42) + "..."
	ELSE
		$ShrunkName = $Name
	ENDIF
	$text2 = "<b>$tmpS</b>, $ShrunkName <a href='$Url'>$StripCode</a>"
	IF $FlagIcons
		# Country flag into $text7
		GOSUB Name=FlagImage
	ENDIF
	GOSUB Name=NumbersLine
ENDSUB #numOldestLine

BEGINSUB Name=numTotals
	$_sql = "SELECT lDate, count(code) from AllFinds GROUP BY lDate ORDER BY lDate"
	$work = Sqlite("sql",$_sql)
	$list = list("sql","replace",$work)
	$count = $_SqlRows
	$tmpS = list("sql","item","1")
	$firstdate = SqlToDate(Extract($tmpS,";",1))
	$tmpS = list("sql","item","$count")
	$lastdate = SqlToDate(Extract($tmpS,";",1))
	$CachingDays = $count
	$TotalDays = DateDiff($firstdate, $lastdate) + 1
	$pc = 100 * $CachingDays / $TotalDays
	$percent = left("$pc",4)
	$text1=$Lang87
	$text2="<b>$FindsWithDuplicates</b> $Lang57 <b>$CachingDays</b> $Lang58 <b>$TotalDays</b> $Lang59 ($percent %)"
	GOSUB Name=NumbersLine
	$perdayC = Alltrim(Str($FindsWithDuplicates / $CachingDays,5,2))
	$perdayO = Alltrim(Str($FindsWithDuplicates / $TotalDays,5,2))
	$perweek = Alltrim(Str(7 * $FindsWithDuplicates / $TotalDays,6,2))
	$permonth = Alltrim(Str(30.44 * $FindsWithDuplicates / $TotalDays,6,2))
	$text1=$Lang88
	$text2="<b>$perdayC</b> $Lang60 <b>$perdayO</b>$Lang61 <b>$perweek</b>$Lang62 <b>$permonth</b>$Lang63"
	GOSUB Name=NumbersLine
ENDSUB #numTotals

BEGINSUB Name=num365
	$_sql = "SELECT count(*) from AllFinds where ldate > date('$Today','-365 day')"
	$count = Val(Sqlite("sql",$_sql))
	IF $count <= 0 
		EXITSUB
	ENDIF
	$_sql = "SELECT count(distinct ldate) from AllFinds where ldate > date('$Today','-365 day')"
	$CachingDays = Val(Sqlite("sql",$_sql))
	IF $CachingDays = 365
		$percent = "100"
	ELSE
		$pc = 100 * $CachingDays / 365
		$percent = left("$pc",4)
	ENDIF
	$text1=$Lang147
	$text2="<b>$count</b> $Lang57 <b>$CachingDays</b> $Lang58 <b>365</b> $Lang59 ($percent %)"
	GOSUB Name=NumbersLine
	$perdayC = Alltrim(Str($count / $CachingDays,5,2))
	$perdayO = Alltrim(Str($count / 365,5,2))
	$perweek = Alltrim(Str(7 * $count / 365,6,2))
	$permonth = Alltrim(Str(30.44 * $count / 365,6,2))
	$text1=$Lang148
	$text2="<b>$perdayC</b> $Lang60 <b>$perdayO</b>$Lang61 <b>$perweek</b>$Lang62 <b>$permonth</b>$Lang63"
	GOSUB Name=NumbersLine
ENDSUB #num365

BEGINSUB name=numConsecFTF
	# Consecutive Months with a FTF
	$_sql = "SELECT DISTINCT (strftime( '%Y', ldate)*12+strftime('%m',ldate)) - (strftime('%Y','2000-01-01')*12+strftime('%m','2000-01-01')) from AllFinds WHERE FTF= '1' ORDER BY lDate"
	$tmpS = Sqlite("sql",$_sql)
	$list = list("sql","replace",$tmpS)
	$count = $_sqlrows
	
	# Exit if we don't have any ftfs
	IF $count = 0
		EXITSUB
	ENDIF
	
	# $i = first find month
	$i = Val(list("sql","item","1"))
	
	# Most recent month
	$k = Val(list("sql","item","$count"))
		
	# $j = Last find month
	$j = $i
	$y = $i
	$z = $i
	
	$ConsecFinds = 0
	$counter = 0
	
	$tmpN = 2
	WHILE $tmpN <= $count
	#Step through the records
		IF Frac($tmpN/50)=0
			SHOWSTATUS msg="$LangStatus40a $tmpN $LangStatus40b $count" Width=350
		ENDIF
		#calculate how many months between this and the last find
		$x = Val(list("sql","item","$tmpN"))
		$diff = $x - $j
		IF $diff = 1
			#Increment consecutive months counter
			$counter=$counter + 1
			IF $counter > $ConsecFinds
				#new Maximum consecutive count
				$ConsecFinds = $counter
				# $y = start
				$y = $i
				# $z = end
				$z = $x
			ENDIF
		ENDIF
		IF $diff > 1
			#Reset consecutive months counter
			$counter = 0
			$i = $x
		ENDIF
		$j = $x
		$tmpN = $tmpN + 1
	ENDWHILE
	$ConsecFinds=$ConsecFinds + 1
	
	$text1 = "$Lang157"
	
	# check for current streak
	$_sql = "SELECT (strftime( '%Y', '$Today')*12+strftime('%m','$Today')) - (strftime('%Y','2000-01-01')*12+strftime('%m','2000-01-01'))"
	$tmpN = Val(Sqlite("sql",$_sql))
	IF $tmpN = $z
		$s = "<i>$Lang65</i>"
	ELSE
		$s = ""
	ENDIF
	
	IF $ConsecFinds = 1
		$text2 = "<b>$ConsecFinds</b>"
	ELSE
		$tmpS = "$Lang13;$Lang14;$Lang15;$Lang16;$Lang17;$Lang18;$Lang19;$Lang20;$Lang21;$Lang22;$Lang23;$Lang24"
		$_sql = "select Strftime('%m-%Y', date('2000-01-01', '$y months'))"
		$tmpS1 = Sqlite("sql",$_sql)
		$tmpM = Val(Extract($tmpS1,"-",1))
		$da1 = Extract($tmpS,";",$tmpM) + " "	+ Extract($tmpS1,"-",2)
		
		$_sql = "select Strftime('%m-%Y', date('2000-01-01', '$z months'))"
		$tmpS1 = Sqlite("sql",$_sql)
		$tmpM = Val(Extract($tmpS1,"-",1))
		$da2 = Extract($tmpS,";",$tmpM) + " "	+ Extract($tmpS1,"-",2)
				
		$text2 = "<b>$ConsecFinds</b>, $Lang66 <b>$da1</b> $Lang67 <b>$da2</b> $s"
	ENDIF
	GOSUB Name=NumbersLine
ENDSUB # name=numConsecFTF



BEGINSUB Name=numConsec
	# Work out most consecutive days with and without finds and best day

	$_sql = "SELECT DISTINCT lDate from AllFinds ORDER BY lDate"
	$tmpS = Sqlite("sql",$_sql)
	$list = list("sql","replace",$tmpS)
	$count = $_SqlRows

	$tmpS = list("sql","item","1")
	$firstdate = SqlToDate($tmpS)
	$tmpS = list("sql","item","$count")
	$MostRecentFind = SqlToDate($tmpS)

	# Initialize Variables
	$ThisRecord = 0
	$ConsecFinds = 0
	$ConsecNoFinds = 0
	$LastFindDate = $firstdate
	$counter = 0
	$MostInADay = 1
	$MostInADayDate = $firstdate
	$tmpMostInADay = 0
	$tmpStart =  $firstdate
	$FindStart = $firstdate
	$FindEnd = $firstdate
	$NoFindStart = $firstdate
	$NoFindEnd = $firstdate

	$tmpN = 2

	WHILE $tmpN <= $count
		#Step through the records
		IF Frac($tmpN/50)=0
			SHOWSTATUS msg="$LangStatus40a $tmpN $LangStatus40b $count" Width=350
		ENDIF
		#calculate how many days between this and the last find
		$tmpS = list("sql","item","$tmpN")
		$ThisFindDate = SqlToDate($tmpS)
		$diff = DateDiff($LastFindDate, $ThisFindDate) - 1
		IF $diff > $ConsecNoFinds
			$ConsecNoFinds = $diff
			$NoFindStart = $LastFindDate +1
			$NoFindEnd   = $ThisFindDate - 1
		ENDIF
		IF $diff = 0
			#Increment consecutive days counter
			$counter=$counter + 1
			IF $counter > $ConsecFinds
				#new Maximum consecutive days
				$ConsecFinds = $counter
				$FindStart = $tmpStart
				$FindEnd = $ThisFindDate
			ENDIF
		ENDIF
		IF $diff > 0
			#Reset consecutive days counter
			$counter = 0
			$tmpStart = $ThisFindDate
		ENDIF
		$LastFindDate = $ThisFindDate
		$tmpN = $tmpN + 1
	ENDWHILE
	$ConsecFinds=$ConsecFinds + 1
	$da1 = DateFormat($FindStart)
	$da2 = DateFormat($FindEnd)
	$text1 = "$Lang64"
	IF $MostRecentFind = $FindEnd
		$s = "<i>$Lang65</i>"
	ELSE
		$s = ""
	ENDIF
	IF $ConsecFinds = 1
		$text2 = "<b>$ConsecFinds</b>"
	ELSE
		$text2 = "<b>$ConsecFinds</b>, $Lang66 <b>$da1</b> $Lang67 <b>$da2</b> $s"
	ENDIF
	GOSUB Name=NumbersLine
	$da1 = DateFormat($NoFindStart)
	$da2 = DateFormat($NoFindEnd)
	$text1 = "$Lang68"
	IF $ConsecNoFinds = 0
		$text2 = "$Lang69"
	ELSE
		$text2 = "<b>$ConsecNoFinds</b>, $lang66 <b>$da1</b> $Lang67 <b>$da2</b>"
	ENDIF
	GOSUB Name=NumbersLine
	
	# Current streak
	
	$_sql = "SELECT max(rowid), ldate from (SELECT DISTINCT lDate from AllFinds order by ldate desc) WHERE julianday((SELECT ldate from AllFinds ORDER BY ldate Desc LIMIT 1)) - julianday(ldate) = rowid - 1"
	$work = Sqlite("sql",$_sql)
	
	$ConsecFinds = Val(Extract($work,";",1))
	$FindStart = SqlToDate(Extract($work,";",2))
	$FindEnd = $MostRecentFind
		
	$da1 = DateFormat($FindStart)
	$da2 = DateFormat($FindEnd)
	$text1 = $Lang65
	IF $ConsecFinds = 1
		$text2 = "<b>$ConsecFinds</b>, <b>$da1</b>"
	ELSE
		$text2 = "<b>$ConsecFinds</b>, $Lang66 <b>$da1</b> $Lang67 <b>$da2</b>"
	ENDIF
	GOSUB Name=NumbersLine
		

	# Most finds in a day
	$_sql = "SELECT Count(Code) as c, lDate from AllFinds GROUP BY lDate ORDER BY c DESC LIMIT 3"
	$work = Sqlite("sql",$_sql)
	$list = list("sql","replace",$work)
	$count = $_SqlRows

	$text1 = "$Lang70"
	$text2 = ""
	$tmpN = 1
	# Loop through first three top days
	WHILE $tmpN <= $count AND $tmpN <=3
		$tmpS = list("sql","item","$tmpN")

		$MostInADay = Val(Extract($tmpS,";",1))
		$MostInADayDate = SqlToDate((Extract($tmpS,";",2)))
		$text2 = $text2 + "<b>$MostInADay</b> $Lang71 <b>$MostInADayDate</b>"
		IF $tmpN<>$count AND $tmpN <>3
			$text2 = $text2 + "; "
		ENDIF
		$tmpN = $tmpN + 1
	ENDWHILE

	#$text2 = "<b>$MostInADay</b>, $Lang71 <b>$MostInADayDate</b>"
	GOSUB Name=NumbersLine
ENDSUB #numConsec

BEGINSUB Name=numArchived
	$_sql = "Select count(DISTINCT Code) from AllFinds WHERE Archived='1'"
	$tmpN = Val(Sqlite("sql",$_sql))

	IF $tmpN >0
		$pc = 100 * $tmpN / ($TotalFinds - $BenchMarkFinds - $WaymarkFinds)
		$percent = left("$pc",4)
		$text1 = "$Lang72"
		$text2 = "<b>$tmpN</b> ($percent %)"
		GOSUB Name=NumbersLine
	ENDIF

ENDSUB #numArchived

BEGINSUB Name=numFtf
	#filter for finds with FTF checked
	$_sql = "Select count(Code) from AllFinds WHERE FTF='1'"
	$tmpN = Val(Sqlite("sql",$_sql))

	IF $tmpN >0
		# Average distance
		$_sql = "Select Avg(Distance) from AllFinds WHERE FTF='1'"
		$tmpS = Alltrim(Str(Val(Sqlite("sql",$_sql)),10,1))
		$pc = 100 * $tmpN / ($TotalFinds - $BenchMarkFinds - $WaymarkFinds)
		$percent = left("$pc",4)
		$text1 = "$LangT15"
		$text2 = "<b>$tmpN</b> ($percent %) - $Lang131 $tmpS $distunits"
		GOSUB Name=NumbersLine
	ENDIF
ENDSUB #numFtf

BEGINSUB Name=numBestMonth
	IF 	$MostInthisMonth <> 0
		$tmpS = "$Lang13;$Lang14;$Lang15;$Lang16;$Lang17;$Lang18;$Lang19;$Lang20;$Lang21;$Lang22;$Lang23;$Lang24"
		$tmpS = Extract($tmpS,";",$mostinthismonth)
		$text1 = "$Lang73"
		$text2 = "<b>$MostInMonth</b>, $Lang74 <b>"
		$text2 = $text2 + "$tmpS" + " "
		$text2 = $text2 + "$bestyear" + "</b>"
		GOSUB Name=NumbersLine
	ENDIF
ENDSUB #numBestMonth

BEGINSUB Name=numFastest100
	#Determine the time taken for the fastest 100 finds
	$numfast = 100
	# Check if we actually have $numfast finds
	IF $FindsWithDuplicates < $numfast
		EXITSUB
	ENDIF
	GOSUB name=numFastest
ENDSUB #numFastest100

BEGINSUB Name=numFastest1000
	#Determine the time taken for the fastest 1000 finds
	$numfast = 1000
	# Check if we actually have $numfast finds
	IF $FindsWithDuplicates < $numfast
		EXITSUB
	ENDIF
	GOSUB name=numFastest
ENDSUB #numFastest1000

BEGINSUB Name=numFastest
	#	Determine the time taken for the fastest $numfast finds

	$_sql = "SELECT fromdate.lDate, todate.lDate, julianday(todate.lDate) - julianday(fromdate.lDate) + 1 AS t FROM allfinds AS todate, allfinds AS fromdate WHERE todate.rowid = (fromdate.rowid + $numfast -1) AND t>0 ORDER BY t LIMIT 1 "
	$work = Sqlite("sql",$_sql)
		
	IF Len(Extract($work,";",1))=0 OR Len(Extract($work,";",2))=0 OR Val(Extract($work,";",3)) <0
		EXITSUB
	ENDIF
	
	$f100from = SqlToDate(Extract($work,";",1))
	$f100to = SqlToDate(Extract($work,";",2))
	$fastest100 = Val(Extract($work,";",3))

	$text1="$Lang75 $numfast $Lang76"
	IF $fastest100=1
		$text2="<b>$fastest100</b> $Lang77 <b>$f100from</b>"
	ELSE
		$text2="<b>$fastest100</b> $Lang78 <b>$f100from</b> $Lang67 <b>$f100to</b>"
	ENDIF
	GOSUB Name=NumbersLine

	$_sql = "SELECT julianday(todate.lDate) - julianday(fromdate.lDate) + 1 FROM allfinds AS todate, allfinds AS fromdate WHERE todate.rowid = $FindsWithDuplicates AND fromdate.rowid = $FindsWithDuplicates - $numfast + 1"
	$fastest100 = Val(Sqlite("sql",$_sql))
	
	IF $fastest100 < 0
		EXITSUB
	ENDIF 

	$text1="$Lang151 $numfast $Lang76"
	IF $fastest100=1
		$text2="<b>$fastest100</b> $Lang36a<b>"
	ELSE
		$text2="<b>$fastest100</b> $Lang36b<b>"
	ENDIF
	GOSUB Name=NumbersLine

ENDSUB #numFastest

BEGINSUB Name=numBestWeekend

	#Returns count and weeknumber-year
	$_sql = "SELECT count(weeknumber) as WeekCount, weeknumber  FROM AllFinds where strftime('%w',ldate) = '0' or strftime('%w',ldate) = '6' group by weeknumber order by weekcount desc LIMIT 1"
	$work = Sqlite("sql",$_sql)
	$best = Val(Extract($work,";",1))
	$tmpS = Extract($work,";",2)

	IF $tmpS = ""
		EXITSUB
	ENDIF

	# Week number-1 times 7 is days to our Monday from 1st Monday in year
	$tmpN = 7*(Val(Extract($tmpS,"-",1))-1)
	# Add 5 for saturday
	$tmpN = $tmpN + 5

	# Extract Year
	$tmpS = Extract($tmpS,"-",2)
	$tmpS = $tmpS + "-01-01"

	# Find date of 1st Monday in year
	$_sql = "SELECT Date('$tmpS','weekday 1')"
	#$_sql = "SELECT Date('$tmpS', CAST($tmpN-strftime('%w','$tmpS') as string)||'days')"
	$work = Sqlite("sql",$_sql)

	$bestSaturday = SqlToDate($work) + $tmpN
	$bestSunday = $bestSaturday + 1

	$text1 = "$Lang79"
	IF $best = 0
		$text2 = "$Lang80"
	ELSE
		$text2 = "<b>$best</b> $Lang81 <b>$bestSaturday</b> $Lang82 <b>$bestSunday</b>"
	ENDIF
	GOSUB Name=NumbersLine
ENDSUB #numBestWeekend

BEGINSUB Name=numBestWeek
	$_sql = "SELECT count(weeknumber) as WeekCount, weeknumber  FROM AllFinds group by weeknumber order by weekcount desc LIMIT 1"

	$work = Sqlite("sql",$_sql)
	$best = Val(Extract($work,";",1))
	$tmpS = Extract($work,";",2)

	# Week number-1 times 7 is days to our Monday from 1st Monday in year
	$tmpN = 7*(Val(Extract($tmpS,"-",1))-1)

	# Extract Year
	$tmpS = Extract($tmpS,"-",2)
	$tmpS = $tmpS + "-01-01"

	# Find date of 1st Monday in year
	$_sql = "SELECT Date('$tmpS','weekday 1')"
	#$_sql = "SELECT Date('$tmpS', CAST($tmpN-strftime('%w','$tmpS') as string)||'days')"
	$work = Sqlite("sql",$_sql)

	$bestMonday = SqlToDate($work) + $tmpN
	$bestSunday = $bestMonday + 6
	$text1 = "$Lang83"
	$text2 = "<b>$best</b> $Lang84 <b>$bestMonday</b> $Lang85 <b>$bestSunday</b>"
	GOSUB Name=NumbersLine
ENDSUB #numBestWeek

BEGINSUB Name=numTotalDistance
	#Initialise variables

	$_sql = "DROP TABLE IF EXISTS Allfindstemp"
	$status = Sqlite("sql",$_sql)

	IF $ExcludeLocationLess
		$note = "<i>$Lang38a</i>"
		$_sql = "CREATE TEMP TABLE AllFindstemp AS select * from Allfinds WHERE cachetype<>'L' AND Exclude <> '1' "
	ELSE
		$note = "<i>$Lang38b</i>"
		$_sql = "CREATE TEMP TABLE AllFindstemp AS select * from Allfinds"
	ENDIF

	$status = Sqlite("sql",$_sql)

	$tmpS = Sysinfo("Distance")

	$_sql = "SELECT sum(g_Distance(t1.latitude,t1.longitude,t2.latitude,t2.longitude,'$tmpS')) FROM allfindstemp AS t1, allfindstemp AS t2 where t1.rowid = t2.rowid - 1"
	$TotalDistance = Val(Sqlite("sql",$_sql))

	$_sql = "SELECT t1.ldate, sum(g_Distance(t1.latitude,t1.longitude,t2.latitude,t2.longitude,'$tmpS')) AS dist FROM allfindstemp AS t1, allfindstemp AS t2 WHERE t1.rowid = t2.rowid - 1 AND t1.ldate = t2.ldate GROUP BY t1.lDate ORDER BY dist DESC LIMIT 1"
	$status=Sqlite("sql",$_sql)

	IF $status = ""
		$tmpB = FALSE
	ELSE
		$tmpB = TRUE
		$MostInADayDate = SqlToDate(Extract($status,";",1))
		$MaxDistance = Val(Extract($status,";",2))
	ENDIF

	$_sql = "DROP TABLE IF EXISTS Allfindstemp"
	$status = Sqlite("sql",$_sql)
	$DistanceRounded = Alltrim(Str($TotalDistance,10,0))
	$text1 = "$Lang86"
	$text2 = "<b>$DistanceRounded</b> $distunits, $note"

	# Circumnavigation and dist to moon
	IF $distunits = "Miles"
		$tmpN = 24881
	ELSE
		$tmpN = 40042
	ENDIF

	$DistanceRounded = Alltrim(Str($TotalDistance/$tmpN,10,2))
	$text2 = $text2 + "<br /><b>$DistanceRounded</b>x $Lang142,"

	$DistanceRounded = Alltrim(Str($TotalDistance/($tmpN*9.59998),10,3))
	$text2 = $text2 + "<br /><b>$DistanceRounded</b>x $Lang143"

	GOSUB Name=NumbersLine

	IF $tmpB
		# Max in one day
				
		# Get all caches on that day into a List for a map - if more than 40 then get first and last 20
		$tmpS1 = DateToSql($MostInADayDate)
		IF $ExcludeLocationLess
			$_sql = "SELECT Count(*) FROM AllFinds WHERE lDate = '$tmpS1' AND cachetype<>'L' AND Exclude <> '1'"
		ELSE
			$_sql = "SELECT Count(*) FROM AllFinds WHERE lDate = '$tmpS1'"
		ENDIF
		$count = Val(Sqlite("sql",$_sql))
		
		IF $count <=40
			$_sql = "SELECT latitude || ',' || longitude FROM AllFinds WHERE lDate = '$tmpS1'"
			$status = Sqlite("sql",$_sql)
		ELSE
			$_sql = "SELECT latitude || ',' || longitude FROM AllFinds WHERE lDate = '$tmpS1' LIMIT 20"
			$status = Sqlite("sql",$_sql)
			$_sql = "SELECT latitude || ',' || longitude FROM AllFinds WHERE lDate = '$tmpS1' LIMIT ($count-20),20"
			$status = $status + $CR + Sqlite("sql",$_sql)
		ENDIF
		
		$DistanceRounded = Alltrim(Str($MaxDistance,10,0))
		$text1 = "$Lang119"
		$text2 = "<b>$DistanceRounded</b> $distunits - <b>$count</b> caches, $Lang71 <b>$MostInADayDate</b>"
		$tmpS = " <a href ='#' onclick=" + Quote("document.getElementById('distdaymap').style.display = (getElementById('distdaymap').style.display != 'none' ? 'none' : '');return false;") + "> <img align ='top' vspace='1' border = 'none' src='http://gsak.net/stats/mapbutton.png'/></a>" + $CR
		$text2 = $text2 + $tmpS + "<br />$note"
		GOSUB Name=NumbersLine
		
				
		$status = Replace($CR,"|",$status)
		
		$tmpS = "&markers=color:blue|" + $status + "&path=color:0xff0000ff|weight:3|" + $status
		
		$out = AddStr(1,"add","<tr id='distdaymap' style='display:none'><td colspan='2'><center><div style='width:600px; border:2px outset blue'><img style='border-style: none' src='http://maps.google.com/maps/api/staticmap?size=600x400&$tmpS&sensor=false'></a></div></center></td></tr>" + $CR)
		
	ENDIF

ENDSUB #numTotalDistance

BEGINSUB Name=MainHome
	#Home Position editor form
	GOSUB name=UpdateHome
		
	$_sql = "BEGIN"
	$status = Sqlite("sql",$_sql,"")
	
	WHILE TRUE
		$tmpS = Form($form17,"")
		# Reset the screen position of the menu form to where the user left it
		$Form17 = EditForm($Form17,"Form17","Top",$_FormTop)
		$Form17 = EditForm($Form17,"Form17","Left",$_FormLeft)
		BEGINCASE
		CASE $HomeCancel
			$_sql = "ROLLBACK"
			$status = Sqlite("sql",$_sql,"")
			BREAK
		CASE $HomeEdit
			GOSUB name=AddHome
		CASE $HomeDelete
			GOSUB name=DeleteHome
		CASE $HomeOK
			$_sql = "COMMIT"
			$status = Sqlite("sql",$_sql,"")
			BREAK
		OTHERWISE
			$_sql = "ROLLBACK"
			$status = Sqlite("sql",$_sql,"")
			CANCEL msg="Macro cancelled"
		ENDCASE
	ENDWHILE
ENDSUB # MainHome

BEGINSUB name=UpdateHome
	$spaces = "                "
	$_sql = "Select * FROM Home WHERE hsettings='$settings' ORDER by hdate"
	$work = Sqlite("sql",$_sql)
		
	$count = $_SqlRows
	$tmpN = 1
	$homememo= ""
	WHILE $tmpN <= $count
		$tmpS = Extract($work,$_NewLine,$tmpN)
		# Date
		$text1 = Extract($tmpS,";",1)
		$text1 = DateFormat(SqlToDate($text1))
		# Latitude
		$text2 = Extract($tmpS,";",2)
		# Longitude
		$text3 = Extract($tmpS,";",3)
		IF $text2 <> "Current"
			# Convert to users standard coord format for display
			$tmpS = GCalc("$text2 $text3",$CoordFormat)
			$text2 = Extract($tmpS,";",1)
			$text3 = Extract($tmpS,";",2)
		ENDIF
		$homememo = $homememo + $text1 + Left($spaces,(12 - Len($text1))) + $text2 + Left($spaces,(18 - Len($text2))) + $text3 + $_NewLine
		$tmpN = $tmpN + 1
	ENDWHILE
ENDSUB #UpdateHome

BEGINSUB name=AddHome
	#hdate, hlat, hlon, hsettings

	$text1 = DateToSql($EditHomeDate)
	IF At("current",Lower($EditHome)) = 0
		$tmpS = GCalc($EditHome,"FormatDegrees")
		$text2 = Extract($tmpS,";",1)
		$text3 = Extract($tmpS,";",2)
	ELSE
		$text2 = "Current"
		$text3 = "Position"
	ENDIF
	$_sql = "REPLACE INTO Home VALUES ('$text1','$text2','$text3','$settings')"
	$work = Sqlite("sql",$_sql)
	GOSUB name=UpdateHome
ENDSUB #AddHome

BEGINSUB name=DeleteHome
	#hdate, hlat, hlon, hsettings
	$text1 = DateToSql($EditHomeDate)
	$_sql = "DELETE FROM Home WHERE hdate='$text1' AND hsettings='$settings'"
	$work = Sqlite("sql",$_sql)
	GOSUB name=UpdateHome
ENDSUB # DeleteHome

BEGINSUB Name=MilestoneOverride

	# Check the main SQL table exists and exit if not

	IF FileExists($sqlfile)
		$_sql = "pragma table_info(allfinds)"
		$status = Sqlite("sql",$_sql)
		IF Len($status) = 0
			MSGOK msg="You must run the Stats program all the way through at least once before editing the Milestones."
			EXITSUB
		ENDIF
	ELSE
		MSGOK msg="You must run the Stats program all the way through at least once before editing the Milestones."
		EXITSUB
	ENDIF
	
	$spaces = "                "
	
	GOSUB name=Corrections
	GOSUB name=CorrMilestones

	SHOWSTATUS msg="$LangStatus20" Width=350 Display=Off

	GOSUB Name=MainMile

ENDSUB # MilestoneOverride

BEGINSUB Name=MainMile
	#Milestone editor form
	
	$_sql = "BEGIN"
	$status = Sqlite("sql",$_sql,"")
	
	WHILE TRUE
		$tmpS = Form($form4,"")
		# Reset the screen position of the menu form to where the user left it
		$Form4 = EditForm($Form4,"Form4","Top",$_FormTop)
		$Form4 = EditForm($Form4,"Form4","Left",$_FormLeft)
		BEGINCASE
		CASE $MileCancel
			$_sql = "ROLLBACK"
			$status = Sqlite("sql",$_sql,"")
			BREAK
		CASE $MileEdit
			GOSUB name=AddCorrection
		CASE $MileDelete
			GOSUB name=DeleteCorrection
		CASE $MileOK
			$_sql = "COMMIT"
			$status = Sqlite("sql",$_sql,"")
			BREAK
		OTHERWISE
			$_sql = "ROLLBACK"
			$status = Sqlite("sql",$_sql,"")
			CANCEL msg="Macro cancelled"
		ENDCASE
	ENDWHILE
ENDSUB # MainMile

BEGINSUB name=Corrections
	$memo2 = ""
	$_sql = "Select * FROM Milestone WHERE msettings='$settings'ORDER by mmilestone"
	$work = Sqlite("sql",$_sql)
	IF $work = ""
		EXITSUB
	ENDIF
	$list = list("MM","replace",$work)
	$MileTotal = val(list("MM","count",""))
	$count = 1
	WHILE $count <= $MileTotal
		$GetMilestone = list("MM","item","$count")
		$tmpS = Extract($GetMilestone,";",3)
		$FindDate = DateFormat(SqlToDate($tmpS))
		$StripCode = Extract($GetMilestone,";",2)
		$tmpS = Extract($GetMilestone,";",1)

		$_sql = "Select Name from AllFinds WHERE Code like '$StripCode' LIMIT 1"
		$name = Sqlite("sql",$_sql)

		$memo2 = $memo2 + "$tmpS" + Left($spaces,(8 - Len($tmpS))) + "$StripCode" + Left($spaces,(9 - Len($StripCode)))
		$memo2 = $memo2 + "$FindDate" + Left($spaces,(12 - Len($FindDate))) + Left($name,50) + $_NewLine
		$count = $count + 1
	ENDWHILE
ENDSUB # Corrections

BEGINSUB name=AddCorrection
	#editmilestone, editcode, editdate
	$sqldate = DateToSql($editdate)
	$editcode = Upper($editcode)
	IF Val($editmilestone) > 0 # AND $editcode <>""
		IF $editcode = ""
			$count = Val($editmilestone)
			# Use existing milestone from sorted list
			$GetMilestone = list("LL","item","$count")
			#Extract the code
			$editcode = Extract($GetMilestone,";",3)
			#Extract the date
			$sqldate = Extract($GetMilestone,";",33)
		ENDIF
		
		# Check code is in database
		$_sql = "Select Name from AllFinds WHERE Code like '$editcode' LIMIT 1"
		$work = Sqlite("sql",$_sql)
		IF $work = ""
			MSGOK msg="Error - That GC code is not in the database"
			EXITSUB
		ENDIF
	
		#$sql = "UPDATE FoundStatsMilestones2 SET mcode='$editcode', mdate='$sqldate' WHERE mmilestone='$editmilestone' AND msettings='$settings'"
		$_sql = "REPLACE INTO Milestone VALUES ('$editmilestone', '$editcode', '$sqldate', '$settings')"
		$work = Sqlite("sql",$_sql)
				
		GOSUB name=Corrections
		GOSUB name=CorrMilestones
	ENDIF
ENDSUB

BEGINSUB name=DeleteCorrection
	#editmilestone, editcode, editdate

	$_sql = "DELETE FROM Milestone WHERE mmilestone='$editmilestone' AND msettings='$settings'"
	$work = Sqlite("sql",$_sql)

	GOSUB name=Corrections
	GOSUB name=CorrMilestones
ENDSUB

BEGINSUB Name=CorrMilestones

	SHOWSTATUS msg="$LangStatus20" Width=350

	# Initialise Section variables
	$memo1 = ""

	IF $UseCurrentSort
		# Use the currently set sort for milestone calculation
		$_sql = "SELECT Name,URL,Code,PlacedDate,CacheType,Difficulty,Terrain,FoundByMeDate,OwnerID,OwnerName,State,Country,Distance,Archived,FTF,Container,Latitude,Longitude,Usersort,CacheID,UserNote,Bearing,County,Userdata,User2,User3,User4,Exclude,lParent,lType,lText,lBy,lDate,lLogid,lOwnerid,Loglength,Weeknumber,CenLat,Cenlon,Elevation,Resolution FROM Allfinds"
	ELSE
		# Sort by Find date + Log ID #
		$_sql = "SELECT Name,URL,Code,PlacedDate,CacheType,Difficulty,Terrain,FoundByMeDate,OwnerID,OwnerName,State,Country,Distance,Archived,FTF,Container,Latitude,Longitude,Usersort,CacheID,UserNote,Bearing,County,Userdata,User2,User3,User4,Exclude,lParent,lType,lText,lBy,lDate,lLogid,lOwnerid,Loglength,Weeknumber,CenLat,Cenlon,Elevation,Resolution FROM Allfinds ORDER BY lDate, lLogid"
	ENDIF

	$work = Sqlite("sql",$_sql,"crlfcvt=<br>")
	$list = list("LL","replace",$work)
	#Initialize Variables
	$LogTotal = $_SqlRows

	IF $LogTotal=0
		MsgOK Msg="You have no caches logged under name $user.$CR Did you spell it correctly? Milestones section skipped..."
		EXITSUB
	ENDIF

	$LogRecord = 0
	$lastdate = [00000000]
	$daysdiff=""

	# First Find
	IF NOT($milestone=1)
		$count = 1
		GOSUB Name=CorrMilestoneLogs
	ENDIF

	# Pick out the caches at intervals of $milestone
	$last = 1
	$count = $milestone

	# First time through we need one less than $milestone for incrementing the pointer
	$incptr = $milestone - 1

	WHILE $count < $LogTotal
		# Save $count
		$counter = $count
		# Check if there are any correction additions between
		# last position $last and next $count
		
		$_sql = "Select mmilestone FROM Milestone WHERE msettings='$settings' AND mmilestone > '$last' AND mmilestone < '$count' ORDER by mmilestone"
		
		
		$work = Sqlite("sql",$_sql)
		$list = list("sql","replace",$work)
		$x = $_sqlrows
		$tmpN1 = 1
		
		# Skip if count = 0
		IF $x <>0
			WHILE $tmpN1 <= $x
				$work = List("sql","item","$tmpN1")
				$count = Val($work)
				GOSUB Name=CorrGoToListPosition
				GOSUB Name=CorrMilestoneLogs
				$tmpN1 = $tmpN1 + 1
			ENDWHILE
		ENDIF
		#Restore $count
		$count = $counter
		
		#Step through the records
		# Use our sorted list
		GOSUB Name=CorrGoToListPosition
		$incptr = $milestone
		GOSUB Name=CorrMilestoneLogs
		IF Frac($count/10)=0
			SHOWSTATUS msg="$LangStatus20 $count" Width=350
		ENDIF
		$last = $count
		$count = $count + $milestone
				
		# For last time round loop check for any additions all the way to $LogTotal
		IF $count >= $LogTotal
			# Save $count
			$counter = $count
			$_sql = "Select mmilestone FROM Milestone WHERE msettings='$settings' AND mmilestone > '$last' AND mmilestone < '$LogTotal' ORDER by mmilestone"
			$work = Sqlite("sql",$_sql)
			$list = list("sql","replace",$work)
			$x = $_sqlrows
			$tmpN1 = 1
		
			# Skip if count = 0
			IF $x <>0
				WHILE $tmpN1 <= $x
					$work = List("sql","item","$tmpN1")
					$count = Val($work)
					GOSUB Name=CorrGoToListPosition
					GOSUB Name=CorrMilestoneLogs
					$tmpN1 = $tmpN1 + 1
				ENDWHILE
			ENDIF
			#Restore $count
			$count = $counter
		ENDIF
		
	ENDWHILE

	$count = $count - $milestone

	# Skip repeating last if it happens to be a milestone
	IF $count < $LogTotal
		#Show last Find
		$count = $LogTotal
		GOSUB Name=CorrGoToListPosition
		GOSUB Name=CorrMilestoneLogs
	ENDIF

ENDSUB #CorrMilestones

BEGINSUB Name=CorrGoToListPosition
	# Use our sorted list
	$GetMilestone = list("LL","item","$count")
	#Extract the date
	$LogDateDate = SqlToDate(Extract($GetMilestone,";",33))
ENDSUB

BEGINSUB Name=CorrMilestoneLogs
	# Create the output lines for milestones and FTFs

	$list = list("MM","replace",$work)

	$GetMilestone = list("LL","item","$count")
	#Extract the date
	$LogDateDate = SqlToDate(Extract($GetMilestone,";",33))

	$lastdate = $LogDateDate

	# Format the date to users standard format for display
	$FindDate = DateFormat($LogDateDate)

	#Strip off the suffix code if necessary
	$StripCode = Extract($GetMilestone,";",3)
	$StripCode = Extract($StripCode,"_",1)

	$name = Extract($GetMilestone,";",1)

	$_sql = "Select mcode, mdate FROM Milestone WHERE mmilestone='$count' AND msettings='$settings'"
	$work = Sqlite("sql",$_sql)
	IF $work<>""
		$StripCode = Extract($work,";",1)
		$FindDate = DateFormat(SqlToDate(Extract($work,";",2)))
		$_sql = "Select Name from ALlFinds WHERE Code like '$StripCode' LIMIT 1"
		$name = Sqlite("sql",$_sql)
	ENDIF

	# Output data
	$memo1 = $memo1 + "$count" + Left($spaces,(8 - Len("$count"))) + "$StripCode" + Left($spaces,(9 - Len($StripCode)))
	$memo1 = $memo1 + "$FindDate" + Left($spaces,(12 - Len($FindDate))) + Left($name,50) + $_NewLine

ENDSUB #CorrMilestoneLogs

#######################---Copy Database Subroutine---###########################
# Setup

	BEGINSUB Name=CopyToNewDatabase
	### Starts Here ###

	SHOWSTATUS msg="$LangStatus45" Width=350

	IF $_CurrentDatabase <> $Db
		DATABASE Name="$Db" Action=Select
	ENDIF
	
	IF $UpdateCounty
		$tmpN = GetCounty("yb")
	ENDIF
		
	# Update elevations if necessary and if it is in the current report anywhere
	$_sql = "SELECT Enabled from OrderMenu WHERE Settings = $settings and ID='29'"
	$status = Sqlite("sql",$_sql,"")
		
	IF $status = "1"
		GOSUB name=UpdateInternalElevations
	ENDIF

	# Any Benchmarks?
	$BenchmarkFinds = 0
	MFILTER Expression=$d_Found AND $d_CacheType="G" AND $d_FoundByMeDate<=$RunDate AND $d_FoundByMeDate>=$StartDate
	$BenchmarkFinds=$_FilterCount
	CANCELFILTER

	# Any Waymarks?
	$WaymarkFinds = 0
	MFILTER Expression=$d_Found AND $d_CacheType="Y" AND $d_FoundByMeDate<=$RunDate AND $d_FoundByMeDate>=$StartDate
	$WaymarkFinds=$_FilterCount
	CANCELFILTER

	CENTRE Location=$Home
	# Restore SORT from before macro run
	#$SORTData = Extract($SavedSort, "=",1)
	#$Sequence = Extract($SavedSort, "=",2)
	#SORT By=$SORTData Sequence=$Sequence
	SQLSORT OrderBy=$SavedSort

	IF Sysinfo("gsakini;TfmConfig;EdtGeoName.Text") = ""
		$msg = "Warning: You don't have a 'Matching Method' set in GSAK." + $CR + $CR + "Please go to Tools/Options and ensure you have set the 'Method for matching caches'." +$CR +$CR+ "You can click 'OK' to continue and the macro will do its best to work it out for you, but note that the macro will miss any caches with multiple finds."
		MSGOK Msg=$msg
	ENDIF
		
	
	SHOWSTATUS msg="Creating SQL files - Caches" Width=350

	# Copy just the found caches over and ignore Benchmarks and Waymarks
	MFILTER Expression=$d_Found AND NOT($d_CacheType="G") AND NOT($d_CacheType="Y") AND $d_FoundByMeDate<=$RunDate AND $d_FoundByMeDate>=$StartDate
		
	$_sql = "DROP TABLE IF EXISTS RawCaches"
	$status = Sqlite("sql",$_sql)


	#$Status = DbToSQLite("caches","Name,URL,Code,PlacedDate,CacheType,Difficulty,Terrain,FoundByMeDate,OwnerID,OwnerName,State,Country,Distance,Archived,FTF,Container,Latitude,Longitude,Usersort,CacheID,UserNote,Bearing,County",$sqlfile)
	#SQLITECACHES
	$sqlinputfile = SqlQuote($_CurrentDataPath + "\sqlite.db3")
	$_sql = "ATTACH $sqlinputfile AS gsakdb"
	$status = Sqlite("sql",$_sql)
	
	IF $_Version >= "8.0.0.0"
		$tmpS = ",FavPoints"
	ELSE
		$tmpS = ""
	ENDIF
	
	$_sql = "CREATE Table RawCaches AS SELECT Name,URL,Code,PlacedDate,CacheType,Difficulty,Terrain,FoundByMeDate,OwnerID,OwnerName,Trim(State) State,Trim(Country) Country,Distance,Archived,FTF,Container,Latitude,Longitude,Usersort,CacheID,UserNote,Bearing,Trim(County) County,Trim(Userdata) Userdata,Trim(User2) User2,Trim(User3) User3,Trim(User4) User4, Elevation, Resolution, latoriginal, lonoriginal $tmpS from gsakdb.cachesall WHERE $_Where ORDER BY $_OrderBy"
	$status = Sqlite("sql",$_sql)

	SHOWSTATUS msg="Creating SQL files - Logs" Width=350

	$_sql = "CREATE TABLE Rawlogs AS select lParent,lType,lText,lBy,lDate,lLogid,lOwnerID,lTime from gsakdb.LogsAll WHERE lIsowner AND (SUBSTR(lType,1,5)='Found' OR SUBSTR(lType,1,5)='Atten' OR SUBSTR(lType,1,5)= 'Webca') AND lDate<='$Today' AND lDate>='$SQLStart'"
	$status = Sqlite("sql",$_sql)
	
	# Check for extended logs and add in the write note logs on the same date if FindStatsExtendedLog is in user notes
	$_sql = "SELECT code from gsakdb.cachesall where usernote like '%FindStatsExtendedLog%'"
	$tmpS = Sqlite("sql",$_sql)
	$tmpN = 1
	WHILE Len(Extract($tmpS,$_NewLine,$tmpN)) > 0
		$Code = Extract($tmpS,$_NewLine,$tmpN)
		$tmpN = $tmpN + 1
		$_sql = "SELECT gsakdb.LogsAll.lText from gsakdb.LogsAll JOIN Rawlogs WHERE gsakdb.LogsAll.lIsowner and gsakdb.LogsAll.lType = 'Write note' and Rawlogs.lparent = '$Code' AND gsakdb.LogsAll.lparent='$Code' AND gsakdb.LogsAll.ldate = Rawlogs.ldate"
		$tmpS1 = Sqlite("sql",$_sql)
		$tmpS1 = Replace($_NewLine," ",$tmpS1)
		$tmpS1 = Replace("'","''",$tmpS1)
		$_sql = "UPDATE Rawlogs SET lText = lText || ' ' || '$tmpS1' WHERE rawlogs.lparent = '$Code'"
		$status = Sqlite("sql",$_sql)
	ENDWHILE
		

	$_sql = "DETACH gsakdb"
	$status = Sqlite("sql",$_sql)

	# Do we have any logs? If not then we need them!
	$_sql = "SELECT Count(*) from RawLogs"
	$tmpN = Val(Sqlite("sql",$_sql))

	IF $tmpN = 0
		$msg = "It looks like either you don't have your Found logs in GSAK "
		$msg = $msg + "or you don't have your 'Method for matching' set up correctly in Tools/Options" + $CR + $CR
		$msg = $msg + "If you don't have your logs then the easiest way to remedy this is "
		$msg = $msg + "to run the 'My Finds' Pocket Query on the Geocaching web site "
		$msg = $msg + "and import that PQ into your database to bring it up to date."
		$msg = $msg + $CR + $CR
		$msg = $msg + "If you have logs and your 'Method for matching' is the problem then Press [Continue] to get help on fixing that." + $CR + $CR
		$msg = $msg + "Or, if you want to continue anyway and let the macro do the best job it can then click [Skip next command]. Clicking [Cancel] will exit the macro."
		PAUSE Msg=$msg
		WEB url="http://gsak.net/board/index.php?showtopic=2334"
		#CANCEL
	ENDIF

	SHOWSTATUS msg="Adjusting SQL files" Width=350
	
	$_sql = "BEGIN"
	$status = Sqlite("sql",$_sql)

	$_sql = "ALTER TABLE RawCaches ADD Exclude text; "
	$_sql = $_sql + "ALTER TABLE RawLogs ADD Loglength integer"
	$status = Sqlite("sql",$_sql)
	
	$_sql = "update RawLogs SET lText = REPLACE(lText, x'0A',' ')"
	$status = Sqlite("sql",$_sql)
	
	$_sql = "update RawLogs SET lText = REPLACE(lText, x'0D','')"
	$status = Sqlite("sql",$_sql)
	
	$_sql = "update RawLogs SET lText = REPLACE(lText, '  ',' ')"
	$status = Sqlite("sql",$_sql)
	
	$_sql = "update RawLogs SET lText = g_RegexReplace('\[This entry was edited.*?\]',lText,'')"
	$status = Sqlite("sql",$_sql)

	$_sql = "update RawLogs SET LogLength = Length(trim(lText)) - Length(REPLACE(trim(lText), ' ', '')) + 1"
	$status = Sqlite("sql",$_sql)

	$_sql = "update RawCaches set Exclude = '1' where usernote like '%FindStatsExclude%'"
	$status = Sqlite("sql",$_sql)

	$_Sql = "update RawCaches set OwnerID = 'T' || OwnerID where substr(code,1,2) = 'TC' or substr(code,1,2) = 'LC'; "
	$_sql = $_sql + "update RawCaches set OwnerID = 'A' || Replace(OwnerName,';',',') where substr(code,1,2) = 'GA'; "
	$_sql = $_sql + "update RawCaches set OwnerID = 'G' || OwnerID where substr(code,1,2) = 'GC'"
	$status = Sqlite("sql",$_sql)

	$_sql = "update RawCaches set FoundByMeDate = '1900-01-01' where FoundByMeDate isnull or FoundByMeDate = ''"
	$status = Sqlite("sql",$_sql)
	
	# Check for 10 year event caches
	$_sql = "UPDATE RawCaches SET CacheType='F'  WHERE FoundByMeDate >= '2010-04-30' AND FoundByMeDate <= '2010-05-03' AND (usernote like '%FindStats10YearEvent%' or usernote like '%PseudoType10YearEvent%')"
	$status = Sqlite("sql",$_sql)

	# Check for Groundspeak HQ event caches
	$_sql = "UPDATE RawCaches SET CacheType='H'  WHERE (usernote like '%FindStatsGroundspeakHQ%' or usernote like '%PseudoTypeGroundspeakHQ%')"
	$status = Sqlite("sql",$_sql)
	
	# Check for Lost and Found caches
	$_sql = "UPDATE RawCaches SET CacheType='D'  WHERE (usernote like '%FindStatsLostFound%' or usernote like '%PseudoTypeLostFound%')"
	$status = Sqlite("sql",$_sql)

	# Check for Block Party caches
	$_sql = "UPDATE RawCaches SET CacheType='P'  WHERE (usernote like '%FindStatsBlockParty%' or usernote like '%PseudoTypeBlockParty%')"
	$status = Sqlite("sql",$_sql)
	
	$_sql = "create index codel on RawLogs (lParent); create index codec on RawCaches (code);"

	IF $UseCurrentSort
		$_sql = $_sql + " create temp table AllFindstemp AS select * from RawCaches LEFT JOIN RawLogs on code=lParent"
	ELSE
		$_sql = $_sql + " create temp table AllFindstemp AS select * from RawCaches LEFT JOIN RawLogs on code=lParent ORDER by lDate, lLogID"
	ENDIF

	$status = Sqlite("sql",$_sql)

	$_sql = "update Allfindstemp set lDate = FoundByMeDate, lTime = '19:00:00',lLogid = 0, LogLength = 0, lParent = Code, lType = 'Found it'  where lLogid isnull OR lLogid = ''"
	$status = Sqlite("sql",$_sql)
	
	# Fix any missing log dates where we can.
	$_sql = "update Allfindstemp set lDate = FoundByMeDate, lTime = '19:00:00' where lDate isnull OR lDate = ''"
	$status = Sqlite("sql",$_sql)
	
	$_sql = "ALTER TABLE Allfindstemp ADD DST integer default 0 not null"
	$status = Sqlite("sql",$_sql)

	# Set DST flag as appropriate
	
	
#2000  	2 a.m. April 2  	2 a.m. Oct. 29
#2001 	2 a.m. April 1 	2 a.m. Oct. 28
#2002 	2 a.m. April 7 	2 a.m. Oct. 27
#2003 	2.a.m. April 6 	2 a.m. Oct. 26	
#2004  	2 a.m. April 4  	2 a.m. Oct. 31
#2005 	2 a.m. April 3 	2 a.m. Oct. 30
#2006 	2 a.m. April 2 	2 a.m. Oct. 29
#2007 	2.a.m. March 11 	2 a.m. Nov. 4
#2008 	2 a.m. March 9 	2 a.m. Nov. 2
#2009 	2 a.m. March 8 	2 a.m. Nov. 1
#2010 	2 a.m. March 14 	2 a.m. Nov 7
#2011 	2 a.m. March 13 	2 a.m. Nov. 6
#2012  	 March 11  	 November 4
#2013 	March 10 	November 3
#2014 	March 9 	November 2
#2015 	March 8 	November 1

	# 2000
	$_sql = "update Allfindstemp set DST = 1 WHERE ldate || ltime >= '2000-04-0209:00:00' AND ldate || ltime < '2000-10-2908:00:00' "
	$status = Sqlite("sql",$_sql)
	
	# 2001
	$_sql = "update Allfindstemp set DST = 1 WHERE ldate || ltime >= '2001-04-0109:00:00' AND ldate || ltime < '2001-10-2808:00:00' "
	$status = Sqlite("sql",$_sql)
	
	# 2002
	$_sql = "update Allfindstemp set DST = 1 WHERE ldate || ltime >= '2002-04-0709:00:00' AND ldate || ltime < '2002-10-2708:00:00' "
	$status = Sqlite("sql",$_sql)
	
	# 2003
	$_sql = "update Allfindstemp set DST = 1 WHERE ldate || ltime >= '2003-04-0609:00:00' AND ldate || ltime < '2003-10-2608:00:00' "
	$status = Sqlite("sql",$_sql)
	
	# 2005
	$_sql = "update Allfindstemp set DST = 1 WHERE ldate || ltime >= '2005-04-0309:00:00' AND ldate || ltime < '2005-10-3008:00:00' "
	$status = Sqlite("sql",$_sql)
	
	# 2006
	$_sql = "update Allfindstemp set DST = 1 WHERE ldate || ltime >= '2006-04-0209:00:00' AND ldate || ltime < '2006-10-2908:00:00' "
	$status = Sqlite("sql",$_sql)
	
	# 2007
	$_sql = "update Allfindstemp set DST = 1 WHERE ldate || ltime >= '2007-03-1109:00:00' AND ldate || ltime < '2007-11-0408:00:00' "
	$status = Sqlite("sql",$_sql)
	
	# 2008
	$_sql = "update Allfindstemp set DST = 1 WHERE ldate || ltime >= '2008-03-0909:00:00' AND ldate || ltime < '2008-11-0208:00:00' "
	$status = Sqlite("sql",$_sql)
	
	# 2009
	$_sql = "update Allfindstemp set DST = 1 WHERE ldate || ltime >= '2009-03-0809:00:00' AND ldate || ltime < '2009-11-0108:00:00' "
	$status = Sqlite("sql",$_sql)
	
	# 2010
	$_sql = "update Allfindstemp set DST = 1 WHERE ldate || ltime >= '2010-03-1409:00:00' AND ldate || ltime < '2010-11-0708:00:00' "
	$status = Sqlite("sql",$_sql)
	
	# 2011
	$_sql = "update Allfindstemp set DST = 1 WHERE ldate || ltime >= '2011-03-1309:00:00' AND ldate || ltime < '2011-11-0608:00:00' "
	$status = Sqlite("sql",$_sql)
	
	# 2012
	$_sql = "update Allfindstemp set DST = 1 WHERE ldate || ltime >= '2012-03-1109:00:00' AND ldate || ltime < '2012-11-0408:00:00' "
	$status = Sqlite("sql",$_sql)
	
	# 2013
	$_sql = "update Allfindstemp set DST = 1 WHERE ldate || ltime >= '2013-03-1009:00:00' AND ldate || ltime < '2013-11-0308:00:00' "
	$status = Sqlite("sql",$_sql)
	
	# 2014
	$_sql = "update Allfindstemp set DST = 1 WHERE ldate || ltime >= '2014-03-0909:00:00' AND ldate || ltime < '2014-11-0208:00:00' "
	$status = Sqlite("sql",$_sql)
	
	# 2015
	$_sql = "update Allfindstemp set DST = 1 WHERE ldate || ltime >= '2015-03-0809:00:00' AND ldate || ltime < '2015-11-0108:00:00' "
	$status = Sqlite("sql",$_sql)
	
	
	
	# Fix-up log dates where lTime is 'exact' rather than 19:00 from an iPhone etc and GC's log date is Zulu time.
	# Subtract 7 hours - note this may still be in error when DST is not in use
	# Note - Only for GC caches and only for dates  later than 2008-1-1
	$_sql = "update Allfindstemp set lDate = date(ldate || 'T' || ltime || 'Z','-8 hours') WHERE DST <> 1 AND substr(code,1,2) = 'GC' AND ldate >= '2008-01-01'"
	$status = Sqlite("sql",$_sql)
	
	$_sql = "update Allfindstemp set lDate = date(ldate || 'T' || ltime || 'Z','-7 hours') WHERE DST = 1 AND substr(code,1,2) = 'GC' AND ldate >= '2008-01-01'"
	$status = Sqlite("sql",$_sql)


	$_sql = "update Allfindstemp set Exclude = '0' where Exclude isnull"
	$status = Sqlite("sql",$_sql)

	# Calculate and fix up week numbers for weeks that cross the year end
	$_sql = "ALTER TABLE Allfindstemp add WeekNumber text; "
	$_sql = $_sql + "UPDATE Allfindstemp set WeekNumber = strftime('%W-%Y',lDate); "
	$_sql = $_sql + "UPDATE Allfindstemp set WeekNumber = strftime('%W-%Y',lDate,'start of year','-1 days') WHERE substr(WeekNumber,1,2) = '00'"
	$status = Sqlite("sql",$_sql)

	#Fix up FTF's on caches with multiple finds, only the oldest find should have the FTF
	$_sql = "select code, ftf, lLogid from allfindstemp where FTF = '1' AND code in(select code from (select count(code) as count, code, llogid from allfindstemp group by code)  where count > 1) order by code, llogid"

	$work = Sqlite("sql",$_sql)
	$list = list("sql","replace",$work)
	$count = $_SqlRows
	$i = 1
	$SaveCode = ""
	WHILE $i <= $count AND $count >0
		$tmpS = List("sql","item","$i")
		$Code = Extract($tmpS,";",1)
		$FTF = Extract($tmpS,";",1)
		$Log = Extract($tmpS,";",3)
		$tmpN = Val($Log)
		IF $Code <> $SaveCode
			$SaveCode = $Code
		ELSE
			$_sql = "UPDATE allfindstemp set FTF = '0' WHERE lLogid = $tmpN"
			$status = Sqlite("sql",$_sql)
		ENDIF
		$i = $i + 1
	ENDWHILE
		

	# Get my OwnerID
	$_sql = "SELECT lOwnerId from Allfindstemp order by lOwnerID DESC LIMIT 1"
	$MyId = Val(Sqlite("sql",$_sql))
	
	# Calculate distances from home positions and update Distance and Bearing fields
	
	$Latitude = SysInfo("gsakini;LastCenter;Lat")
	$longitude = SysInfo("gsakini;LastCenter;Lon")
	
	$_sql = "ALTER TABLE Allfindstemp add CenLat text; ALTER TABLE Allfindstemp add CenLon text"
	$status = Sqlite("sql",$_sql)
	
	$_sql = "UPDATE Allfindstemp set CenLat = (SELECT hlat FROM Home WHERE hdate <= ldate AND hsettings = $settings ORDER BY hdate DESC LIMIT 1); "
	$_sql = $_sql + "UPDATE Allfindstemp set CenLon = (SELECT hlon FROM Home WHERE hdate <= ldate AND hsettings = $settings ORDER BY hdate DESC LIMIT 1)"
	$status = Sqlite("sql",$_sql)

	$_sql = "UPDATE Allfindstemp set CenLat = '$Latitude', CenLon = '$Longitude' WHERE CenLat LIKE('Current')"
	$status = Sqlite("sql",$_sql)
	
	$tmpS = Sysinfo("Distance")

	$_sql = "UPDATE Allfindstemp set Distance =Round(g_Distance(latitude,longitude,CenLat,CenLon,'$tmpS'),2)"
	$status = Sqlite("sql",$_sql)
	
	# Fix up Event cache Placed dates so that repeating events work correctly
	$_sql = "UPDATE Allfindstemp SET PlacedDate=lDate WHERE CacheType = 'E' AND usernote like '%FindStatsRepeatingEvent%'"
	$status = Sqlite("sql",$_sql)

	# Uncomment the next two lines to make bearings also follow changing 'Home' positions
	# $_sql = "UPDATE Allfindstemp set Bearing = g_Bearing1(CenLat,CenLon,latitude,longitude)"
	# $status = Sqlite("sql",$_sql)
	
	# Now it's all fixed up copy to working database in correct order

	IF $UseCurrentSort
		$_sql = "Create table AllFinds AS select * from Allfindstemp;"
	ELSE
		$_sql = "Create table AllFinds AS select * from Allfindstemp ORDER by lDate, lLogID;"
	ENDIF

	$_sql = $_sql + " DROP TABLE IF EXISTS Allfindstemp"
	$status = Sqlite("sql",$_sql)

	$_sql = "UPDATE AllFinds SET URL = 'http://coord.info/' || code WHERE substr(code,1,2) = 'GC'"
	$status = Sqlite("sql",$_sql)
	
	$_sql = "DROP TABLE IF EXISTS RawCaches; "
	$_sql = $_sql + "DROP TABLE IF EXISTS RawLogs"
	$status = Sqlite("sql",$_sql)
	
	$_sql = "COMMIT"
	$status = Sqlite("sql",$_sql)

	SHOWSTATUS msg="$LangStatus50" Width=350

ENDSUB

BEGINSUB name=PlacedStats

	############ Placed Stats Routines ###############

	#Save current environment
	#$PCurrentSort = $_SortBy
	$PCurrentSort = $_OrderBy
	
	IF SysInfo("JoinFilter") = "N"
		$PCurrentFilter = SaveFilter()
	ELSE
		$PCurrentFilter = "NA"
	ENDIF
	$PCurrentDB = $_CurrentDatabase

	# Initialize some variables

	$Data="Name text, URL text, Code text, Placed text, Age real, Type text, Difficulty real,"
	$Data=$Data + "Terrain real, Status text, Finds integer, AvgDays real, LogMin integer, LogMax integer,"
	$Data=$Data + "LogAverage real, Adopted text, Logid integer, Exclude text, CacheType text, Country text,"
	$Data=$Data + "Latitude real, Longitude real, latoriginal real, lonoriginal real"
	
	IF $_Version >= "8.0.0.0"
		$Data = $Data + ",FavPoints integer"
	ENDIF

	$_sql = "CREATE TABLE PlacedStatsdata ($Data)"
	$status = Sqlite("sql",$_sql)

	# Main section of the macro:

	GOSUB name=ChangeDB #and filter for placed caches
	GOSUB name=GatherLogs
	GOSUB name=GatherStats

	# $_sql = "UPDATE PlacedStatsData SET URL = 'http://coord.info/' || code WHERE substr(code,1,2) = 'GC'"
	# $status = Sqlite("sql",$_sql)

	# Restore database, filter, and sort
	IF $PCurrentDB<>$_CurrentDatabase
		DATABASE Name=$PCurrentDB Action=Select
	ENDIF
	
	IF $PCurrentFilter <>"NA"
		IF restorefilter($PCurrentFilter, True) = 0
			PAUSE msg="Previously-set filter would now show no records. Clearing."
		ENDIF
	ENDIF

	#$sortdata = Extract($PCurrentSort, "=",1)
	#$sequence = Extract($PCurrentSort, "=",2)
	#SORT by=$sortdata Sequence=$sequence
	SQLSORT OrderBy=$PCurrentSort
	

ENDSUB #name=PlacedStats

########################
# Start of Subroutines #
########################

BEGINSUB Name=ChangeDB
	IF $PlacedDatabase<>$_CurrentDatabase
		DATABASE Name=$PlacedDatabase Action=Select
	ENDIF
		
	IF $RunDate = $_Today
		MFILTER Expression=IsOwner() AND NOT($d_CacheType="Y")
	ELSE
		MFILTER Expression=IsOwner() AND NOT($d_CacheType="Y") AND $d_PlacedDate<=$RunDate
	ENDIF
	IF $_FilterCount=0
		CANCEL Msg=No placed caches were found in this database.
	ENDIF
	GOTO Position=Top
ENDSUB

BEGINSUB Name=GatherLogs

	#### Code for 7.3+

	#$status = DbtoSqlite("caches","code",$sqlfile)

	$sqlinputfile = SqlQuote($_CurrentDataPath + "\sqlite.db3")
	$_sql = "ATTACH $sqlinputfile AS gsakdb"
	$status = Sqlite("sql",$_sql)

	$_sql = "CREATE TABLE placedlogs AS select lParent,lType,lText,lBy,lDate,lLogid,lOwnerID from gsakdb.LogsAll WHERE (lparent IN (SELECT code FROM gsakdb.caches where $_Where)) AND (SUBSTR(lType,1,5)='Found' OR SUBSTR(lType,1,5)='Atten' OR SUBSTR(lType,1,5)= 'Webca' OR SUBSTR(lType,1,5)= 'Archi') AND lDate<='$Today' AND lDate>='$SQLStart'"
	$status = Sqlite("sql",$_sql)

	$_sql = "DETACH gsakdb"
	$status = Sqlite("sql",$_sql)

	#### Code for 7.3+

	$_sql = "BEGIN"
	$status = Sqlite("sql",$_sql)
	$_sql = "UPDATE Placedlogs Set lOwnerid = 'G' || lOwnerid where substr(lParent,1,2)='GC'"
	$status = Sqlite("sql",$_sql)
	$_sql = "UPDATE Placedlogs Set lOwnerid = 'T' || lOwnerid where substr(lParent,1,2)='TC' OR substr(lParent,1,2)='LC'"
	$status = Sqlite("sql",$_sql)
	$_sql = "UPDATE Placedlogs Set lOwnerid = 'A' || Replace(lBy,';',',') where substr(lparent,1,2) = 'GA'"
	$status = Sqlite("sql",$_sql)
	$_sql = "ALTER TABLE Placedlogs ADD Loglength integer"
	$status = Sqlite("sql",$_sql)
	
	$_sql = "update PlacedLogs SET lText = REPLACE(lText, x'0A',' ')"
	$status = Sqlite("sql",$_sql)
	
	$_sql = "update PlacedLogs SET lText = REPLACE(lText, x'0D','')"
	$status = Sqlite("sql",$_sql)
	
	$_sql = "update PlacedLogs SET lText = REPLACE(lText, '  ',' ')"
	$status = Sqlite("sql",$_sql)
	
	$_sql = "update PlacedLogs SET lText = g_RegexReplace('\[This entry was edited.*?\]',lText,'')"
	$status = Sqlite("sql",$_sql)
	
	$_sql = "update PlacedLogs SET LogLength = Length(trim(lText)) - Length(REPLACE(trim(lText), ' ', '')) + 1"
	$status = Sqlite("sql",$_sql)
	$_sql = "COMMIT"
	$status = Sqlite("sql",$_sql)
ENDSUB

BEGINSUB Name=GatherStats
	$_sql = "BEGIN"
	$status = Sqlite("sql",$_sql)
	# Convert Cache Type from Abbreviation to Full Name
		$AbbTypes="ABCELMORTUVWZXIFHDP"
		$FullTypes="Project Ape;Letterbox;CITO;Event;Locationless;Multi;Other;Earth;Traditional;Unknown/Mystery;Virtual;Webcam;Mega event;GPS Adventures Exhibit;Wherigo;10 Years! Event;Groundspeak HQ;Lost and Found Celebration;Block Party"
	WHILE NOT($_EOL)
		SHOWSTATUS msg="$Lang91: $d_Name" Width=350
		$Data=""
		$Finds=""
		$Finders=""
		$Adopted="0"
		$C_Exclude="0"
		$CacheName=Replace("'","''",$d_Name,TRUE)
		$CacheURL=Replace("'","''",$d_Url,TRUE)
		$CacheCode=Replace("'","''",$d_Code,TRUE)
		$PlacedDate=DateToSql($d_PlacedDate)
		$CacheType=$d_CacheType	
		$Position = At($CacheType,$AbbTypes)
		$CacheTypeFull = Extract($FullTypes,";",$Position)
		$CacheDif=NumToStr($d_Difficulty)
		$CacheTer=NumToStr($d_Terrain)
		$CacheStatus="Available"

		IF $d_TempDisabled
			$CacheStatus="Temp Disabled"
		ENDIF

		IF $d_Archived
			$CacheStatus="Archived"
		ENDIF

		IF $d_HasUserNote
			IF RegEx("PlacedStatsAdopted",$d_UserNote)
				$Adopted = "1"
			ENDIF
			IF RegEx("PlacedStatsExclude",$d_UserNote)
				$C_Exclude = "1"
			ENDIF
			IF RegEx("FindStats10YearEvent",$d_UserNote) OR RegEx("PseudoType10YearEvent",$d_UserNote)
				$CacheType = "F"
			ENDIF
			IF RegEx("FindStatsGroundspeakHQ",$d_UserNote) OR RegEx("PseudoTypeGroundspeakHQ",$d_UserNote)
				$CacheType = "H"
			ENDIF
			IF RegEx("FindStatsLostFound",$d_UserNote) OR RegEx("PseudoTypeLostFound",$d_UserNote)
				$CacheType = "D"
			ENDIF
			$Position = At($CacheType,$AbbTypes)
			$CacheTypeFull = Extract($FullTypes,";",$Position)
		ENDIF

		$AgeInDays=DateDiff($d_PlacedDate,$RunDate)
		$AgeInMonths=Val(Alltrim(Str($AgeInDays/30.1,4,1)))
		GOSUB Name=CountFinds
		IF $PTotalFinds>0
			IF $d_Archived
				$_sql = "SELECT lDate from PlacedLogs where lParent = '$d_Code' order by ldate desc limit 1"
				$LogDateDate = SqlToDate(Sqlite("sql",$_sql))
				$AgeInDays=DateDiff($d_PlacedDate,$LogDateDate)
				$AgeInMonths=Val(Alltrim(Str($AgeInDays/30.1,4,1)))
			ENDIF
			$AvgDaysPerLog=Int(10 * $AgeInDays/$PTotalFinds)
		ELSE
			$AvgDaysPerLog= 9998
		ENDIF

		$LogAverage = Int($LogAverage)

		IF $_Version >= "8.0.0.0"
			$tmpS = ",'$d_FavPoints'"
		ELSE
			$tmpS = ""
		ENDIF
		
		#Write data for this cache to the file
		$_sql = "INSERT INTO PlacedStatsData VALUES('$CacheName','$CacheURL','$CacheCode','$PlacedDate',$AgeInMonths,'$CacheTypeFull',$d_Difficulty,$d_Terrain,'$CacheStatus',"
		$_sql = $_sql + "$PTotalFinds,$AvgDaysPerLog,$LogMin,$LogMax,$LogAverage,'$Adopted',$Logid,'$C_Exclude','$CacheType','$d_country','$d_latitude','$d_longitude','$d_latoriginal','$d_lonoriginal'$tmpS)"	
		
		$result = Sqlite("sql",$_sql)

		GOTO Position=Next
	ENDWHILE
	$_sql = "COMMIT"
	$status = Sqlite("sql",$_sql)
ENDSUB

BEGINSUB Name=CountFinds
	$_sql = "SELECT count(lType) FROM PlacedLogs where lParent = '$d_Code' and lType <> 'Archive'"
	$PTotalFinds = Val(Sqlite("sql",$_sql))
	$_sql = "SELECT loglength FROM PlacedLogs where lParent = '$d_Code' and lType <> 'Archive' order by loglength DESC limit 1"
	$LogMax = Val(Sqlite("sql",$_sql))
	$_sql = "SELECT loglength FROM PlacedLogs where lParent = '$d_Code' and lType <> 'Archive' order by loglength ASC limit 1"
	$LogMin = Val(Sqlite("sql",$_sql))
	$_sql = "SELECT Avg(loglength) FROM PlacedLogs where lParent = '$d_Code' and lType <> 'Archive'order by loglength DESC limit 1"
	$LogAverage = Val(Sqlite("sql",$_sql))
	$_sql = "SELECT lLogid FROM PlacedLogs where lParent = '$d_Code' and lType <> 'Archive' order by loglength DESC limit 1"
	$Logid = Val(Sqlite("sql",$_sql))
ENDSUB

BEGINSUB name=GetMapSelection
	#Choose which maps you want
	$text1 = $MapString
	
	WHILE TRUE
		$Form9 = EditForm($Form9,"MapString","Values",$MapMasterList)
		$tmpS = Form($form9,"")
		# Reset the screen position of the menu form to where the user left it
		$Form9 = EditForm($Form9,"Form9","Top",$_FormTop)
		$Form9 = EditForm($Form9,"Form9","Left",$_FormLeft)
		BEGINCASE
		CASE $MapsCancel
			$MapString = $text1
			GOSUB name=DoTypecasting
			BREAK
		CASE $EditMaps
			GOSUB Name=EditMaps
		CASE $InstallMaps
			GOSUB Name=InstallMapFiles
			GOSUB Name=ChooseCountries
		CASE $MapsOK
			$MapStringText = Replace(";","%%",$MapString,TRUE)
			#MSGOK msg= $mapstring, $Mapstringtext
			BREAK
		OTHERWISE
			CANCEL msg="Macro cancelled"
		ENDCASE
	ENDWHILE
ENDSUB

BEGINSUB Name=CheckDatabase

	# Store Current waypoint for restoration later
	IF NOT($_Count=0)
		$Savedcode = $d_Code
	ENDIF

	# Store current database for restoration later
	$currentdb = $_CurrentDatabase

	# Store current filter to restore at end of macro
	IF SysInfo("JoinFilter") = "N"
		$SavedFilter = SaveFilter()
	ELSE
		$SavedFilter = "NA"
	ENDIF

	# Store current SORT settings to restore at end of macro
	#$SavedSortOriginal = $_SortBy
	$SavedSortOriginal = $_OrderBy

	IF $_CurrentDatabase <> $Db
		DATABASE Name="$Db" Action=Select
	ENDIF

	CANCELFILTER
	MFILTER expression=$d_Source="GC"
	$ThisRecord = 0
	TRANSACTION action=begin
	MACROFLAG Type=Clear Range=All
	GOTO position=Top
	WHILE NOT($_EOL)
		$ThisRecord = $ThisRecord + 1
		IF Frac($ThisRecord/10) = 0
			SHOWSTATUS msg="Now checking record $Thisrecord of $_count"
		ENDIF
		IF NOT(RegEx("^http://www\.geocaching\.com/seek/cache_details\.aspx",$d_Url))
			$d_MacroFlag=TRUE
		ENDIF
		GOTO Position=Next
	ENDWHILE
	TRANSACTION action=end
	SHOWSTATUS Msg="Done" Display=off
	MFILTER expression=$d_Macroflag
	IF $_FilterCount <> 0
		CANCEL Msg="Suspect records found. Please check those listed."
	ELSE

		# Check all dates are good
	
		$_sql = "SELECT code from allfinds WHERE date(ldate) ISNULL OR ldate = '1900-01-01'"
		$tmpS = Sqlite("sql",$_sql)
	
		IF Len($tmpS) > 0
			$msg = "The following caches have bad or missing Log dates. Please check your database:" + $_NewLine + $tmpS
			MSGOK msg=$msg
		ELSE
			MSGOK msg="The database and dates appear to be good"
		ENDIF
	ENDIF

	IF $_CurrentDatabase <> $currentdb
		DATABASE Name=$currentdb Action=select
	ENDIF

	# Restore applied filter
	IF $SavedFilter <>"NA"
		$tmpN = RestoreFilter($SavedFilter,True)
	ENDIF
	# Restore SORT
	#$SORTData = Extract($SavedSortOriginal, "=",1)
	#$Sequence = Extract($SavedSortOriginal, "=",2)
	#SORT By=$SORTData Sequence=$Sequence
	SQLSORT OrderBy=$SavedSortOriginal

	# Position at saved waypoInt
	$tmpB = Seek($SavedCode)

ENDSUB # CheckDatabase

BEGINSUB Name=CheckUpdates
	SHOWSTATUS msg="Checking for updates, please wait..." Width=350
	# Add date/time string to the end to stop caching problems
	$tmpS1 = "?random=" + DateToString($_Today) + Replace(":","",Time(),TRUE)
	$tmpS = "http://www.lignumaqua.com/gsak/findstatsversion.txt" + $tmpS1
	SHOWSTATUS Msg="Done" Display=off
	$result = GetUrl($tmpS)
	IF Left($result,7) <> "*Error*"
		$tmpN = 10000*Val(Extract($result,".",1)) + 100*Val(Extract($result,".",2)) + Val(Extract($result,".",3))
		$tmpN1 = 10000*Val(Extract($revision,".",1)) + 100*Val(Extract($revision,".",2)) + Val(Extract($revision,".",3))
		# MSGOK msg="$tmpN, $tmpN1"
		IF $tmpN > $tmpN1
			$tmpS = "You have version $revision but $result is available"
			$Form7 = Editform($Form7,"UpdateText","caption","$tmpS")
			WHILE TRUE
				$tmpS = Form($form7,"")
				# Reset the screen position of the menu form to where the user left it
				$Form7 = EditForm($Form7,"Form7","Top",$_FormTop)
				$Form7 = EditForm($Form7,"Form7","Left",$_FormLeft)
				BEGINCASE
				CASE $GetUpdate
					# open Web page
					$FileName = $htmlfilepath + "\findstatsgenhelp.html"
					WEB URL="http://gsak.net/board/index.php?act=ST&f=19&t=4623&view=getnewpost"
					BREAK
				CASE $UpdateOK
					BREAK
				ENDCASE
			ENDWHILE
		ELSE
			MSGOK msg="$Lang166"
		ENDIF
	ENDIF

ENDSUB

BEGINSUB Name=Special
	# Check there is some data
	$_sql = "Select * FROM Special WHERE ssettings='$settings' ORDER by snumber"
	$work = Sqlite("sql",$_sql)
	IF $work=""
		EXITSUB
	ENDIF

	# Initialise Section variables

	# Initialise Section header
	$colspan = 1
	$text="$LangForm65"
	GOSUB Name=SectionHead
	$out = AddStr(1,"add","<table width='$maxtablewidth' style='text-align: left;'>" + $CR)
	# Column Heads
	$text1 = "<b>$LangForm64</b>"
	$text2 = "<b>$Lang34</b>"
	$text3 = "<b>$Lang35</b>"
	$text4 = "<b>$LangForm63</b>"

	$out = AddStr(1,"add","<tr>" + "$CR" + "<td style='$stTab2cHead'>" + $CR)
	$out = AddStr(1,"add","$text1</td>" + $CR)
	$out = AddStr(1,"add","<td style='$stTab2cHead'>$text2</td>" + $CR)
	IF $miletypes
		$out = AddStr(1,"add","<td style='$stTab2cHead'>&nbsp;</td>" + $CR)
	ENDIF
	$out = AddStr(1,"add","<td style='$stTab2cHead'>$text3</td>" + $CR)
	$out = AddStr(1,"add","<td style='$stTab2cHead'>$text4</td>" + $CR + "</tr>" + $CR)

	# Initialize variables
	$list = list("SS","replace",$work)
	$SpecialTotal = val(list("SS","count",""))
	$count = 1
	#snumber, stype, scode, sdescription
	WHILE $count <= $SpecialTotal
		$GetSpecial = List("SS","item","$count")
		# Type
		$text1 = Extract($GetSpecial,";",2)
		# $text1=Replace(Chr(96),"'",$text1,TRUE)
		# Code
		$StripCode = Extract($GetSpecial,";",3)
		# Description
		$text4 = Extract($GetSpecial,";",4)
		# $text4=Replace(Chr(96),"'",$text4,TRUE)
		IF $StripCode = "HEAD"
			$out = AddStr(1,"add","<tr>" + "$CR")
			IF $miletypes
				$tmpN = 5
			ELSE
				$tmpN = 4
			ENDIF
			$out = AddStr(1,"add","<td align='center' colspan='$tmpN'><b>$text4</b></td>" + $CR + "</tr>" + $CR)
		ELSE
			$_sql = "Select Name, URL from AllFinds WHERE Code like '$StripCode' LIMIT 1"
			$work = Sqlite("sql",$_sql)
			$text3 = Extract($work,";",1)
			$URL = Extract($work,";",2)
			$text2 = "<a href='$URL'>$StripCode</a>"
			IF $miletypes
				$tmpB = FALSE
				GOSUB Name=StripCodeType
				$text6 = $TypeImage
			ELSE
				$text6 = ""
			ENDIF
			IF Len($text3) > 0
				GOSUB name=SpecialLine
			ENDIF
		ENDIF
		$count = $count + 1
	ENDWHILE

	$out = AddStr(1,"add","</table>" + $CR)

ENDSUB #Special

BEGINSUB name=SpecialLine
	# Add a line to the 'Special' section, inputs are:
	# $text1 : Special type
	# $text2 : Code
	# $text3 : Name
	# $text4 : Description
	$out = AddStr(1,"add","<tr>" + "$CR" + "<td style='$st2c1'>" + $CR)
	$out = AddStr(1,"add","$text1</td>" + $CR)
	$out = AddStr(1,"add","<td style='$st2c2'>$text2</td>" + $CR)
	IF $miletypes
		$out = AddStr(1,"add","<td style='$st2c2'>$text6</td>" + $CR)
	ENDIF
	$out = AddStr(1,"add","<td style='$st2c2'>$text3</td>" + $CR)
	$out = AddStr(1,"add","<td style='$st2c1'>$text4</td>" + $CR + "</tr>" + $CR)
ENDSUB # SpecialLine

BEGINSUB Name=EditSpecial

	# Check the main SQL table exists and exit if not
	
	IF FileExists($sqlfile)
		$_sql = "pragma table_info(allfinds)"
		$status = Sqlite("sql",$_sql)
		IF Len($status) = 0
			MSGOK msg="You must run the Stats program all the way through at least once before adding special caches."
			EXITSUB
		ENDIF
	ELSE
		MSGOK msg="You must run the Stats program all the way through at least once before adding special caches."
		EXITSUB
	ENDIF

	$spaces = "                "
	
	GOSUB name=DisplaySpecials

	SHOWSTATUS msg="$LangStatus20" Width=350 Display=Off

	GOSUB Name=MainSpecial

ENDSUB # EditSpecial

BEGINSUB Name=MainSpecial
	#Special caches editor form
	
	$_sql = "BEGIN"
	$status = Sqlite("sql",$_sql,"")
	
	WHILE TRUE
		$tmpS = Form($form8,"")
		# Reset the screen position of the menu form to where the user left it
		$Form8 = EditForm($Form8,"Form8","Top",$_FormTop)
		$Form8 = EditForm($Form8,"Form8","Left",$_FormLeft)
		BEGINCASE
		CASE $SpecialCancel
			$_sql = "ROLLBACK"
			$status = Sqlite("sql",$_sql,"")
			BREAK
		CASE $SpecialLoad
			GOSUB name=LoadSpecial
		CASE $SpecialEdit
			GOSUB name=AddSpecial
		CASE $SpecialDelete
			GOSUB name=DeleteSpecial
		CASE $SpecialOK
			$_sql = "COMMIT"
			$status = Sqlite("sql",$_sql,"")
			BREAK
		OTHERWISE
			$_sql = "ROLLBACK"
			$status = Sqlite("sql",$_sql,"")
			CANCEL msg="Macro cancelled"
		ENDCASE
	ENDWHILE
ENDSUB # MainSpecial

BEGINSUB name=LoadSpecial
	$_sql = "Select * FROM Special WHERE snumber = '$specialnumber' AND ssettings='$settings'"
	$work = Sqlite("sql",$_sql,"")
	IF $work <> ""
		# Type
		$specialtype = Extract($work,";",2)
		# Code
		$specialcode = Extract($work,";",3)
		# Description
		$specialdescription = Extract($work,";",4)
	ELSE
		MSGOK msg="Error - That number is not defined"
		EXITSUB
	ENDIF

ENDSUB # LoadSpecial

BEGINSUB name=DisplaySpecials
	$specialmemo = ""
	$_sql = "Select * FROM Special WHERE ssettings='$settings' ORDER by snumber"
	$work = Sqlite("sql",$_sql)
	IF $work = ""
		EXITSUB
	ENDIF
	$list = list("SS","replace",$work)
	$SpecialTotal = val(list("SS","count",""))
	$count = 1
	WHILE $count <= $SpecialTotal
		$GetSpecial = list("SS","item","$count")
		# Number
		$text1 = Extract($GetSpecial,";",1)
		# Type
		$text2 = Left(Extract($GetSpecial,";",2),16)
		$text2 = Replace(Chr(96),"'",$text2,TRUE)
		# Code
		$StripCode = Extract($GetSpecial,";",3)
		# Description
		$text4 = Left(Extract($GetSpecial,";",4),32)
		$text4 = Replace(Chr(96),"'",$text4,TRUE)

		$_sql = "Select Name from AllFinds WHERE Code like '$StripCode' LIMIT 1"
		$name = Left(Sqlite("sql",$_sql),20)

		$specialmemo = $specialmemo + $text1 + Left($spaces,(4 - Len($text1))) + $text2 + Left($spaces,(17 - Len($text2))) + "$StripCode" + Left($spaces,(8 - Len($StripCode)))
		$specialmemo = $specialmemo + $name + Left($spaces,(21 - Len($name))) + $text4 + $_NewLine
		$count = $count + 1
	ENDWHILE
ENDSUB # DisplaySpecials

BEGINSUB name=AddSpecial
	#snumber, stype, scode, sdescription

	IF Regex("[^0-9]", $specialnumber) OR Val($specialnumber)=0
		MSGOK msg="The cache number (#) must be a positive integer"
		EXITSUB
	ENDIF

	IF $specialcode <>""

		IF Upper($specialcode) = "HEAD"
			$specialcode=Replace(";",",",$specialcode,TRUE)
			#$specialcode=Replace("'",Chr(96),$specialcode,TRUE)
		ELSE
			# Check code is in database
			$_sql = "Select Name from AllFinds WHERE Code like '$specialcode' LIMIT 1"
			$work = Sqlite("sql",$_sql)
			IF $work = ""
				MSGOK msg="Error - That GC code is not in the database"
				EXITSUB
			ENDIF
		ENDIF

		$text1=Replace(";",",",$specialtype,TRUE)
		$text1=Replace("'","''",$specialtype,TRUE)
		#$text1=Replace("'",Chr(96),$specialtype,TRUE)
		$text2=Replace(";",",",$specialdescription,TRUE)
		$text2=Replace("'","''",$specialdescription,TRUE)
		#$text2=Replace("'",Chr(96),$specialdescription,TRUE)
		$specialcode = Upper($specialcode)

		#$sql = "UPDATE FoundStatsSpecial2 SET stype='$text1', scode='$specialcode', sdescription='$text2' WHERE snumber = '$specialnumber' AND ssettings='$settings'"
		$_sql = "REPLACE INTO Special VALUES ('$specialnumber','$text1','$specialcode','$text2','$settings')"
		$work = Sqlite("sql",$_sql)
		
		GOSUB name=DisplaySpecials
	ENDIF
ENDSUB

BEGINSUB name=DeleteSpecial
	#snumber, stype, scode, sdescription

	$_sql = "DELETE FROM Special WHERE snumber='$specialnumber' AND ssettings='$settings'"
	$work = Sqlite("sql",$_sql)

	GOSUB name=DisplaySpecials
ENDSUB

BEGINSUB name=InstallMapFiles
	# Parse List of Map data files on GSAK server into SQLite database

	# Open main sqlite database file
	$sqlfile = $_Install + "\macros\FoundStatsSQLLite.db3"
	IF NOT(FileExists($sqlfile))
		$status = Sqlite("create",$sqlfile)
	ENDIF
	$status = Sqlite("open",$sqlfile)

	# Drop existing
	$_sql = "DROP TABLE IF EXISTS MapDataFiles"
	$status = Sqlite("sql",$_sql)
	#Create Map Data Files table if necessary
	$Data = "title text unique, link text, version text, author text, mapdate date, mapdescription text, type text"
	$_sql = "CREATE TABLE IF NOT EXISTS MapDataFiles ($Data)"
	$status = Sqlite("sql",$_sql)

	# Create data file path
	$datafilepath = Sysinfo("MacroPath")
	$Folder = $datafilepath + "\FindStatGenData"
	IF Not(FolderExists($Folder))
		$BatFile = $_Install + "\babel.bat"
		$result = PutFile($BatFile, "MD " + quote($Folder))
		FileOpen File="$BatFile" Wait=yes
	ENDIF


	$work = GetUrl("http://gsak.net/stats/test/mapfilelist.php","Getting list of Map Data Files")
	$work = RegExSub("(?s)<mapdatafiles>(.*)</mapdatafiles>",$work,1,1)
	$count = RegExCount("(?s)<map>(.*?)</map>",$work)
	IF $count>0
		$_sql = "BEGIN"
		$status = Sqlite("sql",$_sql,"")
		$i = 1
		WHILE $i <= $count
			$text1 = RegExSub("(?s)<title>(.*?)</title>",$work,$i,1)
			$text2 = RegExSub("(?s)<link>(.*?)</link>",$work,$i,1)
			$text3 = RegExSub("(?s)<version>(.*?)</version>",$work,$i,1)
			$text3 = Extract($text3,$_NewLine,1)
			$text4 = RegExSub("(?s)<author>(.*?)</author>",$work,$i,1)
			$text5 = RegExSub("(?s)<date>(.*?)</date>",$work,$i,1)
			$text6 = RegExSub("(?s)<description><!\[CDATA\[(.*?)\]\]></description>",$work,$i,1)
			$text7 = RegExSub("(?s)<type>(.*?)</type>",$work,$i,1)
			$i = $i + 1
			$_sql = "REPLACE INTO mapdatafiles VALUES('$text1','$text2','$text3','$text4','$text5','$text6','$text7')"
			$status = Sqlite("sql",$_sql)
		ENDWHILE
		$_sql = "COMMIT"
		$status = Sqlite("sql",$_sql,"")
	ENDIF

	$_sql = "SELECT mapdescription FROM MapDataFiles ORDER BY mapdescription COLLATE nocase"
	$status = Sqlite("sql",$_sql,"")
	$tmpS = Replace($_NewLine,";",$status)
	
	# Reset the screen position of the menu form to where the user left it
	$Form18 = EditForm($Form18,"Form18","Top",$_FormTop)
	$Form18 = EditForm($Form18,"Form18","Left",$_FormLeft)

	$form18 = Replace("%MapList%",$tmpS,$form18)

	WHILE TRUE
		$tmpS = Form($form18,"")
		IF $MapCancel
			BREAK
		ENDIF
		IF $MapIndex
			WEB URL="http://gsak.net/board/MapFileIndex.php"
		ENDIF
		IF $MapInstall
			GOSUB name=MapInstall
			BREAK
		ENDIF
	ENDWHILE
ENDSUB #InstallMapFiles


BEGINSUB name=MapInstall
	IF Len($MapFiles) > 0
	$count = RegExCount(";",$MapFiles) + 1
	$x = 1
	WHILE $x <= $count
		$text1 = Extract($MapFiles,";",$x)
		$_sql = "SELECT link,type,title FROM MapDataFiles WHERE mapdescription = '$text1' LIMIT 1"
		$tmpS = Sqlite("sql",$_sql,"")
		$text4 = Extract($tmpS,";",2) # type
		$text2 = Extract($tmpS,";",1) # link
		$text3 = Extract($tmpS,";",3) # title
		IF $text4 = "dat"	
			$work = GetUrl($text2,"Getting Map Data File - $text1")
			$FileName = $datafilepath + "\FindStatGenData\" + $text3 + ".dat"
			$tmpS = PutFile($FileName,$work)
		ENDIF
		IF $text4 = "zip"
			$work = GetUrl($text2,"Getting Map Data File - $text1")
			$FileName = $datafilepath + "\FindStatGenData\" + $text3 + ".zip"
			$tmpS = PutFile($FileName,$work)
			$Folder = $datafilepath + "\FindStatGenData\"
			#unzip the files to the destination folder
			$tmpS = ZipFile("unzip",$FileName,$Folder)
		ENDIF
		$x = $x + 1
	ENDWHILE
ENDIF
ENDSUB #MapInstall



BEGINSUB name=UpdateSQLFiles
	
	# Convert the Settings and Milestones SQL Files to sqlite
	
	# Check if there is any data already in the SQLite table and skip conversion if so
	$_sql = "select snumber from special"
	$status = Sqlite("sql",$_sql)
			
	$tmpS = $_Install + "\macros\FoundStatsSpecial2.txt"
	IF (FileExists($tmpS)) AND $status = ""
		$file = GetFile($_Install + "\macros\FoundStatsSpecial2.txt")
		# Replace single quotes as SQLite can deal with them
		$file=Replace(Chr(96),"'",$file,TRUE)
		$status = Sqlite("import",$File,"table=Special error=trap")
		
		# Remove the header line
		$_sql = "DELETE FROM Special WHERE snumber = 'snumber'"
		$status = Sqlite("sql",$_sql)
	
		# Now rename the old file if the save was good
		$file = Quote($_Install + "\macros\FoundStatsSpecial2.txt") + " " + Quote("FoundStatsSpecial2.old")
		$BatFile = $_Install + "\babel.bat"
		$result = PutFile($BatFile, "REN " + $file)
		FILEOPEN File="$BatFile" Wait=yes
	ENDIF
	
	# Check if there is any data already in the SQLite table and skip conversion if so
	$_sql = "select mmilestone from milestone"
	$status = Sqlite("sql",$_sql)
	
	$tmpS = $_Install + "\macros\FoundStatsMilestones2.txt"
	IF (FileExists($tmpS)) AND $status = ""
		$file = GetFile($_Install + "\macros\FoundStatsMilestones2.txt")
		$status = Sqlite("import",$File,"table=Milestone error=trap")
		
		# Remove the header line
		$_sql = "DELETE FROM Milestone WHERE mmilestone = 'mmilestone'"
		$status = Sqlite("sql",$_sql)
	
		# Now rename the old file if the save was good
		$file = Quote($_Install + "\macros\FoundStatsMilestones2.txt") + " " + Quote("FoundStatsMilestones2.old")
		$BatFile = $_Install + "\babel.bat"
		$result = PutFile($BatFile, "REN " + $file)
		FILEOPEN File="$BatFile" Wait=yes
	ENDIF

ENDSUB # Update SQL Files



BEGINSUB name=UsCountyMap

	$file = $_ExePath + "\bb.db3"
	$file = SqlQuote($file)
	$_sql = "ATTACH $file AS bb"
	$status = Sqlite("sql",$_sql)

	$_sql = "select avg(length(state)) from allfinds where country = 'United States'"
	$tmpN1 = Val(Sqlite("sql",$_sql))

	# Exclude locationless?
	IF $Excludelocationless
		$Locationless = " AND Cachetype <>'L' AND Exclude <> '1'"
	ELSE
		$Locationless = ""
	ENDIF

	IF $tmpN1 > 3
		$_sql = "SELECT cId FROM uscountylist WHERE Upper(State||County) IN (select Upper(state||county) from allfinds WHERE country= 'United States' $Locationless group by state||county)  order by state||county"
	ELSE
		$_sql = "SELECT cId FROM uscountylist WHERE Upper(Abbr||County) IN (select Upper(state||county) from allfinds WHERE country= 'United States' $Locationless group by state||county)  order by abbr||county"
	ENDIF


	# Count Finds per county
	# SELECT count(*) from allfinds where country = 'United States' group by state||county order by state||county

	# or for everything in one

	# SELECT count(*), (select cId from uscountylist where uscountylist.abbr = allfinds.state and uscountylist.county = allfinds.county) from allfinds where country = 'United States' group by allfinds.state||allfinds.county order by allfinds.state||allfinds.county

	$status = Sqlite("sql",$_sql)

	$polygons = Replace($_NewLine,",",$status)
	
	$UseMasterFile = FALSE
	$UsePageBackground = FALSE
	$UseOverlay = TRUE
	
	$FileName = "FindStatGenMap_USCountyShadingFile.dat"
	$tmpS = SysInfo("MacroPath") + "\" + $FileName
	IF (FileExists($tmpS))
		MACRO File=$tmpS
	ELSE
		$tmpS = SysInfo("MacroPath") + "\FindStatGenData\" + $FileName
		IF (FileExists($tmpS))
			MACRO File=$tmpS
		ELSE
			MSGOK msg="Sorry, I cannot find the US County Map Shading file $tmpS"
		ENDIF
	ENDIF

	GOSUB name=MapShading
		
	IF $tmpN1 > 3
		$_sql = "SELECT $_sql FROM (SELECT count(*) cnt from allfinds where country = 'United States' AND Upper(State||County) IN (select Upper(state||county) from uscountylist) $Locationless group by state||county order by state||county)"
	ELSE
		$_sql = "SELECT $_sql FROM (SELECT count(*) cnt from allfinds where country = 'United States' AND Upper(State||County) IN (select Upper(abbr||county) from uscountylist) $Locationless group by state||county order by state||county)"
	ENDIF

	$status = Sqlite("sql",$_sql)

	$colors = Replace($_NewLine,"",$status)

	#MSGOK msg=$shades ; $colors


	#Make best guess at OwnerID
	$_sql = "SELECT lOwnerid FROM (SELECT lOwnerid, Count(lOwnerID) AS c FROM Allfinds GROUP BY lownerid ORDER BY c DESC LIMIT 1)"
	$OwnerID = Sqlite("sql",$_sql)

	# Background color
	#$MapCol4 = "93CEED"
	$Mapcol4 = Substr($MapCol4,2,6)

	$URL = "http://gsak.net/stats/polymaps/usacountymapshaded.php"
	$PostData = "'id','$polygons','name','$OwnerID','settings','$Settings','color2','$MapCol4','col1','$shades','s','$colors','over','$UseOverlay'"

	$result = PostUrl($url,$PostData)

	#MSGOK msg=$result
	
	$tmpN=Random(0)
	$tmpS = Remove("$tmpN",".0","C")

	$url = "http://gsak.net/stats/polymaps/usamaps/" + $OwnerID + "_" + "$Settings" + ".png" + "?" + $tmpS

	$width = 740
	$height = 422

	#$html = "<img src='$url' border='0' width='$width' height='$height' alt='US County Map' title='US County Map' />"

	#CLIP data=$html

	#WEB url=$url
	
	IF Val(List("breaks","count","")) <=2
		$legendTable = ""
	ENDIF

	$code = "<div style='align: center;'>"
	$code = $code + "<img src='$url' border='0' width='$width' height='$height' alt='US County Map' title='US County Map' /><br />$legendTable</div>"  + $CR


	$_sql = "SELECT count(Code) from AllFinds WHERE Country='United States' $Locationless"
	$countrytotal = Val(Sqlite("SQL",$_sql,""))

	IF $tmpN1 > 3
		$_sql = "SELECT count(distinct state||county) from allfinds where country = 'United States' AND Upper(State||County) IN (select Upper(state||county) from uscountylist) $Locationless"
	ELSE
		$_sql = "SELECT count(distinct state||county) from allfinds where country = 'United States' AND Upper(State||County) IN (select Upper(abbr||county) from uscountylist) $Locationless"
	ENDIF
	
	$count = Val(Sqlite("SQL",$_sql,""))

	$_sql = "select count(distinct state||county) from uscountylist where length(abbr) = 2"
	$tmpS = Sqlite("SQL",$_sql,"")

	# Pluralize correctly
	IF $count>1
		$s = $RegionNamePlural
	ELSE
		$s = $RegionName
	ENDIF


	IF $stateChosen = "%"
		$text = "$CountryLocalName - $Countrytotal $Lang43 $count/$tmpS $s"
	ELSE
		$text = "$CountryLocalName - $StateLocalName - $Countrytotal $Lang43 $count/$tmpS $s"
	ENDIF
	$colspan = 1
	GOSUB name=SectionHead
	$out = AddStr(1,"add",$code)

	$_sql = "DETACH bb"
	$status = Sqlite("sql",$_sql)

# Totals under map
# select allfinds.state || ': ' || count(distinct allfinds.state||allfinds.county) || '/' || (select count(distinct uscountylist.state||uscountylist.county) from uscountylist where uscountylist.abbr = allfinds.state ) from allfinds where country = 'United States' group by allfinds.state
ENDSUB #name=UsCountyMap



BEGINSUB name=MapShading

	IF $UseMasterFile
		$FileName = "FindStatGenMap_MasterShadingFile.dat"
		$tmpS = SysInfo("MacroPath") + "\" + $FileName
		IF (FileExists($tmpS))
			MACRO File=$tmpS
		ELSE
			$tmpS = SysInfo("MacroPath") + "\FindStatGenData\" + $FileName
			IF (FileExists($tmpS))
				MACRO File=$tmpS
				ELSE
				MSGOK msg="Sorry, I cannot find the Master Map Shading file $tmpS"
			ENDIF
		ENDIF
	ENDIF
	
	IF $UsePageBackground
		$mapcol4 = RegExSub("background:\s*?(#.*?);",$stMainDiv,1,1)
	ENDIF

	$list = List("breaks", "replace", "")
	$list = List("colors", "replace", "")

	# set up list of break points for groups
	IF Val($limit1) > 0
		$list = List("breaks", "add", $limit1)
	ENDIF
	IF Val($limit2) > 0
		$list = List("breaks", "add", $limit2)
	ENDIF
	IF Val($limit3) > 0
		$list = List("breaks", "add", $limit3)
	ENDIF
	IF Val($limit4) > 0
		$list = List("breaks", "add", $limit4)
	ENDIF
	IF Val($limit5) > 0
		$list = List("breaks", "add", $limit5)
	ENDIF
	IF Val($limit6) > 0
		$list = List("breaks", "add", $limit6)
	ENDIF
	IF Val($limit7) > 0
		$list = List("breaks", "add", $limit7)
	ENDIF
	IF Val($limit8) > 0
		$list = List("breaks", "add", $limit8)
	ENDIF
	IF Val($limit9) > 0
		$list = List("breaks", "add", $limit9)
	ENDIF

	$list = List("breaks", "add", "9999999")

	$list = List("colors", "add", $color1)
	$list = List("colors", "add", $color2)
	$list = List("colors", "add", $color3)
	$list = List("colors", "add", $color4)
	$list = List("colors", "add", $color5)
	$list = List("colors", "add", $color6)
	$list = List("colors", "add", $color7)
	$list = List("colors", "add", $color8)
	$list = List("colors", "add", $color9)
	$list = List("colors", "add", $color10)

	$count=0
	$count=Val(List("breaks","count",""))-1

	# add shading for number of caches in that county
	$BeginColor = $color1
	$EndColor = $color10

	# get the decimal values of the step changes for each shade
	# Red value
	$hex=Substr($BeginColor,2,2)
	GOSUB Name=hextodec
	$begRed=$dec
	$hex=Substr($EndColor,2,2)
	GOSUB Name=hextodec
	$endRed=$dec
	$redChange = Round(($endRed - $begRed) / $count,0)

	# Green value
	$hex=Substr($BeginColor,4,2)
	GOSUB Name=hextodec
	$begGreen=$dec
	$hex=Substr($EndColor,4,2)
	GOSUB Name=hextodec
	$endGreen=$dec
	$greenChange = Round(($endGreen - $begGreen) / $count,0)

	# Blue value
	$hex=Substr($BeginColor,6,2)
	GOSUB Name=hextodec
	$begBlue=$dec
	$hex=Substr($EndColor,6,2)
	GOSUB Name=hextodec
	$endBlue=$dec
	$blueChange = Round(($endBlue - $begBlue) / $count,0)

	$tmpN=0
	$shades=""
	$lowBreak="0"
	$rows=1
	$_sql = " case "
	$legendTable = "<table style='width: 600px; margin: auto auto; font-size: xx-small; text-align: left;' border=0><tr>"

	WHILE $tmpN < $count
		$list = List("colors","item",NumtoStr($tmpN + 1))

		IF len($list) = 0
			$red=$begRed+($redChange*$tmpN)
			$dec=$red
			GOSUB Name=dectohex
			$redhex=$hex

			$green=$begGreen+($greenChange*$tmpN)
			$dec=$green
			GOSUB Name=dectohex
			$greenhex=$hex

			$blue=$begBlue+($blueChange*$tmpN)
			$dec=$blue
			GOSUB Name=dectohex
			$bluehex=$hex
		ELSE
			$redhex=Substr($list,2,2)
			$greenhex=Substr($list,4,2)
			$bluehex=Substr($list,6,2)

			$hex=$redhex
			GOSUB Name=hextodec
			$red=$dec

			$hex=$greenhex
			GOSUB Name=hextodec
			$green=$dec

			$hex=$bluehex
			GOSUB Name=hextodec
			$blue=$dec
		ENDIF

		$shades = $shades + $redhex + $greenhex + $bluehex

		$Break = List("breaks","item",NumtoStr($tmpN+1))
		$_sql = $_sql + " when cnt > $lowBreak and cnt <= $Break then '$tmpN'"

		IF Val($lowBreak) = 0
			IF Val($Break) = 1
				$Label = $Break
			ELSE
				$Label = "1 - " + $Break
			ENDIF
		ELSE
			IF (Val($lowBreak) + 1) = Val($Break)
				$Label = $Break
			ELSE
				$Label = NumtoStr((Val($lowBreak) + 1)) + " - " + $Break
			ENDIF
		ENDIF
		IF $rows < 5
			$legendTable = $legendTable + "<td style='width:10px;height:10px;border:1px solid #000000;background-color:#$redhex$greenhex$bluehex'>&nbsp;</td><td>" + $Label + "</td>"
			$rows = $rows + 1
		ELSE
			$legendTable = $legendTable + "<td style='width:10px;height:10px;border:1px solid #000000;background-color:#$redhex$greenhex$bluehex'>&nbsp;</td><td>" + $Label + "</td></tr><tr>"
			$rows = 1
		ENDIF
		$tmpN = $tmpN + 1
		$lowBreak = $Break
	ENDWHILE

	$dec=$endRed
	GOSUB Name=dectohex
	$redhex=$hex

	$dec=$endGreen
	GOSUB Name=dectohex
	$greenhex=$hex

	$dec=$endBlue
	GOSUB Name=dectohex
	$bluehex=$hex

	$shades = $shades + $redhex + $greenhex + $bluehex

	$Break = List("breaks","item",NumtoStr($tmpN+1))
	$Label = NumtoStr((Val($lowBreak) + 1)) + "+"

	$_sql = $_sql + " when cnt > $lowBreak and cnt <= $Break then '$tmpN' end"

	$legendTable = $legendTable + "<td style='width:10px;height:10px;border:1px solid #000000;background-color:#$redhex$greenhex$bluehex'>&nbsp;</td><td>" + $Label + "</td></tr></table>"

	SHOWSTATUS msg="Shading Map" Width=350

	# Save $_sql
	$tmpS1 = $_sql

ENDSUB #MapShading





########################---Generic Support Subroutines---#######################
BEGINSUB Name=SortResult
	$numitems = RegExCount(";",$result)
	$Sorted   = ""
	WHILE $numitems > 0
		#find largest
		$index   = 1
		$max     = 0
		$maxitem = 1
		$tmpS    = ""
		WHILE $index<=$numitems
			$key = Val(Extract(Extract($result,";",$index),",",2))
			IF $key > $max
				$max = $key
				$maxitem = $index
			ENDIF
			$index=$index+1
		ENDWHILE
		$Sorted = $Sorted + Extract($result,";",$maxitem) + ";"
		$index = 1
		WHILE $index < $maxitem
			$tmpS = $tmpS + Extract($result,";",$index) + ";"
			$index=$index+1
		ENDWHILE
		$index = $maxitem + 1
		WHILE $index <= $numitems
			$tmpS = $tmpS + Extract($result,";",$index) + ";"
			$index=$index+1
		ENDWHILE
		$result = $tmpS
		$numitems = $numitems - 1
	ENDWHILE
	$result = $Sorted
ENDSUB #SortResult

BEGINSUB Name=DayOfWeek
	# To calculate the day on which a particular date falls,
	# Input  $datetoconv
	# Output $daynum - Integer 1 = Sunday...
	#        $dayname - full day name, e.g. "Sunday"
	#        $dayshort - three letter day name e.g. "Sun"

	$daynum = DateDiff([19991226],$datetoconv)
	$daynum   = 1 + $daynum - Int($daynum/7) * 7
	$dayname  = Extract("$Lang51",";", $daynum)
	$dayshort = Left($dayname,3)
ENDSUB #DayOfWeek


BEGINSUB Name=StripCodeType
	#Enters with $Stripcode containing code
	# and $tmpB where TRUE = Placed table and FALSE = finds table
	#Exits with $TypeImage containing image of cache type
	$Types = "ABCEGLMRTUVWZXIYFHDPO"
	$Typenums = "9,5,13,6,27,12,3,137,2,8,4,11,453,2134,1858,waymark,3653,3773,3774,4738,other"
	# If $tmpB is true then use the placed table instead
	IF $tmpB
		$_sql = "Select CacheType from PlacedStatsData WHERE Code like '$StripCode' LIMIT 1"
	ELSE
		$_sql = "Select CacheType from Allfinds WHERE Code like '$StripCode' LIMIT 1"
	ENDIF
	$tmpS = Sqlite("sql",$_sql)
	$tmpN = At($tmpS,$Types)
	$thistype	= Extract($Typenums, "," , $tmpN)
	BEGINCASE
		CASE $tmpS = "Y"
			$TypeImage = "<img align='top' src='http://gsak.net/stats/wm16.gif' />"
		CASE $tmpS = "L"
			$TypeImage = "<img align='top' src='http://gsak.net/stats/1216.gif' />"
		CASE $tmpS = "O"
			$TypeImage = "<img align='top' src='http://gsak.net/stats/othersmall.gif' />"
		OTHERWISE
			$TypeImage = "<img align='top' src='http://www.geocaching.com/images/wpttypes/sm/" + $thistype + ".gif' />"
	ENDCASE
ENDSUB #StripCodeType

BEGINSUB Name=MakeUserLink
	# Generate HTML link from GC userID
	# Format: http://www.geocaching.com/profile/?id=216368
	# Input: Ensure database is on one of the users cache so $d_OwnerId &
	# $d_Ownername are valid
	# Output: $UserLink
	IF Len($OwnerName) > 20
		$ShrunkOwnerName = Left($OwnerName,18) + "..."
	ELSE
		$ShrunkOwnerName = $OwnerName
	ENDIF
	$ShrunkOwnerName = Replace(","," ",$ShrunkOwnerName,true)
	$ShrunkOwnerName = Replace(";"," ",$ShrunkOwnerName,true)

	#Strip off the first character
	$tmpS = Left($OwnerId,1)
	$OwnerId = SubStr($OwnerId,2,0)

	BEGINCASE
	CASE $tmpS = "T"
		$UserLink = "<a href='http://www.terracaching.com/profile.cgi?ID=$OwnerId'>"
	CASE $tmpS = "A"
		$UserLink = "<a href='http://geocaching.com.au/cacher/" + Replace(" ","+",$OwnerName,TRUE) + "'>"
	OTHERWISE
		IF NumToStr(Val($OwnerId))= $OwnerId     # equal - $OwnerId is number, link is created from $OwnerId
			$UserLink = "<a href='http://www.geocaching.com/profile/?id=$OwnerId'>"
		ELSE                                  # not equal - $OwnerId is something else, link is created from $OwnerName
			$UserLink = "<a href='http://www.geocaching.com/profile/?u=" + HttpEncode($OwnerName) + "'>"
		ENDIF
	ENDCASE

	$UserLink = $UserLink + $ShrunkOwnerName + "</a>"
ENDSUB #MakeUserLink
###########################---End of Subroutines---#############################
########################---Start of State Data---###############################
<data> Varname=$states
AL=Alabama,AK=Alaska,AZ=Arizona,AR=Arkansas,CA=California,CO=Colorado,
CT=Connecticut,DE=Delaware,DC=District of Columbia,FL=Florida,GA=Georgia,
HI=Hawaii,ID=Idaho,IL=Illinois,IN=Indiana,IA=Iowa,KS=Kansas,KY=Kentucky,
LA=Louisiana,ME=Maine,MD=Maryland,MA=Massachusetts,MI=Michigan,MN=Minnesota,
MS=Mississippi,MO=Missouri,MT=Montana,NE=Nebraska,NV=Nevada,NH=New Hampshire,
NJ=New Jersey,NM=New Mexico,NY=New York,NC=North Carolina,ND=North Dakota,
OH=Ohio,OK=Oklahoma,OR=Oregon,PA=Pennsylvania,RI=Rhode Island,SC=South Carolina,
SD=South Dakota,TN=Tennessee,TX=Texas,UT=Utah,VT=Vermont,VA=Virginia,
WA=Washington,WV=West Virginia,WI=Wisconsin,WY=Wyoming
<enddata>
<data> Varname=$provinces
AL=Alberta,BC=British Columbia,MA=Manitoba,NB=New Brunswick,NL=Newfoundland and Labrador,
NT=Northwest Territories,NS=Nova Scotia,NU=Nunavut,ON=Ontario,
PE=Prince Edward Island,QU=Quebec,SA=Saskatchewan,YU=Yukon Territory
<enddata>
<data> Varname=$World
AF=Afghanistan,AX=Aland Islands,AL=Albania,DZ=Algeria,AS=American Samoa,
AD=Andorra,AO=Angola,AI=Anguilla,AQ=Antarctica,AG=Antigua and Barbuda,
AR=Argentina,AM=Armenia,AW=Aruba,AU=Australia,AT=Austria,AZ=Azerbaijan,
BS=Bahamas,BH=Bahrain,BD=Bangladesh,BB=Barbados,BY=Belarus,BE=Belgium,
BZ=Belize,BJ=Benin,BM=Bermuda,BT=Bhutan,BO=Bolivia,BA=Bosnia and Herzegovina,
BW=Botswana,BV=Bouvet Island,BR=Brazil,IO=British Indian Ocean Territories,
UV=British Virgin Islands,BN=Brunei,BG=Bulgaria,BF=Burkina Faso,MM=Burma,
BI=Burundi,BF=Burkina Faso,KH=Cambodia,CM=Cameroon,CA=Canada,CV=Cape Verde,
KY=Cayman Islands,CF=Central African Republic,TD=Chad,CL=Chile,CN=China,
CX=Christmas Island,CC=Cocos (Keeling) Islands,CO=Colombia,KM=Comoros,CG=Congo,
CK=Cook Islands,CR=Costa Rica,HR=Croatia,CU=Cuba,CQ=Curacao,CY=Cyprus,
CZ=Czech Republic,CG=Democratic Republic of the Congo,DK=Denmark,DJ=Djibouti,
DM=Dominica,DO=Dominican Republic,TP=East Timor,EC=Ecuador,EG=Egypt,
SV=El Salvador,GQ=Equatorial Guinea,ER=Eritrea,EE=Estonia,ET=Ethiopia,
FK=Falkland Islands,FO=Faroe Islands,FJ=Fiji,FI=Finland,FR=France,
GF=French Guiana,PF=French Polynesia,TF=French Southern Territories,GA=Gabon,
GM=Gambia,GE=Georgia,DE=Germany,GH=Ghana,GI=Gibraltar,GR=Greece,GL=Greenland,
GD=Grenada,GP=Guadeloupe,GU=Guam,GT=Guatemala,GG=Guernsey,GN=Guinea,
GW=Guinea-Bissau,GY=Guyana,HT=Haiti,HM=Heard Island And Mcdonald Islands,
HN=Honduras,CN=Hong Kong,HU=Hungary,IS=Iceland,IN=India,ID=Indonesia,IR=Iran,
IQ=Iraq,IE=Ireland,IM=Isle of Man,IL=Israel,IT=Italy,CI=Ivory Coast,JM=Jamaica,
JP=Japan,JE=Jersey,JO=Jordan,KZ=Kazakhstan,KE=Kenya,KI=Kiribati,KW=Kuwait,
KG=Kyrgyzstan,LA=Laos,LV=Latvia,LB=Lebanon,LS=Lesotho,LR=Liberia,LY=Libya,
LI=Liechtenstein,LT=Lithuania,LU=Luxembourg,CN=Macau,MK=Macedonia,ME=Montenegro,MG=Madagascar,
MI=Madeira &amp; Azores,MW=Malawi,MY=Malaysia,MV=Maldives,ML=Mali,MT=Malta,
MH=Marshall Islands,MQ=Martinique,MR=Mauritania,MU=Mauritius,YT=Mayotte,
MX=Mexico,FM=Micronesia,MD=Moldova,MC=Monaco,MN=Mongolia,MS=Montserrat,
MA=Morocco,MZ=Mozambique,MM=Myanmar,NA=Namibia,NR=Nauru,NP=Nepal,
NL=Netherlands,AN=Netherlands Antilles,KK=Nevis and St Kitts,NC=New Caledonia,
NZ=New Zealand,NI=Nicaragua,NE=Niger,NG=Nigeria,NU=Niue,NF=Norfolk Island,
KP=North Korea,MP=Northern Mariana Islands,NO=Norway,OM=Oman,PK=Pakistan,
PW=Palau,PA=Panama,PG=Papua New Guinea,PY=Paraguay,YE=People Den Rep Yemen,
PE=Peru,PH=Philippines,PN=Pitcairn Islands,PL=Poland,PT=Portugal,PR=Puerto Rico,
QA=Qatar,RE=Reunion,RO=Romania,RU=Russia,RW=Rwanda,SH=Saint Helena,
KK=Saint Kitts and Nevis,LC=Saint Lucia,WS=Samoa,SM=San Marino,
ST=Sao Tome and Principe,SA=Saudi Arabia,SM=St. Martin,SN=Senegal,SP=Serbia and Montenegro,
SC=Seychelles,SL=Sierra Leone,SG=Singapore,SK=Slovakia,SI=Slovenia,
SB=Solomon Islands,SO=Somalia,ZA=South Africa,SP=Serbia,
GS=South Georgia and Sandwich Islands,KR=South Korea,ES=Spain,LK=Sri Lanka,
SX=St Barthelemy,SW=St Eustatius,KK=St Kitts,AN=St Marten,PM=St Pierre Miquelon,
VC=Saint Vincent and the Grenadines,SD=Sudan,SR=Suriname,SJ=Svalbard and Jan Mayen,SZ=Swaziland,
SE=Sweden,CH=Switzerland,SY=Syria,TW=Taiwan,TJ=Tajikistan,TZ=Tanzania,
TH=Thailand,TG=Togo,=Tokelau,TO=Tonga,TT=Trinidad and Tobago,TN=Tunisia,
TR=Turkey,TM=Turkmenistan,TQ=Turks and Caicos Islands,TV=Tuvalu,UG=Uganda,
UA=Ukraine,AE=United Arab Emirates,UK=United Kingdom,US=United States,
=Unknown,UY=Uruguay,UM=US Minor Outlying Islands,VI=US Virgin Islands,
UZ=Uzbekistan,VU=Vanuatu,VA=Vatican City State,VE=Venezuela,VN=Vietnam,
WF=Wallis And Futuna Islands,EH=Western Sahara,IS=Western Somoa L,YE=Yemen,
CD=Zaire,ZM=Zambia,ZW=Zimbabwe,BQ=Bonaire,
<enddata>
<data> Varname=$Europe
AL=Albania,AN=Andorra,AR=Armenia,AU=Austria,AX=Aland Islands,AZ=Azerbaijan,BE=Belgium,
BH=Bosnia and Herzegovina,BL=Belarus,BU=Bulgaria,CR=Croatia,CY=Cyprus,
CZ=Czech Republic,DK=Denmark,GB=United Kingdom,EE=Estonia,FI=Finland,
FR=France,GE=Germany,GG=Georgia,GI=Gibraltar,GR=Greece,HU=Hungary,IC=Iceland,
IE=Ireland,IT=Italy,LE=Latvia,LI=Lithuania,LT=Liechtenstein,
LU=Luxembourg,MA=Macedonia,MC=Monaco,ML=Malta,MO=Moldova,NL=Netherlands,
NO=Norway,PO=Poland,PT=Portugal,RO=Romania,RU=Russia,SA=San Marino,SE=Sweden,
SL=Slovenia,SM=Serbia and Montenegro,ES=Spain,SV=Slovakia,SW=Switzerland,
TU=Turkey,UK=Ukraine,VC=Vatican City State,ME=Montenegro,SP=Serbia,IM=Isle of Man,JE=Jersey,GN=Guernsey,
<enddata>
<data> Varname=$Australia
NSW=New South Wales,VIC=Victoria,QLD=Queensland,SA =South Australia,
WA =Western Australia,NT =Northern Territory,TAS=Tasmania,ACT=Australian Capital Territory,
<enddata>
<data> Varname=$CountriesSQL
1;AW;Aruba
2;AG;Antigua and Barbuda
3;AE;United Arab Emirates
4;AF;Afghanistan
5;DZ;Algeria
6;AZ;Azerbaijan
7;AL;Albania
8;AM;Armenia
9;AD;Andorra
10;AO;Angola
11;AS;American Samoa
12;AR;Argentina
13;AU;Australia
14;AT;Austria
15;AI;Anguilla
16;AQ;Antarctica
17;BH;Bahrain
18;BB;Barbados
19;BW;Botswana
20;BM;Bermuda
21;BE;Belgium
22;BS;Bahamas
23;BD;Bangladesh
24;BZ;Belize
25;BA;Bosnia and Herzegovina
26;BO;Bolivia
27;MM;Myanmar
28;BJ;Benin
29;BY;Belarus
30;SB;Solomon Islands
31;BR;Brazil
32;BT;Bhutan
33;BG;Bulgaria
34;BV;Bouvet Island
35;BN;Brunei
36;BI;Burundi
37;CA;Canada
38;KH;Cambodia
39;TD;Chad
40;LK;Sri Lanka
41;CG;Congo
42;CG;Democratic Republic of the Congo
43;CN;China
44;CL;Chile
45;KY;Cayman Islands
46;CC;Cocos Keeling) Islands
47;CM;Cameroon
48;KM;Comoros
49;CO;Colombia
50;MP;Northern Mariana Islands
51;CR;Costa Rica
52;CF;Central African Republic
53;CU;Cuba
54;CV;Cape Verde
55;CK;Cook Islands
56;CY;Cyprus
57;DK;Denmark
58;DJ;Djibouti
59;DM;Dominica
60;DQ;Jarvis Island
61;DO;Dominican Republic
62;EC;Ecuador
63;EG;Egypt
64;IE;Ireland
65;GQ;Equatorial Guinea
66;EE;Estonia
67;ER;Eritrea
68;SV;El Salvador
69;ET;Ethiopia
70;CZ;Czech Republic
71;GF;French Guiana
72;FI;Finland
73;FJ;Fiji
74;FK;Falkland Islands
75;FM;Micronesia
76;FO;Faroe Islands
77;PF;French Polynesia
78;FQ;Baker Island
79;FR;France
80;TF;French Southern Territories
81;GM;Gambia
82;GA;Gabon
83;GE;Georgia
84;GH;Ghana
85;GI;Gibraltar
86;GD;Grenada
87;GG;Guernsey
88;GL;Greenland
89;DE;Germany
90;GO;Glorioso Is.
91;GP;Guadeloupe
92;GU;Guam
93;GR;Greece
94;GT;Guatemala
95;GN;Guinea
96;GY;Guyana
97;GZ;Gaza Strip
98;HT;Haiti
99;HM;Heard Island And Mcdonald Islands
100;HN;Honduras
101;HQ;Howland I.
102;HR;Croatia
103;HU;Hungary
104;IS;Iceland
105;ID;Indonesia
106;IM;Isle of Man
107;IN;India
108;IO;British Indian Ocean Territories
109;IR;Iran
110;IL;Israel
111;IT;Italy
112;CI;Ivory Coast
113;IQ;Iraq
114;JP;Japan
115;JE;Jersey
116;JM;Jamaica
117;JN;Jan Mayen
118;JO;Jordan
119;JQ;Johnston Atoll
120;JU;Juan De Nova Island
121;KE;Kenya
122;KG;Kyrgyzstan
123;KP;North Korea
124;KI;Kiribati
125;KR;South Korea
126;CX;Christmas Island
127;KW;Kuwait
128;KZ;Kazakhstan
129;LA;Laos
130;LB;Lebanon
131;LV;Latvia
132;LT;Lithuania
133;LR;Liberia
134;SK;Slovakia
135;LI;Liechtenstein
136;LS;Lesotho
137;LU;Luxembourg
138;LY;Libya
139;MG;Madagascar
140;MQ;Martinique
141;MD;Moldova
142;YT;Mayotte
143;MN;Mongolia
144;MS;Montserrat
145;MW;Malawi
146;MK;Macedonia
147;ML;Mali
148;MC;Monaco
149;MA;Morocco
150;MU;Mauritius
151;;Midway Islands
152;MR;Mauritania
153;MT;Malta
154;OM;Oman
155;MV;Maldives
156;MX;Mexico
157;MY;Malaysia
158;MZ;Mozambique
159;NC;New Caledonia
160;NU;Niue
161;NF;Norfolk Island
162;NE;Niger
163;VU;Vanuatu
164;NG;Nigeria
165;NL;Netherlands
166;NO;Norway
167;NP;Nepal
168;NR;Nauru
169;SR;Suriname
170;AN;Netherlands Antilles
171;NI;Nicaragua
172;NZ;New Zealand
173;PY;Paraguay
174;PN;Pitcairn Islands
175;PE;Peru
176;;Paracel Islands
177;;Spratly Island
178;PK;Pakistan
179;PL;Poland
180;PA;Panama
181;PT;Portugal
182;PG;Papua New Guinea
183;PW;Palau
184;GW;Guinea-Bissau
185;QA;Qatar
186;RE;Reunion
187;MH;Marshall Islands
188;RO;Romania
189;PH;Philippines
190;PR;Puerto Rico
191;RU;Russia
192;RW;Rwanda
193;SA;Saudi Arabia
194;PM;St Pierre Miquelon
195;KK;Saint Kitts and Nevis
196;SC;Seychelles
197;ZA;South Africa
198;SN;Senegal
199;SH;Saint Helena
200;SI;Slovenia
201;SL;Sierra Leone
202;SM;San Marino
203;SG;Singapore
204;SO;Somalia
205;ES;Spain
206;LC;Saint Lucia
207;SD;Sudan
208;SJ;Svalbard and Jan Mayen
209;SE;Sweden
210;GS;South Georgia and Sandwich Islands
211;SY;Syria
212;CH;Switzerland
213;TT;Trinidad and Tobago
214;TH;Thailand
215;TJ;Tajikistan
216;UM;Turks and Caicos Islands
217;TK;Tokelau
218;TO;Tonga
219;TG;Togo
220;ST;Sao Tome and Principe
221;TN;Tunisia
222;TL;Timor Leste
223;TR;Turkey
224;TV;Tuvalu
225;TM;Turkmenistan
226;TZ;Tanzania
227;UG;Uganda
228;UK;United Kingdom
229;UA;Ukraine
230;US;United States
231;BF;Burkina Faso
232;UY;Uruguay
233;UZ;Uzbekistan
234;VC;Saint Vincent and the Grenadines
235;VE;Venezuela
236;UV;British Virgin Islands
237;VN;Vietnam
238;VI;US Virgin Islands
239;VA;Vatican City State
240;NA;Namibia
241;WE;West Bank
242;WF;Wallis and Futuna Islands
243;EH;Western Sahara
244;WQ;Wake Island
245;WS;Samoa
246;SZ;Swaziland
247;SP;Serbia and Montenegro
248;YE;Yemen
249;ZM;Zambia
250;ZW;Zimbabwe
251;AX;Aland Islands
252;MM;Burma
253;CQ;Curacao
254;MO;Macau
255;MI;Madeira and Azores
256;KK;Nevis and St Kitts
257;IZ;Western Somoa L
258;CD;Zaire
259;TW;Taiwan
43;HK;Hong Kong
260;ME;Montenegro
261;RS;Serbia
262;BQ;Bonaire
263;UM;US Minor Outlying Islands
264;TP;East Timor
265;SX;St Barthelemy
266;SW;St Eustatius
267;KK;St Kitts
268;SM;St. Martin
269;AN;St Marten
<enddata>

<data> Varname=$ProvincesSQL
1;AB;Alberta
2;BC;British Columbia
3;MB;Manitoba
4;NB;New Brunswick
5;NL;Newfoundland and Labrador
6;NT;Northwest Territories
7;NS;Nova Scotia
8;NU;Nunavut
9;ON;Ontario
10;PE;Prince Edward Island
11;QC;Quebec
12;SK;Saskatchewan
13;YT;Yukon Territory
<enddata>

<data> Varname=$AustraliaSQL
1;ACT;Australian Capital Territory
2;NSW;New South Wales
3;NT;Northern Territory
4;QLD;Queensland
5;SA;South Australia
6;TAS;Tasmania
7;VIC;Victoria
8;WA;Western Australia
<enddata>

<data> Varname=$StatesSQL
1;AL;Alabama
2;AK;Alaska
4;AZ;Arizona
5;AR;Arkansas
6;CA;California
8;CO;Colorado
9;CT;Connecticut
10;DE;Delaware
11;DC;District of Columbia
12;FL;Florida
13;GA;Georgia
15;HI;Hawaii
16;ID;Idaho
17;IL;Illinois
18;IN;Indiana
19;IA;Iowa
20;KS;Kansas
21;KY;Kentucky
22;LA;Louisiana
23;ME;Maine
24;MD;Maryland
25;MA;Massachusetts
26;MI;Michigan
27;MN;Minnesota
28;MS;Mississippi
29;MO;Missouri
30;MT;Montana
31;NE;Nebraska
32;NV;Nevada
33;NH;New Hampshire
34;NJ;New Jersey
35;NM;New Mexico
36;NY;New York
37;NC;North Carolina
38;ND;North Dakota
39;OH;Ohio
40;OK;Oklahoma
41;OR;Oregon
42;PA;Pennsylvania
44;RI;Rhode Island
45;SC;South Carolina
46;SD;South Dakota
47;TN;Tennessee
48;TX;Texas
49;UT;Utah
50;VT;Vermont
51;VA;Virginia
53;WA;Washington
54;WV;West Virginia
55;WI;Wisconsin
56;WY;Wyoming
<enddata>


#########################---End of State Data---################################

##################---Start of Master Shading File Data---#######################
<data> Varname=$FindStatGenMap_MasterShadingFile
#Master Shading File
# Master County Map definition file for FindStatGen3
# V0.4 4-12-09
#

$MasterFile = TRUE

# Shading bands
$limit1 = "1"
$limit2 = "9"
$limit3 = "24"
$limit4 = "49"
$limit5 = "74"
$limit6 = "99"
$limit7 = "149"
$limit8 = "199"
$limit9 = "249"

# Shading colors
$color1 = "#FFEEEE"
$color2 = ""
$color3 = ""
$color4 = ""
$color5 = ""
$color6 = ""
$color7 = ""
$color8 = ""
$color9 = ""
$color10 = "#FF0000"

#$MapCol1 = "#202020" # Optional color value for sea map text
#$MapCol2 = "#202020" # Optional color value for normal map text
#$MapCol3 = "FF8800" # Optional color for found regions
$MapCol4 = "#34669C" # Background color
<enddata>
###################---End of Master Shading File Data---########################

##################---Start of US County Shading File Data---#######################
<data> Varname=$FindStatGenMap_USCountyShadingFile
#US County Shading File
# US County Map definition file for FindStatGen3
# V0.1 10-6-10
#

$MasterFile = FALSE
$Country ="United States"
$CountryLocalName = "United States"

$StateChosen = "%" # State name if relevant. If this is a county map of an entire country then enter "%" here
$StateAbbreviation = "%"

$MapName = "usacountymap" # Name of the map image on server

# Shading bands
$limit1 = "1"
$limit2 = "5"
$limit3 = "10"
$limit4 = "20"
$limit5 = "50"
$limit6 = "100"
$limit7 = "200"
$limit8 = "500"
$limit9 = "1000"

# Shading colors
$color1 = "#FFE0E0"
$color2 = ""
$color3 = ""
$color4 = ""
$color5 = ""
$color6 = ""
$color7 = ""
$color8 = ""
$color9 = ""
$color10 = "#FF0000"

$MapCol4 = "#93CEED" # Background color 93CEED

$RegionName = "County"
$RegionNamePlural = "Counties"
<enddata>
###################---End of US County Shading File Data---########################

##################---Start of World Country Shading File Data---#######################
<data> Varname=$FindStatGenMap_WorldCountryShadingFile
#World Country Shading File
# World Country Map definition file for FindStatGen3
# V0.1 11-13-10
#

$MasterFile = FALSE
$Country ="%"
$CountryLocalName = "%"

$StateChosen = "%" # State name if relevant. If this is a county map of an entire country then enter "%" here
$StateAbbreviation = "%"

$MapName = "worldcountrymap" # Name of the map image on server

# Shading bands
$limit1 = "1"
$limit2 = "5"
$limit3 = "10"
$limit4 = "20"
$limit5 = "50"
$limit6 = "100"
$limit7 = "200"
$limit8 = "500"
$limit9 = "1000"

# Shading colors
$color1 = "#FFE0E0"
$color2 = ""
$color3 = ""
$color4 = ""
$color5 = ""
$color6 = ""
$color7 = ""
$color8 = ""
$color9 = ""
$color10 = "#FF0000"

$MapCol4 = "#93CEED" # Background color 93CEED

$RegionName = "Country"
$RegionNamePlural = "Countries"
<enddata>
###################---End of World Country Shading File Data---########################

##################---Start of Europe Country Shading File Data---#######################
<data> Varname=$FindStatGenMap_EuropeCountryShadingFile
#Europe Country Shading File
# Europe Country Map definition file for FindStatGen3
# V0.1 11-27-10
#

$MasterFile = FALSE
$Country ="%"
$CountryLocalName = "%"

$StateChosen = "%" # State name if relevant. If this is a county map of an entire country then enter "%" here
$StateAbbreviation = "%"

$MapName = "europecountrymap" # Name of the map image on server

# Shading bands
$limit1 = "1"
$limit2 = "5"
$limit3 = "10"
$limit4 = "20"
$limit5 = "50"
$limit6 = "100"
$limit7 = "200"
$limit8 = "500"
$limit9 = "1000"

# Shading colors
$color1 = "#FFE0E0"
$color2 = ""
$color3 = ""
$color4 = ""
$color5 = ""
$color6 = ""
$color7 = ""
$color8 = ""
$color9 = ""
$color10 = "#FF0000"

$MapCol4 = "#93CEED" # Background color 93CEED

$RegionName = "Country"
$RegionNamePlural = "Countries"
<enddata>
###################---End of Europe Country Shading File Data---########################

##################---Start of Canada Country Shading File Data---#######################
<data> Varname=$FindStatGenMap_CanadaCountryShadingFile
#Canada Country Shading File
# Canada Country Map definition file for FindStatGen3
# V0.1 12-9-10
#

$MasterFile = FALSE
$Country ="%"
$CountryLocalName = "%"

$StateChosen = "%" # State name if relevant. If this is a county map of an entire country then enter "%" here
$StateAbbreviation = "%"

$MapName = "canadacountrymap" # Name of the map image on server

# Shading bands
$limit1 = "1"
$limit2 = "5"
$limit3 = "10"
$limit4 = "20"
$limit5 = "50"
$limit6 = "100"
$limit7 = "200"
$limit8 = "500"
$limit9 = "1000"

# Shading colors
$color1 = "#FFE0E0"
$color2 = ""
$color3 = ""
$color4 = ""
$color5 = ""
$color6 = ""
$color7 = ""
$color8 = ""
$color9 = ""
$color10 = "#FF0000"

$MapCol4 = "#93CEED" # Background color 93CEED

$RegionName = "Province"
$RegionNamePlural = "Provinces"
<enddata>
###################---End of Canada Country Shading File Data---########################

##################---Start of Australia Country Shading File Data---#######################
<data> Varname=$FindStatGenMap_AustraliaStateShadingFile
#Australia State Shading File
# Australia Country Map definition file for FindStatGen3
# V0.1 1-1-11
#

$MasterFile = FALSE
$Country ="%"
$CountryLocalName = "%"

$StateChosen = "%" # State name if relevant. If this is a county map of an entire country then enter "%" here
$StateAbbreviation = "%"

$MapName = "australiacountrymap" # Name of the map image on server

# Shading bands
$limit1 = "1"
$limit2 = "5"
$limit3 = "10"
$limit4 = "20"
$limit5 = "50"
$limit6 = "100"
$limit7 = "200"
$limit8 = "500"
$limit9 = "1000"

# Shading colors
$color1 = "#FFE0E0"
$color2 = ""
$color3 = ""
$color4 = ""
$color5 = ""
$color6 = ""
$color7 = ""
$color8 = ""
$color9 = ""
$color10 = "#FF0000"

$MapCol4 = "#93CEED" # Background color 93CEED

$RegionName = "State"
$RegionNamePlural = "States"
<enddata>
###################---End of Australia Country Shading File Data---########################


##################---Start of US State Shading File Data---#######################
<data> Varname=$FindStatGenMap_USStateShadingFile
#US State Shading File
# US State Map definition file for FindStatGen3
# V0.1 12-12-10
#

$MasterFile = FALSE
$Country ="%"
$CountryLocalName = "%"

$StateChosen = "%" # State name if relevant. If this is a county map of an entire country then enter "%" here
$StateAbbreviation = "%"

$MapName = "usstatemap" # Name of the map image on server

# Shading bands
$limit1 = "1"
$limit2 = "5"
$limit3 = "10"
$limit4 = "20"
$limit5 = "50"
$limit6 = "100"
$limit7 = "200"
$limit8 = "500"
$limit9 = "1000"

# Shading colors
$color1 = "#FFE0E0"
$color2 = ""
$color3 = ""
$color4 = ""
$color5 = ""
$color6 = ""
$color7 = ""
$color8 = ""
$color9 = ""
$color10 = "#FF0000"

$MapCol4 = "#93CEED" # Background color 93CEED

$RegionName = "State"
$RegionNamePlural = "States"
<enddata>
###################---End of US State Country Shading File Data---########################

###########################---Start of HTML Data---#############################
<data> Varname=$HTMLHeader
<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html>
<head>
<meta http-equiv='Content-Type' content='text/html; charset=utf-8' />
<title>=USER=</title>
</head>
<body>
<enddata>

<data> Varname=$HTMLfooter
<br /><br />
<span style='font-family: Verdana, Arial, sans-serif; font-size: 10px;'>
<a href='http://gsak.net'target='_blank'><img src='http://gsak.net/stats/statslogo.png' style='border:0;'/></a><br /><br />
Stats generated by FindStatGen3 =VERSION= by rutson and lignumaqua, running on
 <a href='http://gsak.net'>GSAK</a> v=GSAKVERSION=<br />
Themes from <a href='http://pisg.sourceforge.net/'>pisg</a>
 by <a href='http://mbrix.dk/'>Morten Brix Pedersen</a> and <a href='http://www.geocaching.com/profile/?guid=26b3030c-6557-4e1c-a85b-66a18c87c14d'>FormicaPL</a><br />
=LANGFILE=<br />
Statistics generated in =TIME=.
</span>
<span style='font-family: Verdana, Arial, sans-serif; font-size: 10px;'>
<br />This work is licensed under a
 <a rel='license' href='http://creativecommons.org/licenses/by-sa/1.0/'>
Creative Commons License
</a>.
</span>
<p>
<a rel='license' href='http://creativecommons.org/licenses/by-sa/3.0/'>
<img src='http://creativecommons.org/images/public/somerights20.png'
style='border:none;' alt='Some rights reserved' height='31' width='88' />
</a>
</p>
</div>
<enddata>
#########################---End of HTML Data---#################################
########################---Start of Style Data---###############################
BEGINSUB name=InitStyle1
	$stMainDiv     = "width:750px;  background: #dedeee; font-family: Verdana, Arial, sans-serif; font-size: 12px; color: black;"
	$stTitle       = "font-family: Tahoma, Arial, sans-serif; font-size: 16px; font-weight: bold;"
	$stSmall       = "font-family: Verdana, Arial, sans-serif; font-size: 10px;"
	$stTab2cHead   = "background: #C8C8DD;"
	$st2cHi1       = "background: #AAAAAF; font-weight: bold;"
	$st2cHi2       = "background: #BABADD; font-weight: bold;"
	$st2c1         = "background: #CCCCD4;"
	$st2c2         = "background: #BABADD;"
	$stRankRow     = "background: #CCCCCF; font-size: 10px; text-align: center;"
	$stRankTit     = "text-align: left; height: 14px;"					# inherits $stRankRow
	$stYearTop     = "background: #C8C8DD;"
	$stYearGrphRow = "font-family: Arial narrow, Arial, sans-serif; font-size: 10px; color: black; text-align: center;"
	$stYearDataTab = "font-family: Arial, sans-serif; font-size: 13px; text-align: left"
	$stYearDataTit = "background: #CCCCD4; color: black"
	$stYearDataInf = "background: #BABADD; font-weight: bold; text-align: right"
	$stOwners3     = "background: #CCCCCF; font-size: 10px;"
	$stSectHead    = "background: #666699; font-weight: bold; line-height: 20px; font-size: 13px; color: white; border: 1px solid #000000;	text-align: center; margin: 0px auto; margin-bottom: 6px;"
	$stRedBar      = "#B00000"
	$stBlueBar     = "#005BB7"
	$stYellowBar   = "#FF9933"
	$stGreenBar		 = "#00B359"
	$stDiffTerrhi  = "background: #B00000; color: #FFFFFF;"
	$stDiffTerr    = "background: #005BB7; color: #FFFFFF;"
	$ImageYH = "yellow-h.png"
	$ImageYV = "yellow-v.png"
	$ImageBH = "blue-h.png"
	$ImageBV = "blue-v.png"
	$ImageGH = "green-h.png"
	$ImageGV = "green-v.png"
	$ImageRH = "red-h.png"
	$ImageRV = "red-v.png"
	$stTabActive   = "background:#666699;"
	$stTabInactive = "background: #BABADD;"
ENDSUB # InitStyle1

# Alternative Styles Greenish
BEGINSUB name=InitStyle2
	$stMainDiv     = "width:750px;  background: #F0FFF0; font-family: Verdana, Arial, sans-serif; font-size: 12px; color: black;"
	$stTitle       = "font-family: Tahoma, Arial, sans-serif; font-size: 16px; font-weight: bold;"
	$stSmall       = "font-family: Verdana, Arial, sans-serif; font-size: 10px;"
	$stTab2cHead   = "background: #C8DDC8;"
	$st2cHi1       = "background: #AAAFAA; font-weight: bold;"
	$st2cHi2       = "background: #BADDBA; font-weight: bold;"
	$st2c1         = "background: #CCD4CC;"
	$st2c2         = "background: #BADDBA;"
	$stRankRow     = "background: #CCCFCC; font-size: 10px; text-align: center;"
	$stRankTit     = "text-align: left; height: 14px;"					# inherits $stRankRow
	$stYearTop     = "background: #C8DDC8;"
	$stYearGrphRow = "font-family: Arial narrow, Arial, sans-serif; font-size: 10px; color: black; text-align: center;"
	$stYearDataTab = "font-family: Arial, sans-serif; font-size: 13px; text-align: left"
	$stYearDataTit = "background: #CCD4CC; color: black"
	$stYearDataInf = "background: #BADDBA; font-weight: bold; text-align: right"
	$stOwners3     = "background: #CCCFCC; font-size: 10px;"
	$stSectHead    = "background: #669966; font-weight: bold; line-height: 20px; font-size: 13px; color: white; border: 1px solid #000000;	text-align: center;  margin: 0px auto; margin-bottom: 6px;"
	$stRedBar      = "#B00000"
	$stBlueBar     = "#005BB7"
	$stYellowBar   = "#FF9933"
	$stGreenBar		 = "#00B359"
	$stDiffTerrhi  = "background: #B00000; color: #FFFFFF;"
	$stDiffTerr    = "background: #005BB7; color: #FFFFFF;"
	$ImageYH = "yellow-h.png"
	$ImageYV = "yellow-v.png"
	$ImageBH = "blue-h.png"
	$ImageBV = "blue-v.png"
	$ImageGH = "green-h.png"
	$ImageGV = "green-v.png"
	$ImageRH = "red-h.png"
	$ImageRV = "red-v.png"
	$stTabActive   = "background:#669966;"
	$stTabInactive = "background: #BADDBA;"
ENDSUB # InitStyle2

# Alternative Styles Reddish
BEGINSUB name=InitStyle3
	$stMainDiv     = "width:750px; background: #FFF4F4; font-family: Verdana, Arial, sans-serif; font-size: 12px; color: black;"
	$stTitle       = "font-family: Tahoma, Arial, sans-serif; font-size: 16px; font-weight: bold;"
	$stSmall       = "font-family: Verdana, Arial, sans-serif; font-size: 10px;"
	$stTab2cHead   = "background: #DDC8C8;"
	$st2cHi1       = "background: #AFAAAA; font-weight: bold;"
	$st2cHi2       = "background: #DDBABA; font-weight: bold;"
	$st2c1         = "background: #DACCCC;"
	$st2c2         = "background: #DDBABA;"
	$stRankRow     = "background: #DACCCC; font-size: 10px; text-align: center;"
	$stRankTit     = "text-align: left; height: 14px;"					# inherits $stRankRow
	$stYearTop     = "background: #DDC8C8;"
	$stYearGrphRow = "font-family: Arial narrow, Arial, sans-serif; font-size: 10px; color: black; text-align: center;"
	$stYearDataTab = "font-family: Arial, sans-serif; font-size: 13px; text-align: left"
	$stYearDataTit = "background: #CFCCCC; color: black"
	$stYearDataInf = "background: #DDBABA; font-weight: bold; text-align: right"
	$stOwners3     = "background: #CFCCCC; font-size: 10px;"
	$stSectHead    = "background: #996666; font-weight: bold; line-height: 20px; font-size: 13px; color: white; border: 1px solid #000000;	text-align: center;  margin: 0px auto; margin-bottom: 6px;"
	$stRedBar      = "#B00000"
	$stBlueBar     = "#005BB7"
	$stYellowBar   = "#FF9933"
	$stGreenBar		 = "#00B359"
	$stDiffTerrhi  = "background: #B00000; color: #FFFFFF;"
	$stDiffTerr    = "background: #005BB7; color: #FFFFFF;"
	$ImageYH = "yellow-h.png"
	$ImageYV = "yellow-v.png"
	$ImageBH = "blue-h.png"
	$ImageBV = "blue-v.png"
	$ImageGH = "green-h.png"
	$ImageGV = "green-v.png"
	$ImageRH = "red-h.png"
	$ImageRV = "red-v.png"
	$stTabActive   = "background:#996666;"
	$stTabInactive = "background: #DDBABA;"
ENDSUB # InitStyle3

# Alternative Styles Greyish
BEGINSUB name=InitStyle4
	$stMainDiv     = "width:750px;  background: #EDEDED; font-family: Verdana, Arial, sans-serif; font-size: 12px; color: black;"
	$stTitle       = "font-family: Tahoma, Arial, sans-serif; font-size: 16px; font-weight: bold;"
	$stSmall       = "font-family: Verdana, Arial, sans-serif; font-size: 10px;"
	$stTab2cHead   = "background: #B4B4B4;"
	$st2cHi1       = "background: #AAAAAA; font-weight: bold;"
	$st2cHi2       = "background: #BABABA; font-weight: bold;"
	$st2c1         = "background: #CCCCCC;"
	$st2c2         = "background: #BABABA;"
	$stRankRow     = "background: #CCCCCC; font-size: 10px; text-align: center;"
	$stRankTit     = "text-align: left; height: 14px;"					# inherits $stRankRow
	$stYearTop     = "background: #C8C8C8;"
	$stYearGrphRow = "font-family: Arial narrow, Arial, sans-serif; font-size: 10px; color: black; text-align: center;"
	$stYearDataTab = "font-family: Arial, sans-serif; font-size: 13px; text-align: left"
	$stYearDataTit = "background: #CCCCCC; color: black"
	$stYearDataInf = "background: #BABABA; font-weight: bold; text-align: right"
	$stOwners3     = "background: #CCCCCC; font-size: 10px;"
	$stSectHead    = "background: #666666; font-weight: bold; line-height: 20px; font-size: 13px; color: white; border: 1px solid #000000;	text-align: center;  margin: 0px auto; margin-bottom: 6px;"
	$stRedBar      = "#B00000"
	$stBlueBar     = "#005BB7"
	$stYellowBar   = "#FF9933"
	$stGreenBar		 = "#00B359"
	$stDiffTerrhi  = "background: #B00000; color: #FFFFFF;"
	$stDiffTerr    = "background: #005BB7; color: #FFFFFF;"
	$ImageYH = "yellow-h.png"
	$ImageYV = "yellow-v.png"
	$ImageBH = "blue-h.png"
	$ImageBV = "blue-v.png"
	$ImageGH = "green-h.png"
	$ImageGV = "green-v.png"
	$ImageRH = "red-h.png"
	$ImageRV = "red-v.png"
	$stTabActive   = "background:#666666;"
	$stTabInactive = "background: #BABABA;"
ENDSUB # InitStyle4

# Alternative Styles Minimal
BEGINSUB name=InitStyle5
	$stMainDiv     = "width:750px; font-family: Verdana, Arial, sans-serif; font-size: 12px; color: black;"
	$stTitle       = "font-family: Tahoma, Arial, sans-serif; font-size: 16px; font-weight: bold;"
	$stSmall       = "font-family: Verdana, Arial, sans-serif; font-size: 10px;"
	$stTab2cHead   = ""
	$st2cHi1       = ""
	$st2cHi2       = ""
	$st2c1         = ""
	$st2c2         = ""
	$stRankRow     = "font-size: 10px; text-align: center;"
	$stRankTit     = "text-align: left; height: 14px;"					# inherits $stRankRow
	$stYearTop     = ""
	$stYearGrphRow = "font-size: 10px; color: black; text-align: center;"
	$stYearDataTab = "font-size: 13px; text-align: left"
	$stYearDataTit = ""
	$stYearDataInf = "font-weight: bold; text-align: right"
	$stOwners3     = "font-size: 10px;"
	$stSectHead    = "background: #666666; font-weight: bold; line-height: 20px; font-size: 13px; color: white; border: 1px solid #000000;	text-align: center;  margin: 0px auto; margin-bottom: 6px;"
	$stRedBar      = "#B00000"
	$stBlueBar     = "#005BB7"
	$stYellowBar   = "#FF9933"
	$stGreenBar		 = "#00B359"
	$stDiffTerrhi  = "background: #B00000; color: #FFFFFF;"
	$stDiffTerr    = "background: #005BB7; color: #FFFFFF;"
	$ImageYH = "yellow-h.png"
	$ImageYV = "yellow-v.png"
	$ImageBH = "blue-h.png"
	$ImageBV = "blue-v.png"
	$ImageGH = "green-h.png"
	$ImageGV = "green-v.png"
	$ImageRH = "red-h.png"
	$ImageRV = "red-v.png"
	$stTabActive   = "background:#666666;"
	$stTabInactive = ""
ENDSUB # InitStyle5

# Alternative Styles from Style Creator
BEGINSUB name=InitStyle6
	$stMainDiv     = "width:750px;  background: $Theme8; font-family: Verdana, Arial, sans-serif; font-size: 12px; color: black;"
	$stTitle       = "font-family: Tahoma, Arial, sans-serif; font-size: 16px; font-weight: bold;"
	$stSmall       = "font-family: Verdana, Arial, sans-serif; font-size: 10px;"
	$stTab2cHead   = "background: $Theme7;"
	$st2cHi1       = "background: $Theme2; font-weight: bold;"
	$st2cHi2       = "background: $Theme6; font-weight: bold;"
	$st2c1         = "background: $Theme5;"
	$st2c2         = "background: $Theme6;"
	$stRankRow     = "background: $Theme5; font-size: 10px; text-align: center;"
	$stRankTit     = "text-align: left; height: 14px;"					# inherits $stRankRow
	$stYearTop     = "background: $Theme7;"
	$stYearGrphRow = "font-family: Arial narrow, Arial, sans-serif; font-size: 10px; color: black; text-align: center;"
	$stYearDataTab = "font-family: Arial, sans-serif; font-size: 13px; text-align: left"
	$stYearDataTit = "background: $Theme4; color: black"
	$stYearDataInf = "background: $Theme6; font-weight: bold; text-align: right"
	$stOwners3     = "background: $Theme4; font-size: 10px;"
	$stSectHead    = "background: $Theme1; font-weight: bold; line-height: 20px; font-size: 13px; color: white; border: 1px solid #000000;	text-align: center;  margin: 0px auto; margin-bottom: 6px;"
	$stRedBar      = "#B00000"
	$stBlueBar     = "#005BB7"
	$stYellowBar   = "#FF9933"
	$stGreenBar		 = "#00B359"
	$stDiffTerrhi  = "background: #B00000; color: #FFFFFF;"
	$stDiffTerr    = "background: #005BB7; color: #FFFFFF;"
	$ImageYH = "yellow-h.png"
	$ImageYV = "yellow-v.png"
	$ImageBH = "blue-h.png"
	$ImageBV = "blue-v.png"
	$ImageGH = "green-h.png"
	$ImageGV = "green-v.png"
	$ImageRH = "red-h.png"
	$ImageRV = "red-v.png"
	$stTabActive   = "background: $Theme1;"
	$stTabInactive = "background: $Theme6;"
ENDSUB # InitStyle6

# New GC style from FormicaPL
BEGINSUB name=InitStyle7
	# Smooth by formicaPL
	$stMainDiv     = "width:750px; background: #FFFFFF; font-family: Verdana, Arial, sans-serif; font-size: 12px; color: black;"
	$stTitle       = "font-size: 16px; font-weight: bold;"
	$stSmall       = "font-family: Verdana, Arial, sans-serif; font-size: 10px;"
	$stTab2cHead   = "background: #d8cd9d; font-weight: bold;"
	$st2cHi1       = "background: #e0d7b1; font-weight: bold"
	$st2cHi2       = "background: #e0d7b1; font-weight: bold;"
	$st2c1         = "background: #e3ddc2;"
	$st2c2         = "background: #e3ddc2;"
	$stRankRow     = "background: #e3ddc2; font-size: 10px; text-align: center;"
	$stRankTit     = "background: #d8cd9d; text-align: left; height: 14px;"
	$stYearTop     = "background: #D8cd9d;"
	$stYearGrphRow = "font-family: Arial narrow, Arial, sans-serif; font-size: 10px; color: black; text-align: center;"
	$stYearDataTab = "font-family: Arial, sans-serif; font-size: 13px; text-align: left;"
	$stYearDataTit = "background: #d8cd9d;"
	$stYearDataInf = "background: #e3ddc2; font-weight: bold; text-align: right;"
	$stOwners3     = "background: #CFCCCC; font-size: 10px;"
	$stSectHead    = "background-color: #64742e; border-color: #717073; margin: 0px auto;"
	$stRedBar      = "#B00000"
	$stBlueBar     = "#005BB7"
	$stYellowBar   = "#FF9933"
	$stGreenBar		 = "#00B359"
	$stDiffTerrhi  = "background: #B00000; color: #FFFFFF;"
	$stDiffTerr    = "background: #005BB7; color: #FFFFFF;"
	$ImageYH = "yellow-h.png"
	$ImageYV = "yellow-v.png"
	$ImageBH = "blue-h.png"
	$ImageBV = "blue-v.png"
	$ImageGH = "green-h.png"
	$ImageGV = "green-v.png"
	$ImageRH = "red-h.png"
	$ImageRV = "red-v.png"
	$stTabActive   = "background: #64742E; color: #E3DDC2;"
	$stTabInactive = "background: #e3ddc2; color: #594A42;"
ENDSUB # InitStyle7 

########################---Start of Image Data---###############################
<data> VarName=$zyellowv
iVBORw0KGgoAAAANSUhEUgAAAA8AAAABCAIAAACOvmNtAAAAMElEQVQY0wXBwQ0AIAgEwdj/zw4twN8F
ItwSZ9Y9e6bgmfREO7DaKsvIHYVwMgnvA906K3R1efbRAAAAAElFTkSuQmCC
<enddata>
<data> VarName=$zblueh
iVBORw0KGgoAAAANSUhEUgAAAAEAAAAPCAIAAACqfTKuAAAAN0lEQVQYGQXBOQ6AQAwEQan/H5HzRCJ8
rD0jRBXX/SB9nDU9plpkm+zlrSVSRInoJUvUmD5m1j/z/Sr7N4Q/XAAAAABJRU5ErkJggg==
<enddata>
<data> VarName=$zbluev
iVBORw0KGgoAAAANSUhEUgAAAA8AAAABCAIAAACOvmNtAAAAMUlEQVQY0wXBMQ7AMAwCQPX/W/Y+sVNt
iAFFuXvW+9lnK5yAbqapH6p2wUU1jAl3RrnJoSre97h7bAAAAABJRU5ErkJggg==
<enddata>
<data> VarName=$zgreenh
iVBORw0KGgoAAAANSUhEUgAAAAEAAAAPCAIAAACqfTKuAAAAOUlEQVQYGQXBMRaAMAhEwebfv/A+HsmC
uAkEMM8Z7udin8LbUQfqxVsTK2EpLIWVGClGT1QLtRNf/PmhKwD3rhOdAAAAAElFTkSuQmCC
<enddata>
<data> VarName=$zgreenv
iVBORw0KGgoAAAANSUhEUgAAAA8AAAABCAIAAACOvmNtAAAAMklEQVQYGR3CQQ4AEAwEwPj/zX88yaEs
LbtEYjKp1LwuXQ4FNDuHEbZ/om00DXBCHiceyywqxf0Ns5MAAAAASUVORK5CYII=
<enddata>
<data> VarName=$zredh
iVBORw0KGgoAAAANSUhEUgAAAAEAAAAPCAIAAACqfTKuAAAANUlEQVQYVyWKSQoAIAzEYP5/6j892cUu
iJUeAoEEiwg3AuWOMkOpIpkRKsjN403Kp5vIfMcf8FMq1xQBglUAAAAASUVORK5CYII=
<enddata>
<data> VarName=$zredv
iVBORw0KGgoAAAANSUhEUgAAAA8AAAABCAIAAACOvmNtAAAAL0lEQVQY0wXBQQ4AIAgDsPj/G//05AbC
FmO7dsSbcbernClgkjoQMIAIMUW6yrc/xyMquqSctmAAAAAASUVORK5CYII=
<enddata>
<data> VarName=$zyellowh
iVBORw0KGgoAAAANSUhEUgAAAAEAAAAPCAIAAACqfTKuAAAANUlEQVQYGQ3FsQ0AIAwDMJT/Jz7kADbU
ipJUZLA89proLkgXVIIdeAyIxx+UUfYC5cWE2nQ/DOArj98dWKYAAAAASUVORK5CYII=
<enddata>
#########################---End of Image Data---################################

#########################---Form Data---################################

<Data> VarName=$FormOptions

Name = Form1
  Type = Form
  Caption = LangForm001
  Height = 560
  Width = 759

Name = FrmGrp4
  Type = Groupbox
  Caption = LangForm016
  Height = 116
  Left = 380
  Top = 122
  Width = 363
  Taborder = 0

Name = FrmGrp3
  Type = Groupbox
  Caption = LangForm24
  Height = 131
  Left = 380
  Top = 238
  Width = 363
  Taborder = 1

Name = SelectGrp
  Type = Groupbox
  Caption = LangForm31
  Height = 50
  Left = 447
  Top = 418
  Width = 264
  Taborder = 2

Name = Groupbox1
  Type = Groupbox
  Height = 60
  Left = 3
  Top = 71
  Width = 363
  Taborder = 6

Name = GroupBox2
  Type = Groupbox
  Height = 74
  Left = 3
  Top = 133
  Width = 363
  Taborder = 7

Name = Groupbox3
  Type = Groupbox
  Height = 50
  Left = 380
  Top = 71
  Width = 363
  Taborder = 8

Name = Groupbox4
  Type = Groupbox
  Height = 41
  Left = 3
  Top = 30
  Width = 740
  Taborder = 9

Name = Groupbox5
  Type = Groupbox
  Height = 129
  Left = 3
  Top = 339
  Width = 363
  Taborder = 10

Name = Groupbox6
  Type = Groupbox
  Height = 130
  Left = 3
  Top = 208
  Width = 363
  Taborder = 11

Name = Groupbox7
  Type = Groupbox
  Height = 50
  Left = 380
  Top = 368
  Width = 363
  Taborder = 12

Name = Groupbox8
  Type = Groupbox
  Container = FrmGrp4
  Height = 46
  Left = 5
  Top = 64
  Width = 352
  Taborder = 0

Name = Label1
  Type = Label
  Color = 16744448
  Height = 20
  Left = 10
  Size = 13
  Style = bold
  Top = 4
  Width = 122
  Caption = LangForm002

Name = Label2
  Type = Label
  Container = Groupbox4
  Height = 13
  Left = 7
  Top = 18
  Width = 73
  Caption = LangForm003

Name = db
  Type = Combobox
  Container = Groupbox4
  Height = 21
  Left = 165
  Top = 12
  Values = $dblist
  Width = 132
  Taborder = 0

Name = Label3
  Type = Label
  Container = Groupbox4
  Height = 13
  Left = 384
  Top = 18
  Width = 73
  Caption = LangForm004

Name = user
  Type = Edit
  Container = Groupbox4
  Height = 21
  Left = 556
  Top = 12
  Width = 130
  Taborder = 2

Name = FrmLbl41
  Type = Label
  Container = Groupbox6
  Height = 13
  Left = 10
  Top = 15
  Width = 73
  Caption = LangForm006

Name = ftfseptext
  Type = Edit
  Container = Groupbox6
  Height = 21
  Left = 165
  Top = 11
  Width = 130
  Taborder = 0

Name = Label5
  Type = Label
  Container = Groupbox6
  Height = 13
  Left = 10
  Top = 40
  Width = 73
  Caption = LangForm007

Name = home
  Type = Combobox
  Container = Groupbox6
  Height = 21
  Left = 165
  Top = 36
  Values = $loclist
  Width = 132
  Taborder = 1

Name = Frmlbl36
  Type = Label
  Container = Groupbox6
  Height = 13
  Left = 10
  Top = 65
  Width = 73
  Caption = LangForm008

Name = StyleSet
  Type = Combobox
  Container = Groupbox6
  Exitonchange = Yes
  Height = 21
  Left = 165
  Top = 61
  Values = $Stylelist
  Width = 132
  Taborder = 2

Name = Frmlbl44
  Type = Label
  Container = Groupbox6
  Height = 13
  Left = 10
  Top = 107
  Width = 73
  Caption = LangForm009

Name = Language
  Type = Combobox
  Container = Groupbox6
  Exitonchange = Yes
  Height = 21
  Left = 165
  Top = 103
  Values = $LangList
  Width = 132
  Taborder = 3

Name = FrmLbl31
  Type = Label
  Container = Groupbox5
  Height = 13
  Left = 10
  Top = 12
  Width = 73
  Caption = LangForm011

Name = ExcludeLocationless
  Type = Checkbox
  Container = Groupbox5
  Height = 17
  Left = 280
  Top = 10
  Width = 15
  Taborder = 0

Name = FrmLbl42
  Type = Label
  Container = Groupbox3
  Height = 13
  Left = 6
  Top = 9
  Width = 73
  Caption = LangForm013

Name = YearsDescending
  Type = Checkbox
  Container = Groupbox3
  Height = 17
  Left = 251
  Top = 8
  Width = 15
  Taborder = 0

Name = FrmLbl33
  Type = Label
  Container = FrmGrp4
  Height = 13
  Left = 6
  Top = 52
  Width = 73
  Caption = LangForm017

Name = FrmLbl39
  Type = Label
  Container = Groupbox8
  Height = 13
  Left = 3
  Top = 10
  Width = 73
  Caption = LangForm018

Name = FrmLbl40
  Type = Label
  Container = Groupbox8
  Height = 13
  Left = 3
  Top = 25
  Width = 73
  Caption = LangForm019

Name = imagepathlocal
  Type = Radiobutton
  Container = Groupbox8
  Height = 17
  Left = 246
  Top = 13
  Width = 15
  Taborder = 0

Name = radiolabel1
  Type = Label
  Container = Groupbox8
  Height = 13
  Left = 198
  Top = 16
  Width = 67
  Caption = LangForm20

Name = imagepathremote
  Type = Radiobutton
  Container = Groupbox8
  Height = 17
  Left = 324
  Top = 13
  Width = 15
  Taborder = 1

Name = radiolabel2
  Type = Label
  Container = Groupbox8
  Height = 13
  Left = 270
  Top = 16
  Width = 67
  Caption = LangForm21

Name = Start2
  Type = Label
  Container = Groupbox5
  Height = 13
  Left = 10
  Top = 84
  Width = 67
  Caption = LangForm27

Name = StartAuto
  Type = Checkbox
  Container = Groupbox5
  Height = 17
  Left = 280
  Top = 82
  Width = 15
  Taborder = 3

Name = ok
  Type = Button
  Enter = yes
  Height = 25
  Left = 232
  Top = 487
  Width = 75
  Taborder = 3
  Caption = LangForm22

Name = cancelform
  Type = Button
  Escape = yes
  Height = 25
  Left = 347
  Top = 487
  Width = 75
  Taborder = 4
  Caption = LangForm23

Name = Help
  Type = Button
  Height = 25
  Left = 462
  Top = 487
  Width = 75
  Taborder = 5
  Caption = Help

Name = Reset
  Type = Button
  Container = FrmGrp3
  Height = 20
  Left = 131
  Top = 15
  Width = 100
  Taborder = 0
  Caption = LangForm26

Name = NotesButton
  Type = Button
  Container = FrmGrp3
  Height = 20
  Left = 34
  Top = 46
  Width = 75
  Taborder = 1
  Caption = Lang89

Name = Memo1
  Type = Memo
  Color = 16777215
  Container = SelectGrp
  Enabled = no
  Height = 27
  Left = 9
  Top = 16
  Width = 27
  Taborder = 0

Name = Memo2
  Type = Memo
  Color = 16777215
  Container = SelectGrp
  Enabled = no
  Height = 27
  Left = 39
  Top = 16
  Width = 27
  Taborder = 1

Name = Memo3
  Type = Memo
  Color = 16777215
  Container = SelectGrp
  Enabled = no
  Height = 27
  Left = 69
  Top = 16
  Width = 27
  Taborder = 2

Name = Memo4
  Type = Memo
  Color = 16777215
  Container = SelectGrp
  Enabled = no
  Height = 27
  Left = 99
  Top = 16
  Width = 27
  Taborder = 3

Name = Select1
  Type = Button
  Container = SelectGrp
  Height = 19
  Left = 13
  Top = 20
  Width = 19
  Taborder = 4
  Caption = 1

Name = Select2
  Type = Button
  Container = SelectGrp
  Height = 19
  Left = 43
  Top = 20
  Width = 19
  Taborder = 5
  Caption = 2

Name = Select3
  Type = Button
  Container = SelectGrp
  Height = 19
  Left = 73
  Top = 20
  Width = 19
  Taborder = 6
  Caption = 3

Name = Select4
  Type = Button
  Container = SelectGrp
  Height = 19
  Left = 103
  Top = 20
  Width = 19
  Taborder = 7
  Caption = 4

Name = SelectStore
  Type = Button
  Container = SelectGrp
  Height = 20
  Left = 132
  Top = 19
  Width = 56
  Taborder = 8
  Caption = LangForm32

Name = NumButton
  Type = Button
  Container = FrmGrp3
  Height = 20
  Left = 144
  Top = 46
  Width = 75
  Taborder = 2
  Caption = LangForm42

Name = Check
  Type = Button
  Container = Groupbox4
  Height = 21
  Left = 322
  Top = 12
  Width = 36
  Taborder = 1
  Caption = OK?

Name = SpecialButton
  Type = Button
  Container = FrmGrp3
  Height = 20
  Left = 254
  Top = 46
  Width = 75
  Taborder = 3
  Caption = LangForm67

Name = Label7
  Type = Label
  Container = Groupbox1
  Height = 13
  Left = 7
  Top = 15
  Width = 67
  Caption = LangForm43

Name = PlacedDatabase
  Type = Combobox
  Container = Groupbox1
  Height = 21
  Left = 165
  Top = 11
  Values = $dblist
  Width = 132
  Taborder = 0

Name = Placededit
  Type = Button
  Container = Groupbox1
  Height = 21
  Left = 322
  Top = 11
  Width = 36
  Taborder = 1
  Caption = Edit

Name = PlacedSort
  Type = Checkbox
  Container = Groupbox1
  Enabled = Yes
  Height = 17
  Left = 327
  Top = 35
  Width = 15
  Taborder = 2

Name = Label8
  Type = Label
  Container = Groupbox1
  Enabled = Yes
  Height = 13
  Left = 287
  Top = 37
  Width = 38
  Caption = Sorts?

Name = IncludeOwn
  Type = Checkbox
  Container = Groupbox1
  Height = 17
  Left = 247
  Top = 35
  Width = 15
  Taborder = 3

Name = Label6
  Type = Label
  Container = Groupbox1
  Height = 13
  Left = 7
  Top = 37
  Width = 67
  Caption = LangForm41

Name = Label4
  Type = Label
  Container = GroupBox2
  Height = 13
  Left = 6
  Top = 15
  Width = 73
  Caption = LangForm005

Name = milestonetext
  Type = Edit
  Container = GroupBox2
  Height = 21
  Left = 165
  Top = 11
  Width = 130
  Taborder = 0

Name = milestoneedit
  Type = Button
  Container = GroupBox2
  Height = 21
  Left = 321
  Top = 11
  Width = 36
  Taborder = 1
  Caption = Edit

Name = UseCurrentSort
  Type = Checkbox
  Container = GroupBox2
  Height = 17
  Left = 246
  Top = 41
  Width = 15
  Taborder = 2

Name = Frmlbl34
  Type = Label
  Container = GroupBox2
  Height = 13
  Left = 6
  Top = 43
  Width = 73
  Caption = LangForm014

Name = Frmlbl35
  Type = Label
  Container = GroupBox2
  Height = 13
  Left = 6
  Top = 55
  Width = 73
  Caption = LangForm015

Name = YearsAll
  Type = Checkbox
  Container = Groupbox3
  Enabled = Yes
  Height = 17
  Left = 251
  Top = 27
  Width = 15
  Taborder = 1

Name = Label9
  Type = Label
  Container = Groupbox3
  Enabled = Yes
  Height = 13
  Left = 6
  Top = 28
  Width = 67
  Caption = LangForm70

Name = PieLabel
  Type = Label
  Container = Groupbox5
  Height = 13
  Left = 10
  Top = 48
  Width = 67
  Caption = LangForm71

Name = PieCharts
  Type = Checkbox
  Container = Groupbox5
  Height = 17
  Left = 280
  Top = 46
  Width = 15
  Taborder = 2

Name = CumulativeLabel
  Type = Label
  Container = Groupbox5
  Height = 13
  Left = 10
  Top = 30
  Width = 67
  Caption = LangForm72

Name = Cumulative
  Type = Checkbox
  Container = Groupbox5
  Height = 17
  Left = 280
  Top = 28
  Width = 15
  Taborder = 1

Name = MapsButton
  Type = Button
  Container = FrmGrp3
  Height = 20
  Left = 34
  Top = 75
  Width = 75
  Taborder = 4
  Caption = LangForm73

Name = Label10
  Type = Label
  Container = GroupBox2
  Height = 13
  Left = 287
  Top = 42
  Width = 43
  Caption = Types?

Name = MileTypes
  Type = Checkbox
  Container = GroupBox2
  Height = 17
  Left = 327
  Top = 40
  Width = 15
  Taborder = 3

Name = SetSectionOrder
  Type = Button
  Container = FrmGrp3
  Height = 20
  Left = 107
  Top = 103
  Width = 148
  Taborder = 5
  Caption = LangForm75

Name = Label11
  Type = Label
  Height = 13
  Left = 20
  Top = 97
  Width = 59
  Caption = LangForm27

Name = Label12
  Type = Label
  Container = Groupbox7
  Height = 13
  Left = 6
  Top = 29
  Width = 67
  Caption = LangForm76

Name = Center
  Type = Checkbox
  Container = Groupbox7
  Height = 17
  Left = 246
  Top = 27
  Width = 15
  Taborder = 1

Name = Label13
  Type = Label
  Container = Groupbox7
  Height = 13
  Left = 6
  Top = 11
  Width = 67
  Caption = LangForm87

Name = UpdateCounty
  Type = Checkbox
  Container = Groupbox7
  Height = 17
  Left = 246
  Top = 9
  Width = 15
  Taborder = 0

Name = ElevationEdit
  Type = Button
  Container = FrmGrp3
  Height = 20
  Left = 144
  Top = 75
  Width = 75
  Taborder = 6
  Caption = LangForm90

Name = FlagsLabel
  Type = Label
  Container = Groupbox5
  Height = 13
  Left = 10
  Top = 66
  Width = 67
  Caption = LangForm91

Name = FlagIcons
  Type = Checkbox
  Container = Groupbox5
  Height = 17
  Left = 280
  Top = 64
  Width = 15
  Taborder = 4

Name = Seed
  Type = Edit
  Container = Groupbox6
  Height = 21
  Left = 301
  Top = 61
  Width = 55
  Taborder = 4

Name = EditHomePosition
  Type = Button
  Container = FrmGrp3
  Height = 20
  Left = 254
  Top = 75
  Width = 75
  Taborder = 7
  Caption = Home

Name = HeatMapLabel
  Type = Label
  Container = Groupbox5
  Height = 13
  Left = 10
  Top = 102
  Width = 73
  Caption = LangForm102

Name = UseHeatMap
  Type = Checkbox
  Container = Groupbox5
  Height = 17
  Left = 280
  Top = 100
  Width = 15
  Taborder = 5

Name = Label14
  Type = Label
  Container = FrmGrp4
  Height = 13
  Left = 6
  Top = 34
  Width = 73
  Caption = LangForm104

Name = UseHeatBars
  Type = Radiobutton
  Container = FrmGrp4
  Exitonchange = Yes
  Height = 17
  Left = 251
  Top = 31
  Width = 15
  Taborder = 1

Name = UseImageBars
  Type = Radiobutton
  Container = FrmGrp4
  Exitonchange = Yes
  Height = 17
  Left = 251
  Top = 49
  Width = 15
  Taborder = 2

Name = Label15
  Type = Label
  Container = FrmGrp4
  Height = 13
  Left = 6
  Top = 16
  Width = 73
  Caption = LangForm105

Name = UsePlainBars
  Type = Radiobutton
  Container = FrmGrp4
  Exitonchange = Yes
  Height = 17
  Left = 251
  Top = 13
  Width = 15
  Taborder = 3

Name = CopySettings
  Type = Button
  Container = SelectGrp
  Height = 20
  Left = 198
  Top = 19
  Width = 56
  Taborder = 9
  Caption = LangForm107

Name = Label16
  Type = Label
  Container = Groupbox6
  Height = 17
  Left = 10
  Top = 85
  Width = 73
  Caption = LangForm108

Name = StyleRounded
  Type = Checkbox
  Container = Groupbox6
  Height = 17
  Left = 165
  Top = 82
  Width = 15
  Taborder = 5

<enddata>





















#********************************************************************
# Startup Form
#********************************************************************

<Data> VarName=$FormRun

Name = Form2
  Type = Form
  Caption = LangForm002
  Delay = 0
  Height = 240
  Width = 365

Name = Start1
  Type = Label
  Color = 16744448
  Height = 20
  Left = 50
  Size = 13
  Style = bold
  Top = 13
  Width = 112
  Caption = LangForm30

Name = Start3
  Type = Label
  Enabled = no
  Height = 13
  Left = 20
  Style = underline
  Top = 76
  Width = 67
  Caption = LangForm28

Name = StartOK
  Type = Button
  Enter = yes
  Height = 25
  Left = 16
  Top = 148
  Width = 70
  Taborder = 8
  Caption = LangForm22

Name = StartCancel
  Type = Button
  Escape = yes
  Height = 25
  Left = 102
  Top = 148
  Width = 70
  Taborder = 9
  Caption = LangForm23

Name = StartOptions
  Type = Button
  Height = 25
  Left = 188
  Top = 148
  Width = 70
  Taborder = 10
  Caption = LangForm29

Name = Help
  Type = Button
  Height = 25
  Left = 274
  Top = 148
  Width = 70
  Taborder = 11
  Caption = Help

Name = VersionLabel
  Type = Label
  Height = 13
  Left = 309
  Top = 196
  Width = 42
  Caption = version

Name = CheckUpdates
  Type = Button
  Height = 18
  Left = 128
  Top = 186
  Width = 100
  Taborder = 12
  Caption = LangForm77

Name = settingslabel
  Type = Label
  Color = 0
  Height = 20
  Left = 120
  Size = 12
  Top = 43
  Width = 125
  Caption = Setting Group: 1

Name = RunDate
  Type = Date
  Height = 21
  Left = 147
  Top = 108
  Width = 121
  Taborder = 13

Name = Label1
  Type = Label
  Height = 13
  Left = 89
  Top = 112
  Width = 67
  Caption = LangForm78

<enddata>


#********************************************************************
# Notes edit form
#********************************************************************

<Data> VarName=$NotesForm

Name = Form3
  Type = Form
  Height = 560
  Width = 800

Name = Groupbox1
  Type = Groupbox
  Caption = Notes
  Color = 14803455
  Height = 151
  Left = 5
  Top = 26
  Width = 777
  Taborder = 2

Name = Groupbox2
  Type = Groupbox
  Caption = Notes B
  Color = 16777185
  Height = 151
  Left = 5
  Top = 181
  Width = 777
  Taborder = 3

Name = GroupBox3
  Type = Groupbox
  Caption = Notes C
  Color = 14811106
  Height = 151
  Left = 5
  Top = 337
  Width = 777
  Taborder = 4

Name = FrmLbl2
  Type = Label
  Color = 16744448
  Height = 20
  Left = 320
  Size = 13
  Style = bold
  Top = 6
  Width = 150
  Caption = lang89 <settings>

Name = Notes
  Type = Memo
  Container = Groupbox1
  Height = 100
  Left = 15
  Scrollbars = vertical
  Top = 42
  Width = 750
  Wrap = yes
  Taborder = 0

Name = NotesOK
  Type = Button
  Enter = yes
  Height = 25
  Left = 273
  Top = 493
  Width = 75
  Taborder = 0
  Caption = LangForm22

Name = NotesCancel
  Type = Button
  Escape = yes
  Height = 25
  Left = 436
  Top = 493
  Width = 75
  Taborder = 1
  Caption = LangForm23

Name = FrmBtn5
  Type = Button
  Container = Groupbox1
  Height = 20
  Left = 620
  Spellcheck = Notes
  Top = 14
  Width = 140
  Taborder = 1
  Caption = LangForm86

Name = NotesB
  Type = Memo
  Container = Groupbox2
  Height = 100
  Left = 15
  Scrollbars = vertical
  Top = 42
  Width = 750
  Wrap = yes
  Taborder = 0

Name = Button2
  Type = Button
  Container = Groupbox2
  Height = 20
  Left = 620
  Spellcheck = NotesB
  Top = 14
  Width = 140
  Taborder = 1
  Caption = LangForm86

Name = Label1
  Type = Label
  Container = Groupbox1
  Height = 13
  Left = 49
  Top = 19
  Width = 23
  Caption = Title:

Name = Title
  Type = Edit
  Container = Groupbox1
  Height = 21
  Left = 81
  Top = 15
  Width = 230
  Taborder = 2

Name = TitleB
  Type = Edit
  Container = Groupbox2
  Height = 21
  Left = 81
  Top = 15
  Width = 230
  Taborder = 2

Name = Label2
  Type = Label
  Container = Groupbox2
  Height = 13
  Left = 49
  Top = 19
  Width = 23
  Caption = Title:

Name = Test
  Type = Button
  Container = Groupbox1
  Height = 20
  Left = 530
  Top = 14
  Width = 75
  Taborder = 3
  Caption = Test

Name = TestB
  Type = Button
  Container = Groupbox2
  Height = 20
  Left = 530
  Top = 14
  Width = 75
  Taborder = 3
  Caption = Test

Name = Label3
  Type = Label
  Container = GroupBox3
  Height = 13
  Left = 49
  Top = 19
  Width = 23
  Caption = Title:

Name = NotesC
  Type = Memo
  Container = GroupBox3
  Height = 100
  Left = 15
  Scrollbars = vertical
  Top = 42
  Width = 750
  Wrap = yes
  Taborder = 0

Name = Button3
  Type = Button
  Container = GroupBox3
  Height = 20
  Left = 620
  Spellcheck = NotesC
  Top = 14
  Width = 140
  Taborder = 1
  Caption = LangForm86

Name = TitleC
  Type = Edit
  Container = GroupBox3
  Height = 21
  Left = 81
  Top = 15
  Width = 230
  Taborder = 2

Name = TestC
  Type = Button
  Container = GroupBox3
  Height = 20
  Left = 530
  Top = 14
  Width = 75
  Taborder = 3
  Caption = Test

<enddata>






<Data> VarName=$formElevation
#********************************************************************
# Form generated by GSAK form designer on Wed 19-Aug-2009 18:58:25
#********************************************************************

Name = Form15
  Type = Form
  Height = 232
  Width = 451
  Caption = LangForm90

Name = EditElevationTitle
  Type = Label
  Color = 16744448
  Height = 20
  Left = 100
  Size = 13
  Style = bold
  Top = 10
  Width = 116
  Caption = LangForm93

Name = ElevationCode
  Type = Edit
  Height = 21
  Left = 46
  Top = 80
  Width = 121
  Taborder = 8

Name = ElevationElevation
  Type = Edit
  Height = 21
  Left = 276
  Top = 80
  Width = 121
  Taborder = 9

Name = ElevationLoad
  Type = Button
  Height = 25
  Left = 189
  Top = 78
  Width = 65
  Taborder = 10
  Caption = LangForm94

Name = ElevationOK
  Type = Button
  Height = 25
  Left = 79
  Top = 150
  Width = 75
  Taborder = 11
  Caption = Update

Name = ElevationCancel
  Type = Button
  Height = 25
  Left = 289
  Top = 150
  Width = 75
  Taborder = 12
  Caption = Exit

Name = Label2
  Type = Label
  Height = 13
  Left = 46
  Top = 60
  Width = 58
  Caption = Cache code

Name = Label3
  Type = Label
  Height = 13
  Left = 276
  Top = 60
  Width = 44
  Caption = Elevation

Name = Label4
  Type = Label
  Height = 13
  Left = 174
  Top = 84
  Width = 9
  Caption = ->

Name = Label5
  Type = Label
  Height = 13
  Left = 261
  Top = 84
  Width = 9
  Caption = ->

<enddata>

<Data> VarName=$formmilestones
#********************************************************************
# Milestone edit form
# Form generated by GSAK form designer on Sun 12-Apr-2009 22:59:00
#********************************************************************

Name = Form4
  Type = Form
  Height = 580
  Width = 751

Name = Groupbox1
  Type = Groupbox
  Caption = LangForm33
  Height = 105
  Left = 40
  Top = 436
  Width = 441
  Taborder = 8

Name = Memo1
  Type = Memo
  Font = Courier
  Height = 190
  Left = 40
  Readonly = Yes
  Scrollbars = Vertical
  Top = 233
  Width = 665
  Taborder = 9

Name = EditMilestone
  Type = Edit
  Container = Groupbox1
  Height = 21
  Left = 28
  Top = 33
  Width = 121
  Taborder = 0

Name = EditCode
  Type = Edit
  Container = Groupbox1
  Height = 21
  Left = 164
  Top = 33
  Width = 121
  Taborder = 1

Name = EditDate
  Type = Date
  Container = Groupbox1
  Height = 21
  Left = 298
  Top = 33
  Width = 121
  Taborder = 2

Name = Label1
  Type = Label
  Container = Groupbox1
  Height = 13
  Left = 68
  Top = 15
  Width = 59
  Caption = LangForm34

Name = Label3
  Type = Label
  Container = Groupbox1
  Height = 13
  Left = 208
  Top = 15
  Width = 59
  Caption = LangForm35

Name = Label4
  Type = Label
  Container = Groupbox1
  Height = 13
  Left = 340
  Top = 15
  Width = 59
  Caption = LangForm36

Name = MileEdit
  Type = Button
  Container = Groupbox1
  Height = 25
  Left = 69
  Top = 73
  Width = 125
  Taborder = 3
  Caption = LangForm37

Name = MileDelete
  Type = Button
  Container = Groupbox1
  Height = 25
  Left = 254
  Top = 71
  Width = 125
  Taborder = 4
  Caption = LangForm38

Name = MileCancel
  Type = Button
  Height = 30
  Left = 513
  Top = 475
  Width = 70
  Taborder = 10
  Caption = LangForm23

Name = MileOK
  Type = Button
  Height = 30
  Left = 616
  Top = 475
  Width = 70
  Taborder = 11
  Caption = LangForm22

Name = Memo2
  Type = Memo
  Font = Courier
  Height = 165
  Left = 40
  Scrollbars = Vertical
  Top = 36
  Width = 665
  Taborder = 12

Name = Label2
  Type = Label
  Color = 16744448
  Height = 24
  Left = 260
  Size = 14
  Style = bold
  Top = 8
  Width = 117
  Caption = LangForm39

Name = Label6
  Type = Label
  Color = 16744448
  Height = 24
  Left = 310
  Size = 14
  Style = bold
  Top = 205
  Width = 117
  Caption = LangForm40

<enddata>


<Data> VarName=$formNumbers
#********************************************************************
# Some Numbers Selection Form
# Form generated by GSAK form designer on Sun 02-Oct-2011 12:42:09
#********************************************************************

Name = Form5
  Type = Form
  Height = 400
  Width = 290

Name = Groupbox1
  Type = Groupbox
  Height = 52
  Left = 27
  Top = 144
  Width = 214
  Taborder = 13

Name = numTotals
  Type = Checkbox
  Height = 17
  Left = 218
  Top = 51
  Width = 15
  Taborder = 0

Name = Label2
  Type = Label
  Height = 13
  Left = 32
  Top = 51
  Width = 67
  Caption = LangForm51

Name = numConsecutive
  Type = Checkbox
  Height = 17
  Left = 218
  Top = 71
  Width = 15
  Taborder = 1

Name = Label3
  Type = Label
  Height = 13
  Left = 32
  Top = 71
  Width = 67
  Caption = LangForm52

Name = numPeriods
  Type = Checkbox
  Height = 17
  Left = 218
  Top = 91
  Width = 15
  Taborder = 2

Name = Label4
  Type = Label
  Height = 13
  Left = 32
  Top = 91
  Width = 67
  Caption = LangForm53

Name = numFastest
  Type = Checkbox
  Height = 17
  Left = 218
  Top = 111
  Width = 15
  Taborder = 3

Name = Label5
  Type = Label
  Height = 13
  Left = 32
  Top = 111
  Width = 67
  Caption = LangForm54

Name = numDistance
  Type = Checkbox
  Height = 17
  Left = 218
  Top = 131
  Width = 15
  Taborder = 4

Name = Label6
  Type = Label
  Height = 13
  Left = 32
  Top = 131
  Width = 67
  Caption = LangForm55

Name = numExtremes
  Type = Checkbox
  Height = 17
  Left = 218
  Top = 195
  Width = 15
  Taborder = 5

Name = Label8
  Type = Label
  Height = 13
  Left = 32
  Top = 195
  Width = 67
  Caption = LangForm57

Name = numCentroid
  Type = Checkbox
  Height = 17
  Left = 218
  Top = 215
  Width = 15
  Taborder = 6

Name = Label9
  Type = Label
  Height = 13
  Left = 32
  Top = 215
  Width = 67
  Caption = LangForm58

Name = numOldest
  Type = Checkbox
  Height = 17
  Left = 218
  Top = 235
  Width = 15
  Taborder = 7

Name = Label10
  Type = Label
  Height = 13
  Left = 32
  Top = 235
  Width = 67
  Caption = LangForm59

Name = numArchived
  Type = Checkbox
  Height = 17
  Left = 218
  Top = 255
  Width = 15
  Taborder = 8

Name = Label11
  Type = Label
  Height = 13
  Left = 32
  Top = 255
  Width = 67
  Caption = LangForm60

Name = numFTF
  Type = Checkbox
  Height = 17
  Left = 218
  Top = 275
  Width = 15
  Taborder = 9

Name = Label12
  Type = Label
  Height = 13
  Left = 32
  Top = 275
  Width = 35
  Caption = FTFs:

Name = Label1
  Type = Label
  Color = 16744448
  Height = 25
  Left = 68
  Size = 16
  Style = bold
  Top = 10
  Width = 139
  Caption = LangForm62

Name = numOK
  Type = Button
  Height = 25
  Left = 40
  Top = 330
  Width = 70
  Taborder = 10
  Caption = OK

Name = numCancel
  Type = Button
  Height = 25
  Left = 180
  Top = 330
  Width = 70
  Taborder = 11
  Caption = LangForm61

Name = Label13
  Type = Label
  Height = 13
  Left = 32
  Top = 295
  Width = 34
  Caption = Logs:

Name = numLogs
  Type = Checkbox
  Height = 17
  Left = 218
  Top = 295
  Width = 15
  Taborder = 12

Name = Label7
  Type = Label
  Container = Groupbox1
  Height = 13
  Left = 5
  Top = 9
  Width = 67
  Caption = LangForm56

Name = numClosest
  Type = Checkbox
  Container = Groupbox1
  Height = 17
  Left = 191
  Top = 6
  Width = 15
  Taborder = 0

Name = Label14
  Type = Label
  Container = Groupbox1
  Height = 13
  Left = 5
  Top = 29
  Width = 67
  Caption = LangForm68

Name = ClosestText
  Type = Edit
  Container = Groupbox1
  Height = 21
  Left = 187
  Top = 26
  Width = 20
  Taborder = 1

<enddata>


<Data> VarName=$formPlaced
#********************************************************************
# Placed Selection Form
# Form generated by GSAK form designer on Sun 02-Oct-2011 12:42:34
#********************************************************************

Name = Form6
  Type = Form
  Height = 240
  Width = 290

Name = placedTotals
  Type = Checkbox
  Height = 17
  Left = 218
  Top = 51
  Width = 15
  Taborder = 8

Name = Label2
  Type = Label
  Height = 13
  Left = 32
  Top = 51
  Width = 67
  Caption = LangForm79

Name = placedList
  Type = Checkbox
  Height = 17
  Left = 218
  Top = 71
  Width = 15
  Taborder = 9

Name = Label3
  Type = Label
  Height = 13
  Left = 32
  Top = 71
  Width = 67
  Caption = LangForm80

Name = placedFinders
  Type = Checkbox
  Height = 17
  Left = 218
  Top = 91
  Width = 15
  Taborder = 10

Name = Label4
  Type = Label
  Height = 13
  Left = 32
  Top = 91
  Width = 67
  Caption = LangForm81

Name = Label1
  Type = Label
  Color = 16744448
  Height = 25
  Left = 68
  Size = 16
  Style = bold
  Top = 10
  Width = 139
  Caption = LangForm82

Name = placedOK
  Type = Button
  Height = 25
  Left = 40
  Top = 165
  Width = 70
  Taborder = 11
  Caption = OK

Name = placedCancel
  Type = Button
  Height = 25
  Left = 170
  Top = 165
  Width = 70
  Taborder = 12
  Caption = LangForm61

Name = Label5
  Type = Label
  Height = 13
  Left = 30
  Top = 135
  Width = 67
  Caption = LangForm83

Name = NumPlacedText
  Type = Edit
  Height = 21
  Left = 218
  Top = 131
  Width = 31
  Taborder = 13

Name = label6
  Type = Label
  Height = 13
  Left = 32
  Top = 111
  Width = 67
  Caption = LangForm92

Name = placedCharts
  Type = Checkbox
  Height = 17
  Left = 218
  Top = 111
  Width = 15
  Taborder = 14

<enddata>



<Data> VarName=$formUpdate
#********************************************************************
# Form generated by GSAK form designer on Sat 03-Nov-2007 22:06:23
#********************************************************************

Name = Form7
Type = Form
Height = 166
Width = 300
Caption = Update Check

Name = UpdateOK
Type = Button
Height = 25
Left = 43
Top = 100
Width = 75
Caption = OK

Name = GetUpdate
Type = Button
Height = 25
Left = 173
Top = 100
Width = 75
Caption = Get Update

Name = UpdateCaption
Type = Label
Color = 16711680
Height = 20
Left = 78
Size = 12
Style = bold
Top = 20
Width = 136
Caption = Update Available

Name = UpdateText
Type = Label
Height = 15
Left = 16
Size = 9
Top = 60
Width = 260
Caption = You have version xx.xx.xx but yy.yy.yy is available

<enddata>

<Data> VarName=$formspecial
#********************************************************************
# Special caches edit form
# Form generated by GSAK form designer on Wed 13-Oct-2010 09:37:12
#********************************************************************

Name = Form8
  Type = Form
  Height = 550
  Width = 750

Name = Groupbox1
  Type = Groupbox
  Caption = LangForm66
  Height = 166
  Left = 38
  Top = 295
  Width = 665
  Taborder = 0

Name = SpecialNumber
  Type = Edit
  Container = Groupbox1
  Height = 21
  Left = 10
  Top = 35
  Width = 30
  Taborder = 0

Name = SpecialType
  Type = Edit
  Container = Groupbox1
  Height = 21
  Left = 50
  Top = 35
  Width = 120
  Taborder = 1

Name = SpecialCode
  Type = Edit
  Container = Groupbox1
  Height = 21
  Left = 180
  Top = 35
  Width = 80
  Taborder = 2

Name = SpecialDescription
  Type = Memo
  Container = Groupbox1
  Height = 86
  Left = 270
  Top = 35
  Width = 380
  Taborder = 3

Name = Label1
  Type = Label
  Container = Groupbox1
  Height = 13
  Left = 13
  Top = 17
  Width = 7
  Caption = #

Name = Label3
  Type = Label
  Container = Groupbox1
  Height = 13
  Left = 50
  Top = 17
  Width = 59
  Caption = LangForm64

Name = Label4
  Type = Label
  Container = Groupbox1
  Height = 13
  Left = 270
  Top = 17
  Width = 59
  Caption = LangForm63

Name = Label5
  Type = Label
  Container = Groupbox1
  Height = 13
  Left = 180
  Top = 17
  Width = 59
  Caption = LangForm35

Name = SpecialEdit
  Type = Button
  Container = Groupbox1
  Height = 25
  Left = 177
  Top = 133
  Width = 125
  Taborder = 4
  Caption = LangForm37

Name = SpecialDelete
  Type = Button
  Container = Groupbox1
  Height = 25
  Left = 354
  Top = 131
  Width = 125
  Taborder = 5
  Caption = LangForm38

Name = SpecialCancel
  Type = Button
  Height = 30
  Left = 242
  Top = 479
  Width = 70
  Taborder = 1
  Caption = LangForm23

Name = SpecialOK
  Type = Button
  Height = 30
  Left = 426
  Top = 479
  Width = 70
  Taborder = 2
  Caption = LangForm22

Name = SpecialMemo
  Type = Memo
  Font = Courier
  Height = 225
  Left = 38
  Scrollbars = Vertical
  Top = 36
  Width = 665
  Taborder = 3

Name = Label2
  Type = Label
  Color = 16744448
  Height = 24
  Left = 260
  Size = 14
  Style = bold
  Top = 8
  Width = 117
  Caption = LangForm65

Name = SpecialLoad
  Type = Button
  Container = Groupbox1
  Height = 25
  Left = 10
  Top = 60
  Width = 30
  Taborder = 6
  Caption = LangForm010

Name = Button1
  Type = Button
  Container = Groupbox1
  Height = 25
  Left = 526
  Spellcheck = SpecialDescription
  Top = 131
  Width = 125
  Taborder = 7
  Caption = LangForm86

Name = Label6
  Type = Label
  Container = Groupbox1
  Height = 9
  Left = 180
  Size = 6
  Top = 62
  Width = 43
  Caption = LangForm69

<enddata>



<Data> VarName=$formMaps

#********************************************************************
# Form generated by GSAK form designer on Thu 02-Dec-2010 19:17:12
#********************************************************************

Name = form9
  Type = Form
  Height = 399
  Width = 296

Name = MapString
  Type = Checklistbox
  Columns = 0
  Height = 181
  Left = 30
  Top = 40
  Values = MapMasterList
  Width = 227
  Taborder = 8

Name = MapsOk
  Type = Button
  Height = 25
  Left = 54
  Top = 330
  Width = 75
  Taborder = 9
  Caption = OK

Name = MapsCancel
  Type = Button
  Height = 25
  Left = 158
  Top = 330
  Width = 75
  Taborder = 10
  Caption = Cancel

Name = Label1
  Type = Label
  Color = 16711680
  Height = 16
  Left = 31
  Size = 10
  Style = bold
  Top = 12
  Width = 85
  Caption = LangForm74

Name = EditMaps
  Type = Button
  Height = 20
  Left = 55
  Top = 230
  Width = 170
  Taborder = 11
  Caption = Edit Map Data Files

Name = InstallMaps
  Type = Button
  Height = 20
  Left = 55
  Top = 260
  Width = 170
  Taborder = 12
  Caption = Install Map Data Files from GSAK
<enddata>

#Name = UseLegacyMaps
#  Type = Checkbox
#  Captionposition = Left
#  Height = 17
#  Left = 55
#  Top = 290
#  Width = 170
#  Taborder = 13
#  Caption = Use Legacy World66 Maps







<data> VarName=$formMapEditor

#********************************************************************
# Map Data File editor
#********************************************************************

Name = form11
  Type = Form
  Caption = County Mapper
  Height = 530
  Width = 800

Name = Groupbox4
  Type = Groupbox
  Height = 402
  Left = 322
  Top = 41
  Width = 215
  Taborder = 1

Name = Groupbox1
  Type = Groupbox
  Height = 200
  Left = 6
  Top = 173
  Width = 310
  Taborder = 2

Name = Groupbox2
  Type = Groupbox
  Height = 131
  Left = 6
  Top = 41
  Width = 310
  Taborder = 3

Name = GroupBox3
  Type = Groupbox
  Height = 402
  Left = 321
  Top = 41
  Width = 216
  Taborder = 4

Name = Groupbox5
  Type = Groupbox
  Height = 36
  Left = 7
  Top = 406
  Width = 310
  Taborder = 7

Name = Groupbox6
  Type = Groupbox
  Height = 31
  Left = 350
  Top = 65
  Width = 161
  Taborder = 8

Name = Groupbox7
  Type = Groupbox
  Height = 31
  Left = 350
  Top = 65
  Width = 161
  Taborder = 9

Name = Groupbox8
  Type = Groupbox
  Height = 36
  Left = 7
  Top = 372
  Width = 310
  Taborder = 10

Name = Label1
  Type = Label
  Color = 16744448
  Height = 20
  Left = 277
  Size = 13
  Style = bold
  Top = 7
  Width = 238
  Caption = County Map Data File Editor

Name = MapEditOK
  Type = Button
  Height = 25
  Left = 249
  Top = 464
  Width = 100
  Taborder = 0
  Caption = Save && Exit

Name = text1
  Type = Label
  Container = Groupbox4
  Height = 13
  Left = 48
  Top = 62
  Width = 56
  Caption = Upper Limit:

Name = Label7
  Type = Label
  Container = Groupbox4
  Height = 13
  Left = 123
  Top = 62
  Width = 42
  Caption = Fill Color:

Name = Limit1
  Type = Edit
  Container = Groupbox4
  Height = 21
  Left = 57
  Top = 79
  Width = 40
  Taborder = 0

Name = Limit2
  Type = Edit
  Container = Groupbox4
  Height = 21
  Left = 57
  Top = 102
  Width = 40
  Taborder = 1

Name = Limit3
  Type = Edit
  Container = Groupbox4
  Height = 21
  Left = 57
  Top = 125
  Width = 40
  Taborder = 2

Name = Limit4
  Type = Edit
  Container = Groupbox4
  Height = 21
  Left = 57
  Top = 148
  Width = 40
  Taborder = 3

Name = Limit5
  Type = Edit
  Container = Groupbox4
  Height = 21
  Left = 57
  Top = 171
  Width = 40
  Taborder = 4

Name = Limit6
  Type = Edit
  Container = Groupbox4
  Height = 21
  Left = 57
  Top = 194
  Width = 40
  Taborder = 5

Name = Limit7
  Type = Edit
  Container = Groupbox4
  Height = 21
  Left = 57
  Top = 217
  Width = 40
  Taborder = 6

Name = Limit8
  Type = Edit
  Container = Groupbox4
  Height = 21
  Left = 57
  Top = 240
  Width = 40
  Taborder = 7

Name = Limit9
  Type = Edit
  Container = Groupbox4
  Height = 21
  Left = 57
  Top = 263
  Width = 40
  Taborder = 8

Name = Color1
  Type = Edit
  Container = Groupbox4
  Height = 21
  Left = 104
  Top = 79
  Width = 70
  Taborder = 9

Name = Color2
  Type = Edit
  Container = Groupbox4
  Height = 21
  Left = 104
  Top = 102
  Width = 70
  Taborder = 10

Name = Color3
  Type = Edit
  Container = Groupbox4
  Height = 21
  Left = 104
  Top = 125
  Width = 70
  Taborder = 11

Name = Color4
  Type = Edit
  Container = Groupbox4
  Height = 21
  Left = 104
  Top = 148
  Width = 70
  Taborder = 12

Name = Color5
  Type = Edit
  Container = Groupbox4
  Height = 21
  Left = 104
  Top = 171
  Width = 70
  Taborder = 13

Name = Color6
  Type = Edit
  Container = Groupbox4
  Height = 21
  Left = 104
  Top = 194
  Width = 70
  Taborder = 14

Name = Color7
  Type = Edit
  Container = Groupbox4
  Height = 21
  Left = 104
  Top = 217
  Width = 70
  Taborder = 15

Name = Color8
  Type = Edit
  Container = Groupbox4
  Height = 21
  Left = 104
  Top = 240
  Width = 70
  Taborder = 16

Name = Color9
  Type = Edit
  Container = Groupbox4
  Height = 21
  Left = 104
  Top = 263
  Width = 70
  Taborder = 17

Name = Label10
  Type = Label
  Container = Groupbox4
  Height = 13
  Left = 16
  Top = 83
  Width = 34
  Caption = Band 1

Name = Label11
  Type = Label
  Container = Groupbox4
  Height = 13
  Left = 16
  Top = 106
  Width = 34
  Caption = Band 2

Name = Label12
  Type = Label
  Container = Groupbox4
  Height = 13
  Left = 16
  Top = 152
  Width = 34
  Caption = Band 4

Name = Label13
  Type = Label
  Container = Groupbox4
  Height = 13
  Left = 16
  Top = 129
  Width = 34
  Caption = Band 3

Name = Label14
  Type = Label
  Container = Groupbox4
  Height = 13
  Left = 16
  Top = 175
  Width = 34
  Caption = Band 5

Name = Label15
  Type = Label
  Container = Groupbox4
  Height = 13
  Left = 16
  Top = 198
  Width = 34
  Caption = Band 6

Name = Label16
  Type = Label
  Container = Groupbox4
  Height = 13
  Left = 16
  Top = 221
  Width = 34
  Caption = Band 7

Name = Label17
  Type = Label
  Container = Groupbox4
  Height = 13
  Left = 16
  Top = 244
  Width = 34
  Caption = Band 8

Name = Label18
  Type = Label
  Container = Groupbox4
  Height = 13
  Left = 16
  Top = 267
  Width = 34
  Caption = Band 9

Name = Label8
  Type = Label
  Container = Groupbox4
  Height = 13
  Left = 32
  Top = 290
  Width = 67
  Caption = All Remaining:

Name = Color10
  Type = Edit
  Container = Groupbox4
  Height = 21
  Left = 104
  Top = 286
  Width = 70
  Taborder = 18

Name = MapCol4
  Type = Edit
  Container = Groupbox4
  Height = 21
  Left = 104
  Top = 315
  Width = 70
  Taborder = 19

Name = Label6
  Type = Label
  Container = Groupbox4
  Height = 13
  Left = 11
  Top = 319
  Width = 88
  Caption = Background Color:

Name = Country
  Type = Edit
  Container = Groupbox1
  Enabled = No
  Height = 21
  Left = 177
  Top = 33
  Width = 121
  Taborder = 0

Name = Label2
  Type = Label
  Container = Groupbox1
  Height = 13
  Left = 13
  Top = 36
  Width = 39
  Caption = Country:

Name = Label3
  Type = Label
  Container = Groupbox1
  Height = 13
  Left = 13
  Top = 63
  Width = 99
  Caption = Country Local Name:

Name = CountryLocalName
  Type = Edit
  Container = Groupbox1
  Height = 21
  Left = 177
  Top = 60
  Width = 121
  Taborder = 1

Name = Label4
  Type = Label
  Container = Groupbox1
  Height = 13
  Left = 13
  Top = 90
  Width = 122
  Caption = State (% if whole country):

Name = StateChosen
  Type = Edit
  Container = Groupbox1
  Enabled = No
  Height = 21
  Left = 177
  Top = 87
  Width = 121
  Taborder = 2

Name = Label5
  Type = Label
  Container = Groupbox4
  Height = 16
  Left = 79
  Size = 10
  Style = bold
  Top = 10
  Width = 57
  Caption = Shading

Name = Label9
  Type = Label
  Container = Groupbox1
  Height = 13
  Left = 13
  Top = 144
  Width = 68
  Caption = Region Name:

Name = RegionName
  Type = Edit
  Container = Groupbox1
  Height = 21
  Left = 177
  Top = 141
  Width = 121
  Taborder = 3

Name = Label19
  Type = Label
  Container = Groupbox1
  Height = 13
  Left = 13
  Top = 171
  Width = 102
  Caption = Region Name (plural):

Name = RegionNamePlural
  Type = Edit
  Container = Groupbox1
  Height = 21
  Left = 177
  Top = 168
  Width = 121
  Taborder = 4

Name = Label20
  Type = Label
  Container = Groupbox1
  Height = 16
  Left = 135
  Size = 10
  Style = bold
  Top = 10
  Width = 49
  Caption = Names

Name = Label23
  Type = Label
  Container = Groupbox1
  Height = 13
  Left = 13
  Top = 117
  Width = 153
  Caption = State Abbreviation (% if country):

Name = StateAbbreviation
  Type = Edit
  Container = Groupbox1
  Enabled = No
  Height = 21
  Left = 177
  Top = 114
  Width = 121
  Taborder = 5

Name = Refresh
  Type = Button
  Container = Groupbox4
  Height = 25
  Left = 57
  Top = 367
  Width = 100
  Taborder = 31
  Caption = Refresh Colors

Name = Sample1
  Type = Edit
  Container = Groupbox4
  Height = 21
  Left = 176
  Top = 79
  Width = 21
  Taborder = 20

Name = Sample2
  Type = Edit
  Container = Groupbox4
  Height = 21
  Left = 176
  Top = 102
  Width = 21
  Taborder = 28

Name = Sample3
  Type = Edit
  Container = Groupbox4
  Height = 21
  Left = 176
  Top = 125
  Width = 21
  Taborder = 22

Name = Sample4
  Type = Edit
  Container = Groupbox4
  Height = 21
  Left = 176
  Top = 148
  Width = 21
  Taborder = 27

Name = Sample5
  Type = Edit
  Container = Groupbox4
  Height = 21
  Left = 176
  Top = 171
  Width = 21
  Taborder = 26

Name = Sample6
  Type = Edit
  Container = Groupbox4
  Height = 21
  Left = 176
  Top = 194
  Width = 21
  Taborder = 25

Name = Sample7
  Type = Edit
  Container = Groupbox4
  Height = 21
  Left = 176
  Top = 217
  Width = 21
  Taborder = 24

Name = Sample8
  Type = Edit
  Container = Groupbox4
  Height = 21
  Left = 176
  Top = 240
  Width = 21
  Taborder = 23

Name = Sample9
  Type = Edit
  Container = Groupbox4
  Height = 21
  Left = 176
  Top = 263
  Width = 21
  Taborder = 21

Name = Sample10
  Type = Edit
  Container = Groupbox4
  Height = 21
  Left = 176
  Top = 286
  Width = 21
  Taborder = 29

Name = SampleBackground
  Type = Edit
  Container = Groupbox4
  Height = 21
  Left = 176
  Top = 315
  Width = 21
  Taborder = 30

Name = EditMapString
  Type = Combobox
  Container = Groupbox2
  Exitonchange = Yes
  Height = 21
  Left = 41
  Top = 38
  Values = MapMasterList
  Width = 227
  Taborder = 0

Name = Label21
  Type = Label
  Container = Groupbox2
  Height = 16
  Left = 80
  Size = 10
  Style = bold
  Top = 10
  Width = 150
  Caption = Select map file to edit

Name = Save
  Type = Button
  Container = Groupbox2
  Height = 25
  Left = 105
  Top = 95
  Width = 100
  Taborder = 1
  Caption = Save

Name = Label25
  Type = Label
  Container = GroupBox3
  Height = 16
  Left = 36
  Size = 10
  Top = 158
  Width = 138
  Caption = Not a Shaded Map File

Name = Edit5
  Type = Edit
  Container = GroupBox3
  Height = 21
  Left = 428
  Top = 228
  Width = 25
  Taborder = 0

Name = Edit6
  Type = Edit
  Container = GroupBox3
  Height = 21
  Left = 428
  Top = 228
  Width = 25
  Taborder = 1

Name = Edit7
  Type = Edit
  Container = GroupBox3
  Height = 21
  Left = 428
  Top = 228
  Width = 25
  Taborder = 2

Name = Label22
  Type = Label
  Container = GroupBox3
  Height = 16
  Left = 79
  Size = 10
  Style = bold
  Top = 10
  Width = 57
  Caption = Shading

Name = Browser1
  Type = Browser
  Height = 396
  Left = 543
  Top = 45
  Width = 240
  Taborder = 5

Name = MapEditCancel
  Type = Button
  Height = 25
  Left = 443
  Top = 464
  Width = 100
  Taborder = 6
  Caption = Cancel

Name = Label24
  Type = Label
  Container = Groupbox5
  Height = 13
  Left = 13
  Top = 14
  Width = 63
  Caption = Data Source:

Name = MapDataSource
  Type = Combobox
  Container = Groupbox5
  Directinput = yes
  Height = 21
  Left = 177
  Top = 10
  Values = County;State;UserData;User2;User3;User4
  Width = 121
  Taborder = 0

Name = UseMasterFile
  Type = Checkbox
  Container = Groupbox6
  Height = 17
  Left = 136
  Top = 9
  Width = 15
  Taborder = 0

Name = Label26
  Type = Label
  Container = Groupbox6
  Height = 13
  Left = 8
  Top = 11
  Width = 118
  Caption = Use Master Shading File:

Name = Label27
  Type = Label
  Container = Groupbox7
  Height = 16
  Left = 11
  Size = 10
  Style = bold
  Top = 9
  Width = 138
  Caption = Master Shading File

Name = CurrentMap
  Type = Label
  Color = 16744448
  Container = Groupbox2
  Height = 16
  Left = 56
  Size = 10
  Style = bold
  Top = 70
  Width = 198
  Caption = Please choose a map to edit

Name = Label28
  Type = Label
  Container = Groupbox8
  Height = 13
  Left = 13
  Top = 14
  Width = 85
  Caption = Use Map Overlay:

Name = UseOverlay
  Type = Checkbox
  Container = Groupbox8
  Height = 17
  Left = 177
  Top = 12
  Width = 17
  Taborder = 0

Name = UsePageBackground
  Type = Checkbox
  Captionposition = Left
  Container = Groupbox4
  Height = 17
  Left = 180
  Top = 338
  Width = 17
  Taborder = 32

Name = Label29
  Type = Label
  Container = Groupbox4
  Height = 13
  Left = 11
  Top = 340
  Width = 138
  Caption = Use Page Background Color:

<enddata>






<Data> VarName=$MissingIDsForm
#********************************************************************
# Form generated by GSAK form designer on Sat 11-Apr-2009 12:01:56
#********************************************************************

Name = Form12
  Type = Form
  Height = 422
  Width = 700

Name = Label1
  Type = Label
  Color = 16744448
  Height = 20
  Left = 271
  Size = 12
  Style = bold
  Top = 13
  Width = 149
  Caption = Missing Owner IDs

Name = MissingMemo
  Type = Memo
  Font = Courier
  Height = 251
  Left = 46
  Readonly = Yes
  Scrollbars = Vertical
  Top = 75
  Width = 600
  Taborder = 8

Name = MissingOK
  Type = Button
  Height = 25
  Left = 308
  Top = 350
  Width = 75
  Taborder = 9
  Caption = OK

Name = Label2
  Type = Label
  Height = 13
  Left = 162
  Top = 55
  Width = 368
  Caption = There is no owner ID for these logs in your placed caches, placed list skipped:

<enddata>



<Data> VarName=$CountyUpdateCheck
#********************************************************************
# Ask for permission to update counties
#********************************************************************

Name = Form13
  Type = Form
  Caption = WARNING:
  Height = 159
  Width = 466
  Delay = 10

Name = CountyUpdateOK
  Type = Button
  Height = 25
  Left = 124
  Top = 85
  Width = 90
  Taborder = 8
  Caption = Update Counties

Name = CountyUpdateCancel
  Type = Button
  Height = 25
  Left = 244
  Top = 85
  Width = 90
  Taborder = 9
  Caption = Continue

Name = Label1
  Type = Label
  Height = 16
  Left = 80
  Size = 10
  Style = bold
  Top = 12
  Width = 297
  Caption = Your database contains blank county fields

Name = Label2
  Type = Label
  Height = 16
  Left = 95
  Size = 10
  Style = bold
  Top = 27
  Width = 268
  Caption = County maps may not display properly.

Name = Label3
  Type = Label
  Height = 16
  Left = 82
  Size = 10
  Style = bold
  Top = 45
  Width = 294
  Caption = Click "Update Counties" to fix this problem.

<enddata>


<Data> VarName=$formElevationOptions
#********************************************************************
# Form generated by GSAK form designer on Thu 02-Dec-2010 19:57:34
#********************************************************************

Name = Form16
  Type = Form
  Caption = LangForm90
  Height = 389
  Width = 280

Name = Groupbox1
  Type = Groupbox
  Height = 101
  Left = 12
  Top = 150
  Width = 241
  Taborder = 5

Name = EditElevationTitle
  Type = Label
  Color = 16744448
  Height = 20
  Left = 103
  Size = 13
  Style = bold
  Top = 10
  Width = 104
  Caption = LangForm90

Name = ElevationIntervals
  Type = Edit
  Container = Groupbox1
  Height = 21
  Left = 93
  Top = 71
  Width = 65
  Taborder = 1

Name = EditElevation
  Type = Button
  Height = 25
  Left = 89
  Top = 268
  Width = 100
  Taborder = 0
  Caption = LangForm93

Name = ElevationOK
  Type = Button
  Height = 25
  Left = 40
  Top = 317
  Width = 75
  Taborder = 1
  Caption = OK

Name = ElevationCancel
  Type = Button
  Height = 25
  Left = 162
  Top = 317
  Width = 75
  Taborder = 2
  Caption = Cancel

Name = ShowElevationChart
  Type = Checkbox
  Captionposition = Left
  Height = 17
  Left = 39
  Top = 50
  Width = 200
  Taborder = 3
  Caption = LangForm89

Name = SuppressZeroes
  Type = Checkbox
  Captionposition = Left
  Height = 17
  Left = 39
  Top = 70
  Width = 200
  Taborder = 4
  Caption = LangForm97

Name = Label1
  Type = Label
  Container = Groupbox1
  Height = 13
  Left = 82
  Style = underline
  Top = 10
  Width = 59
  Caption = LangForm95

Name = AutomaticIntervals
  Type = Checkbox
  Captionposition = Left
  Container = Groupbox1
  Height = 17
  Left = 13
  Top = 36
  Width = 97
  Taborder = 0
  Caption = LangForm96

Name = Label2
  Type = Label
  Container = Groupbox1
  Height = 13
  Left = 160
  Top = 76
  Width = 31
  Caption = %EU%

Name = Label3
  Type = Label
  Container = Groupbox1
  Height = 13
  Left = 117
  Style = italic
  Top = 38
  Width = 59
  Caption = LangForm98

Name = EditinGSAK
  Type = Label
  Color = 255
  Height = 13
  Left = 70
  Style = bold
  Top = 273
  Visible = No
  Width = 136
  Caption = Edit Elevations in GSAK

Name = UseAster
  Type = Checkbox
  Captionposition = Left
  Height = 17
  Left = 39
  Top = 90
  Width = 200
  Taborder = 6
  Caption = LangForm103

Name = Label4
  Type = Label
  Height = 13
  Left = 41
  Top = 114
  Width = 65
  Caption = LangForm106

Name = ElevationLimit
  Type = Edit
  Height = 21
  Left = 213
  Top = 110
  Width = 26
  Taborder = 7

<enddata>














<Data> VarName=$ElevationUpdateCheck
#********************************************************************
# Ask for permission to update elevations
#********************************************************************

Name = Form14
  Type = Form
  Caption = WARNING:
  Delay = 10
  Height = 212
  Width = 466

Name = ElevationUpdateOK
  Type = Button
  Height = 25
  Left = 84
  Top = 145
  Width = 100
  Taborder = 8
  Caption = Update Elevations

Name = ElevationUpdateCancel
  Type = Button
  Height = 25
  Left = 274
  Top = 145
  Width = 100
  Taborder = 9
  Caption = Continue

Name = ElevationLabel
  Type = Label
  Height = 16
  Left = 90
  Size = 10
  Top = 42
  Width = 256
  Caption = Your database contains missing elevations

Name = Label2
  Type = Label
  Height = 16
  Left = 97
  Size = 10
  Top = 65
  Width = 263
  Caption = Elevation statistics may not display properly.

Name = Label3
  Type = Label
  Height = 16
  Left = 98
  Size = 10
  Top = 87
  Width = 261
  Caption = Click "Update Elevations" to fix this problem.

Name = Label1
  Type = Label
  Color = 16744448
  Height = 20
  Left = 137
  Size = 12
  Style = bold
  Top = 10
  Width = 183
  Caption = Missing Elevation Data

Name = Label4
  Type = Label
  Color = 255
  Height = 13
  Left = 98
  Top = 120
  Width = 261
  Caption = Warning: May take some time if there are many missing!

<enddata>


<Data> VarName=$formhome
#********************************************************************
# Milestone edit form
# Form generated by GSAK form designer on Sat 20-Mar-2010 17:21:02
#********************************************************************

Name = Form17
  Type = Form
  Height = 432
  Width = 488

Name = Groupbox1
  Type = Groupbox
  Caption = LangForm99
  Height = 111
  Left = 40
  Top = 220
  Width = 391
  Taborder = 0

Name = EditHome
  Type = Edit
  Container = Groupbox1
  Height = 21
  Left = 166
  Top = 43
  Width = 205
  Taborder = 4

Name = EditHomeDate
  Type = Date
  Container = Groupbox1
  Height = 21
  Left = 22
  Top = 43
  Width = 121
  Taborder = 3

Name = Label1
  Type = Label
  Container = Groupbox1
  Height = 13
  Left = 166
  Top = 25
  Width = 65
  Caption = LangForm100

Name = Label4
  Type = Label
  Container = Groupbox1
  Height = 13
  Left = 22
  Top = 25
  Width = 59
  Caption = LangForm36

Name = HomeEdit
  Type = Button
  Container = Groupbox1
  Height = 25
  Left = 40
  Top = 73
  Width = 125
  Taborder = 5
  Caption = LangForm37

Name = HomeDelete
  Type = Button
  Container = Groupbox1
  Height = 25
  Left = 225
  Top = 71
  Width = 125
  Taborder = 6
  Caption = LangForm38

Name = HomeCancel
  Type = Button
  Height = 30
  Left = 99
  Top = 355
  Width = 70
  Taborder = 2
  Caption = LangForm23

Name = HomeOK
  Type = Button
  Height = 30
  Left = 302
  Top = 355
  Width = 70
  Taborder = 1
  Caption = LangForm22

Name = homememo
  Type = Memo
  Font = Courier
  Height = 165
  Left = 21
  Scrollbars = Vertical
  Top = 36
  Width = 430
  Taborder = 3

Name = Label2
  Type = Label
  Color = 16744448
  Height = 24
  Left = 128
  Size = 14
  Style = bold
  Top = 8
  Width = 128
  Caption = LangForm101

<enddata>

<Data> VarName=$formUpdateMaps
#********************************************************************
# Form generated by GSAK form designer on Sat 20-Mar-2010 18:00:06
#********************************************************************

Name = Form18
  Type = Form
  Caption = FSG Map File Installer
  Height = 580
  Width = 292

Name = MapFiles
  Type = Checklistbox
  Columns = 0
  Height = 391
  Left = 18
  Top = 90
  Values = %MapList%
  Width = 240
  Taborder = 9

Name = MapInstall
  Type = Button
  Height = 25
  Left = 39
  Top = 514
  Width = 75
  Taborder = 8
  Caption = Install

Name = Label1
  Type = Label
  Height = 20
  Left = 51
  Size = 12
  Top = 38
  Width = 174
  Caption = Available Map Data Files

Name = Label3
  Type = Label
  Color = 16744448
  Height = 20
  Left = 15
  Size = 12
  Style = bold
  Top = 7
  Width = 246
  Caption = FindStatGen Map File Installer

Name = MapCancel
  Type = Button
  Height = 25
  Left = 162
  Top = 514
  Width = 75
  Taborder = 10
  Caption = Cancel

Name = Label2
  Type = Label
  Height = 15
  Left = 33
  Size = 9
  Style = italic
  Top = 71
  Width = 210
  Caption = Select desired maps then click 'Install''

Name = MapIndex
  Type = Button
  Height = 18
  Left = 88
  Top = 484
  Width = 100
  Taborder = 11
  Caption = GSAK Map Index

<enddata>


<Data> VarName=$formNotesBrowser
#********************************************************************
# Form generated by GSAK form designer on Wed 12-May-2010 21:55:23
#********************************************************************

Name = Form19
  Type = Form
  Height = 510
  Width = 860

Name = NotesBrowser
  Type = Browser
  Height = 390
  Left = 7
  Top = 41
  Width = 830
  Taborder = 8

Name = NotesBrowserOK
  Type = Button
  Height = 25
  Left = 384
  Top = 442
  Width = 75
  Taborder = 9
  Caption = OK

Name = Label1
  Type = Label
  Color = 16744448
  Height = 20
  Left = 378
  Size = 12
  Style = bold
  Top = 10
  Width = 87
  Caption = Notes Test

<enddata>



<Data> VarName=$formPlugIn

Name = Form20
  Type = Form
  Height = 415
  Width = 800

Name = Groupbox1
  Type = Groupbox
  Caption = Notes Before Section %%section
  Color = 14803455
  Height = 151
  Left = 5
  Top = 26
  Width = 777
  Taborder = 2

Name = Groupbox2
  Type = Groupbox
  Caption = Notes After Section %%section
  Color = 16777185
  Height = 151
  Left = 5
  Top = 181
  Width = 777
  Taborder = 3

Name = FrmLbl2
  Type = Label
  Color = 16744448
  Height = 20
  Left = 320
  Size = 13
  Style = bold
  Top = 6
  Width = 150
  Caption = lang89 <settings>

Name = PlugInBefore
  Type = Memo
  Container = Groupbox1
  Height = 100
  Left = 15
  Scrollbars = vertical
  Top = 42
  Width = 750
  Wrap = yes
  Taborder = 0

Name = NotesOK
  Type = Button
  Enter = yes
  Height = 25
  Left = 273
  Top = 343
  Width = 75
  Taborder = 0
  Caption = LangForm22

Name = NotesCancel
  Type = Button
  Escape = yes
  Height = 25
  Left = 436
  Top = 343
  Width = 75
  Taborder = 1
  Caption = LangForm23

Name = FrmBtn5
  Type = Button
  Container = Groupbox1
  Height = 20
  Left = 620
  Spellcheck = PlugInBefore
  Top = 14
  Width = 140
  Taborder = 1
  Caption = LangForm86

Name = PlugInAfter
  Type = Memo
  Container = Groupbox2
  Height = 100
  Left = 15
  Scrollbars = vertical
  Top = 42
  Width = 750
  Wrap = yes
  Taborder = 0

Name = Button2
  Type = Button
  Container = Groupbox2
  Height = 20
  Left = 620
  Spellcheck = PlugInAfter
  Top = 14
  Width = 140
  Taborder = 1
  Caption = LangForm86
  
Name = Label1
  Type = Label
  Container = Groupbox1
  Height = 13
  Left = 49
  Top = 19
  Width = 23
  Caption = Title:

Name = Title
  Type = Edit
  Container = Groupbox1
  Height = 21
  Left = 81
  Top = 15
  Width = 230
  Taborder = 2

Name = TitleB
  Type = Edit
  Container = Groupbox2
  Height = 21
  Left = 81
  Top = 15
  Width = 230
  Taborder = 2

Name = Label2
  Type = Label
  Container = Groupbox2
  Height = 13
  Left = 49
  Top = 19
  Width = 23
  Caption = Title:

Name = Test
  Type = Button
  Container = Groupbox1
  Height = 20
  Left = 530
  Top = 14
  Width = 75
  Taborder = 3
  Caption = Test

Name = TestB
  Type = Button
  Container = Groupbox2
  Height = 20
  Left = 530
  Top = 14
  Width = 75
  Taborder = 3
  Caption = Test

<enddata>


<Data> VarName=$formCopySettings
#********************************************************************
# Form generated by GSAK form designer on Mon 04-Jul-2011 20:49:24
#********************************************************************

Name = Form21
  Type = Form
  Height = 277
  Width = 250

Name = GroupBox2
  Type = Groupbox
  Height = 96
  Left = 39
  Top = 60
  Width = 154
  Taborder = 0

Name = Label1
  Type = Label
  Color = 16744448
  Height = 20
  Left = 60
  Size = 12
  Style = bold
  Top = 5
  Width = 112
  Caption = Copy Settings

Name = To1
  Type = Radiobutton
  Captionposition = Left
  Container = GroupBox2
  Height = 17
  Left = 10
  Top = 10
  Width = 130
  Taborder = 0
  Caption = Setting Group 1

Name = To2
  Type = Radiobutton
  Captionposition = Left
  Container = GroupBox2
  Height = 17
  Left = 10
  Top = 30
  Width = 130
  Taborder = 1
  Caption = Setting Group 2

Name = To3
  Type = Radiobutton
  Captionposition = Left
  Container = GroupBox2
  Height = 17
  Left = 10
  Top = 50
  Width = 130
  Taborder = 2
  Caption = Setting Group 3

Name = To4
  Type = Radiobutton
  Captionposition = Left
  Container = GroupBox2
  Height = 17
  Left = 10
  Top = 70
  Width = 130
  Taborder = 3
  Caption = Setting Group 4

Name = Label3
  Type = Label
  Height = 13
  Left = 55
  Top = 45
  Width = 91
  Caption = From Setting Group

Name = CopySettingsOK
  Type = Button
  Height = 25
  Left = 21
  Top = 210
  Width = 75
  Taborder = 1
  Caption = Copy

Name = CancelSettings
  Type = Button
  Height = 25
  Left = 121
  Top = 210
  Width = 75
  Taborder = 2
  Caption = Cancel

Name = Label2
  Type = Label
  Color = 255
  Height = 13
  Left = 11
  Style = bold
  Top = 170
  Width = 211
  Caption = Warning: The selected Setting Group

Name = Label4
  Type = Label
  Color = 255
  Height = 13
  Left = 31
  Style = bold
  Top = 185
  Width = 171
  Caption = will be completely overwritten!

Name = settinglabel
  Type = Label
  Height = 13
  Left = 148
  Top = 45
  Width = 7
  Caption = #

Name = Label6
  Type = Label
  Height = 13
  Left = 159
  Top = 45
  Width = 12
  Caption = to:

<enddata>












#########################---End of Form Data---################################

BEGINSUB Name=English

	#English
	###################################
	# Language file for FindStatGen3
	#
	# Ver 1.21
	# 10-3-09
	###################################

	###################################
	# Strings for Status Windows
	###################################

	$LangStatus01 = "Initializing Files... 25%"
	$LangStatus02 = "Initializing variables... 50%"
	$LangStatus03 = "Initializing Booleans... 75%"
	$LangStatus04 = "Menu Form"
	$LangStatus05 = "Initializing Options..."
	$LangStatus06 = "Initializing Options Form..."
	$LangStatus07 = "Menu Form"
	$LangStatus08 = "Options Data Saved..."
	$LangStatus09 = "Initializing Database... 20%"
	$LangStatus10 = "Initializing Logs... 70%"
	$LangStatus11 = "Initializing Output... 80%"
	$LangStatus12 = "Cleaning Up..."
	$LangStatus13 = "Find best Month:"
	$LangStatus14 = "Finds By Month:"
	$LangStatus15 = "Generating stats:"
	$LangStatus16 = "Writing Output..."
	$LangStatus17 = "Finds by difficulty/terrain..."
	$LangStatus18 = "Chart of difficulty/terrain..."
	$LangStatus19 = "Finds By Month..."
	$LangStatus20 = "Milestones, creating output:"
	$LangStatus21 = "Analysing logs:"
	$LangStatus22a = "Finds by"
	$LangStatus22b = " from Home"
	$LangStatus23a = "Finds by"
	$LangStatus23b = "from home..."
	$LangStatus24 = "Finds by Type"
	$LangStatus25 = "Finds by Type..."
	$LangStatus26 = "Finds by Container"
	$LangStatus27 = "Finds by Container..."
	$LangStatus28 = "Finds by Owner..."
	$LangStatus29a = "Finds by Owner, analysing record:"
	$LangStatus29b = "of"
	$LangStatus30 = "Finds by State..."
	$LangStatus31 = "Finds by State..."
	$LangStatus32 = "Drawing State maps"
	$LangStatus33 = "Finds by Province..."
	$LangStatus34 = "Finds by Country..."
	$LangStatus35 = "Finds by European Country..."
	$LangStatus36 = "State:"
	$LangStatus37 = "Finds by Weekday..."
	$LangStatus38a = "Finds by Weekday, analysing record:"
	$LangStatus38b = "of"
	$LangStatus39a = "Finds by Weekday, counting:"
	$LangStatus39b = "'s finds."
	$LangStatus40a = "Consecutive days, analysing record:"
	$LangStatus40b = "of"
	$LangStatus41a = "Determining fastest"
	$LangStatus41b = "finds, checking record:"
	$LangStatus41c = "of"
	$LangStatus42 = "Determining best weekend, checking:"
	$LangStatus43 = "Determining best week, checking:"
	$LangStatus44 = "Total Distance, analysing cache:"
	$LangStatus45 = "Copying Database... 30%"
	$LangStatus46 = "Copying Database... 40%"
	$LangStatus47 = "Analysing waypoints... 50%"
	$LangStatus48 = "Analysing waypoints... 55%"
	$LangStatus49 = "Cache with multiple find logs:"
	$LangStatus50 = "Initializing new database... 60%"

	###################################
	# Strings for all Forms
	###################################

	##################################
	# The following 20 strings $LangT1 - $LangT20
	# are for the drop-down Section Menus and
	# cannot contain commas ',' or colons ':'
	##################################

	$LangT1 = "Finds by Month"
	$LangT2 = "Milestones"
	$LangT3 = "Distance from Home *"
	$LangT4 = "Cache Type *"
	$LangT5 = "Diff/Terr"
	$LangT6 = "Owner"
	$LangT7 = "US State map"
	$LangT8 = "Canadian Province map"
	$LangT9 = "European map"
	$LangT10 = "Australian map"
	$LangT11 = "World map"
	$LangT12 = "Days of the week *"
	$LangT13 = "Container type *"
	$LangT14 = "Other statistics"
	$LangT15 = "FTFs"
	$LangT16 = "--Exclude--"
	$LangT17 = "Notes"
	$LangT18 = "Placed"
	$LangT19 = "Special"
	$LangT20 = "Other Maps"
	$LangT21 = "Bearing *"
	$LangT22 = "Best Month *"
	$LangT23 = "Year Cache Placed *"
	$LangT24 = "Finds To Today *"
	$LangT25 = "Notes B"
	$LangT26 = "Finds by Found Date"
	$LangT27 = "Diff/Terr Chart"
	$LangT28 = "Finds by Placed Month"
	$LangT29 = "Elevation"
	$LangT30 = "Average Distance *"
	$LangT31 = "Finds Per Day"
	$LangT32 = "US County Map"
	$LangT33 = "Finds by Placed Date"
	$LangT34 = "First Cache By Country"
	$LangT35 = "Notes C"
	$LangT36 = "Favorites"
	

	##################################
	# These are the Form Labels and can
	# contain commas and colons
	##################################

	$LangForm01 = "Find Statistics HTML Export Options"
	$LangForm02 = "'Find' Statistics HTML Export"
	$LangForm03 = "Found caches Database"
	$LangForm04 = "User Geocaching Name"
	$LangForm05 = "Milestone separation"
	$LangForm06 = "FTF separation"
	$LangForm07 = "'Home' Location name"
	$LangForm08 = "Style color"
	$LangForm09 = "Language"
	$LangForm10 = "Set"
	$LangForm11 = "Exclude Locationless?"
	$LangForm12 = "Show Difficulty/Terrain Chart?"
	$LangForm13 = "Show years in descending order?"
	$LangForm14 = "Use current sort order for milestones?"
	$LangForm15 = "(Normally leave unchecked)"
	$LangForm16 = "Shaded bars"
	$LangForm17 = "Use 3D shaded bars?"
	$LangForm18 = "Shaded bar image source"
	$LangForm19 = "(Select Remote for GC Profile)"
	$LangForm20 = "Local"
	$LangForm21 = "Remote"
	$LangForm22 = "OK"
	$LangForm23 = "Cancel"
	$LangForm24 = "Select report sections and display order:"
	$LangForm25 = "(Keep half width reports, shown by *, in pairs)"
	$LangForm26 = "Reset Defaults"
	$LangForm27 = "Auto-Run macro next time (with delay)"
	$LangForm28 = "Click anywhere on the form to cancel auto-run"
	$LangForm29 = "Options"
	$LangForm30 = "'Find' Statistics HTML Export"
	$LangForm31 = "Setting Group"
	$LangForm32 = "Save"
	$LangForm33 = "Edit Milestone"
	$LangForm34 = "Milestone"
	$LangForm35 = "Code"
	$LangForm36 = "Date"
	$LangForm37 = "Add/Edit"
	$LangForm38 = "Delete"
	$LangForm39 = "Corrections to Milestones"
	$LangForm40 = "Corrected List"
	$LangForm41 = "Include Own Finds in Placed?"
	$LangForm42 = "Numbers"
	$LangForm43 = "Placed caches Database"
	$LangForm51 = "Totals:"
	$LangForm52 = "Consecutive:"
	$LangForm53 = "Best Time Periods:"
	$LangForm54 = "Fastest:"
	$LangForm55 = "Total Distance:"
	$LangForm56 = "Closest/Furthest:"
	$LangForm57 = "Lat/Lon Extremes:"
	$LangForm58 = "Centroid:"
	$LangForm59 = "Oldest/Youngest:"
	$LangForm60 = "Archived:"
	$LangForm61 = "Cancel"
	$LangForm62 = "Some Numbers"
	$LangForm63 = "Description"
	$LangForm64 = "Type"
	$LangForm65 = "Special Caches"
	$LangForm66 = "Edit Special Caches"
	$LangForm67 = "Special"
	$LangForm68 = "Closest displayed:"
	$LangForm69 = "(HEAD for sub-heading)"
	$LangForm70 = "Show all years"
	$LangForm71 = "Use Pie Charts?"
	$LangForm72 = "Show Cumulative Finds Chart?"
	$LangForm73 = "Maps"
	$LangForm74 = "Select Country/County Maps"
	$LangForm75 = "Section Order"
	$LangForm76 = "Center Output?"
	$LangForm77 = "Check for updates"
	$LangForm78 = "Run date:"
	$LangForm79 = "Owned Cache Statistics:"
	$LangForm80 = "List of Owned Caches:"
	$LangForm81 = "Finders of my caches:"
	$LangForm82 = "Placed Stats"
	$LangForm83 = "Number of placed caches to show:"
	$LangForm84 = "Enabled"
	$LangForm85 = "Disabled"
	$LangForm86 = "Spell check"
	$LangForm87 = "Update County (one time only)"
	$LangForm88 = "Please choose a map to edit..."
	$LangForm89 = "Show Elevation Chart?"
	$LangForm90 = "Elevation"
	$LangForm91 = "Use Flag Icons?"
	$LangForm92 = "Placed charts"
	$LangForm93 = "Edit Elevation"
	$LangForm94 = "Load"
	$LangForm95 = "Elevation Intervals"
	$LangForm96 = "Use automatic"
	$LangForm97 = "Suppress multiple zeroes"
	$LangForm98 = "(Overrides value below)"
	$LangForm99 = "Edit Home Position"
	$LangForm100 = "Coordinates"
	$LangForm101 = "Home Positions"
	$LangForm102 = "Use Heat Map Shading for charts"
	$LangForm103 = "Use Aster 30m Data"
	$LangForm104 = "Use Heat Map Shaded bars"
	$LangForm105 = "Use Flat Shaded bars"
	$LangForm106 = "Elevations to display"
	$LangForm107 = "Copy"
	$LangForm108 = "Rounded Style"

	###################################
	# Strings for HTML Output
	###################################

	$Lang01 = "has"
	$Lang01a = "has"
	$Lang02 = "Finds on"
	$Lang03 = "unique Geocaches"
	$Lang04 = "Statistics generated on"
	$Lang05 = "Number"
	$Lang06 = "Percent"
	$Lang07 = "Total finds"
	$Lang08 = "Days caching"
	$Lang09 = "Average finds per caching day"
	$Lang10 = "Overall finds per day"
	$Lang11 = "Average finds per week"
	$Lang11a = "Average finds per month"
	$Lang12 = "Month:"
	$Lang13 = "Jan"
	$Lang14 = "Feb"
	$Lang15 = "Mar"
	$Lang16 = "Apr"
	$Lang17 = "May"
	$Lang18 = "Jun"
	$Lang19 = "Jul"
	$Lang20 = "Aug"
	$Lang21 = "Sep"
	$Lang22 = "Oct"
	$Lang23 = "Nov"
	$Lang24 = "Dec"
	$Lang25 = "Days caching:"
	$Lang26 = "Finds by Difficulty Rating"
	$Lang27 = "Finds by Terrain Rating"
	$Lang28 = "Difficulty / Terrain Chart"
	$Lang28a = "Difficulty"
	$Lang28b = "Terrain"
	$Lang29 = "Finds by Month"
	$Lang30 = "Milestones"
	$Lang31 = "Milestone"
	$Lang32 = "Date"
	$Lang33 = "Interval"
	$Lang34 = "Code"
	$Lang35 = "Cache Name"
	$Lang36a = "day"
	$Lang36b = "days"
	$lang36c = "days"
	$lang36d = "days"
	$Lang37 = "Count"
	$Lang38a = "Note: excludes locationless caches."
	$Lang38b = "Note: includes locationless caches."
	$Lang39 = "Finds by Owner"
	$Lang40 = "These didn't make it to the top:"
	$Lang41 = "has also found caches placed by"
	$Lang42 = "other people"
	$Lang42a = "other people"
	$Lang43 = "finds in"
	$Lang44a = "State"
	$Lang44b = "States"
	$Lang45 = "Image from"
	$Lang46a = "Province"
	$Lang46b = "Provinces"
	$Lang47 = "World"
	$Lang48 = "Countries"
	$Lang49 = "Country"
	$Lang50 = "Finds by Weekday"
	$Lang51 = "Sunday;Monday;Tuesday;Wednesday;Thursday;Friday;Saturday"
	$Lang52 = "Some Numbers"
	$Lang53 = "Nearest cache found"
	$Lang54 = "Furthest cache found"
	$Lang55 = "Youngest cache found"
	$Lang56 = "Oldest cache found"
	$Lang57 = "finds in"
	$Lang58 = "caching days over"
	$Lang59 = "total days"
	$Lang60 = "finds per caching day,"
	$Lang61 = "/day,"
	$Lang62 = "/week,"
	$Lang63 = "/month"
	$Lang64 = "Most consecutive days with finds"
	$Lang65 = "(Current streak)"
	$Lang66 = "from"
	$Lang67 = "to"
	$Lang68 = "Most consecutive days without a find"
	$Lang69 = "None - you have found a cache every day!"
	$Lang70 = "Most finds in a day"
	$Lang71 = "on"
	$Lang72 = "Caches found which are now archived"
	$Lang73 = "Most finds in a calendar month"
	$Lang74 = "in"
	$Lang75 = "Fastest"
	$Lang76 = "finds"
	$Lang77 = "day on"
	$Lang78 = "days from"
	$Lang79 = "Best weekend caching"
	$Lang80 = "No weekend finds"
	$Lang81 = "finds, on Saturday"
	$Lang82 = "&amp; Sunday"
	$Lang83 = "Best week caching"
	$Lang84 = "finds, from Monday"
	$Lang85 = "to Sunday"
	$Lang86 = "Total cache-to-cache distance"
	$Lang87 = "Overall Total Finds"
	$Lang88 = "Overall Averages"
	$Lang89 = "Notes"
	$Lang90 = "Geocaches Owned By"
	$Lang91 = "Placed"
	$Lang92 = "Finds"
	$Lang93 = "Days/Find"
	$Lang94 = "Code"
	$Lang95 = "Cache Name"
	$Lang96 = "Owned Caches Statistics"
	$Lang97 = "Total finds of my caches"
	$Lang98 = "Total finds I've made"
	$Lang99 = "Caching Karma"
	$Lang100 = "Hide with most finds"
	$Lang101 = "Hide found most frequently"
	$Lang102 = "Every"
	$Lang103 = "Finds on"
	$Lang104 = "combinations found, out of"
	$Lang104a = ""
	$Lang105 = "should reach"
	$Lang106 = "finds in"
	$Lang107 = "Caching days"
	$Lang108 = "and"
	$Lang109 = "Europe"
	$Lang110 = "Canada"
	$Lang111 = "USA"
	$Lang112 = "Most Northerly cache found"
	$Lang113 = "Most Southerly cache found"
	$Lang114 = "Most Westerly cache found"
	$Lang115 = "Most Easterly cache found"
	$Lang116 = ""
	$Lang117 = "now archived"
	$Lang118 = "Most FTFs in a day"
	$Lang119 = "Maximum distance in a day"
	$Lang120 = "Cache centroid"
	$Lang121 = "Finders of My Caches"
	$Lang122 = "have also found caches placed by"
	$Lang123 = "Log Length, words"
	$Lang124 = "Average"
	$Lang125 = "Longest"
	$Lang126 = "Shortest"
	$Lang127 = "finds were rated with Diff or Terr of 3 or greater"
	$Lang128 = "Last Find"
	$Lang129 = "Sort by Date"
	$Lang130 = "Sort by Finds"
	$Lang131 = "Average Distance"
	$Lang132 = "Click years to show or hide the statistics for that year"
	$Lang133 = "All"
	$Lang134 = "Cumulative Finds by Month"
	$Lang135 = "Cumulative Total"
	$Lang136 = "Annual Totals"
	$Lang137 = "No data"
	$Lang138 = "Show Archived"
	$Lang139 = "Hide Archived"
	$Lang140 = "Owned"
	$Lang141 = "adopted"
	$Lang142 = "Earth Circumnavigation"
	$Lang143 = "Distance to the Moon"
	$Lang144 = "Most FTFs in a calendar month"
	$Lang145 = "out of"
	$Lang146a = "other cache"
	$Lang146b = "other caches"
	$Lang147 = "Last 365 Days"
	$Lang148 = "Last 365 Days Averages"
	$Lang149 = "Finds by Bearing"
	$Lang150 = "Finds by Month"
	$Lang151 = "Last"
	$Lang152 = "Finds by Year Cache Placed"
	$Lang153 = "Most Cache Types in a day"
	$Lang154 = "Finds To Today's Date By Year"
	$Lang155 = "Found Dates, out of"
	$Lang156 = "Placed Months, out of"
	$Lang157 = "Most consecutive months with a FTF"
	$Lang158 = "Highest and Lowest Elevations"
	$Lang159 = "Resolution"
	$Lang160 = "Elevation"
	$Lang161 = "Sort by Days/Find"
	$Lang162 = "Weekend Finds"
	$Lang163 = "Weekday Finds"
	$Lang164 = "Total Words"
	$Lang165 = "Total Characters"
	$Lang166 = "The macro is up to date"
	$Lang167 = "Average elevation of all finds"
	$Lang168 = "Elevation Chart"
	$Lang169 = "State"
	$Lang170 = "Finds to"
	$Lang171 = "for Each Year"
	$Lang172 = "Sort by Totals"
	$Lang173 = "Sort by Name"
	$Lang174 = "Cumulative Finds of My Caches"
	$Lang175 = "Edit Elevation"
	$Lang176 = "Average Distance by Bearing"
	$Lang177 = "Green cells or black text indicate at least one FTF on that day"
	$Lang178 = "Finds Per Day"
	$Lang179 = "Caches Found In a Day"
	$Lang180 = "Most Countries in a day"
	$Lang181 = "Most States in a day"
	$Lang182 = "Most Counties in a day"
	$Lang183 = "Number of times finds/day has been achieved"
	$Lang184 = "Have Made"
	$Lang185 = "is"
	$Lang186 = "from home"
	$Lang187 = "has also had"
	$Lang188 = "with more than 100 finds"
	$Lang189 = "with one find"
	$Lang190 = "Placed Dates, out of"
	$Lang191 = "Caches with most Favorite Points"
	$Lang192 = "Favorites"
	$Lang193 = "Hide with most fav points"
	$Lang194 = "Sort by Fav Points"
	$Lang195 = "Sort by Last Find"

ENDSUB #English

BEGINSUB Name=French

	#Francais
	###################################
	# Language file for FindStatGen3
	#
	# Ver 1.15
	# 10-06-07
	###################################

	###################################
	# Strings for Status Windows
	###################################

	$LangStatus01 = "Initialisation fichiers... 25%"
	$LangStatus02 = "Initialisation variables... 50%"
	$LangStatus03 = "Initialisation variables Boolenes... 75%"
	$LangStatus04 = "Menu"
	$LangStatus05 = "Initialisation des Options..."
	$LangStatus06 = "Initialisation formulaire d'Options..."
	$LangStatus07 = "Menu"
	$LangStatus08 = "Sauvegarde des Options..."
	$LangStatus09 = "Initialisation de la base de donne... 20%"
	$LangStatus10 = "Initialisations des Logs... 70%"
	$LangStatus11 = "Initialisation du Rapport... 80%"
	$LangStatus12 = "Nettoyage..."
	$LangStatus13 = "Recherche meilleur mois:"
	$LangStatus14 = "Trouves/mois:"
	$LangStatus15 = "Cration des statistiques:"
	$LangStatus16 = "criture du Rapport..."
	$LangStatus17 = "Trouves par difficult/terrain..."
	$LangStatus18 = "Graphique des difficult/terrain..."
	$LangStatus19 = "Trouves/mois..."
	$LangStatus20 = "Balises, cration du Rapport:"
	$LangStatus21 = "Analyse des logs:"
	$LangStatus22a = "Trouves par"
	$LangStatus22b = " de la Maison"
	$LangStatus23a = "Trouves par"
	$LangStatus23b = "de la Maison..."
	$LangStatus24 = "Trouves par Type"
	$LangStatus25 = "Trouves par Type..."
	$LangStatus26 = "Trouves par Format"
	$LangStatus27 = "Trouves par Format..."
	$LangStatus28 = "Trouves par Propritaire..."
	$LangStatus29a = "Trouves par Proprio, analyse enregistrement:"
	$LangStatus29b = "de"
	$LangStatus30 = "Trouves par tat..."
	$LangStatus31 = "Trouves par tat..."
	$LangStatus32 = "Cration carte des tats"
	$LangStatus33 = "Trouves par Province..."
	$LangStatus34 = "Trouves par Pays..."
	$LangStatus35 = "Trouves par pays Europen..."
	$LangStatus36 = "tat:"
	$LangStatus37 = "Trouves/jour de semaine..."
	$LangStatus38a = "Trouves/jour de semaine, analyse enregistrement:"
	$LangStatus38b = "de"
	$LangStatus39a = "Trouves/jour de semaine, dcompte:"
	$LangStatus39b = "'s trouves."
	$LangStatus40a = "Jours conscutifs, analyse enregistrement:"
	$LangStatus40b = "de"
	$LangStatus41a = "Recherche du plus vite"
	$LangStatus41b = "trouves, vrifie enregistrement:"
	$LangStatus41c = "de"
	$LangStatus42 = "Recherche meilleur weekend, vrifie:"
	$LangStatus43 = "Recherche meilleure semaine, vrifie:"
	$LangStatus44 = "Distance totale, analyse cache:"
	$LangStatus45 = "Copie Base de donne... 30%"
	$LangStatus46 = "Copie Base de donne... 40%"
	$LangStatus47 = "Analyse waypoints... 50%"
	$LangStatus48 = "Analyse waypoints... 55%"
	$LangStatus49 = "Cache avec multiple logs 'trouve':"
	$LangStatus50 = "Initialisation nouvelle BD... 60%"

	# Form strings

	$LangT1 = "Trouves par mois"
	$LangT2 = "Balises"
	$LangT3 = "Distance de la Maison *"
	$LangT4 = "Type de Cache *"
	$LangT5 = "Diff/Terr"
	$LangT6 = "Proprio"
	$LangT7 = "Carte tats-Unis"
	$LangT8 = "Carte Provinces Canadiennes"
	$LangT9 = "Carte de l'Europe"
	$LangT10 = "Carte de l'Australie"
	$LangT11 = "Carte Mondiale"
	$LangT12 = "Jours de la semaine *"
	$LangT13 = "Type de Contenant *"
	$LangT14 = "Autres Statistiques"
	$LangT15 = "PATs"
	$LangT16 = "--Exclu--"
	$LangT17 = "Notes"
	$LangT18 = "Cach"
	$LangT19 = "Mmorables"
	$LangT20 = "Autres Cartes"
	$LangT21 = "Relvement *"
	$LangT22 = "Mois *"
	$LangT23 = "Anne Caches places *"
	$LangT24 = "Trouvailles jusqu' aujourd'hui *"
	$LangT25 = "Notes B"
	$LangT26 = "Trouves par date trouve"
	$LangT27 = "Tableau Diff/Terr"
	$LangT28 = "Trouves selon le mois o la cache a t place"
	$LangT29 = "lvation"
	$LangT30 = "Distance Moyenne *"
	$LangT31 = "Trouves par jour"
	$LangT32 = "US County Map"
	$LangT33 = "Trouves selon la date o la cache a t place"
	$LangT34 = "First Cache By Country"
	$LangT35 = "Notes C"
	$LangT36 = "Favorites"

	$LangForm01 = "Options d'exportation des statistiques"
	$LangForm02 = "Export des statistiques des 'Trouves' en HTML"
	$LangForm03 = "Base de donne pour l'exportation"
	$LangForm04 = "Nom du Gocacheur"
	$LangForm05 = "Intervalle des Balises"
	$LangForm06 = "Intervalle des PAT"
	$LangForm07 = "Nom localisation 'Home'"
	$LangForm08 = "Style de couleur"
	$LangForm09 = "Langue"
	$LangForm10 = "MAJ"
	$LangForm11 = "Exclure les 'Locationless'?"
	$LangForm12 = "Afficher le tableau Difficult/Terrain?"
	$LangForm13 = "Afficher les annes en ordre descendant?"
	$LangForm14 = "Utiliser l'ordre du tri actuel pour les Balises?"
	$LangForm15 = "(Laisser non-slectionn normalement)"
	$LangForm16 = "Barres ombrages"
	$LangForm17 = "Afficher les barres ombrages?"
	$LangForm18 = "Source des barres ombrages"
	$LangForm19 = "(Choisir distant pour profil GC.com)"
	$LangForm20 = "Local"
	$LangForm21 = "Distant"
	$LangForm22 = "OK"
	$LangForm23 = "Annuler"
	$LangForm24 = "Choisir les sections et l'ordre d'affichage:"
	$LangForm25 ="* = sections demi-largeur,  garder en paires"
	$LangForm26 = "Restaurer dfauts"
	$LangForm27 = "xcution automatique de la macro (avec dlai)"
	$LangForm28 = "Cliquez n'importe o sur la boite pour arrter l'xcution automatique"
	$LangForm29 = "Options"
	$LangForm30 = "Exportation des statistiques en HTML"
	$LangForm31 = "Ensembles de paramtres"
	$LangForm32 = "Save"
	$LangForm33 = "Changez Balise"
	$LangForm34 = "Balise"
	$LangForm35 = "Code"
	$LangForm36 = "Date"
	$LangForm37 = "Ajouter/diter"
	$LangForm38 = "Effacer"
	$LangForm39 = "Corrections aux Balises"
	$LangForm40 = "Liste Corrige"
	$LangForm41 = "Incluez vos Trouvailles dans Cach?"
	$LangForm42 = "Nombres"
	$LangForm43 = "Base de Geocaches Caches"
	$LangForm51 = "Totaux:"
	$LangForm52 = "Conscutif:"
	$LangForm53 = "Meilleures Priodes De Temps:"
	$LangForm54 = "Plus rapidement:"
	$LangForm55 = "Distance Totale:"
	$LangForm56 = "Plus prs/Plus loigne:"
	$LangForm57 = "Lat/Lon Extrmits:"
	$LangForm58 = "Centroid:"
	$LangForm59 = "Plus ancienne/Plus rcente:"
	$LangForm60 = "Archives:"
	$LangForm61 = "Annuler"
	$LangForm62 = "Autres Statistiques"
	$LangForm63 = "Description"
	$LangForm64 = "Type"
	$LangForm65 = "Caches mmorables"
	$LangForm66 = "diter caches mmorables"
	$LangForm67 = "Mmorables"
	$LangForm68 = "Plus proche affiche:"
	$LangForm69 = "(HEAD pour sparateur)"
	$LangForm70 = "Toutes les annes"
	$LangForm71 = "Utiliser graphique circulaire?"
	$LangForm72 = "Afficher graphique cumulatif?"
	$LangForm73 = "Cartes"
	$LangForm74 = "Choisir Cartes  Afficher"
	$LangForm75 = "Ordre des sections"
	$LangForm76 = "Centrer le rsultat?"
	$LangForm77 = "Vrifer les mises  jours"
	$LangForm78 = "Date d'excution:"
	$LangForm79 = "Statistiques de mes caches:"
	$LangForm80 = "Liste des mes caches:"
	$LangForm81 = "Trouveurs de mes caches:"
	$LangForm82 = "Caches Places"
	$LangForm83 = "Nombre de caches places  montrer:"
	$LangForm84 = "Active"
	$LangForm85 = "Desactive"
	$LangForm86 = "Vrificateur d'orthographe"
	$LangForm87 = "Mise  jour des rgions (County)"
	$LangForm88 = "Choisissez la carte  diter..."
	$LangForm89 = "Afficher la carte des lvations?"
	$LangForm90 = "lvation"
	$LangForm91 = "Utiliser les drapeaux?"
	$LangForm92 = "Placed charts"
	$LangForm93 = "diter lvation"
	$LangForm94 = "Load"
	$LangForm95 = "Intervales des lvation"
	$LangForm96 = "Automatique"
	$LangForm97 = "Supprimer les zros"
	$LangForm98 = "(Remplace la valeur ci-dessous)"
	$LangForm99 = "Modifier la position de 'Home'"
	$LangForm100 = "Coordonnes"
	$LangForm101 = "Positions de 'Home'"
	$LangForm102 = "Utilisez les cartes  ombrage dgrade"
	$LangForm103 = "Utiliser les donnes Aster 30m"
	$LangForm104 = "Utiliser barres ombrages pour la carte thermique"
	$LangForm105 = "Utiliser les barres ombrages plates"
	$LangForm106 = "lvations  afficher"
	$LangForm107 = "Copy"
	$LangForm108 = "Rounded Style"

	# Main Strings

	$Lang01 = "a"
	$Lang01a = "a"
	$Lang02 = "Trouves sur"
	$Lang03 = "Gocaches individuelles"
	$Lang04 = "Statistiques gnres le"
	$Lang05 = "Nombre"
	$Lang06 = "%"
	$Lang07 = "Total des Trouves"
	$Lang08 = "Jours de Gocaching"
	$Lang09 = "Moy Trouves/Jour de gocaching"
	$Lang10 = "Total des Trouves par jour"
	$Lang11 = "Moyenne Trouves/semaine"
	$Lang11a = "Moyenne Trouves/mois"
	$Lang12 = "Mois:"
	$Lang13 = "Jan"
	$Lang14 = "Fv"
	$Lang15 = "Mar"
	$Lang16 = "Avr"
	$Lang17 = "Mai"
	$Lang18 = "Juin"
	$Lang19 = "Juil"
	$Lang20 = "Aot"
	$Lang21 = "Sep"
	$Lang22 = "Oct"
	$Lang23 = "Nov"
	$Lang24 = "Dc"
	$Lang25 = "Jours de Gocaching:"
	$Lang26 = "Trouves par niveau Difficult"
	$Lang27 = "Trouves par niveau Terrain"
	$Lang28 = "Tableau Difficult / Terrain"
	$Lang28a = "Difficult"
	$Lang28b = "Terrain"
	$Lang29 = "Trouves par Mois"
	$Lang30 = "Balises"
	$Lang31 = "Balise"
	$Lang32 = "Date"
	$Lang33 = "Intervalle"
	$Lang34 = "Code"
	$Lang35 = "Nom de la Cache"
	$lang36a = "jour"
	$lang36b = "jours"
	$lang36c = "jours"
	$lang36d = "jour"
	$Lang37 = "Compte"
	$Lang38a = "Note: excluant les caches 'locationless'."
	$Lang38b = "Note: incluant les caches 'locationless'."
	$Lang39 = "Trouves par Propritaire"
	$Lang40 = "Celles-ci ne se sont pas retrouves parmis le palmars:"
	$Lang41 = "a aussi trouv des caches places par "
	$Lang42 = "autres personnes"
	$Lang42a = "autres personnes"
	$Lang43 = "trouves dans"
	$Lang44a = "tat"
	$Lang44b = "tats"
	$Lang45 = "Image de"
	$Lang46a = "Province"
	$Lang46b = "Provinces"
	$Lang47 = "Monde"
	$Lang48 = "Pays"
	$Lang49 = "Pays"
	$Lang50 = "Trouves par jour de semaine"
	$Lang51 = "Dimanche;Lundi;Mardi;Mercredi;Jeudi;Vendredi;Samedi"
	$Lang52 = "Autres statistiques"
	$Lang53 = "Cache trouve la plus prs"
	$Lang54 = "Cache trouve la plus loigne"
	$Lang55 = "Plus rcente cache trouve"
	$Lang56 = "Plus ancienne cache trouve"
	$Lang57 = "trouves en"
	$Lang58 = "jours de gocaching sur plus de"
	$Lang59 = "jours au total"
	$Lang60 = "trouves par jour de gocaching,"
	$Lang61 = "/jour,"
	$Lang62 = "/sem,"
	$Lang63 = "/mois"
	$Lang64 = "Plus grand nombre de jours conscutifs  trouver"
	$Lang65 = "(Current streak)"
	$Lang66 = "du"
	$Lang67 = "au"
	$Lang68 = "Plus grand nombre de jours conscutifs sans trouver"
	$Lang69 = "Aucun - vous avez trouv une cache  chaque jour!"
	$Lang70 = "Plus grand nombre trouves en une journe"
	$Lang71 = "le"
	$Lang72 = "Caches trouves maintenant archives"
	$Lang73 = "Plus grand nombre de trouves en un mois"
	$Lang74 = "en"
	$Lang75 = "Plus rapide"
	$Lang76 = "trouves"
	$Lang77 = "jour du "
	$Lang78 = "jours du "
	$Lang79 = "Meilleure fin de semaine de gocaching"
	$Lang80 = "Aucune trouve le week-end"
	$Lang81 = "trouves, du Samedi"
	$Lang82 = "au Dimanche"
	$Lang83 = "Meilleure semaine de gocaching"
	$Lang84 = "trouves, du Lundi"
	$Lang85 = "au Dimanche"
	$Lang86 = "Distance Totale cache--cache"
	$Lang87 = "Total Global"
	$Lang88 = "Moyenne Globale"
	$Lang89 = "Notes"
	$Lang90 = "Geocaches Caches Par"
	$Lang91 = "Cach"
	$Lang92 = "Trouves"
	$Lang93 = "Jours/Trouve"
	$Lang94 = "Code"
	$Lang95 = "Nom de la Cache"
	$Lang96 = "Statistiques De Geocaches Caches"
	$Lang97 = "Trouves Total de mes caches"
	$Lang98 = "Total que j'ai trouv"
	$Lang99 = "Karma de gocaching"
	$Lang100 = "Geocache le plus trouve"
	$Lang101 = "Geocache le plus souvent trouve"
	$Lang102 = "Tous les"
	$Lang103 = "Trouves sur"
	$Lang104 = "combinaisons trouve sur"
	$Lang104a = ""
	$Lang105 = "devrait atteindre"
	$Lang106 = "trouves en"
	$Lang107 = "jours de gocaching"
	$Lang108 = "et"
	$Lang109 = "Europe"
	$Lang110 = "Canada"
	$Lang111 = "USA"
	$Lang112 = "Cache trouve la plus au Nord"
	$Lang113 = "Cache trouve la plus au Sud"
	$Lang114 = "Cache trouve la plus  l'Ouest"
	$Lang115 = "Cache trouve la plus  l'Est"
	$Lang116 = ""
	$Lang117 = "maintenant archive(s)"
	$Lang118 = "Plus grand nombre PATs en une journe"
	$Lang119 = "Plus grande distance en une journe"
	$Lang120 = "Cache centroid"
	$Lang121 = "Trouveur de mes caches"
	$Lang122 = "ont aussi trouv des caches places par "
	$Lang123 = "Longueur des Logs en nombre de mots"
	$Lang124 = "Moyenne"
	$Lang125 = "Le plus long"
	$Lang126 = "Le plus court"
	$Lang127 = "des trouvailles ont t values avec Diff ou Terr de 3 ou plus grand"
	$Lang128 = "Dernire trouve"
	$Lang129 = "Tri par Date"
	$Lang130 = "Tri par Trouves"
	$Lang131 = "Distance Moyenne"
	$Lang132 = "Cliquer sur l'anne pour montrer ou cacher les statistiques de cette anne"
	$Lang133 = "Tout"
	$Lang134 = "Cumulatif des caches trouves par mois"
	$Lang135 = "Total Cumulatif"
	$Lang136 = "Total Annuel"
	$Lang137 = "Pas indiqu"
	$Lang138 = "Voir archive(s)"
	$Lang139 = "Cacher archive(s)"
	$Lang140 = "Caches"
	$Lang141 = "adopte(s)"
	$Lang142 = "Tour de la Terre"
	$Lang143 = "Distance Terre-Lune"
	$Lang144 = "Plus grand nombre PATs en un mois"
	$Lang145 = "sur"
	$Lang146a = "autre cache"
	$Lang146b = "autres caches"
	$Lang147 = "Dernire 365 Jours"
	$Lang148 = "Dernire 365 Jours Moyenne"
	$Lang149 = "Trouves par Direction"
	$Lang150 = "Meilleur mois"
	$Lang151 = "Dernire"
	$Lang152 = "Trouves par Anne de placement des caches"
	$Lang153 = "Plus grand nombre types en une journe"
	$Lang154 = "Trouves jusqu' la date du jour par anne"
	$Lang155 = "dates trouves sur"
	$Lang156 = "mois diffrents, sur un total de"
	$Lang157 = "Plus de mois conscutifs avec des PT"
	$Lang158 = "Trouves selon l'lvation : les plus hautes et les plus basses"
	$Lang159 = "Rsolution"
	$Lang160 = "lvation"
	$Lang161 = "Trier par Jours/Trouve"
	$Lang162 = "Trouves les fins de semaine"
	$Lang163 = "en semaine"
	$Lang164 = "Total de mots"
	$Lang165 = "Total de caractres"
	$Lang166 = "La macro est  jour"
	$Lang167 = "lvation moyenne de toutes les Trouves"
	$Lang168 = "Carte des lvations"
	$Lang169 = "tat"
	$Lang170 = "Trouves jusqu'au"
	$Lang171 = "de chaque anne"
	$Lang172 = "Trier par Totaux"
	$Lang173 = "Trier par Nom"
	$Lang174 = "Trouvailles cummules de mes caches"
	$Lang175 = "Edit Elevation"
	$Lang176 = "Distance moyenne par relvement"
	$Lang177 = "Les cellules vertes ou textes noirs indiquent qu'il y a  eu au moins un PAT cette journe"
	$Lang178 = "Nombre trouves par jour"
	$Lang179 = "Caches trouves en une journe"
	$Lang180 = "Plus de pays en un jour"
	$Lang181 = "Plus de rgion en un jour"
	$Lang182 = "Plus de dpartement en un jour"
	$Lang183 = "Nombre de fois trouves/jour a t accompli"
	$Lang184 = "a fait"
	$Lang185 = "est"
	$Lang186 = "de la maison"
	$Lang187 = "a aussi eu"
	$Lang188 = "avec plus de 100 trouves"
	$Lang189 = "avec une trouve"
	$Lang190 = "dates diffrentes, sur un total de"
	$Lang191 = "Caches with most Favorite Points"
	$Lang192 = "Favorites"
	$Lang193 = "Geocache le plus fav points"
	$Lang194 = "Trier par Fav Points"
	$Lang195 = "Trier par dernire trouve"

ENDSUB #French

BEGINSUB Name=German

	#Deutsch
	###################################
	# Language file for FindStatGen3
	#
	# Ver 1.15
	# 10-06-07
	###################################

	# Status Windows
	$LangStatus01 = "Initialisiere Daten... 25%"
	$LangStatus02 = "Initialisiere Variablen... 50%"
	$LangStatus03 = "Initialisiere Boolean... 75%"
	$LangStatus04 = "Men"
	$LangStatus05 = "Initialisiere Optionen..."
	$LangStatus06 = "Initialisiere Optionsmen..."
	$LangStatus07 = "Men"
	$LangStatus08 = "Optionen gesichert..."
	$LangStatus09 = "Initialisiere Datenbank... 20%"
	$LangStatus10 = "Initialisiere Log... 70%"
	$LangStatus11 = "Initialisiere Ausgabe... 80%"
	$LangStatus12 = "Aufrumen..."
	$LangStatus13 = "Finde besten Monat:"
	$LangStatus14 = "Funde nach Monat:"
	$LangStatus15 = "Generiere Statistik:"
	$LangStatus16 = "Schreibe Ausgabe..."
	$LangStatus17 = "Funde nach Schwierigkeit/Gelnde..."
	$LangStatus18 = "bersicht nach Schwierigkeit/Gelnde..."
	$LangStatus19 = "Funde nach Monat..."
	$LangStatus20 = "Meilensteine, erstelle Ausgabe:"
	$LangStatus21 = "Analysiere Logs:"
	$LangStatus22a = "Funde nach"
	$LangStatus22b = " von zu Hause"
	$LangStatus23a = "Funde nach"
	$LangStatus23b = " von zu Hause ..."
	$LangStatus24 = "Funde nach Typ"
	$LangStatus25 = "Funde nach Typ..."
	$LangStatus26 = "Funde nach Behlter"
	$LangStatus27 = "Funde nach Behlter..."
	$LangStatus28 = "Funde nach Owner..."
	$LangStatus29a = "Funde nach Owner, analysiere Eintrge:"
	$LangStatus29b = "of"
	$LangStatus30 = "Funde nach Bundestaat (US)..."
	$LangStatus31 = "Funde nach Bundestaat (US)..."
	$LangStatus32 = "Erstelle Staatenkarte"
	$LangStatus33 = "Funde nach Provinz (CA)..."
	$LangStatus34 = "Funde nach Land..."
	$LangStatus35 = "Funde nach europischen Lndern..."
	$LangStatus36 = "Staat:"
	$LangStatus37 = "Funde nach Wochentag..."
	$LangStatus38a = "Funde nach Wochentag, analysiere Eintrge:"
	$LangStatus38b = "of"
	$LangStatus39a = "Funde nach Wochentag, zhle:"
	$LangStatus39b = "'s Funde."
	$LangStatus40a = "Aufeinanderfolgende Tage, analysiere Eintrge:"
	$LangStatus40b = "of"
	$LangStatus41a = "Ermittele schnellste"
	$LangStatus41b = "Funde, suche Eintrge:"
	$LangStatus41c = "of"
	$LangStatus42 = "Ermittele bestes Wochenende, suche:"
	$LangStatus43 = "Ermittele beste Woche, suche:"
	$LangStatus44 = "Gesamte Entfernung, analysiere Cache:"
	$LangStatus45 = "Kopiere Datenbank... 30%"
	$LangStatus46 = "Kopiere Datenbank... 40%"
	$LangStatus47 = "Analysiere Wegpunkte... 50%"
	$LangStatus48 = "Analysiere Wegpunkte... 55%"
	$LangStatus49 = "Caches mit mehreren Funden:"
	$LangStatus50 = "Initialisiere neu Datenbank... 60%"

	# Form strings

	$LangT1 = "Funde nach Monat"
	$LangT2 = "Meilensteine"
	$LangT3 = "Entfernung von zu Hause *"
	$LangT4 = "Cache Typ *"
	$LangT5 = "Schwierigkeit/Gelnde"
	$LangT6 = "Besitzer"
	$LangT7 = "Karte der USA"
	$LangT8 = "Kanadische Karte"
	$LangT9 = "Europische Karte"
	$LangT10 = "Australische Karte"
	$LangT11 = "Weltkarte"
	$LangT12 = "Wochentage *"
	$LangT13 = "Behltergre *"
	$LangT14 = "Andere Statistiken"
	$LangT15 = "FTFs"
	$LangT16 = "--Ausgeschlossen--"
	$LangT17 = "Anmerkungen"
	$LangT18 = "Versteckte Caches"
	$LangT19 = "Spezial"
	$LangT20 = "Weitere Karten"
	$LangT21 = "Richtung *"
	$LangT22 = "Monat *"
	$LangT23 = "Platzierungsjahr *"
	$LangT24 = "Funde bis heute *"
	$LangT25 = "Anmerkungen B"
	$LangT26 = "Funde nach Kalendertagen"
	$LangT27 = "Tabelle Schwierigkeit/Gelnde"
	$LangT28 = "Funde nach Platzierungsmonat"
	$LangT29 = "Hhe"
	$LangT30 = "Mittl. Entfernung *"
	$LangT31 = "Funde pro Tag"
	$LangT32 = "US County Map"
	$LangT33 = "Funde nach Versteck-Datum"
	$LangT34 = "Erster Cache eines Landes"
	$LangT35 = "Anmerkungen C"
	$LangT36 = "Favorites"

	$LangForm01 = "Fund Statistik HTML Export Optionen"
	$LangForm02 = "Fund Statistik HTML Export"
	$LangForm03 = "Zu exportierende Datenbank"
	$LangForm04 = "Geocaching Nickname"
	$LangForm05 = "Abstand Meilensteine"
	$LangForm06 = "Abstand FTF"
	$LangForm07 = "Heimatort"
	$LangForm08 = "Stil Farbe"
	$LangForm09 = "Sprache"
	$LangForm10 = "Set"
	$LangForm11 = "Locationless ausschliessen?"
	$LangForm12 = "Zeige Tabelle Schwierigkeit/Gelnde?"
	$LangForm13 = "Zeige Jahre in absteigender Reihenfolge"
	$LangForm14 = "Benutze momentane Sortierung fr Meilensteine?"
	$LangForm15 = "(Normalerweise nicht ausgewhlt)"
	$LangForm16 = "Schattierte Balken"
	$LangForm17 = "Benutze schattierte Balken?"
	$LangForm18 = "Bilderquelle schattierte Balken"
	$LangForm19 = "(Whle Remote fr GC Profil)"
	$LangForm20 = "Lokal"
	$LangForm21 = "Remote"
	$LangForm22 = "OK"
	$LangForm23 = "Abbrechen"
	$LangForm24 = "Auswahl Reporte und Reihenfolge:"
	$LangForm25 ="(* Bitte prchenweise auswhlen)"
	$LangForm26 = "Auf Standard"
	$LangForm27 = "Makro-Autostart beim nchsten Mal (mit Verzgerung)"
	$LangForm28 = "Um Autostart anzuhalten, klicke irgendwo auf das Formular"
	$LangForm29 = "Optionen"
	$LangForm30 = "Fund Statistik HTML Export"
	$LangForm31 = "Gruppenauswahl"
	$LangForm32 = "Speichern"
	$LangForm33 = "Meilenstein bearbeiten"
	$LangForm34 = "Meilenstein"
	$LangForm35 = "Code"
	$LangForm36 = "Datum"
	$LangForm37 = "Hinzufgen/Bearbeiten"
	$LangForm38 = "Lschen"
	$LangForm39 = "Korrekturen zu den Meilensteinen"
	$LangForm40 = "Behobene Liste"
	$LangForm41 = "Eigene Funde bei Versteckten bercksichtigen?"
	$LangForm42 = "Nummern"
	$LangForm43 = "Versteckte Caches Datenbank"
	$LangForm51 = "Summen:"
	$LangForm52 = "Folgen:"
	$LangForm53 = "Beste Zeitrume:"
	$LangForm54 = "Schnellsten:"
	$LangForm55 = "Gesamte Distanz:"
	$LangForm56 = "Nhester/Weitester:"
	$LangForm57 = "Lat/Lon Extreme:"
	$LangForm58 = "Schwerpunkt:"
	$LangForm59 = "ltester/Jngster:"
	$LangForm60 = "Archiviert:"
	$LangForm61 = "Abbrechen"
	$LangForm62 = "Eigene Statistiken"
	$LangForm63 = "Beschreibung"
	$LangForm64 = "Typ"
	$LangForm65 = "Spezielle Caches"
	$LangForm66 = "Spezielle Caches editieren"
	$LangForm67 = "Spezial"
	$LangForm68 = "Nchster Angezeigter:"
	$LangForm69 = "(HEAD fr Unterabschnitt)"
	$LangForm70 = "Alle Jahre anzeigen"
	$LangForm71 = "Verwende Tortendiagramm?"
	$LangForm72 = "Zeige Grafik fr Kumulierte Funde?"
	$LangForm73 = "Karten"
	$LangForm74 = "Landeskarten auswhlen"
	$LangForm75 = "Reihenfolge der Auswertungen"
	$LangForm76 = "Zentrierte Ausgabe?"
	$LangForm77 = "Auf Updates prfen"
	$LangForm78 = "Stichtag:"
	$LangForm79 = "Statistik fr eigene Caches:"
	$LangForm80 = "Liste eigener Caches:"
	$LangForm81 = "Finder meiner Caches:"
	$LangForm82 = "Versteckte Caches"
	$LangForm83 = " Anzahl eigener angezeigter Caches:"
	$LangForm84 = "Anzeigen"
	$LangForm85 = "Ausblenden"
	$LangForm86 = "Rechtschreibprfung"
	$LangForm87 = "Landkreise aktualisieren"
	$LangForm88 = "Please choose a map to edit..."
	$LangForm89 = "Zeige Hhenbersicht"
	$LangForm90 = "Hhe"
	$LangForm91 = "Verwende Flaggen Icons?"
	$LangForm92 = "bersicht eigener Caches "
	$LangForm93 = "Verndere Hhe"
	$LangForm94 = "Laden"
	$LangForm95 = "Elevation Intervals"
	$LangForm96 = "verwende Automatische Abstnde"
	$LangForm97 = " Mehrfache Nullhhen ausblenden"
	$LangForm98 = "(berschreibt Werte unten)"
	$LangForm99 = "Heimatkoordinaten bearbeiten"
	$LangForm100 = "Koordinaten"
	$LangForm101 = "Heimatkoordinaten"
	$LangForm102 = "Warm-/Kalt-Schattierung verwenden" 
	$LangForm103 = "Benutze Aster 30m Daten"
	$LangForm104 = "Benutze wie die 'Heatmap' gefrbte Balken"
	$LangForm105 = "Benutze einfach gefrbte Balken "
	$LangForm106 = "Hhen zum Anzeigen"
	$LangForm107 = "Copy"
	$LangForm108 = "Abgerundeter Stil"

	# Main Strings

	$Lang01 = "hat"
	$Lang01a = "hat"
	$Lang02 = "Funde bei"
	$Lang03 = "einzelnen Geocaches"
	$Lang04 = "Statistik generiert am"
	$Lang05 = "Anzahl"
	$Lang06 = "Prozent"
	$Lang07 = "Alle Funde"
	$Lang08 = "Cachetage"
	$Lang09 = "Durchschnittliche Funde pro Cache-Tag"
	$Lang10 = "Durchschnittliche Funde pro Tag"
	$Lang11 = "Durchschnittliche Funde pro Woche"
	$Lang11a = "Durchschnittliche Funde pro Monat"
	$Lang12 = "Monat:"
	$Lang13 = "Jan"
	$Lang14 = "Feb"
	$Lang15 = "Mr"
	$Lang16 = "Apr"
	$Lang17 = "Mai"
	$Lang18 = "Jun"
	$Lang19 = "Jul"
	$Lang20 = "Aug"
	$Lang21 = "Sep"
	$Lang22 = "Okt"
	$Lang23 = "Nov"
	$Lang24 = "Dez"
	$Lang25 = "Cachetage:"
	$Lang26 = "Funde nach Aufgabenschwierigkeit"
	$Lang27 = "Funde nach Gelndeschwierigkeit"
	$Lang28 = "bersicht Schwierigkeit / Gelnde"
	$Lang28a = "Schwierigkeit"
	$Lang28b = "Gelnde"
	$Lang29 = "Funde nach Monat"
	$Lang30 = "Meilensteine"
	$Lang31 = "Meilenstein"
	$Lang32 = "Datum"
	$Lang33 = "Abstand"
	$Lang34 = "Code"
	$Lang35 = "Cache Name"
	$lang36a = "Tag"
	$lang36b = "Tage"
	$lang36c = "Tagen"
	$lang36d = "Tage"
	$Lang37 = "Nr."
	$Lang38a = "Hinweis: Ausgenommen Locationless Caches."
	$Lang38b = "Hinweis: Eingenommen Locationless Caches."
	$Lang39 = "Funde nach Besitzer"
	$Lang40 = "Diese haben es nicht in die Spitze geschafft:"
	$Lang41 = "hat auerdem Caches von"
	$Lang42 = "anderen Leuten gefunden"
	$Lang42a = "andere Leute"
	$Lang43 = "Funde in"
	$Lang44a = "Staat"
	$Lang44b = "Staaten"
	$Lang45 = "Karte von"
	$Lang46a = "Provinz"
	$Lang46b = "Provinzen"
	$Lang47 = "Welt"
	$Lang48 = "Lndern"
	$Lang49 = "Land"
	$Lang50 = "Funde nach Wochentag"
	$Lang51 = "Sonntag;Montag;Dienstag;Mittwoch;Donnerstag;Freitag;Samstag"
	$Lang52 = "Einige Statistiken"
	$Lang53 = "Am nchsten liegender Cache-Fund"
	$Lang54 = "Am weitesten entfernter Cache-Fund"
	$Lang55 = "Neuster gefundener Cache"
	$Lang56 = "ltester gefundener Cache"
	$Lang57 = "Funde an"
	$Lang58 = "Cache Tagen bei"
	$Lang59 = "Tagen total"
	$Lang60 = "Funde per Cache Tag,"
	$Lang61 = "/Tag,"
	$Lang62 = "/Woche,"
	$Lang63 = "/Monat"
	$Lang64 = "Die meisten aufeinanderfolgenden Tage mit Funden"
	$Lang65 = "(Momentane Strhne)"
	$Lang66 = "vom"
	$Lang67 = "bis zum"
	$Lang68 = "Die meisten aufeinanderfolgenden Tage ohne Funde"
	$Lang69 = "Keine - Du hast jeden Tag einen Fund!"
	$Lang70 = "Tag mit den meisten Funden"
	$Lang71 = "am"
	$Lang72 = "Mittlerweile archivierte Caches"
	$Lang73 = "Die meisten Funde in einem Kalendermonat"
	$Lang74 = "in"
	$Lang75 = "Schnellsten"
	$Lang76 = "Funde"
	$Lang77 = "Tag von"
	$Lang78 = "Tage vom"
	$Lang79 = "Bestes Ergebnis an einem Wochenende"
	$Lang80 = "Keine Funde am Wochenende"
	$Lang81 = "Funde, am Samstag"
	$Lang82 = "&amp; Sonntag"
	$Lang83 = "Erfolgreichste Woche"
	$Lang84 = "Funde, von Montag"
	$Lang85 = "bis Sonntag"
	$Lang86 = "Entfernung von Cache-zu-Cache"
	$Lang87 = "Globale Gesamtmenge"
	$Lang88 = "Globaler Durchschnitt"
	$Lang89 = "Anmerkungen"
	$Lang90 = "Geocaches versteckt von"
	$Lang91 = "Versteckt"
	$Lang92 = "Funde"
	$Lang93 = "Tage/Fund"
	$Lang94 = "Code"
	$Lang95 = "Cache Name"
	$Lang96 = "Statistik versteckter Caches"
	$Lang97 = "Summe aller Funde meiner Caches"
	$Lang98 = "Summe aller meiner Funde"
	$Lang99 = "Caching Karma"
	$Lang100 = "Versteck mit den meisten Funden"
	$Lang101 = "Meistfrequentierter Cache"
	$Lang102 = "Alle"
	$Lang103 = "Funde bei"
	$Lang104 = "Kombinationen von"
	$Lang104a = "Mglichen gefunden"
	$Lang105 = "sollte"
	$Lang106 = "Funde in"
	$Lang107 = "Cache-Tage"
	$Lang108 = "und"
	$Lang109 = "Europa"
	$Lang110 = "Kanada"
	$Lang111 = "USA"
	$Lang112 = "Nrdlichster Cache-Fund"
	$Lang113 = "Sdlichster Cache-Fund"
	$Lang114 = "Westlichster Cache-Fund"
	$Lang115 = "stlichster Cache-Fund"
	$Lang116 = "erreichen"
	$Lang117 = "mittlerweile archivierte"
	$Lang118 = "Tag mit den meisten FTFs"
	$Lang119 = "Tag mit der grten Entfernung"
	$Lang120 = "Cache Schwerpunkt"
	$Lang121 = "Finder meiner Caches"
	$Lang122 = "haben auerdem Caches gefunden, die versteckt wurden von"
	$Lang123 = "Lnge der Logs (Worte)"
	$Lang124 = "Durchschnitt"
	$Lang125 = "Lngstes"
	$Lang126 = "Krzestes"
	$Lang127 = "Funde haben eine Schwierigkeit/Gelnde von 3 oder grer"
	$Lang128 = "Letzter Fund"
	$Lang129 = "Sortierung nach Datum"
	$Lang130 = "Sortierung nach Funden"
	$Lang131 = "Durchschnittliche Entfernung"
	$Lang132 = "Klicke die Jahre zum Ein- und Ausschalten der zugehrigen Statistik"
	$Lang133 = "Alle"
	$Lang134 = "Kumulierte Funde nach Monat"
	$Lang135 = "Kumuliert Gesamt"
	$Lang136 = "Pro Jahr"
	$Lang137 = "ohne Zuordnung"
	$Lang138 = "Archivierte anzeigen"
	$Lang139 = "Archivierte ausblenden"
	$Lang140 = "Versteckte"
	$Lang141 = "adoptierte"
	$Lang142 = "Erdumrundungen"
	$Lang143 = "Flug zum Mond"
	$Lang144 = "Die meisten FTFs in einem Kalendermonat"
	$Lang145 = "von"
	$Lang146a = "weitere cache"
	$Lang146b = "weitere caches"
	$Lang147 = "Vergangene 365 Tage"
	$Lang148 = "Durchschnitt ber die vergangenen 365 Tage"
	$Lang149 = "Funde nach Richtung"
	$Lang150 = "Funde nach Monat"
	$Lang151 = "Vergangene"
	$Lang152 = "Funde nach Platzierungsjahr der Caches"
	$Lang153 = "Tag mit den meisten Typen"
	$Lang154 = "Funde bis zum heutigen Tag im Jahr"
	$Lang155 = "Kalendertage von"
	$Lang156 = "Platzierungsmonate von"
	$Lang157 = "Die meisten aufeinanderfolgenden Monate mit FTFs"
	$Lang158 = "Hchste und Niedrigste Erhebung"
	$Lang159 = "Auflsung"
	$Lang160 = "Hhe"
	$Lang161 = "Sortierung nach Tage/Fund"
	$Lang162 = "Funde am Wochenende"
	$Lang163 = "Funde an Wochentagen"
	$Lang164 = "Anzahl Wrter"
	$Lang165 = "Anzahl Buchstaben"
	$Lang166 = "Das Macro ist aktuell"
	$Lang167 = "Durchschnittliche Hhe aller Funde"
	$Lang168 = "Hhenbersicht"
	$Lang169 = "Staat"
	$Lang170 = "Funde bis zum"
	$Lang171 = "des Jahres"
	$Lang172 = "Sort nach Summen"
	$Lang173 = "Sortiert nach Name"
	$Lang174 = "Kumulierte Funde meiner Caches"
	$Lang175 = "Verndere Hhe"
	$Lang176 = "Durchschnittliche Entfernung nach Richtung"
	$Lang177 = "Grne Felder oder schwarze Zahlen bedeuten mindestens einen FTF an diesem Tag"
	$Lang178 = "Funde pro Tag"
	$Lang179 = "Funde pro Tag"
	$Lang180 = "Meiste Lnder an einem Tag"
	$Lang181 = "Meisten Bundeslnder pro Tag"
	$Lang182 = "Meisten Landkreise pro Tag"
	$Lang183 = "Anzahl der Tage mit dieser Funden"
	$Lang184 = "machten"
	$Lang185 = "liegt"
	$Lang186 = "von zu Hause entfernt"
	$Lang187 = "hat auch"
	$Lang188 = "mit mehr als 100 Funden"
	$Lang189 = "mit einem Fund"
	$Lang190 = "Versteck-Daten von"
	$Lang191 = "Caches mit den meisten Favoritenpunkten"
	$Lang192 = "Favoriten"
	$Lang193 = "Versteck mit den meisten Favoritenpunkten"
	$Lang194 = "Sort nach Favoritenpunkten"
	$Lang195 = "Sort nach Letzter Fund"

ENDSUB

BEGINSUB Name=DeclareFormVariables
	# Section Form Variables (do not delete)

	DECLARE Var=$M1 Type=String
	Declare Var=$M2 Type=String
	Declare Var=$M3 Type=String
	Declare Var=$M4 Type=String
	Declare Var=$M5 Type=String
	Declare Var=$M6 Type=String
	Declare Var=$M7 Type=String
	Declare Var=$M8 Type=String
	Declare Var=$M9 Type=String
	Declare Var=$M10 Type=String
	Declare Var=$M11 Type=String
	Declare Var=$M12 Type=String
	Declare Var=$M13 Type=String
	Declare Var=$M14 Type=String
	Declare Var=$M15 Type=String
	Declare Var=$M16 Type=String
	Declare Var=$M17 Type=String
	Declare Var=$M18 Type=String
	Declare Var=$M19 Type=String
	Declare Var=$M20 Type=String
	Declare Var=$M21 Type=String
	Declare Var=$M22 Type=String
	Declare Var=$M23 Type=String
	Declare Var=$M24 Type=String
	Declare Var=$M25 Type=String
	Declare Var=$M26 Type=String
	Declare Var=$M27 Type=String
	Declare Var=$M28 Type=String
	Declare Var=$M29 Type=String
	Declare Var=$M30 Type=String
	Declare Var=$M31 Type=String
	Declare Var=$M32 Type=String
	Declare Var=$M33 Type=String

	DECLARE Var=$E1 Type=Boolean
	Declare Var=$E2 Type=Boolean
	Declare Var=$E3 Type=Boolean
	Declare Var=$E4 Type=Boolean
	Declare Var=$E5 Type=Boolean
	Declare Var=$E6 Type=Boolean
	Declare Var=$E7 Type=Boolean
	Declare Var=$E8 Type=Boolean
	Declare Var=$E9 Type=Boolean
	Declare Var=$E10 Type=Boolean
	Declare Var=$E11 Type=Boolean
	Declare Var=$E12 Type=Boolean
	Declare Var=$E13 Type=Boolean
	Declare Var=$E14 Type=Boolean
	Declare Var=$E15 Type=Boolean
	Declare Var=$E16 Type=Boolean
	Declare Var=$E17 Type=Boolean
	Declare Var=$E18 Type=Boolean
	Declare Var=$E19 Type=Boolean
	Declare Var=$E20 Type=Boolean
	Declare Var=$E21 Type=Boolean
	Declare Var=$E22 Type=Boolean
	Declare Var=$E23 Type=Boolean
	Declare Var=$E24 Type=Boolean
	Declare Var=$E25 Type=Boolean
	Declare Var=$E26 Type=Boolean
	Declare Var=$E27 Type=Boolean
	Declare Var=$E28 Type=Boolean
	Declare Var=$E29 Type=Boolean
	Declare Var=$E30 Type=Boolean
	Declare Var=$E31 Type=Boolean
	Declare Var=$E32 Type=Boolean
	Declare Var=$E33 Type=Boolean

	DECLARE Var=$U1 Type=Boolean
	Declare Var=$U2 Type=Boolean
	Declare Var=$U3 Type=Boolean
	Declare Var=$U4 Type=Boolean
	Declare Var=$U5 Type=Boolean
	Declare Var=$U6 Type=Boolean
	Declare Var=$U7 Type=Boolean
	Declare Var=$U8 Type=Boolean
	Declare Var=$U9 Type=Boolean
	Declare Var=$U10 Type=Boolean
	Declare Var=$U11 Type=Boolean
	Declare Var=$U12 Type=Boolean
	Declare Var=$U13 Type=Boolean
	Declare Var=$U14 Type=Boolean
	Declare Var=$U15 Type=Boolean
	Declare Var=$U16 Type=Boolean
	Declare Var=$U17 Type=Boolean
	Declare Var=$U18 Type=Boolean
	Declare Var=$U19 Type=Boolean
	Declare Var=$U20 Type=Boolean
	Declare Var=$U21 Type=Boolean
	Declare Var=$U22 Type=Boolean
	Declare Var=$U23 Type=Boolean
	Declare Var=$U24 Type=Boolean
	Declare Var=$U25 Type=Boolean
	DECLARE Var=$U26 Type=Boolean
	Declare Var=$U27 Type=Boolean
	Declare Var=$U28 Type=Boolean
	Declare Var=$U29 Type=Boolean
	Declare Var=$U30 Type=Boolean
	Declare Var=$U31 Type=Boolean
	Declare Var=$U32 Type=Boolean
	Declare Var=$U33 Type=Boolean

	DECLARE Var=$D1 Type=Boolean
	Declare Var=$D2 Type=Boolean
	Declare Var=$D3 Type=Boolean
	Declare Var=$D4 Type=Boolean
	Declare Var=$D5 Type=Boolean
	Declare Var=$D6 Type=Boolean
	Declare Var=$D7 Type=Boolean
	Declare Var=$D8 Type=Boolean
	Declare Var=$D9 Type=Boolean
	Declare Var=$D10 Type=Boolean
	Declare Var=$D11 Type=Boolean
	Declare Var=$D12 Type=Boolean
	Declare Var=$D13 Type=Boolean
	Declare Var=$D14 Type=Boolean
	Declare Var=$D15 Type=Boolean
	Declare Var=$D16 Type=Boolean
	Declare Var=$D17 Type=Boolean
	Declare Var=$D18 Type=Boolean
	Declare Var=$D19 Type=Boolean
	Declare Var=$D20 Type=Boolean
	Declare Var=$D21 Type=Boolean
	Declare Var=$D22 Type=Boolean
	Declare Var=$D23 Type=Boolean
	Declare Var=$D24 Type=Boolean
	Declare Var=$D25 Type=Boolean
	Declare Var=$D25 Type=Boolean
	DECLARE Var=$D26 Type=Boolean
	Declare Var=$D27 Type=Boolean
	Declare Var=$D28 Type=Boolean
	Declare Var=$D29 Type=Boolean
	Declare Var=$D30 Type=Boolean
	Declare Var=$D31 Type=Boolean
	Declare Var=$D32 Type=Boolean
	Declare Var=$D33 Type=Boolean

	# End of sections form variables

ENDSUB

BEGINSUB name=DeclareVariables

	#*******************************************************
	#   Variable declarations for
	#   C:\Program Files\GSAK\Macros\FindStatGen35Beta.gsk
	#
	#   Generated 2/10/2009 7:14:22 PM on GSAKVariables.gsk Rev V0.30
	#
	#*******************************************************

	Option Explicit=Yes

	Declare Var=$AbbTypes Type=String
	Declare Var=$Adopted Type=String
	Declare Var=$AgeInDays Type=Numeric
	Declare Var=$AgeInMonths Type=Numeric
	Declare Var=$AllStates Type=String
	Declare Var=$Australia Type=String
	Declare Var=$australiatotal Type=Numeric
	Declare Var=$AutomaticIntervals Type=Boolean
	Declare Var=$AutomaticIntervalsText Type=String
	Declare Var=$AutoRun Type=Boolean
	Declare Var=$AvgDaysPerLog Type=Numeric
	Declare Var=$axis Type=Numeric
	Declare Var=$Bands Type=String
	Declare Var=$Base Type=Numeric
	Declare Var=$BatFile Type=String
	Declare Var=$Before Type=Boolean
	Declare Var=$begBlue Type=Numeric
	Declare Var=$begGreen Type=Numeric
	Declare Var=$BeginColor Type=String
	Declare Var=$begRed Type=Numeric
	Declare Var=$BenchmarkFinds Type=Numeric
	Declare Var=$best Type=Numeric
	Declare Var=$BestInYear Type=Numeric
	Declare Var=$BestPlacedInYear Type=Numeric
	Declare Var=$bestMonday Type=Date
	Declare Var=$bestSaturday Type=Date
	Declare Var=$bestSunday Type=Date
	Declare Var=$BestYear Type=Numeric
	Declare Var=$blue Type=Numeric
	Declare Var=$blueChange Type=Numeric
	Declare Var=$bluehex Type=String
	Declare Var=$Bold Type=String
	Declare Var=$boldoff Type=String
	Declare Var=$Break Type=String
	Declare Var=$c_d Type=Numeric
	Declare Var=$C_Exclude Type=String
	Declare Var=$C_FoundDate Type=Date
	Declare Var=$C_PlacedDate Type=Date
	Declare Var=$c_q Type=Numeric
	Declare Var=$c_r Type=Numeric
	Declare Var=$c_s Type=String
	Declare Var=$c_x Type=String
	Declare Var=$c_y Type=String
	Declare Var=$CacheCode Type=String
	Declare Var=$CacheDif Type=String
	Declare Var=$CacheName Type=String
	Declare Var=$CacheStatus Type=String
	Declare Var=$CacheTer Type=String
	Declare Var=$CacheType Type=String
	Declare Var=$CacheTypeFull Type=String
	DECLARE Var=$CacheURL Type=String
	Declare Var=$Caching100 Type=Numeric
	Declare Var=$Caching1000 Type=Numeric
	Declare Var=$Caching1000C Type=Numeric
	Declare Var=$Caching100C Type=Numeric
	Declare Var=$Caching500 Type=Numeric
	Declare Var=$Caching500C Type=Numeric
	Declare Var=$CachingDays Type=Numeric
	Declare Var=$canadatotal Type=Numeric
	Declare Var=$caption Type=String
	Declare Var=$cellstyle Type=String
	Declare Var=$cellwidth Type=Numeric
	Declare Var=$Center Type=Boolean
	Declare Var=$CenterText Type=String
	DECLARE Var=$Closest Type=Numeric
	Declare Var=$ClosestText Type=String
	Declare Var=$Code Type=String
	Declare Var=$Codefield Type=String
	Declare Var=$color Type=String
	Declare Var=$colors Type=String
	Declare Var=$color1 Type=String
	Declare Var=$color10 Type=String
	Declare Var=$color2 Type=String
	Declare Var=$color3 Type=String
	Declare Var=$color4 Type=String
	Declare Var=$color5 Type=String
	Declare Var=$color6 Type=String
	Declare Var=$color7 Type=String
	Declare Var=$color8 Type=String
	Declare Var=$color9 Type=String
	Declare Var=$ColorStates Type=String
	Declare Var=$colspan Type=Numeric
	Declare Var=$column Type=Numeric
	Declare Var=$CompareState Type=String
	Declare Var=$ConsecFinds Type=Numeric
	Declare Var=$ConsecNoFinds Type=Numeric
	Declare Var=$Cont Type=String
	Declare Var=$Conversion Type=Numeric
	Declare Var=$CoordFormat Type=String
	Declare Var=$Count Type=Numeric
	Declare Var=$countbackwards Type=Boolean
	Declare Var=$counter Type=Numeric
	Declare Var=$CountiesSQlFile Type=String
	Declare Var=$CountyUpdateOK Type=Boolean
	Declare Var=$Country Type=String
	Declare Var=$CountryLocalName Type=String
	Declare Var=$Countrytotal Type=Numeric
	Declare Var=$countyCnt Type=String
	Declare Var=$countyName Type=String
	Declare Var=$CR Type=String
	Declare Var=$Cumulative Type=Boolean
	Declare Var=$CumulativeText Type=String
	Declare Var=$currentdb Type=String
	Declare Var=$CurrentPosition Type=Numeric
	Declare Var=$Cutoff Type=Numeric
	Declare Var=$da1 Type=String
	Declare Var=$da2 Type=String
	Declare Var=$Data Type=String
	Declare Var=$DataFile Type=String
	Declare Var=$datafilepath Type=String
	Declare Var=$Date Type=String
	Declare Var=$Date100 Type=String
	Declare Var=$Date1000 Type=String
	Declare Var=$Date500 Type=String
	Declare Var=$DateFirstFind Type=Date
	Declare Var=$day Type=Numeric
	Declare Var=$dayname Type=String
	Declare Var=$daynum Type=Numeric
	Declare Var=$Days Type=String
	Declare Var=$dayscached Type=Numeric
	Declare Var=$daysdiff Type=String
	Declare Var=$dayshort Type=String
	Declare Var=$DaysInYear Type=Numeric
	Declare Var=$DB Type=String
	Declare Var=$DBS Type=String
	Declare Var=$dblist Type=String
	Declare Var=$dec Type=Numeric
	Declare Var=$DefaultMenuFile Type=String
	Declare Var=$DefaultSingleMenuFile Type=String
	Declare Var=$DefaultNames Type=String
	Declare Var=$DefaultSectionOrder Type=String
	Declare Var=$delta Type=Numeric
	Declare Var=$dif Type=String
	Declare Var=$diff Type=Numeric
	Declare Var=$difficulty Type=Numeric
	Declare Var=$diffterr Type=String
	Declare Var=$DirList Type=String
	Declare Var=$DirListMap Type=String
	Declare Var=$Distance Type=String
	Declare Var=$DistanceRounded Type=String
	Declare Var=$distunits Type=String
	Declare Var=$ecc Type=Numeric
	Declare Var=$editcode Type=String
	Declare Var=$EditMapString Type=String
	Declare Var=$elevation Type=Numeric
	Declare Var=$ElevationIntervals Type=String
	Declare Var=$ElevationLimit Type=String
	Declare Var=$enabled Type=String
	Declare Var=$encodingString Type=String
	Declare Var=$endBlue Type=Numeric
	Declare Var=$EndColor Type=String
	Declare Var=$Enddate Type=Date
	Declare Var=$endGreen Type=Numeric
	Declare Var=$EndMonth Type=Numeric
	Declare Var=$endRed Type=Numeric
	Declare Var=$endtime Type=String
	Declare Var=$Error Type=String
	Declare Var=$errvalue Type=Numeric
	Declare Var=$Europe Type=String
	Declare Var=$EuropeCountries Type=String
	Declare Var=$EuropeFlag Type=Boolean
	Declare Var=$europetotal Type=Numeric
	Declare Var=$ExcludeLocationless Type=Boolean
	Declare Var=$ExcludeLocationlessText Type=String
	Declare Var=$ExternalSettings Type=Numeric
	Declare Var=$ExternalRunDate Type=String
	Declare Var=$ExternalStartDate Type=String
	Declare Var=$f100from Type=Date
	Declare Var=$f100to Type=Date
	Declare Var=$fastest100 Type=Numeric
	Declare Var=$file Type=String
	Declare Var=$FileMask Type=String
	Declare Var=$FileName Type=String
	Declare Var=$FileRevision Type=String
	Declare Var=$FindDate Type=String
	Declare Var=$FindEnd Type=Date
	Declare Var=$Finders Type=String
	Declare Var=$Finds Type=String
	Declare Var=$FindStart Type=Date
	Declare Var=$findstatsgenhelp Type=String
	Declare Var=$FindsWithDuplicates Type=Numeric
	Declare Var=$firstdate Type=Date
	Declare Var=$FirstHideFoundDate Type=Date
	DECLARE Var=$FirstYear Type=Numeric
	Declare Var=$fiSec Type=Numeric
	Declare Var=$FlagIcons Type=Boolean
	Declare Var=$FlagIconsText Type=String
	Declare Var=$Folder Type=String
	Declare Var=$Form Type=String
	Declare Var=$Form2 Type=String
	Declare Var=$Form3 Type=String
	Declare Var=$Form4 Type=String
	Declare Var=$Form5 Type=String
	Declare Var=$Form6 Type=String
	Declare Var=$Form7 Type=String
	Declare Var=$Form8 Type=String
	Declare Var=$Form9 Type=String
	Declare Var=$Form10 Type=String
	Declare Var=$Form11 Type=String
	Declare Var=$Form12 Type=String
	Declare Var=$Form13 Type=String
	Declare Var=$Form14 Type=String
	Declare Var=$Form15 Type=String
	Declare Var=$Form16 Type=String
	Declare Var=$Form17 Type=String
	Declare Var=$Form18 Type=String
	Declare Var=$Form19 Type=String
	Declare Var=$Form20 Type=String
	Declare Var=$Form21 Type=String
	DECLARE Var=$formitem Type=String
	Declare Var=$formMaps Type=String
	Declare Var=$formmilestones Type=String
	Declare Var=$formNumbers Type=String
	Declare Var=$FormOptions Type=String
	Declare Var=$formPlaced Type=String
	Declare Var=$FormRun Type=String
	Declare Var=$formSections Type=String
	Declare Var=$formspecial Type=String
	Declare Var=$formUpdate Type=String
	DECLARE Var=$FTF Type=String
	Declare Var=$ftfsep Type=Numeric
	Declare Var=$ftfsepAbs Type=Numeric
	Declare Var=$ftfseptext Type=String
	Declare Var=$FullName Type=String
	Declare Var=$FullTypes Type=String
	Declare Var=$GCID Type=String
	Declare Var=$GCIDPrefix Type=String
	Declare Var=$GCIDs Type=String
	Declare Var=$GCIDSuffix Type=String
	Declare Var=$GetMilestone Type=String
	Declare Var=$GetSpecial Type=String
	Declare Var=$Goal100 Type=Numeric
	Declare Var=$Goal1000 Type=Numeric
	Declare Var=$Goal500 Type=Numeric
	Declare Var=$green Type=Numeric
	Declare Var=$greenChange Type=Numeric
	Declare Var=$greenhex Type=String
	Declare Var=$greyed Type=String
	Declare Var=$GSAKProv Type=String
	Declare Var=$halfformitem Type=String
	Declare Var=$headerwidth Type=Numeric
	Declare Var=$heatcolor Type=String
	Declare Var=$heatmax Type=Numeric
	Declare Var=$heatnum Type=Numeric
	Declare Var=$heatstyle Type=String
	Declare Var=$heatx Type=Numeric
	Declare Var=$heaty Type=Numeric
	Declare Var=$height Type=Numeric
	Declare Var=$hex Type=String
	Declare Var=$hexlookup Type=String
	Declare Var=$Hidden Type=Numeric
	Declare Var=$Hides Type=String
	Declare Var=$home Type=String
	Declare Var=$homememo Type=String
	Declare Var=$HTDSUBcounter Type=Numeric
	Declare Var=$HTDSUBhexcodes Type=String
	Declare Var=$HTDSUBnumDigits Type=Numeric
	Declare Var=$htmlfilepath Type=String
	Declare Var=$HTMLFooter Type=String
	Declare Var=$HTMLHeader Type=String
	Declare Var=$i Type=Numeric
	Declare Var=$ID Type=String
	Declare Var=$image Type=String
	Declare Var=$ImageBH Type=String
	Declare Var=$ImageBV Type=String
	Declare Var=$ImageGH Type=String
	Declare Var=$ImageGV Type=String
	Declare Var=$imagepath Type=String
	Declare Var=$ImagePathAus Type=String
	Declare Var=$ImagePathCountry Type=String
	Declare Var=$ImagePathEurope Type=String
	Declare Var=$imagepathlocal Type=Boolean
	Declare Var=$imagepathremote Type=Boolean
	Declare Var=$ImageRH Type=String
	Declare Var=$ImageRV Type=String
	Declare Var=$ImageURL Type=String
	Declare Var=$ImageYH Type=String
	Declare Var=$ImageYV Type=String
	Declare Var=$IncludeOwn Type=Boolean
	Declare Var=$IncludeOwnText Type=String
	Declare Var=$incptr Type=Numeric
	Declare Var=$index Type=Numeric
	Declare Var=$indexd Type=Numeric
	Declare Var=$indexstring Type=String
	Declare Var=$indext Type=Numeric
	Declare Var=$InMilestones Type=Boolean
	Declare Var=$Internal Type=Boolean
	Declare Var=$j Type=Numeric
	Declare Var=$k Type=Numeric
	Declare Var=$Karma Type=String
	Declare Var=$key Type=Numeric
	Declare Var=$Label Type=String
	Declare Var=$Lang01 Type=String
	Declare Var=$Lang01a Type=String
	Declare Var=$Lang02 Type=String
	Declare Var=$Lang03 Type=String
	Declare Var=$Lang04 Type=String
	Declare Var=$Lang05 Type=String
	Declare Var=$Lang06 Type=String
	Declare Var=$Lang07 Type=String
	Declare Var=$Lang08 Type=String
	Declare Var=$Lang09 Type=String
	Declare Var=$Lang10 Type=String
	Declare Var=$Lang100 Type=String
	Declare Var=$Lang101 Type=String
	Declare Var=$Lang102 Type=String
	Declare Var=$Lang103 Type=String
	Declare Var=$Lang104 Type=String
	Declare Var=$Lang104a Type=String
	Declare Var=$Lang105 Type=String
	Declare Var=$Lang106 Type=String
	Declare Var=$Lang107 Type=String
	Declare Var=$Lang108 Type=String
	Declare Var=$Lang109 Type=String
	Declare Var=$Lang11 Type=String
	Declare Var=$Lang110 Type=String
	Declare Var=$Lang111 Type=String
	Declare Var=$Lang112 Type=String
	Declare Var=$Lang113 Type=String
	Declare Var=$Lang114 Type=String
	Declare Var=$Lang115 Type=String
	Declare Var=$Lang116 Type=String
	Declare Var=$Lang117 Type=String
	Declare Var=$Lang118 Type=String
	Declare Var=$Lang119 Type=String
	Declare Var=$Lang11a Type=String
	Declare Var=$Lang12 Type=String
	Declare Var=$Lang120 Type=String
	Declare Var=$Lang121 Type=String
	Declare Var=$Lang122 Type=String
	Declare Var=$Lang123 Type=String
	Declare Var=$Lang124 Type=String
	Declare Var=$Lang125 Type=String
	Declare Var=$Lang126 Type=String
	Declare Var=$Lang127 Type=String
	Declare Var=$Lang128 Type=String
	Declare Var=$Lang129 Type=String
	Declare Var=$Lang13 Type=String
	Declare Var=$Lang130 Type=String
	Declare Var=$Lang131 Type=String
	Declare Var=$Lang132 Type=String
	Declare Var=$Lang133 Type=String
	Declare Var=$Lang134 Type=String
	Declare Var=$Lang135 Type=String
	Declare Var=$Lang136 Type=String
	Declare Var=$Lang137 Type=String
	Declare Var=$Lang138 Type=String
	Declare Var=$Lang139 Type=String
	Declare Var=$Lang14 Type=String
	Declare Var=$Lang140 Type=String
	Declare Var=$Lang141 Type=String
	Declare Var=$Lang142 Type=String
	Declare Var=$Lang143 Type=String
	Declare Var=$Lang144 Type=String
	Declare Var=$Lang145 Type=String
	Declare Var=$Lang146a Type=String
	Declare Var=$Lang146b Type=String
	Declare Var=$Lang147 Type=String
	Declare Var=$Lang148 Type=String
	Declare Var=$Lang149 Type=String
	Declare Var=$Lang15 Type=String
	Declare Var=$Lang150 Type=String
	Declare Var=$Lang151 Type=String
	Declare Var=$Lang152 Type=String
	Declare Var=$Lang153 Type=String
	Declare Var=$Lang154 Type=String
	Declare Var=$Lang155 Type=String
	Declare Var=$Lang156 Type=String
	Declare Var=$Lang157 Type=String
	Declare Var=$Lang158 Type=String
	Declare Var=$Lang159 Type=String
	Declare Var=$Lang160 Type=String
	Declare Var=$Lang161 Type=String
	Declare Var=$Lang162 Type=String
	Declare Var=$Lang163 Type=String
	Declare Var=$Lang164 Type=String
	Declare Var=$Lang165 Type=String
	Declare Var=$Lang166 Type=String
	Declare Var=$Lang167 Type=String
	Declare Var=$Lang168 Type=String
	Declare Var=$Lang169 Type=String
	Declare Var=$Lang170 Type=String
	Declare Var=$Lang171 Type=String
	Declare Var=$Lang172 Type=String
	Declare Var=$Lang173 Type=String
	Declare Var=$Lang174 Type=String
	Declare Var=$Lang175 Type=String
	Declare Var=$Lang176 Type=String
	Declare Var=$Lang177 Type=String
	Declare Var=$Lang178 Type=String
	Declare Var=$Lang179 Type=String
	Declare Var=$Lang180 Type=String
	Declare Var=$Lang181 Type=String
	Declare Var=$Lang182 Type=String
	Declare Var=$Lang183 Type=String
	Declare Var=$Lang184 Type=String
	Declare Var=$Lang185 Type=String
	Declare Var=$Lang186 Type=String
	Declare Var=$Lang187 Type=String
	Declare Var=$Lang188 Type=String
	Declare Var=$Lang189 Type=String
	Declare Var=$Lang190 Type=String
	Declare Var=$Lang191 Type=String
	Declare Var=$Lang192 Type=String
	Declare Var=$Lang193 Type=String
	Declare Var=$Lang194 Type=String
	Declare Var=$Lang195 Type=String
	Declare Var=$Lang16 Type=String
	Declare Var=$Lang17 Type=String
	Declare Var=$Lang18 Type=String
	Declare Var=$Lang19 Type=String
	Declare Var=$Lang20 Type=String
	Declare Var=$Lang21 Type=String
	Declare Var=$Lang22 Type=String
	Declare Var=$Lang23 Type=String
	Declare Var=$Lang24 Type=String
	Declare Var=$Lang25 Type=String
	Declare Var=$Lang26 Type=String
	Declare Var=$Lang27 Type=String
	Declare Var=$Lang28 Type=String
	Declare Var=$Lang28a Type=String
	Declare Var=$Lang28b Type=String
	Declare Var=$Lang29 Type=String
	Declare Var=$Lang30 Type=String
	Declare Var=$Lang31 Type=String
	Declare Var=$Lang32 Type=String
	Declare Var=$Lang33 Type=String
	Declare Var=$Lang34 Type=String
	Declare Var=$Lang35 Type=String
	Declare Var=$Lang36a Type=String
	Declare Var=$Lang36b Type=String
	Declare Var=$lang36c Type=String
	Declare Var=$lang36d Type=String
	Declare Var=$Lang37 Type=String
	Declare Var=$Lang38a Type=String
	Declare Var=$Lang38b Type=String
	Declare Var=$Lang39 Type=String
	Declare Var=$Lang40 Type=String
	Declare Var=$Lang41 Type=String
	Declare Var=$Lang42 Type=String
	Declare Var=$Lang42a Type=String
	Declare Var=$Lang43 Type=String
	Declare Var=$Lang44a Type=String
	Declare Var=$Lang44b Type=String
	Declare Var=$Lang45 Type=String
	Declare Var=$Lang46a Type=String
	Declare Var=$Lang46b Type=String
	Declare Var=$Lang47 Type=String
	Declare Var=$Lang48 Type=String
	Declare Var=$Lang49 Type=String
	Declare Var=$Lang50 Type=String
	Declare Var=$Lang51 Type=String
	Declare Var=$Lang52 Type=String
	Declare Var=$Lang53 Type=String
	Declare Var=$Lang54 Type=String
	Declare Var=$Lang55 Type=String
	Declare Var=$Lang56 Type=String
	Declare Var=$Lang57 Type=String
	Declare Var=$Lang58 Type=String
	Declare Var=$Lang59 Type=String
	Declare Var=$Lang60 Type=String
	Declare Var=$Lang61 Type=String
	Declare Var=$Lang62 Type=String
	Declare Var=$Lang63 Type=String
	Declare Var=$Lang64 Type=String
	Declare Var=$Lang65 Type=String
	Declare Var=$Lang66 Type=String
	Declare Var=$Lang67 Type=String
	Declare Var=$Lang68 Type=String
	Declare Var=$Lang69 Type=String
	Declare Var=$Lang70 Type=String
	Declare Var=$Lang71 Type=String
	Declare Var=$Lang72 Type=String
	Declare Var=$Lang73 Type=String
	Declare Var=$Lang74 Type=String
	Declare Var=$Lang75 Type=String
	Declare Var=$Lang76 Type=String
	Declare Var=$Lang77 Type=String
	Declare Var=$Lang78 Type=String
	Declare Var=$Lang79 Type=String
	Declare Var=$Lang80 Type=String
	Declare Var=$Lang81 Type=String
	Declare Var=$Lang82 Type=String
	Declare Var=$Lang83 Type=String
	Declare Var=$Lang84 Type=String
	Declare Var=$Lang85 Type=String
	Declare Var=$Lang86 Type=String
	Declare Var=$Lang87 Type=String
	Declare Var=$Lang88 Type=String
	Declare Var=$Lang89 Type=String
	Declare Var=$Lang90 Type=String
	Declare Var=$Lang91 Type=String
	Declare Var=$Lang92 Type=String
	Declare Var=$Lang93 Type=String
	Declare Var=$Lang94 Type=String
	Declare Var=$Lang95 Type=String
	Declare Var=$Lang96 Type=String
	Declare Var=$Lang97 Type=String
	Declare Var=$Lang98 Type=String
	Declare Var=$Lang99 Type=String
	DECLARE Var=$LangCount Type=Numeric
	Declare Var=$LangFile Type=String
	Declare Var=$LangFileAttribution Type=String
	DECLARE Var=$LangForm01 Type=String
	Declare Var=$LangForm02 Type=String
	Declare Var=$LangForm03 Type=String
	Declare Var=$LangForm04 Type=String
	Declare Var=$LangForm05 Type=String
	Declare Var=$LangForm06 Type=String
	Declare Var=$LangForm07 Type=String
	Declare Var=$LangForm08 Type=String
	Declare Var=$LangForm09 Type=String
	Declare Var=$LangForm10 Type=String
	Declare Var=$LangForm11 Type=String
	Declare Var=$LangForm12 Type=String
	Declare Var=$LangForm13 Type=String
	Declare Var=$LangForm14 Type=String
	Declare Var=$LangForm15 Type=String
	Declare Var=$LangForm16 Type=String
	Declare Var=$LangForm17 Type=String
	Declare Var=$LangForm18 Type=String
	Declare Var=$LangForm19 Type=String
	Declare Var=$LangForm20 Type=String
	Declare Var=$LangForm21 Type=String
	Declare Var=$LangForm22 Type=String
	Declare Var=$LangForm23 Type=String
	Declare Var=$LangForm24 Type=String
	Declare Var=$LangForm25 Type=String
	Declare Var=$LangForm26 Type=String
	Declare Var=$LangForm27 Type=String
	Declare Var=$LangForm28 Type=String
	Declare Var=$LangForm29 Type=String
	Declare Var=$LangForm30 Type=String
	Declare Var=$LangForm31 Type=String
	Declare Var=$LangForm32 Type=String
	Declare Var=$LangForm33 Type=String
	Declare Var=$LangForm34 Type=String
	Declare Var=$LangForm35 Type=String
	Declare Var=$LangForm36 Type=String
	Declare Var=$LangForm37 Type=String
	Declare Var=$LangForm38 Type=String
	Declare Var=$LangForm39 Type=String
	Declare Var=$LangForm40 Type=String
	Declare Var=$LangForm41 Type=String
	Declare Var=$LangForm42 Type=String
	Declare Var=$LangForm43 Type=String
	Declare Var=$LangForm51 Type=String
	Declare Var=$LangForm52 Type=String
	Declare Var=$LangForm53 Type=String
	Declare Var=$LangForm54 Type=String
	Declare Var=$LangForm55 Type=String
	Declare Var=$LangForm56 Type=String
	Declare Var=$LangForm57 Type=String
	Declare Var=$LangForm58 Type=String
	Declare Var=$LangForm59 Type=String
	Declare Var=$LangForm60 Type=String
	Declare Var=$LangForm61 Type=String
	Declare Var=$LangForm62 Type=String
	Declare Var=$LangForm63 Type=String
	Declare Var=$LangForm64 Type=String
	Declare Var=$LangForm65 Type=String
	Declare Var=$LangForm66 Type=String
	Declare Var=$LangForm67 Type=String
	Declare Var=$LangForm68 Type=String
	Declare Var=$LangForm69 Type=String
	Declare Var=$LangForm70 Type=String
	Declare Var=$LangForm71 Type=String
	Declare Var=$LangForm72 Type=String
	Declare Var=$LangForm73 Type=String
	Declare Var=$LangForm74 Type=String
	Declare Var=$LangForm75 Type=String
	Declare Var=$LangForm76 Type=String
	Declare Var=$LangForm77 Type=String
	Declare Var=$LangForm78 Type=String
	Declare Var=$LangForm79 Type=String
	Declare Var=$LangForm80 Type=String
	Declare Var=$LangForm81 Type=String
	Declare Var=$LangForm82 Type=String
	Declare Var=$LangForm83 Type=String
	Declare Var=$LangForm84 Type=String
	Declare Var=$LangForm85 Type=String
	Declare Var=$LangForm86 Type=String
	Declare Var=$LangForm87 Type=String
	Declare Var=$LangForm88 Type=String
	Declare Var=$LangForm89 Type=String
	Declare Var=$LangForm90 Type=String
	Declare Var=$LangForm91 Type=String
	Declare Var=$LangForm92 Type=String
	Declare Var=$LangForm93 Type=String
	Declare Var=$LangForm94 Type=String
	Declare Var=$LangForm95 Type=String
	Declare Var=$LangForm96 Type=String
	Declare Var=$LangForm97 Type=String
	Declare Var=$LangForm98 Type=String
	Declare Var=$LangForm99 Type=String
	Declare Var=$LangForm100 Type=String
	Declare Var=$LangForm101 Type=String
	Declare Var=$LangForm102 Type=String
	Declare Var=$LangForm103 Type=String
	Declare Var=$LangForm104 Type=String
	Declare Var=$LangForm105 Type=String
	Declare Var=$LangForm106 Type=String
	Declare Var=$LangForm107 Type=String
	Declare Var=$LangForm108 Type=String
	Declare Var=$LangList Type=String
	Declare Var=$LangName Type=String
	Declare Var=$LangStatus01 Type=String
	Declare Var=$LangStatus02 Type=String
	Declare Var=$LangStatus03 Type=String
	Declare Var=$LangStatus04 Type=String
	Declare Var=$LangStatus05 Type=String
	Declare Var=$LangStatus06 Type=String
	Declare Var=$LangStatus07 Type=String
	Declare Var=$LangStatus08 Type=String
	Declare Var=$LangStatus09 Type=String
	Declare Var=$LangStatus10 Type=String
	Declare Var=$LangStatus11 Type=String
	Declare Var=$LangStatus12 Type=String
	Declare Var=$LangStatus13 Type=String
	Declare Var=$LangStatus14 Type=String
	Declare Var=$LangStatus15 Type=String
	Declare Var=$LangStatus16 Type=String
	Declare Var=$LangStatus17 Type=String
	Declare Var=$LangStatus18 Type=String
	Declare Var=$LangStatus19 Type=String
	Declare Var=$LangStatus20 Type=String
	Declare Var=$LangStatus21 Type=String
	Declare Var=$LangStatus22a Type=String
	Declare Var=$LangStatus22b Type=String
	Declare Var=$LangStatus23a Type=String
	Declare Var=$LangStatus23b Type=String
	Declare Var=$LangStatus24 Type=String
	Declare Var=$LangStatus25 Type=String
	Declare Var=$LangStatus26 Type=String
	Declare Var=$LangStatus27 Type=String
	Declare Var=$LangStatus28 Type=String
	Declare Var=$LangStatus29a Type=String
	Declare Var=$LangStatus29b Type=String
	Declare Var=$LangStatus30 Type=String
	Declare Var=$LangStatus31 Type=String
	Declare Var=$LangStatus32 Type=String
	Declare Var=$LangStatus33 Type=String
	Declare Var=$LangStatus34 Type=String
	Declare Var=$LangStatus35 Type=String
	Declare Var=$LangStatus36 Type=String
	Declare Var=$LangStatus37 Type=String
	Declare Var=$LangStatus38a Type=String
	Declare Var=$LangStatus38b Type=String
	Declare Var=$LangStatus39a Type=String
	Declare Var=$LangStatus39b Type=String
	Declare Var=$LangStatus40a Type=String
	Declare Var=$LangStatus40b Type=String
	Declare Var=$LangStatus41a Type=String
	Declare Var=$LangStatus41b Type=String
	Declare Var=$LangStatus41c Type=String
	Declare Var=$LangStatus42 Type=String
	Declare Var=$LangStatus43 Type=String
	Declare Var=$LangStatus44 Type=String
	Declare Var=$LangStatus45 Type=String
	Declare Var=$LangStatus46 Type=String
	Declare Var=$LangStatus47 Type=String
	Declare Var=$LangStatus48 Type=String
	Declare Var=$LangStatus49 Type=String
	Declare Var=$LangStatus50 Type=String
	Declare Var=$LangT1 Type=String
	Declare Var=$LangT10 Type=String
	Declare Var=$LangT11 Type=String
	Declare Var=$LangT12 Type=String
	Declare Var=$LangT13 Type=String
	Declare Var=$LangT14 Type=String
	Declare Var=$LangT15 Type=String
	Declare Var=$LangT16 Type=String
	Declare Var=$LangT17 Type=String
	Declare Var=$LangT18 Type=String
	Declare Var=$LangT19 Type=String
	Declare Var=$LangT2 Type=String
	Declare Var=$LangT20 Type=String
	Declare Var=$LangT21 Type=String
	Declare Var=$LangT22 Type=String
	Declare Var=$LangT23 Type=String
	Declare Var=$LangT24 Type=String
	Declare Var=$LangT25 Type=String
	Declare Var=$LangT26 Type=String
	Declare Var=$LangT27 Type=String
	Declare Var=$LangT28 Type=String
	Declare Var=$LangT29 Type=String
	Declare Var=$LangT30 Type=String
	Declare Var=$LangT31 Type=String
	Declare Var=$LangT32 Type=String
	Declare Var=$LangT33 Type=String
	Declare Var=$LangT34 Type=String
	Declare Var=$LangT35 Type=String
	Declare Var=$LangT36 Type=String
	Declare Var=$LangT3 Type=String
	Declare Var=$LangT4 Type=String
	Declare Var=$LangT5 Type=String
	Declare Var=$LangT6 Type=String
	Declare Var=$LangT7 Type=String
	Declare Var=$LangT8 Type=String
	Declare Var=$LangT9 Type=String
	Declare Var=$Language Type=String
	Declare Var=$LanguageFile Type=String
	Declare Var=$last Type=Numeric
	Declare Var=$last_lat Type=String
	Declare Var=$last_lon Type=String
	Declare Var=$lastcolspan Type=Numeric
	Declare Var=$lastdate Type=Date
	Declare Var=$LastFindDate Type=Date
	Declare Var=$lasthalf Type=Boolean
	Declare Var=$laststate Type=String
	Declare Var=$Latitude Type=String
	Declare Var=$LatitudeN Type=Numeric
	Declare Var=$Left Type=String
	Declare Var=$leftedge Type=Numeric
	Declare Var=$legendTable Type=String
	Declare Var=$limit1 Type=String
	Declare Var=$limit2 Type=String
	Declare Var=$limit3 Type=String
	Declare Var=$limit4 Type=String
	Declare Var=$limit5 Type=String
	Declare Var=$limit6 Type=String
	Declare Var=$limit7 Type=String
	Declare Var=$limit8 Type=String
	Declare Var=$limit9 Type=String
	DECLARE Var=$line Type=String
	Declare Var=$LineFeed Type=String
	Declare Var=$list Type=String
	Declare Var=$listedowners Type=Numeric
	Declare Var=$ListStates Type=String
	Declare Var=$Locationless Type=String
	Declare Var=$loclist Type=String
	Declare Var=$Log Type=String
	Declare Var=$LogAverage Type=Numeric
	Declare Var=$LogDateDate Type=Date
	Declare Var=$Logid Type=Numeric
	Declare Var=$LogidSubstitute Type=Numeric
	Declare Var=$LogList Type=String
	Declare Var=$LogMax Type=Numeric
	Declare Var=$LogMin Type=Numeric
	Declare Var=$LogRecord Type=Numeric
	Declare Var=$LogTotal Type=Numeric
	Declare Var=$Longitude Type=String
	Declare Var=$LongitudeN Type=Numeric
	Declare Var=$lowBreak Type=String
	Declare Var=$Map Type=String
	Declare Var=$MapCol1 Type=String
	Declare Var=$MapCol2 Type=String
	Declare Var=$MapCol3 Type=String
	Declare Var=$MapCol4 Type=String
	Declare Var=$MapCount Type=Numeric
	Declare Var=$MapIDCount Type=Numeric
	Declare Var=$MapDataFile Type=String
	Declare Var=$MapDataSource Type=String
	DECLARE Var=$MapFile Type=String
	Declare Var=$MapGif Type=String
	Declare Var=$MapList Type=String
	Declare Var=$MapMasterList Type=String
	Declare Var=$MapName Type=String
	Declare Var=$MapString Type=String
	Declare Var=$MapStringText Type=String
	Declare Var=$MasterFile Type=Boolean
	DECLARE Var=$max Type=Numeric
	Declare Var=$maxdif Type=Numeric
	Declare Var=$maxdiffterr Type=Numeric
	Declare Var=$maxcellF Type=Numeric
	Declare Var=$numcombF Type=Numeric
	DECLARE Var=$MaxDistance Type=Numeric
	Declare Var=$MaxInMonth Type=Numeric
	Declare Var=$MaxInThisMonth Type=Numeric
	Declare Var=$maxitem Type=Numeric
	Declare Var=$MaxKarma Type=Numeric
	Declare Var=$maxnum Type=Numeric
	Declare Var=$maxtablewidth Type=Numeric
	Declare Var=$maxterr Type=Numeric
	Declare Var=$maxwidth Type=Numeric
	Declare Var=$memo1 Type=String
	Declare Var=$memo2 Type=String
	Declare Var=$MenuForm Type=String
	Declare Var=$milestone Type=Numeric
	Declare Var=$milestoneText Type=String
	Declare Var=$MileTotal Type=Numeric
	Declare Var=$MileTypes Type=Boolean
	Declare Var=$MileTypesText Type=String
	Declare Var=$min Type=Numeric
	Declare Var=$mins Type=Numeric
	Declare Var=$MissingMemo Type=String
	Declare Var=$Month Type=Numeric
	Declare Var=$MonthDay Type=String
	Declare Var=$MonthNumber Type=Numeric
	Declare Var=$MostInADay Type=Numeric
	Declare Var=$MostInADayDate Type=Date
	Declare Var=$MostInMonth Type=Numeric
	Declare Var=$MostInthisMonth Type=Numeric
	Declare Var=$MostRecentFind Type=Date
	Declare Var=$msg Type=String
	Declare Var=$MultiList Type=String
	Declare Var=$MyId Type=Numeric
	Declare Var=$name Type=String
	Declare Var=$Names Type=String
	Declare Var=$Namefield Type=String
	Declare Var=$NameStates Type=String
	Declare Var=$NewVersion Type=Boolean
	DECLARE Var=$NewSectionIDs Type=String
	DECLARE Var=$NewSectionWidths Type=String
	DECLARE Var=$NewCount Type=Numeric
	DECLARE Var=$NoFindEnd Type=Date
	Declare Var=$NoFindStart Type=Date
	Declare Var=$note Type=String
	Declare Var=$Notes Type=String
	Declare Var=$Notes1 Type=String
	Declare Var=$Notes2 Type=String
	Declare Var=$Notes3 Type=String
	Declare Var=$Notes4 Type=String
	Declare Var=$NotesB Type=String
	Declare Var=$Notes1B Type=String
	Declare Var=$Notes2B Type=String
	Declare Var=$Notes3B Type=String
	Declare Var=$Notes4B Type=String
	Declare Var=$NotesC Type=String
	Declare Var=$Notes1C Type=String
	Declare Var=$Notes2C Type=String
	Declare Var=$Notes3C Type=String
	Declare Var=$Notes4C Type=String
	Declare Var=$NotesForm Type=String
	Declare Var=$NotesOld Type=String
	Declare Var=$NotesOldB Type=String
	Declare Var=$NotesOldC Type=String
	Declare Var=$NState Type=Numeric
	Declare Var=$num Type=Numeric
	Declare Var=$numArchived Type=Boolean
	Declare Var=$NumbersOld Type=String
	Declare Var=$numbertext Type=String
	Declare Var=$numCentroid Type=Boolean
	Declare Var=$numClosest Type=Boolean
	Declare Var=$numConsecutive Type=Boolean
	Declare Var=$numDistance Type=Boolean
	Declare Var=$numExtremes Type=Boolean
	Declare Var=$numfast Type=Numeric
	Declare Var=$numFastest Type=Boolean
	Declare Var=$numFTF Type=Boolean
	Declare Var=$NumInternal Type=Numeric
	Declare Var=$NumItems Type=Numeric
	Declare Var=$numLogs Type=Boolean
	Declare Var=$numOldest Type=Boolean
	Declare Var=$numPeriods Type=Boolean
	Declare Var=$NumPlaced Type=Numeric
	Declare Var=$NumPlacedText Type=String
	Declare Var=$NumPlacedTextOld Type=String
	DECLARE Var=$numTotals Type=Boolean
	Declare Var=$offset Type=Numeric
	Declare Var=$OK Type=Boolean
	Declare Var=$out Type=String
	Declare Var=$OwnerID Type=String
	Declare Var=$OwnerName Type=String
	DECLARE Var=$p_FSGData Type=String
	Declare Var=$pc Type=Numeric
	Declare Var=$pc2 Type=Numeric
	Declare Var=$pc3 Type=Numeric
	Declare Var=$PCurrentDB Type=String
	Declare Var=$PCurrentFilter Type=String
	Declare Var=$PCurrentSort Type=String
	Declare Var=$percent Type=String
	Declare Var=$perdayC Type=String
	Declare Var=$perdayO Type=String
	Declare Var=$permonth Type=String
	Declare Var=$perweek Type=String
	Declare Var=$pi Type=Numeric
	Declare Var=$PieCharts Type=Boolean
	Declare Var=$PieChartsText Type=String
	Declare Var=$Placed Type=Boolean
	Declare Var=$PlacedDatabase Type=String
	Declare Var=$PlacedDate Type=String
	Declare Var=$placedFinders Type=Boolean
	Declare Var=$placedList Type=Boolean
	Declare Var=$PlacedOld Type=String
	Declare Var=$PlacedSections Type=String
	Declare Var=$PlacedSort Type=Boolean
	Declare Var=$PlacedSortText Type=String
	Declare Var=$placedTotals Type=Boolean
	Declare Var=$placedcharts Type=Boolean
	Declare Var=$PlugInBefore Type=String
	Declare Var=$PlugInBeforeOld Type=String
	Declare Var=$PlugInAfter Type=String
	Declare Var=$PlugInAfterOld Type=String
	Declare Var=$PlugInNotes Type=String
	Declare Var=$polygons Type=String
	Declare Var=$Position Type=Numeric
	Declare Var=$postdata Type=String
	Declare Var=$preamble Type=String
	Declare Var=$PreviousCountyName Type=String
	Declare Var=$provinces Type=String
	Declare Var=$PTotalFinds Type=Numeric
	Declare Var=$rating Type=Numeric
	Declare Var=$rawloclist Type=String
	Declare Var=$red Type=Numeric
	Declare Var=$redChange Type=Numeric
	Declare Var=$redhex Type=String
	Declare Var=$RedSeed Type=String
	Declare Var=$BlueSeed Type=String
	Declare Var=$GreenSeed Type=String
	Declare Var=$RegionName Type=String
	Declare Var=$RegionNamePlural Type=String
	Declare Var=$Reset Type=Boolean
	Declare Var=$ResetDefaults Type=Boolean
	Declare Var=$resolution Type=String
	Declare Var=$result Type=String
	Declare Var=$result2 Type=String
	Declare Var=$result3 Type=String
	Declare Var=$Revision Type=String
	Declare Var=$row Type=Numeric
	Declare Var=$rowcount Type=Numeric
	Declare Var=$rows Type=Numeric
	Declare Var=$RunDate Type=Date
	Declare Var=$SQLStart Type=String
	DECLARE Var=$StartDate Type=Date
	Declare Var=$RunMapCount Type=Numeric
	Declare Var=$RunningSectionCount Type=Numeric
	Declare Var=$s Type=String
	Declare Var=$Savecode Type=String
	Declare Var=$Savedcode Type=String
	Declare Var=$Savedcenter Type=String
	Declare Var=$SavedFilter Type=String
	Declare Var=$SavedSort Type=String
	Declare Var=$SavedSortOriginal Type=String
	Declare Var=$SCol Type=String
	Declare Var=$SearchState Type=String
	Declare Var=$secs Type=Numeric
	Declare Var=$SectionCount Type=Numeric
	Declare Var=$SectionList Type=String
	Declare Var=$SectionOrder Type=String
	Declare Var=$SectionTemp Type=String
	Declare Var=$Seed Type=String
	Declare Var=$Sequence Type=String
	Declare Var=$Settings Type=Numeric
	Declare Var=$Settings1 Type=String
	Declare Var=$Settings2 Type=String
	Declare Var=$Settings3 Type=String
	Declare Var=$Settings4 Type=String
	Declare Var=$SettingsPrevious Type=Numeric
	Declare Var=$shades Type=String
	Declare Var=$ShowDiffTerrChart Type=Boolean
	Declare Var=$ShowDiffTerrChartText Type=String
	Declare Var=$ShowElevationChart Type=Boolean
	Declare Var=$ShowElevationChartText Type=String
	Declare Var=$ShowTitle Type=Boolean
	DECLARE Var=$ShrunkName Type=String
	Declare Var=$ShrunkOwnerName Type=String
	Declare Var=$Skipflag Type=Boolean
	Declare Var=$Snum Type=Numeric
	Declare Var=$SomeNumbers Type=String
	Declare Var=$SortByLogsRun Type=Boolean
	Declare Var=$SORTData Type=String
	Declare Var=$Sorted Type=String
	Declare Var=$spaces Type=String
	Declare Var=$specialcode Type=String
	Declare Var=$specialdescription Type=String
	Declare Var=$specialmemo Type=String
	Declare Var=$SpecialTotal Type=Numeric
	Declare Var=$specialtype Type=String
	Declare Var=$Sprefix Type=String
	Declare Var=$sql Type=String
	Declare Var=$sqldate Type=String
	Declare Var=$sqlfile Type=String
	Declare Var=$sqlinputfile Type=String
	Declare Var=$Srun Type=String
	Declare Var=$st2c1 Type=String
	Declare Var=$st2c2 Type=String
	Declare Var=$st2cHi1 Type=String
	Declare Var=$st2cHi2 Type=String
	Declare Var=$Stag Type=String
	Declare Var=$StartAuto Type=Boolean
	Declare Var=$StartAutoText Type=String
	Declare Var=$StartOK Type=Boolean
	Declare Var=$StartOptions Type=Boolean
	Declare Var=$starttime Type=String
	Declare Var=$State Type=String
	Declare Var=$StateAbbreviation Type=String
	Declare Var=$StateChosen Type=String
	Declare Var=$StateColor Type=String
	Declare Var=$StateList Type=String
	Declare Var=$StateLocalName Type=String
	Declare Var=$StateName Type=String
	Declare Var=$StateNum Type=Numeric
	Declare Var=$states Type=String
	Declare Var=$status Type=String
	Declare Var=$stBlueBar Type=String
	Declare Var=$stDiffTerr Type=String
	Declare Var=$stDiffTerrhi Type=String
	Declare Var=$stGreenBar Type=String
	Declare Var=$stMainDiv Type=String
	Declare Var=$stOwners3 Type=String
	Declare Var=$stRankRow Type=String
	Declare Var=$stRankTit Type=String
	Declare Var=$stRedBar Type=String
	Declare Var=$stripcode Type=String
	Declare Var=$stSec Type=Numeric
	Declare Var=$stSectHead Type=String
	Declare Var=$stSmall Type=String
	Declare Var=$stTab2cHead Type=String
	Declare Var=$stTabActive Type=String
	Declare Var=$stTabInactive Type=String
	Declare Var=$stTitle Type=String
	Declare Var=$stYearDataInf Type=String
	Declare Var=$stYearDataTab Type=String
	Declare Var=$stYearDataTit Type=String
	Declare Var=$stYearGrphRow Type=String
	Declare Var=$stYearTop Type=String
	Declare Var=$stYellowBar Type=String
	Declare Var=$style1 Type=String
	Declare Var=$style2 Type=String
	Declare Var=$StyleFile Type=String
	Declare Var=$stylelist Type=String
	Declare Var=$StyleRounded Type=Boolean
	Declare Var=$StyleRoundedText Type=String
	Declare Var=$StyleSet Type=String
	Declare Var=$SuppressZeroes Type=Boolean
	Declare Var=$SuppressZeroesText Type=String
	Declare Var=$TabCount Type=Numeric
	Declare Var=$TabString Type=String
	Declare Var=$TabHeader Type=String
	Declare Var=$TabHtml Type=String
	Declare Var=$TabName Type=String
	DECLARE Var=$tempitem Type=String
	Declare Var=$terr Type=String
	Declare Var=$terrain Type=Numeric
	Declare Var=$TestMode Type=Numeric
	Declare Var=$text Type=String
	Declare Var=$text1 Type=String
	Declare Var=$text10 Type=String
	Declare Var=$text2 Type=String
	Declare Var=$text3 Type=String
	Declare Var=$text4 Type=String
	Declare Var=$text5 Type=String
	Declare Var=$text6 Type=String
	Declare Var=$text7 Type=String
	Declare Var=$text8 Type=String
	Declare Var=$text9 Type=String
	Declare Var=$Theme1 Type=String
	Declare Var=$Theme2 Type=String
	Declare Var=$Theme3 Type=String
	Declare Var=$Theme4 Type=String
	Declare Var=$Theme5 Type=String
	Declare Var=$Theme6 Type=String
	Declare Var=$Theme7 Type=String
	Declare Var=$Theme8 Type=String
	Declare Var=$this Type=Numeric
	Declare Var=$ThisFindDate Type=Date
	Declare Var=$ThisRecord Type=Numeric
	Declare Var=$ThisState Type=String
	Declare Var=$thistype Type=String
	Declare Var=$ThisYear Type=Numeric
	Declare Var=$time Type=Numeric
	Declare Var=$Timeout Type=Boolean
	Declare Var=$TimeTaken Type=String
	Declare Var=$tindexd Type=String
	Declare Var=$Title Type=String
	Declare Var=$TitleB Type=String
	Declare Var=$TitleC Type=String
	Declare Var=$tmp Type=Numeric
	Declare Var=$tmpB Type=Boolean
	Declare Var=$tmpM Type=Numeric
	Declare Var=$tmpMostInADay Type=Numeric
	Declare Var=$tmpN Type=Numeric
	Declare Var=$tmpN1 Type=Numeric
	Declare Var=$Tmps Type=String
	Declare Var=$tmpS1 Type=String
	Declare Var=$tmpStart Type=Date
	Declare Var=$To1 Type=Boolean
	Declare Var=$To2 Type=Boolean
	Declare Var=$To3 Type=Boolean
	Declare Var=$To4 Type=Boolean
	Declare Var=$Today Type=String
	Declare Var=$Top Type=String
	Declare Var=$topedge Type=Numeric
	Declare Var=$TotalByLogs Type=Numeric
	Declare Var=$TotalCount Type=Numeric
	Declare Var=$TotalDays Type=Numeric
	Declare Var=$TotalDaysCached Type=Numeric
	Declare Var=$TotalDistance Type=Numeric
	Declare Var=$TotalFinds Type=Numeric
	Declare Var=$TotalHides Type=Numeric
	Declare Var=$TotalMonths Type=Numeric
	Declare Var=$totalowners Type=Numeric
	Declare Var=$totalpercent Type=Numeric
	Declare Var=$TotList Type=String
	Declare Var=$TotList2 Type=String
	Declare Var=$TypeImage Type=String
	Declare Var=$Typenums Type=String
	Declare Var=$Types Type=String
	Declare Var=$unlistedowners Type=Numeric
	Declare Var=$UpdateCounty Type=Boolean
	Declare Var=$URL Type=String
	Declare Var=$URLtmp Type=String
	Declare Var=$usatotal Type=Numeric
	Declare Var=$UseAster Type=Boolean
	Declare Var=$UseAsterText Type=String
	Declare Var=$UseCurrentSort Type=Boolean
	Declare Var=$UseCurrentSortText Type=String
	Declare Var=$UseHeatBars Type=Boolean
	Declare Var=$UseHeatBarsText Type=String
	Declare Var=$UseHeatMap Type=Boolean
	Declare Var=$UseHeatMapText Type=String
	Declare Var=$UseImageBars Type=Boolean
	Declare Var=$UseImageBarsText Type=String
	Declare Var=$UseLegacyMaps Type=Boolean
	Declare Var=$UseLegacyMapsText Type=String
	Declare Var=$UseMasterFile Type=Boolean
	Declare Var=$UseOverlay Type=Boolean
	Declare Var=$UsePageBackground Type=Boolean
	DECLARE Var=$UsePlainBars Type=Boolean
	Declare Var=$user Type=String
	Declare Var=$UserLink Type=String
	Declare Var=$UserSort Type=Numeric
	Declare Var=$UserStyleName Type=String
	Declare Var=$v Type=Numeric
	Declare Var=$variables Type=String
	Declare Var=$WaymarkFinds Type=Numeric
	Declare Var=$Wd66Prov Type=String
	Declare Var=$WhiteMask Type=Numeric
	Declare Var=$BlackMask Type=Numeric
	Declare Var=$width Type=Numeric
	Declare Var=$work Type=String
	Declare Var=$World Type=String
	Declare Var=$worldtotal Type=Numeric
	Declare Var=$x Type=Numeric
	Declare Var=$xCoord Type=Numeric
	Declare Var=$xCoordText Type=String
	Declare Var=$xFill Type=String
	Declare Var=$xFillState Type=String
	Declare Var=$xMap Type=Numeric
	Declare Var=$xOffset Type=Numeric
	Declare Var=$xsea Type=String
	Declare Var=$Xstates Type=String
	Declare Var=$y Type=Numeric
	Declare Var=$yCoord Type=Numeric
	Declare Var=$yCoordText Type=String
	Declare Var=$Year Type=Numeric
	Declare Var=$YearFinds Type=Numeric
	Declare Var=$YearNow Type=Numeric
	Declare Var=$YearsAll Type=Boolean
	Declare Var=$YearsAllText Type=String
	Declare Var=$YearsDescending Type=Boolean
	Declare Var=$YearsDescendingText Type=String
	Declare Var=$yFill Type=String
	Declare Var=$yFillState Type=String
	Declare Var=$yMap Type=Numeric
	Declare Var=$yOffset Type=Numeric
	Declare Var=$ysea Type=String
	Declare Var=$Ystates Type=String
	Declare Var=$z Type=Numeric
	Declare Var=$ZeroElevation Type=Boolean
	Declare Var=$zblueh Type=String
	Declare Var=$zbluev Type=String
	Declare Var=$zgreenh Type=String
	Declare Var=$zgreenv Type=String
	Declare Var=$zredh Type=String
	Declare Var=$zredv Type=String
	Declare Var=$zyellowh Type=String
	Declare Var=$zyellowv Type=String

ENDSUB


<data> VarName=$colorpicker
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
<enddata>




##############################


